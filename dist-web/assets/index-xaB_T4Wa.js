(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function t(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=t(a);fetch(a.href,o)}})();function NC(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Vp={exports:{}},du={};var $x;function CC(){if($x)return du;$x=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,a,o){var c=null;if(o!==void 0&&(c=""+o),a.key!==void 0&&(c=""+a.key),"key"in a){o={};for(var d in a)d!=="key"&&(o[d]=a[d])}else o=a;return a=o.ref,{$$typeof:n,type:r,key:c,ref:a!==void 0?a:null,props:o}}return du.Fragment=e,du.jsx=t,du.jsxs=t,du}var Hx;function RC(){return Hx||(Hx=1,Vp.exports=CC()),Vp.exports}var m=RC(),Mp={exports:{}},Ve={};var Kx;function kC(){if(Kx)return Ve;Kx=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),E=Symbol.iterator;function S(q){return q===null||typeof q!="object"?null:(q=E&&q[E]||q["@@iterator"],typeof q=="function"?q:null)}var R={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j=Object.assign,N={};function I(q,F,L){this.props=q,this.context=F,this.refs=N,this.updater=L||R}I.prototype.isReactComponent={},I.prototype.setState=function(q,F){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,F,"setState")},I.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function te(){}te.prototype=I.prototype;function X(q,F,L){this.props=q,this.context=F,this.refs=N,this.updater=L||R}var de=X.prototype=new te;de.constructor=X,j(de,I.prototype),de.isPureReactComponent=!0;var ve=Array.isArray;function ge(){}var D={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function O(q,F,L){var Q=L.ref;return{$$typeof:n,type:q,key:F,ref:Q!==void 0?Q:null,props:L}}function z(q,F){return O(q.type,F,q.props)}function M(q){return typeof q=="object"&&q!==null&&q.$$typeof===n}function P(q){var F={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(L){return F[L]})}var k=/\/+/g;function Ne(q,F){return typeof q=="object"&&q!==null&&q.key!=null?P(""+q.key):F.toString(36)}function Ze(q){switch(q.status){case"fulfilled":return q.value;case"rejected":throw q.reason;default:switch(typeof q.status=="string"?q.then(ge,ge):(q.status="pending",q.then(function(F){q.status==="pending"&&(q.status="fulfilled",q.value=F)},function(F){q.status==="pending"&&(q.status="rejected",q.reason=F)})),q.status){case"fulfilled":return q.value;case"rejected":throw q.reason}}throw q}function B(q,F,L,Q,oe){var se=typeof q;(se==="undefined"||se==="boolean")&&(q=null);var $=!1;if(q===null)$=!0;else switch(se){case"bigint":case"string":case"number":$=!0;break;case"object":switch(q.$$typeof){case n:case e:$=!0;break;case v:return $=q._init,B($(q._payload),F,L,Q,oe)}}if($)return oe=oe(q),$=Q===""?"."+Ne(q,0):Q,ve(oe)?(L="",$!=null&&(L=$.replace(k,"$&/")+"/"),B(oe,F,L,"",function(Se){return Se})):oe!=null&&(M(oe)&&(oe=z(oe,L+(oe.key==null||q&&q.key===oe.key?"":(""+oe.key).replace(k,"$&/")+"/")+$)),F.push(oe)),1;$=0;var W=Q===""?".":Q+":";if(ve(q))for(var me=0;me<q.length;me++)Q=q[me],se=W+Ne(Q,me),$+=B(Q,F,L,se,oe);else if(me=S(q),typeof me=="function")for(q=me.call(q),me=0;!(Q=q.next()).done;)Q=Q.value,se=W+Ne(Q,me++),$+=B(Q,F,L,se,oe);else if(se==="object"){if(typeof q.then=="function")return B(Ze(q),F,L,Q,oe);throw F=String(q),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.")}return $}function ue(q,F,L){if(q==null)return q;var Q=[],oe=0;return B(q,Q,"","",function(se){return F.call(L,se,oe++)}),Q}function pe(q){if(q._status===-1){var F=q._result;F=F(),F.then(function(L){(q._status===0||q._status===-1)&&(q._status=1,q._result=L)},function(L){(q._status===0||q._status===-1)&&(q._status=2,q._result=L)}),q._status===-1&&(q._status=0,q._result=F)}if(q._status===1)return q._result.default;throw q._result}var Re=typeof reportError=="function"?reportError:function(q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var F=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof q=="object"&&q!==null&&typeof q.message=="string"?String(q.message):String(q),error:q});if(!window.dispatchEvent(F))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",q);return}console.error(q)},Pe={map:ue,forEach:function(q,F,L){ue(q,function(){F.apply(this,arguments)},L)},count:function(q){var F=0;return ue(q,function(){F++}),F},toArray:function(q){return ue(q,function(F){return F})||[]},only:function(q){if(!M(q))throw Error("React.Children.only expected to receive a single React element child.");return q}};return Ve.Activity=b,Ve.Children=Pe,Ve.Component=I,Ve.Fragment=t,Ve.Profiler=a,Ve.PureComponent=X,Ve.StrictMode=r,Ve.Suspense=f,Ve.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=D,Ve.__COMPILER_RUNTIME={__proto__:null,c:function(q){return D.H.useMemoCache(q)}},Ve.cache=function(q){return function(){return q.apply(null,arguments)}},Ve.cacheSignal=function(){return null},Ve.cloneElement=function(q,F,L){if(q==null)throw Error("The argument must be a React element, but you passed "+q+".");var Q=j({},q.props),oe=q.key;if(F!=null)for(se in F.key!==void 0&&(oe=""+F.key),F)!C.call(F,se)||se==="key"||se==="__self"||se==="__source"||se==="ref"&&F.ref===void 0||(Q[se]=F[se]);var se=arguments.length-2;if(se===1)Q.children=L;else if(1<se){for(var $=Array(se),W=0;W<se;W++)$[W]=arguments[W+2];Q.children=$}return O(q.type,oe,Q)},Ve.createContext=function(q){return q={$$typeof:c,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null},q.Provider=q,q.Consumer={$$typeof:o,_context:q},q},Ve.createElement=function(q,F,L){var Q,oe={},se=null;if(F!=null)for(Q in F.key!==void 0&&(se=""+F.key),F)C.call(F,Q)&&Q!=="key"&&Q!=="__self"&&Q!=="__source"&&(oe[Q]=F[Q]);var $=arguments.length-2;if($===1)oe.children=L;else if(1<$){for(var W=Array($),me=0;me<$;me++)W[me]=arguments[me+2];oe.children=W}if(q&&q.defaultProps)for(Q in $=q.defaultProps,$)oe[Q]===void 0&&(oe[Q]=$[Q]);return O(q,se,oe)},Ve.createRef=function(){return{current:null}},Ve.forwardRef=function(q){return{$$typeof:d,render:q}},Ve.isValidElement=M,Ve.lazy=function(q){return{$$typeof:v,_payload:{_status:-1,_result:q},_init:pe}},Ve.memo=function(q,F){return{$$typeof:p,type:q,compare:F===void 0?null:F}},Ve.startTransition=function(q){var F=D.T,L={};D.T=L;try{var Q=q(),oe=D.S;oe!==null&&oe(L,Q),typeof Q=="object"&&Q!==null&&typeof Q.then=="function"&&Q.then(ge,Re)}catch(se){Re(se)}finally{F!==null&&L.types!==null&&(F.types=L.types),D.T=F}},Ve.unstable_useCacheRefresh=function(){return D.H.useCacheRefresh()},Ve.use=function(q){return D.H.use(q)},Ve.useActionState=function(q,F,L){return D.H.useActionState(q,F,L)},Ve.useCallback=function(q,F){return D.H.useCallback(q,F)},Ve.useContext=function(q){return D.H.useContext(q)},Ve.useDebugValue=function(){},Ve.useDeferredValue=function(q,F){return D.H.useDeferredValue(q,F)},Ve.useEffect=function(q,F){return D.H.useEffect(q,F)},Ve.useEffectEvent=function(q){return D.H.useEffectEvent(q)},Ve.useId=function(){return D.H.useId()},Ve.useImperativeHandle=function(q,F,L){return D.H.useImperativeHandle(q,F,L)},Ve.useInsertionEffect=function(q,F){return D.H.useInsertionEffect(q,F)},Ve.useLayoutEffect=function(q,F){return D.H.useLayoutEffect(q,F)},Ve.useMemo=function(q,F){return D.H.useMemo(q,F)},Ve.useOptimistic=function(q,F){return D.H.useOptimistic(q,F)},Ve.useReducer=function(q,F,L){return D.H.useReducer(q,F,L)},Ve.useRef=function(q){return D.H.useRef(q)},Ve.useState=function(q){return D.H.useState(q)},Ve.useSyncExternalStore=function(q,F,L){return D.H.useSyncExternalStore(q,F,L)},Ve.useTransition=function(){return D.H.useTransition()},Ve.version="19.2.0",Ve}var Qx;function qy(){return Qx||(Qx=1,Mp.exports=kC()),Mp.exports}var V=qy();const Yx=NC(V);var Lp={exports:{}},hu={},Up={exports:{}},zp={};var Wx;function DC(){return Wx||(Wx=1,(function(n){function e(B,ue){var pe=B.length;B.push(ue);e:for(;0<pe;){var Re=pe-1>>>1,Pe=B[Re];if(0<a(Pe,ue))B[Re]=ue,B[pe]=Pe,pe=Re;else break e}}function t(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var ue=B[0],pe=B.pop();if(pe!==ue){B[0]=pe;e:for(var Re=0,Pe=B.length,q=Pe>>>1;Re<q;){var F=2*(Re+1)-1,L=B[F],Q=F+1,oe=B[Q];if(0>a(L,pe))Q<Pe&&0>a(oe,L)?(B[Re]=oe,B[Q]=pe,Re=Q):(B[Re]=L,B[F]=pe,Re=F);else if(Q<Pe&&0>a(oe,pe))B[Re]=oe,B[Q]=pe,Re=Q;else break e}}return ue}function a(B,ue){var pe=B.sortIndex-ue.sortIndex;return pe!==0?pe:B.id-ue.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var c=Date,d=c.now();n.unstable_now=function(){return c.now()-d}}var f=[],p=[],v=1,b=null,E=3,S=!1,R=!1,j=!1,N=!1,I=typeof setTimeout=="function"?setTimeout:null,te=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;function de(B){for(var ue=t(p);ue!==null;){if(ue.callback===null)r(p);else if(ue.startTime<=B)r(p),ue.sortIndex=ue.expirationTime,e(f,ue);else break;ue=t(p)}}function ve(B){if(j=!1,de(B),!R)if(t(f)!==null)R=!0,ge||(ge=!0,P());else{var ue=t(p);ue!==null&&Ze(ve,ue.startTime-B)}}var ge=!1,D=-1,C=5,O=-1;function z(){return N?!0:!(n.unstable_now()-O<C)}function M(){if(N=!1,ge){var B=n.unstable_now();O=B;var ue=!0;try{e:{R=!1,j&&(j=!1,te(D),D=-1),S=!0;var pe=E;try{t:{for(de(B),b=t(f);b!==null&&!(b.expirationTime>B&&z());){var Re=b.callback;if(typeof Re=="function"){b.callback=null,E=b.priorityLevel;var Pe=Re(b.expirationTime<=B);if(B=n.unstable_now(),typeof Pe=="function"){b.callback=Pe,de(B),ue=!0;break t}b===t(f)&&r(f),de(B)}else r(f);b=t(f)}if(b!==null)ue=!0;else{var q=t(p);q!==null&&Ze(ve,q.startTime-B),ue=!1}}break e}finally{b=null,E=pe,S=!1}ue=void 0}}finally{ue?P():ge=!1}}}var P;if(typeof X=="function")P=function(){X(M)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,Ne=k.port2;k.port1.onmessage=M,P=function(){Ne.postMessage(null)}}else P=function(){I(M,0)};function Ze(B,ue){D=I(function(){B(n.unstable_now())},ue)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return E},n.unstable_next=function(B){switch(E){case 1:case 2:case 3:var ue=3;break;default:ue=E}var pe=E;E=ue;try{return B()}finally{E=pe}},n.unstable_requestPaint=function(){N=!0},n.unstable_runWithPriority=function(B,ue){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var pe=E;E=B;try{return ue()}finally{E=pe}},n.unstable_scheduleCallback=function(B,ue,pe){var Re=n.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?Re+pe:Re):pe=Re,B){case 1:var Pe=-1;break;case 2:Pe=250;break;case 5:Pe=1073741823;break;case 4:Pe=1e4;break;default:Pe=5e3}return Pe=pe+Pe,B={id:v++,callback:ue,priorityLevel:B,startTime:pe,expirationTime:Pe,sortIndex:-1},pe>Re?(B.sortIndex=pe,e(p,B),t(f)===null&&B===t(p)&&(j?(te(D),D=-1):j=!0,Ze(ve,pe-Re))):(B.sortIndex=Pe,e(f,B),R||S||(R=!0,ge||(ge=!0,P()))),B},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(B){var ue=E;return function(){var pe=E;E=ue;try{return B.apply(this,arguments)}finally{E=pe}}}})(zp)),zp}var Xx;function jC(){return Xx||(Xx=1,Up.exports=DC()),Up.exports}var Fp={exports:{}},An={};var Jx;function OC(){if(Jx)return An;Jx=1;var n=qy();function e(f){var p="https://react.dev/errors/"+f;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)p+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+f+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(f,p,v){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:b==null?null:""+b,children:f,containerInfo:p,implementation:v}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(f,p){if(f==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return An.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,An.createPortal=function(f,p){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return o(f,p,null,v)},An.flushSync=function(f){var p=c.T,v=r.p;try{if(c.T=null,r.p=2,f)return f()}finally{c.T=p,r.p=v,r.d.f()}},An.preconnect=function(f,p){typeof f=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,r.d.C(f,p))},An.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},An.preinit=function(f,p){if(typeof f=="string"&&p&&typeof p.as=="string"){var v=p.as,b=d(v,p.crossOrigin),E=typeof p.integrity=="string"?p.integrity:void 0,S=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;v==="style"?r.d.S(f,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:b,integrity:E,fetchPriority:S}):v==="script"&&r.d.X(f,{crossOrigin:b,integrity:E,fetchPriority:S,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},An.preinitModule=function(f,p){if(typeof f=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var v=d(p.as,p.crossOrigin);r.d.M(f,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&r.d.M(f)},An.preload=function(f,p){if(typeof f=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var v=p.as,b=d(v,p.crossOrigin);r.d.L(f,v,{crossOrigin:b,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},An.preloadModule=function(f,p){if(typeof f=="string")if(p){var v=d(p.as,p.crossOrigin);r.d.m(f,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else r.d.m(f)},An.requestFormReset=function(f){r.d.r(f)},An.unstable_batchedUpdates=function(f,p){return f(p)},An.useFormState=function(f,p,v){return c.H.useFormState(f,p,v)},An.useFormStatus=function(){return c.H.useHostTransitionStatus()},An.version="19.2.0",An}var Zx;function PC(){if(Zx)return Fp.exports;Zx=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Fp.exports=OC(),Fp.exports}var ew;function VC(){if(ew)return hu;ew=1;var n=jC(),e=qy(),t=PC();function r(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,l=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(l=s.return),i=s.return;while(i)}return s.tag===3?l:null}function c(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function d(i){if(i.tag===31){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function f(i){if(o(i)!==i)throw Error(r(188))}function p(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(r(188));return s!==i?null:i}for(var l=i,u=s;;){var g=l.return;if(g===null)break;var y=g.alternate;if(y===null){if(u=g.return,u!==null){l=u;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===l)return f(g),i;if(y===u)return f(g),s;y=y.sibling}throw Error(r(188))}if(l.return!==u.return)l=g,u=y;else{for(var x=!1,T=g.child;T;){if(T===l){x=!0,l=g,u=y;break}if(T===u){x=!0,u=g,l=y;break}T=T.sibling}if(!x){for(T=y.child;T;){if(T===l){x=!0,l=y,u=g;break}if(T===u){x=!0,u=y,l=g;break}T=T.sibling}if(!x)throw Error(r(189))}}if(l.alternate!==u)throw Error(r(190))}if(l.tag!==3)throw Error(r(188));return l.stateNode.current===l?i:s}function v(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=v(i),s!==null)return s;i=i.sibling}return null}var b=Object.assign,E=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),R=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),te=Symbol.for("react.consumer"),X=Symbol.for("react.context"),de=Symbol.for("react.forward_ref"),ve=Symbol.for("react.suspense"),ge=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),z=Symbol.for("react.memo_cache_sentinel"),M=Symbol.iterator;function P(i){return i===null||typeof i!="object"?null:(i=M&&i[M]||i["@@iterator"],typeof i=="function"?i:null)}var k=Symbol.for("react.client.reference");function Ne(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===k?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case j:return"Fragment";case I:return"Profiler";case N:return"StrictMode";case ve:return"Suspense";case ge:return"SuspenseList";case O:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case R:return"Portal";case X:return i.displayName||"Context";case te:return(i._context.displayName||"Context")+".Consumer";case de:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case D:return s=i.displayName||null,s!==null?s:Ne(i.type)||"Memo";case C:s=i._payload,i=i._init;try{return Ne(i(s))}catch{}}return null}var Ze=Array.isArray,B=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,pe={pending:!1,data:null,method:null,action:null},Re=[],Pe=-1;function q(i){return{current:i}}function F(i){0>Pe||(i.current=Re[Pe],Re[Pe]=null,Pe--)}function L(i,s){Pe++,Re[Pe]=i.current,i.current=s}var Q=q(null),oe=q(null),se=q(null),$=q(null);function W(i,s){switch(L(se,s),L(oe,i),L(Q,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?mx(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=mx(s),i=gx(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}F(Q),L(Q,i)}function me(){F(Q),F(oe),F(se)}function Se(i){i.memoizedState!==null&&L($,i);var s=Q.current,l=gx(s,i.type);s!==l&&(L(oe,i),L(Q,l))}function Fe(i){oe.current===i&&(F(Q),F(oe)),$.current===i&&(F($),ou._currentValue=pe)}var jt,zt;function Rt(i){if(jt===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);jt=s&&s[1]||"",zt=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+jt+i+zt}var ai=!1;function Io(i,s){if(!i||ai)return"";ai=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(s){var ce=function(){throw Error()};if(Object.defineProperty(ce.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ce,[])}catch(re){var ee=re}Reflect.construct(i,[],ce)}else{try{ce.call()}catch(re){ee=re}i.call(ce.prototype)}}else{try{throw Error()}catch(re){ee=re}(ce=i())&&typeof ce.catch=="function"&&ce.catch(function(){})}}catch(re){if(re&&ee&&typeof re.stack=="string")return[re.stack,ee.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=u.DetermineComponentFrameRoot(),x=y[0],T=y[1];if(x&&T){var U=x.split(`
`),Z=T.split(`
`);for(g=u=0;u<U.length&&!U[u].includes("DetermineComponentFrameRoot");)u++;for(;g<Z.length&&!Z[g].includes("DetermineComponentFrameRoot");)g++;if(u===U.length||g===Z.length)for(u=U.length-1,g=Z.length-1;1<=u&&0<=g&&U[u]!==Z[g];)g--;for(;1<=u&&0<=g;u--,g--)if(U[u]!==Z[g]){if(u!==1||g!==1)do if(u--,g--,0>g||U[u]!==Z[g]){var ae=`
`+U[u].replace(" at new "," at ");return i.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",i.displayName)),ae}while(1<=u&&0<=g);break}}}finally{ai=!1,Error.prepareStackTrace=l}return(l=i?i.displayName||i.name:"")?Rt(l):""}function jm(i,s){switch(i.tag){case 26:case 27:case 5:return Rt(i.type);case 16:return Rt("Lazy");case 13:return i.child!==s&&s!==null?Rt("Suspense Fallback"):Rt("Suspense");case 19:return Rt("SuspenseList");case 0:case 15:return Io(i.type,!1);case 11:return Io(i.type.render,!1);case 1:return Io(i.type,!0);case 31:return Rt("Activity");default:return""}}function wd(i){try{var s="",l=null;do s+=jm(i,l),l=i,i=i.return;while(i);return s}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var Ao=Object.prototype.hasOwnProperty,wa=n.unstable_scheduleCallback,No=n.unstable_cancelCallback,Om=n.unstable_shouldYield,uc=n.unstable_requestPaint,gn=n.unstable_now,Ed=n.unstable_getCurrentPriorityLevel,en=n.unstable_ImmediatePriority,an=n.unstable_UserBlockingPriority,oi=n.unstable_NormalPriority,Td=n.unstable_LowPriority,dc=n.unstable_IdlePriority,Pm=n.log,Ea=n.unstable_setDisableYieldValue,ns=null,Sn=null;function cr(i){if(typeof Pm=="function"&&Ea(i),Sn&&typeof Sn.setStrictMode=="function")try{Sn.setStrictMode(ns,i)}catch{}}var Dn=Math.clz32?Math.clz32:Sd,Vm=Math.log,hc=Math.LN2;function Sd(i){return i>>>=0,i===0?32:31-(Vm(i)/hc|0)|0}var Ta=256,zr=262144,rs=4194304;function Ir(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return i&261888;case 262144:case 524288:case 1048576:case 2097152:return i&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function ur(i,s,l){var u=i.pendingLanes;if(u===0)return 0;var g=0,y=i.suspendedLanes,x=i.pingedLanes;i=i.warmLanes;var T=u&134217727;return T!==0?(u=T&~y,u!==0?g=Ir(u):(x&=T,x!==0?g=Ir(x):l||(l=T&~i,l!==0&&(g=Ir(l))))):(T=u&~y,T!==0?g=Ir(T):x!==0?g=Ir(x):l||(l=u&~i,l!==0&&(g=Ir(l)))),g===0?0:s!==0&&s!==g&&(s&y)===0&&(y=g&-g,l=s&-s,y>=l||y===32&&(l&4194048)!==0)?s:g}function is(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function Co(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function fc(){var i=rs;return rs<<=1,(rs&62914560)===0&&(rs=4194304),i}function li(i){for(var s=[],l=0;31>l;l++)s.push(i);return s}function ss(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function pn(i,s,l,u,g,y){var x=i.pendingLanes;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=l,i.entangledLanes&=l,i.errorRecoveryDisabledLanes&=l,i.shellSuspendCounter=0;var T=i.entanglements,U=i.expirationTimes,Z=i.hiddenUpdates;for(l=x&~l;0<l;){var ae=31-Dn(l),ce=1<<ae;T[ae]=0,U[ae]=-1;var ee=Z[ae];if(ee!==null)for(Z[ae]=null,ae=0;ae<ee.length;ae++){var re=ee[ae];re!==null&&(re.lane&=-536870913)}l&=~ce}u!==0&&mc(i,u,0),y!==0&&g===0&&i.tag!==0&&(i.suspendedLanes|=y&~(x&~s))}function mc(i,s,l){i.pendingLanes|=s,i.suspendedLanes&=~s;var u=31-Dn(s);i.entangledLanes|=s,i.entanglements[u]=i.entanglements[u]|1073741824|l&261930}function as(i,s){var l=i.entangledLanes|=s;for(i=i.entanglements;l;){var u=31-Dn(l),g=1<<u;g&s|i[u]&s&&(i[u]|=s),l&=~g}}function os(i,s){var l=s&-s;return l=(l&42)!==0?1:gc(l),(l&(i.suspendedLanes|s))!==0?0:l}function gc(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function pc(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function ci(){var i=ue.p;return i!==0?i:(i=window.event,i===void 0?32:Lx(i.type))}function Id(i,s){var l=ue.p;try{return ue.p=i,s()}finally{ue.p=l}}var Fr=Math.random().toString(36).slice(2),Ot="__reactFiber$"+Fr,yn="__reactProps$"+Fr,Br="__reactContainer$"+Fr,ls="__reactEvents$"+Fr,qr="__reactListeners$"+Fr,Ad="__reactHandles$"+Fr,yc="__reactResources$"+Fr,ui="__reactMarker$"+Fr;function Sa(i){delete i[Ot],delete i[yn],delete i[ls],delete i[qr],delete i[Ad]}function di(i){var s=i[Ot];if(s)return s;for(var l=i.parentNode;l;){if(s=l[Br]||l[Ot]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(i=wx(i);i!==null;){if(l=i[Ot])return l;i=wx(i)}return s}i=l,l=i.parentNode}return null}function hi(i){if(i=i[Ot]||i[Br]){var s=i.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return i}return null}function Ia(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(r(33))}function Ar(i){var s=i[yc];return s||(s=i[yc]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Ft(i){i[ui]=!0}var Ro=new Set,cs={};function jn(i,s){Gr(i,s),Gr(i+"Capture",s)}function Gr(i,s){for(cs[i]=s,i=0;i<s.length;i++)Ro.add(s[i])}var Mm=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),vc={},_c={};function Nd(i){return Ao.call(_c,i)?!0:Ao.call(vc,i)?!1:Mm.test(i)?_c[i]=!0:(vc[i]=!0,!1)}function us(i,s,l){if(Nd(s))if(l===null)i.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var u=s.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+l)}}function ds(i,s,l){if(l===null)i.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+l)}}function dr(i,s,l,u){if(u===null)i.removeAttribute(l);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttributeNS(s,l,""+u)}}function On(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Cd(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Lm(i,s,l){var u=Object.getOwnPropertyDescriptor(i.constructor.prototype,s);if(!i.hasOwnProperty(s)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,y=u.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return g.call(this)},set:function(x){l=""+x,y.call(this,x)}}),Object.defineProperty(i,s,{enumerable:u.enumerable}),{getValue:function(){return l},setValue:function(x){l=""+x},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function ko(i){if(!i._valueTracker){var s=Cd(i)?"checked":"value";i._valueTracker=Lm(i,s,""+i[s])}}function bc(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var l=s.getValue(),u="";return i&&(u=Cd(i)?i.checked?"true":"false":i.value),i=u,i!==l?(s.setValue(i),!0):!1}function Do(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var fi=/[\n"\\]/g;function Pt(i){return i.replace(fi,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function hs(i,s,l,u,g,y,x,T){i.name="",x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?i.type=x:i.removeAttribute("type"),s!=null?x==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+On(s)):i.value!==""+On(s)&&(i.value=""+On(s)):x!=="submit"&&x!=="reset"||i.removeAttribute("value"),s!=null?jo(i,x,On(s)):l!=null?jo(i,x,On(l)):u!=null&&i.removeAttribute("value"),g==null&&y!=null&&(i.defaultChecked=!!y),g!=null&&(i.checked=g&&typeof g!="function"&&typeof g!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?i.name=""+On(T):i.removeAttribute("name")}function Aa(i,s,l,u,g,y,x,T){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(i.type=y),s!=null||l!=null){if(!(y!=="submit"&&y!=="reset"||s!=null)){ko(i);return}l=l!=null?""+On(l):"",s=s!=null?""+On(s):l,T||s===i.value||(i.value=s),i.defaultValue=s}u=u??g,u=typeof u!="function"&&typeof u!="symbol"&&!!u,i.checked=T?i.checked:!!u,i.defaultChecked=!!u,x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(i.name=x),ko(i)}function jo(i,s,l){s==="number"&&Do(i.ownerDocument)===i||i.defaultValue===""+l||(i.defaultValue=""+l)}function et(i,s,l,u){if(i=i.options,s){s={};for(var g=0;g<l.length;g++)s["$"+l[g]]=!0;for(l=0;l<i.length;l++)g=s.hasOwnProperty("$"+i[l].value),i[l].selected!==g&&(i[l].selected=g),g&&u&&(i[l].defaultSelected=!0)}else{for(l=""+On(l),s=null,g=0;g<i.length;g++){if(i[g].value===l){i[g].selected=!0,u&&(i[g].defaultSelected=!0);return}s!==null||i[g].disabled||(s=i[g])}s!==null&&(s.selected=!0)}}function Na(i,s,l){if(s!=null&&(s=""+On(s),s!==i.value&&(i.value=s),l==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=l!=null?""+On(l):""}function fs(i,s,l,u){if(s==null){if(u!=null){if(l!=null)throw Error(r(92));if(Ze(u)){if(1<u.length)throw Error(r(93));u=u[0]}l=u}l==null&&(l=""),s=l}l=On(s),i.defaultValue=l,u=i.textContent,u===l&&u!==""&&u!==null&&(i.value=u),ko(i)}function hr(i,s){if(s){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=s;return}}i.textContent=s}var Um=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function xc(i,s,l){var u=s.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?u?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":u?i.setProperty(s,l):typeof l!="number"||l===0||Um.has(s)?s==="float"?i.cssFloat=l:i[s]=(""+l).trim():i[s]=l+"px"}function Rd(i,s,l){if(s!=null&&typeof s!="object")throw Error(r(62));if(i=i.style,l!=null){for(var u in l)!l.hasOwnProperty(u)||s!=null&&s.hasOwnProperty(u)||(u.indexOf("--")===0?i.setProperty(u,""):u==="float"?i.cssFloat="":i[u]="");for(var g in s)u=s[g],s.hasOwnProperty(g)&&l[g]!==u&&xc(i,g,u)}else for(var y in s)s.hasOwnProperty(y)&&xc(i,y,s[y])}function wc(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zm=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Fm=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function $r(i){return Fm.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}function on(){}var Oo=null;function Po(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var mi=null,Yn=null;function kd(i){var s=hi(i);if(s&&(i=s.stateNode)){var l=i[yn]||null;e:switch(i=s.stateNode,s.type){case"input":if(hs(i,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),s=l.name,l.type==="radio"&&s!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Pt(""+s)+'"][type="radio"]'),s=0;s<l.length;s++){var u=l[s];if(u!==i&&u.form===i.form){var g=u[yn]||null;if(!g)throw Error(r(90));hs(u,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<l.length;s++)u=l[s],u.form===i.form&&bc(u)}break e;case"textarea":Na(i,l.value,l.defaultValue);break e;case"select":s=l.value,s!=null&&et(i,!!l.multiple,s,!1)}}}var Ec=!1;function Dd(i,s,l){if(Ec)return i(s,l);Ec=!0;try{var u=i(s);return u}finally{if(Ec=!1,(mi!==null||Yn!==null)&&(Nh(),mi&&(s=mi,i=Yn,Yn=mi=null,kd(s),i)))for(s=0;s<i.length;s++)kd(i[s])}}function Un(i,s){var l=i.stateNode;if(l===null)return null;var u=l[yn]||null;if(u===null)return null;l=u[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(i=i.type,u=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!u;break e;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(r(231,s,typeof l));return l}var Nr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tc=!1;if(Nr)try{var Hr={};Object.defineProperty(Hr,"passive",{get:function(){Tc=!0}}),window.addEventListener("test",Hr,Hr),window.removeEventListener("test",Hr,Hr)}catch{Tc=!1}var Wn=null,Vo=null,Kr=null;function ms(){if(Kr)return Kr;var i,s=Vo,l=s.length,u,g="value"in Wn?Wn.value:Wn.textContent,y=g.length;for(i=0;i<l&&s[i]===g[i];i++);var x=l-i;for(u=1;u<=x&&s[l-u]===g[y-u];u++);return Kr=g.slice(i,1<u?1-u:void 0)}function Ca(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function gs(){return!0}function _t(){return!1}function In(i){function s(l,u,g,y,x){this._reactName=l,this._targetInst=g,this.type=u,this.nativeEvent=y,this.target=x,this.currentTarget=null;for(var T in i)i.hasOwnProperty(T)&&(l=i[T],this[T]=l?l(y):y[T]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?gs:_t,this.isPropagationStopped=_t,this}return b(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=gs)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=gs)},persist:function(){},isPersistent:gs}),s}var gi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ra=In(gi),ps=b({},gi,{view:0,detail:0}),jd=In(ps),ys,Mo,Pn,ka=b({},ps,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_s,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Pn&&(Pn&&i.type==="mousemove"?(ys=i.screenX-Pn.screenX,Mo=i.screenY-Pn.screenY):Mo=ys=0,Pn=i),ys)},movementY:function(i){return"movementY"in i?i.movementY:Mo}}),Od=In(ka),Da=b({},ka,{dataTransfer:0}),Pd=In(Da),Sc=b({},ps,{relatedTarget:0}),vs=In(Sc),Vd=b({},gi,{animationName:0,elapsedTime:0,pseudoElement:0}),Lo=In(Vd),Bm=b({},gi,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Md=In(Bm),ja=b({},gi,{data:0}),Ic=In(ja),Ld={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ac={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ud(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=Nc[i])?!!s[i]:!1}function _s(){return Ud}var zd=b({},ps,{key:function(i){if(i.key){var s=Ld[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Ca(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Ac[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_s,charCode:function(i){return i.type==="keypress"?Ca(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ca(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Fd=In(zd),pi=b({},ka,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cc=In(pi),Bd=b({},ps,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_s}),qd=In(Bd),Gd=b({},gi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Uo=In(Gd),Vn=b({},ka,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),$d=In(Vn),Hd=b({},gi,{newState:0,oldState:0}),bs=In(Hd),h=[9,13,27,32],_=Nr&&"CompositionEvent"in window,w=null;Nr&&"documentMode"in document&&(w=document.documentMode);var A=Nr&&"TextEvent"in window&&!w,Y=Nr&&(!_||w&&8<w&&11>=w),ie=" ",ye=!1;function at(i,s){switch(i){case"keyup":return h.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Kt(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ze=!1;function ln(i,s){switch(i){case"compositionend":return Kt(s);case"keypress":return s.which!==32?null:(ye=!0,ie);case"textInput":return i=s.data,i===ie&&ye?null:i;default:return null}}function cn(i,s){if(ze)return i==="compositionend"||!_&&at(i,s)?(i=ms(),Kr=Vo=Wn=null,ze=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Y&&s.locale!=="ko"?null:s.data;default:return null}}var xs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zn(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!xs[i.type]:s==="textarea"}function Oa(i,s,l,u){mi?Yn?Yn.push(u):Yn=[u]:mi=u,s=Ph(s,"onChange"),0<s.length&&(l=new Ra("onChange","change",null,l,u),i.push({event:l,listeners:s}))}var yi=null,Rc=null;function t1(i){lx(i,0)}function Kd(i){var s=Ia(i);if(bc(s))return i}function Av(i,s){if(i==="change")return s}var Nv=!1;if(Nr){var qm;if(Nr){var Gm="oninput"in document;if(!Gm){var Cv=document.createElement("div");Cv.setAttribute("oninput","return;"),Gm=typeof Cv.oninput=="function"}qm=Gm}else qm=!1;Nv=qm&&(!document.documentMode||9<document.documentMode)}function Rv(){yi&&(yi.detachEvent("onpropertychange",kv),Rc=yi=null)}function kv(i){if(i.propertyName==="value"&&Kd(Rc)){var s=[];Oa(s,Rc,i,Po(i)),Dd(t1,s)}}function n1(i,s,l){i==="focusin"?(Rv(),yi=s,Rc=l,yi.attachEvent("onpropertychange",kv)):i==="focusout"&&Rv()}function r1(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Kd(Rc)}function i1(i,s){if(i==="click")return Kd(s)}function s1(i,s){if(i==="input"||i==="change")return Kd(s)}function a1(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var Xn=typeof Object.is=="function"?Object.is:a1;function kc(i,s){if(Xn(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var l=Object.keys(i),u=Object.keys(s);if(l.length!==u.length)return!1;for(u=0;u<l.length;u++){var g=l[u];if(!Ao.call(s,g)||!Xn(i[g],s[g]))return!1}return!0}function Dv(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function jv(i,s){var l=Dv(i);i=0;for(var u;l;){if(l.nodeType===3){if(u=i+l.textContent.length,i<=s&&u>=s)return{node:l,offset:s-i};i=u}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Dv(l)}}function Ov(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?Ov(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function Pv(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=Do(i.document);s instanceof i.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)i=s.contentWindow;else break;s=Do(i.document)}return s}function $m(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var o1=Nr&&"documentMode"in document&&11>=document.documentMode,zo=null,Hm=null,Dc=null,Km=!1;function Vv(i,s,l){var u=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Km||zo==null||zo!==Do(u)||(u=zo,"selectionStart"in u&&$m(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Dc&&kc(Dc,u)||(Dc=u,u=Ph(Hm,"onSelect"),0<u.length&&(s=new Ra("onSelect","select",null,s,l),i.push({event:s,listeners:u}),s.target=zo)))}function Pa(i,s){var l={};return l[i.toLowerCase()]=s.toLowerCase(),l["Webkit"+i]="webkit"+s,l["Moz"+i]="moz"+s,l}var Fo={animationend:Pa("Animation","AnimationEnd"),animationiteration:Pa("Animation","AnimationIteration"),animationstart:Pa("Animation","AnimationStart"),transitionrun:Pa("Transition","TransitionRun"),transitionstart:Pa("Transition","TransitionStart"),transitioncancel:Pa("Transition","TransitionCancel"),transitionend:Pa("Transition","TransitionEnd")},Qm={},Mv={};Nr&&(Mv=document.createElement("div").style,"AnimationEvent"in window||(delete Fo.animationend.animation,delete Fo.animationiteration.animation,delete Fo.animationstart.animation),"TransitionEvent"in window||delete Fo.transitionend.transition);function Va(i){if(Qm[i])return Qm[i];if(!Fo[i])return i;var s=Fo[i],l;for(l in s)if(s.hasOwnProperty(l)&&l in Mv)return Qm[i]=s[l];return i}var Lv=Va("animationend"),Uv=Va("animationiteration"),zv=Va("animationstart"),l1=Va("transitionrun"),c1=Va("transitionstart"),u1=Va("transitioncancel"),Fv=Va("transitionend"),Bv=new Map,Ym="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ym.push("scrollEnd");function Cr(i,s){Bv.set(i,s),jn(s,[i])}var Qd=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)},fr=[],Bo=0,Wm=0;function Yd(){for(var i=Bo,s=Wm=Bo=0;s<i;){var l=fr[s];fr[s++]=null;var u=fr[s];fr[s++]=null;var g=fr[s];fr[s++]=null;var y=fr[s];if(fr[s++]=null,u!==null&&g!==null){var x=u.pending;x===null?g.next=g:(g.next=x.next,x.next=g),u.pending=g}y!==0&&qv(l,g,y)}}function Wd(i,s,l,u){fr[Bo++]=i,fr[Bo++]=s,fr[Bo++]=l,fr[Bo++]=u,Wm|=u,i.lanes|=u,i=i.alternate,i!==null&&(i.lanes|=u)}function Xm(i,s,l,u){return Wd(i,s,l,u),Xd(i)}function Ma(i,s){return Wd(i,null,null,s),Xd(i)}function qv(i,s,l){i.lanes|=l;var u=i.alternate;u!==null&&(u.lanes|=l);for(var g=!1,y=i.return;y!==null;)y.childLanes|=l,u=y.alternate,u!==null&&(u.childLanes|=l),y.tag===22&&(i=y.stateNode,i===null||i._visibility&1||(g=!0)),i=y,y=y.return;return i.tag===3?(y=i.stateNode,g&&s!==null&&(g=31-Dn(l),i=y.hiddenUpdates,u=i[g],u===null?i[g]=[s]:u.push(s),s.lane=l|536870912),y):null}function Xd(i){if(50<eu)throw eu=0,ap=null,Error(r(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var qo={};function d1(i,s,l,u){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jn(i,s,l,u){return new d1(i,s,l,u)}function Jm(i){return i=i.prototype,!(!i||!i.isReactComponent)}function vi(i,s){var l=i.alternate;return l===null?(l=Jn(i.tag,s,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=s,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&65011712,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,s=i.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l.refCleanup=i.refCleanup,l}function Gv(i,s){i.flags&=65011714;var l=i.alternate;return l===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,s=l.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function Jd(i,s,l,u,g,y){var x=0;if(u=i,typeof i=="function")Jm(i)&&(x=1);else if(typeof i=="string")x=pC(i,l,Q.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case O:return i=Jn(31,l,s,g),i.elementType=O,i.lanes=y,i;case j:return La(l.children,g,y,s);case N:x=8,g|=24;break;case I:return i=Jn(12,l,s,g|2),i.elementType=I,i.lanes=y,i;case ve:return i=Jn(13,l,s,g),i.elementType=ve,i.lanes=y,i;case ge:return i=Jn(19,l,s,g),i.elementType=ge,i.lanes=y,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case X:x=10;break e;case te:x=9;break e;case de:x=11;break e;case D:x=14;break e;case C:x=16,u=null;break e}x=29,l=Error(r(130,i===null?"null":typeof i,"")),u=null}return s=Jn(x,l,s,g),s.elementType=i,s.type=u,s.lanes=y,s}function La(i,s,l,u){return i=Jn(7,i,u,s),i.lanes=l,i}function Zm(i,s,l){return i=Jn(6,i,null,s),i.lanes=l,i}function $v(i){var s=Jn(18,null,null,0);return s.stateNode=i,s}function eg(i,s,l){return s=Jn(4,i.children!==null?i.children:[],i.key,s),s.lanes=l,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var Hv=new WeakMap;function mr(i,s){if(typeof i=="object"&&i!==null){var l=Hv.get(i);return l!==void 0?l:(s={value:i,source:s,stack:wd(s)},Hv.set(i,s),s)}return{value:i,source:s,stack:wd(s)}}var Go=[],$o=0,Zd=null,jc=0,gr=[],pr=0,ws=null,Qr=1,Yr="";function _i(i,s){Go[$o++]=jc,Go[$o++]=Zd,Zd=i,jc=s}function Kv(i,s,l){gr[pr++]=Qr,gr[pr++]=Yr,gr[pr++]=ws,ws=i;var u=Qr;i=Yr;var g=32-Dn(u)-1;u&=~(1<<g),l+=1;var y=32-Dn(s)+g;if(30<y){var x=g-g%5;y=(u&(1<<x)-1).toString(32),u>>=x,g-=x,Qr=1<<32-Dn(s)+g|l<<g|u,Yr=y+i}else Qr=1<<y|l<<g|u,Yr=i}function tg(i){i.return!==null&&(_i(i,1),Kv(i,1,0))}function ng(i){for(;i===Zd;)Zd=Go[--$o],Go[$o]=null,jc=Go[--$o],Go[$o]=null;for(;i===ws;)ws=gr[--pr],gr[pr]=null,Yr=gr[--pr],gr[pr]=null,Qr=gr[--pr],gr[pr]=null}function Qv(i,s){gr[pr++]=Qr,gr[pr++]=Yr,gr[pr++]=ws,Qr=s.id,Yr=s.overflow,ws=i}var vn=null,bt=null,Xe=!1,Es=null,yr=!1,rg=Error(r(519));function Ts(i){var s=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Oc(mr(s,i)),rg}function Yv(i){var s=i.stateNode,l=i.type,u=i.memoizedProps;switch(s[Ot]=i,s[yn]=u,l){case"dialog":$e("cancel",s),$e("close",s);break;case"iframe":case"object":case"embed":$e("load",s);break;case"video":case"audio":for(l=0;l<nu.length;l++)$e(nu[l],s);break;case"source":$e("error",s);break;case"img":case"image":case"link":$e("error",s),$e("load",s);break;case"details":$e("toggle",s);break;case"input":$e("invalid",s),Aa(s,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":$e("invalid",s);break;case"textarea":$e("invalid",s),fs(s,u.value,u.defaultValue,u.children)}l=u.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||s.textContent===""+l||u.suppressHydrationWarning===!0||hx(s.textContent,l)?(u.popover!=null&&($e("beforetoggle",s),$e("toggle",s)),u.onScroll!=null&&$e("scroll",s),u.onScrollEnd!=null&&$e("scrollend",s),u.onClick!=null&&(s.onclick=on),s=!0):s=!1,s||Ts(i,!0)}function Wv(i){for(vn=i.return;vn;)switch(vn.tag){case 5:case 31:case 13:yr=!1;return;case 27:case 3:yr=!0;return;default:vn=vn.return}}function Ho(i){if(i!==vn)return!1;if(!Xe)return Wv(i),Xe=!0,!1;var s=i.tag,l;if((l=s!==3&&s!==27)&&((l=s===5)&&(l=i.type,l=!(l!=="form"&&l!=="button")||xp(i.type,i.memoizedProps)),l=!l),l&&bt&&Ts(i),Wv(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));bt=xx(i)}else if(s===31){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));bt=xx(i)}else s===27?(s=bt,Ls(i.type)?(i=Ip,Ip=null,bt=i):bt=s):bt=vn?_r(i.stateNode.nextSibling):null;return!0}function Ua(){bt=vn=null,Xe=!1}function ig(){var i=Es;return i!==null&&(Gn===null?Gn=i:Gn.push.apply(Gn,i),Es=null),i}function Oc(i){Es===null?Es=[i]:Es.push(i)}var sg=q(null),za=null,bi=null;function Ss(i,s,l){L(sg,s._currentValue),s._currentValue=l}function xi(i){i._currentValue=sg.current,F(sg)}function ag(i,s,l){for(;i!==null;){var u=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,u!==null&&(u.childLanes|=s)):u!==null&&(u.childLanes&s)!==s&&(u.childLanes|=s),i===l)break;i=i.return}}function og(i,s,l,u){var g=i.child;for(g!==null&&(g.return=i);g!==null;){var y=g.dependencies;if(y!==null){var x=g.child;y=y.firstContext;e:for(;y!==null;){var T=y;y=g;for(var U=0;U<s.length;U++)if(T.context===s[U]){y.lanes|=l,T=y.alternate,T!==null&&(T.lanes|=l),ag(y.return,l,i),u||(x=null);break e}y=T.next}}else if(g.tag===18){if(x=g.return,x===null)throw Error(r(341));x.lanes|=l,y=x.alternate,y!==null&&(y.lanes|=l),ag(x,l,i),x=null}else x=g.child;if(x!==null)x.return=g;else for(x=g;x!==null;){if(x===i){x=null;break}if(g=x.sibling,g!==null){g.return=x.return,x=g;break}x=x.return}g=x}}function Ko(i,s,l,u){i=null;for(var g=s,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var x=g.alternate;if(x===null)throw Error(r(387));if(x=x.memoizedProps,x!==null){var T=g.type;Xn(g.pendingProps.value,x.value)||(i!==null?i.push(T):i=[T])}}else if(g===$.current){if(x=g.alternate,x===null)throw Error(r(387));x.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(i!==null?i.push(ou):i=[ou])}g=g.return}i!==null&&og(s,i,l,u),s.flags|=262144}function eh(i){for(i=i.firstContext;i!==null;){if(!Xn(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function Fa(i){za=i,bi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function _n(i){return Xv(za,i)}function th(i,s){return za===null&&Fa(i),Xv(i,s)}function Xv(i,s){var l=s._currentValue;if(s={context:s,memoizedValue:l,next:null},bi===null){if(i===null)throw Error(r(308));bi=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else bi=bi.next=s;return l}var h1=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(l,u){i.push(u)}};this.abort=function(){s.aborted=!0,i.forEach(function(l){return l()})}},f1=n.unstable_scheduleCallback,m1=n.unstable_NormalPriority,Qt={$$typeof:X,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function lg(){return{controller:new h1,data:new Map,refCount:0}}function Pc(i){i.refCount--,i.refCount===0&&f1(m1,function(){i.controller.abort()})}var Vc=null,cg=0,Qo=0,Yo=null;function g1(i,s){if(Vc===null){var l=Vc=[];cg=0,Qo=hp(),Yo={status:"pending",value:void 0,then:function(u){l.push(u)}}}return cg++,s.then(Jv,Jv),s}function Jv(){if(--cg===0&&Vc!==null){Yo!==null&&(Yo.status="fulfilled");var i=Vc;Vc=null,Qo=0,Yo=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function p1(i,s){var l=[],u={status:"pending",value:null,reason:null,then:function(g){l.push(g)}};return i.then(function(){u.status="fulfilled",u.value=s;for(var g=0;g<l.length;g++)(0,l[g])(s)},function(g){for(u.status="rejected",u.reason=g,g=0;g<l.length;g++)(0,l[g])(void 0)}),u}var Zv=B.S;B.S=function(i,s){Vb=gn(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&g1(i,s),Zv!==null&&Zv(i,s)};var Ba=q(null);function ug(){var i=Ba.current;return i!==null?i:pt.pooledCache}function nh(i,s){s===null?L(Ba,Ba.current):L(Ba,s.pool)}function e_(){var i=ug();return i===null?null:{parent:Qt._currentValue,pool:i}}var Wo=Error(r(460)),dg=Error(r(474)),rh=Error(r(542)),ih={then:function(){}};function t_(i){return i=i.status,i==="fulfilled"||i==="rejected"}function n_(i,s,l){switch(l=i[l],l===void 0?i.push(s):l!==s&&(s.then(on,on),s=l),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,i_(i),i;default:if(typeof s.status=="string")s.then(on,on);else{if(i=pt,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=s,i.status="pending",i.then(function(u){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=u}},function(u){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=u}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,i_(i),i}throw Ga=s,Wo}}function qa(i){try{var s=i._init;return s(i._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Ga=l,Wo):l}}var Ga=null;function r_(){if(Ga===null)throw Error(r(459));var i=Ga;return Ga=null,i}function i_(i){if(i===Wo||i===rh)throw Error(r(483))}var Xo=null,Mc=0;function sh(i){var s=Mc;return Mc+=1,Xo===null&&(Xo=[]),n_(Xo,i,s)}function Lc(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function ah(i,s){throw s.$$typeof===E?Error(r(525)):(i=Object.prototype.toString.call(s),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function s_(i){function s(H,G){if(i){var J=H.deletions;J===null?(H.deletions=[G],H.flags|=16):J.push(G)}}function l(H,G){if(!i)return null;for(;G!==null;)s(H,G),G=G.sibling;return null}function u(H){for(var G=new Map;H!==null;)H.key!==null?G.set(H.key,H):G.set(H.index,H),H=H.sibling;return G}function g(H,G){return H=vi(H,G),H.index=0,H.sibling=null,H}function y(H,G,J){return H.index=J,i?(J=H.alternate,J!==null?(J=J.index,J<G?(H.flags|=67108866,G):J):(H.flags|=67108866,G)):(H.flags|=1048576,G)}function x(H){return i&&H.alternate===null&&(H.flags|=67108866),H}function T(H,G,J,le){return G===null||G.tag!==6?(G=Zm(J,H.mode,le),G.return=H,G):(G=g(G,J),G.return=H,G)}function U(H,G,J,le){var Ce=J.type;return Ce===j?ae(H,G,J.props.children,le,J.key):G!==null&&(G.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===C&&qa(Ce)===G.type)?(G=g(G,J.props),Lc(G,J),G.return=H,G):(G=Jd(J.type,J.key,J.props,null,H.mode,le),Lc(G,J),G.return=H,G)}function Z(H,G,J,le){return G===null||G.tag!==4||G.stateNode.containerInfo!==J.containerInfo||G.stateNode.implementation!==J.implementation?(G=eg(J,H.mode,le),G.return=H,G):(G=g(G,J.children||[]),G.return=H,G)}function ae(H,G,J,le,Ce){return G===null||G.tag!==7?(G=La(J,H.mode,le,Ce),G.return=H,G):(G=g(G,J),G.return=H,G)}function ce(H,G,J){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=Zm(""+G,H.mode,J),G.return=H,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case S:return J=Jd(G.type,G.key,G.props,null,H.mode,J),Lc(J,G),J.return=H,J;case R:return G=eg(G,H.mode,J),G.return=H,G;case C:return G=qa(G),ce(H,G,J)}if(Ze(G)||P(G))return G=La(G,H.mode,J,null),G.return=H,G;if(typeof G.then=="function")return ce(H,sh(G),J);if(G.$$typeof===X)return ce(H,th(H,G),J);ah(H,G)}return null}function ee(H,G,J,le){var Ce=G!==null?G.key:null;if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return Ce!==null?null:T(H,G,""+J,le);if(typeof J=="object"&&J!==null){switch(J.$$typeof){case S:return J.key===Ce?U(H,G,J,le):null;case R:return J.key===Ce?Z(H,G,J,le):null;case C:return J=qa(J),ee(H,G,J,le)}if(Ze(J)||P(J))return Ce!==null?null:ae(H,G,J,le,null);if(typeof J.then=="function")return ee(H,G,sh(J),le);if(J.$$typeof===X)return ee(H,G,th(H,J),le);ah(H,J)}return null}function re(H,G,J,le,Ce){if(typeof le=="string"&&le!==""||typeof le=="number"||typeof le=="bigint")return H=H.get(J)||null,T(G,H,""+le,Ce);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case S:return H=H.get(le.key===null?J:le.key)||null,U(G,H,le,Ce);case R:return H=H.get(le.key===null?J:le.key)||null,Z(G,H,le,Ce);case C:return le=qa(le),re(H,G,J,le,Ce)}if(Ze(le)||P(le))return H=H.get(J)||null,ae(G,H,le,Ce,null);if(typeof le.then=="function")return re(H,G,J,sh(le),Ce);if(le.$$typeof===X)return re(H,G,J,th(G,le),Ce);ah(G,le)}return null}function Ee(H,G,J,le){for(var Ce=null,tt=null,Ie=G,Ue=G=0,Ke=null;Ie!==null&&Ue<J.length;Ue++){Ie.index>Ue?(Ke=Ie,Ie=null):Ke=Ie.sibling;var nt=ee(H,Ie,J[Ue],le);if(nt===null){Ie===null&&(Ie=Ke);break}i&&Ie&&nt.alternate===null&&s(H,Ie),G=y(nt,G,Ue),tt===null?Ce=nt:tt.sibling=nt,tt=nt,Ie=Ke}if(Ue===J.length)return l(H,Ie),Xe&&_i(H,Ue),Ce;if(Ie===null){for(;Ue<J.length;Ue++)Ie=ce(H,J[Ue],le),Ie!==null&&(G=y(Ie,G,Ue),tt===null?Ce=Ie:tt.sibling=Ie,tt=Ie);return Xe&&_i(H,Ue),Ce}for(Ie=u(Ie);Ue<J.length;Ue++)Ke=re(Ie,H,Ue,J[Ue],le),Ke!==null&&(i&&Ke.alternate!==null&&Ie.delete(Ke.key===null?Ue:Ke.key),G=y(Ke,G,Ue),tt===null?Ce=Ke:tt.sibling=Ke,tt=Ke);return i&&Ie.forEach(function(qs){return s(H,qs)}),Xe&&_i(H,Ue),Ce}function ke(H,G,J,le){if(J==null)throw Error(r(151));for(var Ce=null,tt=null,Ie=G,Ue=G=0,Ke=null,nt=J.next();Ie!==null&&!nt.done;Ue++,nt=J.next()){Ie.index>Ue?(Ke=Ie,Ie=null):Ke=Ie.sibling;var qs=ee(H,Ie,nt.value,le);if(qs===null){Ie===null&&(Ie=Ke);break}i&&Ie&&qs.alternate===null&&s(H,Ie),G=y(qs,G,Ue),tt===null?Ce=qs:tt.sibling=qs,tt=qs,Ie=Ke}if(nt.done)return l(H,Ie),Xe&&_i(H,Ue),Ce;if(Ie===null){for(;!nt.done;Ue++,nt=J.next())nt=ce(H,nt.value,le),nt!==null&&(G=y(nt,G,Ue),tt===null?Ce=nt:tt.sibling=nt,tt=nt);return Xe&&_i(H,Ue),Ce}for(Ie=u(Ie);!nt.done;Ue++,nt=J.next())nt=re(Ie,H,Ue,nt.value,le),nt!==null&&(i&&nt.alternate!==null&&Ie.delete(nt.key===null?Ue:nt.key),G=y(nt,G,Ue),tt===null?Ce=nt:tt.sibling=nt,tt=nt);return i&&Ie.forEach(function(AC){return s(H,AC)}),Xe&&_i(H,Ue),Ce}function ft(H,G,J,le){if(typeof J=="object"&&J!==null&&J.type===j&&J.key===null&&(J=J.props.children),typeof J=="object"&&J!==null){switch(J.$$typeof){case S:e:{for(var Ce=J.key;G!==null;){if(G.key===Ce){if(Ce=J.type,Ce===j){if(G.tag===7){l(H,G.sibling),le=g(G,J.props.children),le.return=H,H=le;break e}}else if(G.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===C&&qa(Ce)===G.type){l(H,G.sibling),le=g(G,J.props),Lc(le,J),le.return=H,H=le;break e}l(H,G);break}else s(H,G);G=G.sibling}J.type===j?(le=La(J.props.children,H.mode,le,J.key),le.return=H,H=le):(le=Jd(J.type,J.key,J.props,null,H.mode,le),Lc(le,J),le.return=H,H=le)}return x(H);case R:e:{for(Ce=J.key;G!==null;){if(G.key===Ce)if(G.tag===4&&G.stateNode.containerInfo===J.containerInfo&&G.stateNode.implementation===J.implementation){l(H,G.sibling),le=g(G,J.children||[]),le.return=H,H=le;break e}else{l(H,G);break}else s(H,G);G=G.sibling}le=eg(J,H.mode,le),le.return=H,H=le}return x(H);case C:return J=qa(J),ft(H,G,J,le)}if(Ze(J))return Ee(H,G,J,le);if(P(J)){if(Ce=P(J),typeof Ce!="function")throw Error(r(150));return J=Ce.call(J),ke(H,G,J,le)}if(typeof J.then=="function")return ft(H,G,sh(J),le);if(J.$$typeof===X)return ft(H,G,th(H,J),le);ah(H,J)}return typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint"?(J=""+J,G!==null&&G.tag===6?(l(H,G.sibling),le=g(G,J),le.return=H,H=le):(l(H,G),le=Zm(J,H.mode,le),le.return=H,H=le),x(H)):l(H,G)}return function(H,G,J,le){try{Mc=0;var Ce=ft(H,G,J,le);return Xo=null,Ce}catch(Ie){if(Ie===Wo||Ie===rh)throw Ie;var tt=Jn(29,Ie,null,H.mode);return tt.lanes=le,tt.return=H,tt}finally{}}}var $a=s_(!0),a_=s_(!1),Is=!1;function hg(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function fg(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function As(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function Ns(i,s,l){var u=i.updateQueue;if(u===null)return null;if(u=u.shared,(st&2)!==0){var g=u.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),u.pending=s,s=Xd(i),qv(i,null,l),s}return Wd(i,u,s,l),Xd(i)}function Uc(i,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194048)!==0)){var u=s.lanes;u&=i.pendingLanes,l|=u,s.lanes=l,as(i,l)}}function mg(i,s){var l=i.updateQueue,u=i.alternate;if(u!==null&&(u=u.updateQueue,l===u)){var g=null,y=null;if(l=l.firstBaseUpdate,l!==null){do{var x={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};y===null?g=y=x:y=y.next=x,l=l.next}while(l!==null);y===null?g=y=s:y=y.next=s}else g=y=s;l={baseState:u.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:u.shared,callbacks:u.callbacks},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=s:i.next=s,l.lastBaseUpdate=s}var gg=!1;function zc(){if(gg){var i=Yo;if(i!==null)throw i}}function Fc(i,s,l,u){gg=!1;var g=i.updateQueue;Is=!1;var y=g.firstBaseUpdate,x=g.lastBaseUpdate,T=g.shared.pending;if(T!==null){g.shared.pending=null;var U=T,Z=U.next;U.next=null,x===null?y=Z:x.next=Z,x=U;var ae=i.alternate;ae!==null&&(ae=ae.updateQueue,T=ae.lastBaseUpdate,T!==x&&(T===null?ae.firstBaseUpdate=Z:T.next=Z,ae.lastBaseUpdate=U))}if(y!==null){var ce=g.baseState;x=0,ae=Z=U=null,T=y;do{var ee=T.lane&-536870913,re=ee!==T.lane;if(re?(He&ee)===ee:(u&ee)===ee){ee!==0&&ee===Qo&&(gg=!0),ae!==null&&(ae=ae.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var Ee=i,ke=T;ee=s;var ft=l;switch(ke.tag){case 1:if(Ee=ke.payload,typeof Ee=="function"){ce=Ee.call(ft,ce,ee);break e}ce=Ee;break e;case 3:Ee.flags=Ee.flags&-65537|128;case 0:if(Ee=ke.payload,ee=typeof Ee=="function"?Ee.call(ft,ce,ee):Ee,ee==null)break e;ce=b({},ce,ee);break e;case 2:Is=!0}}ee=T.callback,ee!==null&&(i.flags|=64,re&&(i.flags|=8192),re=g.callbacks,re===null?g.callbacks=[ee]:re.push(ee))}else re={lane:ee,tag:T.tag,payload:T.payload,callback:T.callback,next:null},ae===null?(Z=ae=re,U=ce):ae=ae.next=re,x|=ee;if(T=T.next,T===null){if(T=g.shared.pending,T===null)break;re=T,T=re.next,re.next=null,g.lastBaseUpdate=re,g.shared.pending=null}}while(!0);ae===null&&(U=ce),g.baseState=U,g.firstBaseUpdate=Z,g.lastBaseUpdate=ae,y===null&&(g.shared.lanes=0),js|=x,i.lanes=x,i.memoizedState=ce}}function o_(i,s){if(typeof i!="function")throw Error(r(191,i));i.call(s)}function l_(i,s){var l=i.callbacks;if(l!==null)for(i.callbacks=null,i=0;i<l.length;i++)o_(l[i],s)}var Jo=q(null),oh=q(0);function c_(i,s){i=Ri,L(oh,i),L(Jo,s),Ri=i|s.baseLanes}function pg(){L(oh,Ri),L(Jo,Jo.current)}function yg(){Ri=oh.current,F(Jo),F(oh)}var Zn=q(null),vr=null;function Cs(i){var s=i.alternate;L(Bt,Bt.current&1),L(Zn,i),vr===null&&(s===null||Jo.current!==null||s.memoizedState!==null)&&(vr=i)}function vg(i){L(Bt,Bt.current),L(Zn,i),vr===null&&(vr=i)}function u_(i){i.tag===22?(L(Bt,Bt.current),L(Zn,i),vr===null&&(vr=i)):Rs()}function Rs(){L(Bt,Bt.current),L(Zn,Zn.current)}function er(i){F(Zn),vr===i&&(vr=null),F(Bt)}var Bt=q(0);function lh(i){for(var s=i;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Tp(l)||Sp(l)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var wi=0,Me=null,dt=null,Yt=null,ch=!1,Zo=!1,Ha=!1,uh=0,Bc=0,el=null,y1=0;function Vt(){throw Error(r(321))}function _g(i,s){if(s===null)return!1;for(var l=0;l<s.length&&l<i.length;l++)if(!Xn(i[l],s[l]))return!1;return!0}function bg(i,s,l,u,g,y){return wi=y,Me=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,B.H=i===null||i.memoizedState===null?K_:Pg,Ha=!1,y=l(u,g),Ha=!1,Zo&&(y=h_(s,l,u,g)),d_(i),y}function d_(i){B.H=$c;var s=dt!==null&&dt.next!==null;if(wi=0,Yt=dt=Me=null,ch=!1,Bc=0,el=null,s)throw Error(r(300));i===null||Wt||(i=i.dependencies,i!==null&&eh(i)&&(Wt=!0))}function h_(i,s,l,u){Me=i;var g=0;do{if(Zo&&(el=null),Bc=0,Zo=!1,25<=g)throw Error(r(301));if(g+=1,Yt=dt=null,i.updateQueue!=null){var y=i.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}B.H=Q_,y=s(l,u)}while(Zo);return y}function v1(){var i=B.H,s=i.useState()[0];return s=typeof s.then=="function"?qc(s):s,i=i.useState()[0],(dt!==null?dt.memoizedState:null)!==i&&(Me.flags|=1024),s}function xg(){var i=uh!==0;return uh=0,i}function wg(i,s,l){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~l}function Eg(i){if(ch){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}ch=!1}wi=0,Yt=dt=Me=null,Zo=!1,Bc=uh=0,el=null}function Mn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?Me.memoizedState=Yt=i:Yt=Yt.next=i,Yt}function qt(){if(dt===null){var i=Me.alternate;i=i!==null?i.memoizedState:null}else i=dt.next;var s=Yt===null?Me.memoizedState:Yt.next;if(s!==null)Yt=s,dt=i;else{if(i===null)throw Me.alternate===null?Error(r(467)):Error(r(310));dt=i,i={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},Yt===null?Me.memoizedState=Yt=i:Yt=Yt.next=i}return Yt}function dh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function qc(i){var s=Bc;return Bc+=1,el===null&&(el=[]),i=n_(el,i,s),s=Me,(Yt===null?s.memoizedState:Yt.next)===null&&(s=s.alternate,B.H=s===null||s.memoizedState===null?K_:Pg),i}function hh(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return qc(i);if(i.$$typeof===X)return _n(i)}throw Error(r(438,String(i)))}function Tg(i){var s=null,l=Me.updateQueue;if(l!==null&&(s=l.memoCache),s==null){var u=Me.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(s={data:u.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),l===null&&(l=dh(),Me.updateQueue=l),l.memoCache=s,l=s.data[s.index],l===void 0)for(l=s.data[s.index]=Array(i),u=0;u<i;u++)l[u]=z;return s.index++,l}function Ei(i,s){return typeof s=="function"?s(i):s}function fh(i){var s=qt();return Sg(s,dt,i)}function Sg(i,s,l){var u=i.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=l;var g=i.baseQueue,y=u.pending;if(y!==null){if(g!==null){var x=g.next;g.next=y.next,y.next=x}s.baseQueue=g=y,u.pending=null}if(y=i.baseState,g===null)i.memoizedState=y;else{s=g.next;var T=x=null,U=null,Z=s,ae=!1;do{var ce=Z.lane&-536870913;if(ce!==Z.lane?(He&ce)===ce:(wi&ce)===ce){var ee=Z.revertLane;if(ee===0)U!==null&&(U=U.next={lane:0,revertLane:0,gesture:null,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null}),ce===Qo&&(ae=!0);else if((wi&ee)===ee){Z=Z.next,ee===Qo&&(ae=!0);continue}else ce={lane:0,revertLane:Z.revertLane,gesture:null,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},U===null?(T=U=ce,x=y):U=U.next=ce,Me.lanes|=ee,js|=ee;ce=Z.action,Ha&&l(y,ce),y=Z.hasEagerState?Z.eagerState:l(y,ce)}else ee={lane:ce,revertLane:Z.revertLane,gesture:Z.gesture,action:Z.action,hasEagerState:Z.hasEagerState,eagerState:Z.eagerState,next:null},U===null?(T=U=ee,x=y):U=U.next=ee,Me.lanes|=ce,js|=ce;Z=Z.next}while(Z!==null&&Z!==s);if(U===null?x=y:U.next=T,!Xn(y,i.memoizedState)&&(Wt=!0,ae&&(l=Yo,l!==null)))throw l;i.memoizedState=y,i.baseState=x,i.baseQueue=U,u.lastRenderedState=y}return g===null&&(u.lanes=0),[i.memoizedState,u.dispatch]}function Ig(i){var s=qt(),l=s.queue;if(l===null)throw Error(r(311));l.lastRenderedReducer=i;var u=l.dispatch,g=l.pending,y=s.memoizedState;if(g!==null){l.pending=null;var x=g=g.next;do y=i(y,x.action),x=x.next;while(x!==g);Xn(y,s.memoizedState)||(Wt=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),l.lastRenderedState=y}return[y,u]}function f_(i,s,l){var u=Me,g=qt(),y=Xe;if(y){if(l===void 0)throw Error(r(407));l=l()}else l=s();var x=!Xn((dt||g).memoizedState,l);if(x&&(g.memoizedState=l,Wt=!0),g=g.queue,Cg(p_.bind(null,u,g,i),[i]),g.getSnapshot!==s||x||Yt!==null&&Yt.memoizedState.tag&1){if(u.flags|=2048,tl(9,{destroy:void 0},g_.bind(null,u,g,l,s),null),pt===null)throw Error(r(349));y||(wi&127)!==0||m_(u,s,l)}return l}function m_(i,s,l){i.flags|=16384,i={getSnapshot:s,value:l},s=Me.updateQueue,s===null?(s=dh(),Me.updateQueue=s,s.stores=[i]):(l=s.stores,l===null?s.stores=[i]:l.push(i))}function g_(i,s,l,u){s.value=l,s.getSnapshot=u,y_(s)&&v_(i)}function p_(i,s,l){return l(function(){y_(s)&&v_(i)})}function y_(i){var s=i.getSnapshot;i=i.value;try{var l=s();return!Xn(i,l)}catch{return!0}}function v_(i){var s=Ma(i,2);s!==null&&$n(s,i,2)}function Ag(i){var s=Mn();if(typeof i=="function"){var l=i;if(i=l(),Ha){cr(!0);try{l()}finally{cr(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:i},s}function __(i,s,l,u){return i.baseState=l,Sg(i,dt,typeof u=="function"?u:Ei)}function _1(i,s,l,u,g){if(ph(i))throw Error(r(485));if(i=s.action,i!==null){var y={payload:g,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(x){y.listeners.push(x)}};B.T!==null?l(!0):y.isTransition=!1,u(y),l=s.pending,l===null?(y.next=s.pending=y,b_(s,y)):(y.next=l.next,s.pending=l.next=y)}}function b_(i,s){var l=s.action,u=s.payload,g=i.state;if(s.isTransition){var y=B.T,x={};B.T=x;try{var T=l(g,u),U=B.S;U!==null&&U(x,T),x_(i,s,T)}catch(Z){Ng(i,s,Z)}finally{y!==null&&x.types!==null&&(y.types=x.types),B.T=y}}else try{y=l(g,u),x_(i,s,y)}catch(Z){Ng(i,s,Z)}}function x_(i,s,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(u){w_(i,s,u)},function(u){return Ng(i,s,u)}):w_(i,s,l)}function w_(i,s,l){s.status="fulfilled",s.value=l,E_(s),i.state=l,s=i.pending,s!==null&&(l=s.next,l===s?i.pending=null:(l=l.next,s.next=l,b_(i,l)))}function Ng(i,s,l){var u=i.pending;if(i.pending=null,u!==null){u=u.next;do s.status="rejected",s.reason=l,E_(s),s=s.next;while(s!==u)}i.action=null}function E_(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function T_(i,s){return s}function S_(i,s){if(Xe){var l=pt.formState;if(l!==null){e:{var u=Me;if(Xe){if(bt){t:{for(var g=bt,y=yr;g.nodeType!==8;){if(!y){g=null;break t}if(g=_r(g.nextSibling),g===null){g=null;break t}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){bt=_r(g.nextSibling),u=g.data==="F!";break e}}Ts(u)}u=!1}u&&(s=l[0])}}return l=Mn(),l.memoizedState=l.baseState=s,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:T_,lastRenderedState:s},l.queue=u,l=G_.bind(null,Me,u),u.dispatch=l,u=Ag(!1),y=Og.bind(null,Me,!1,u.queue),u=Mn(),g={state:s,dispatch:null,action:i,pending:null},u.queue=g,l=_1.bind(null,Me,g,y,l),g.dispatch=l,u.memoizedState=i,[s,l,!1]}function I_(i){var s=qt();return A_(s,dt,i)}function A_(i,s,l){if(s=Sg(i,s,T_)[0],i=fh(Ei)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var u=qc(s)}catch(x){throw x===Wo?rh:x}else u=s;s=qt();var g=s.queue,y=g.dispatch;return l!==s.memoizedState&&(Me.flags|=2048,tl(9,{destroy:void 0},b1.bind(null,g,l),null)),[u,y,i]}function b1(i,s){i.action=s}function N_(i){var s=qt(),l=dt;if(l!==null)return A_(s,l,i);qt(),s=s.memoizedState,l=qt();var u=l.queue.dispatch;return l.memoizedState=i,[s,u,!1]}function tl(i,s,l,u){return i={tag:i,create:l,deps:u,inst:s,next:null},s=Me.updateQueue,s===null&&(s=dh(),Me.updateQueue=s),l=s.lastEffect,l===null?s.lastEffect=i.next=i:(u=l.next,l.next=i,i.next=u,s.lastEffect=i),i}function C_(){return qt().memoizedState}function mh(i,s,l,u){var g=Mn();Me.flags|=i,g.memoizedState=tl(1|s,{destroy:void 0},l,u===void 0?null:u)}function gh(i,s,l,u){var g=qt();u=u===void 0?null:u;var y=g.memoizedState.inst;dt!==null&&u!==null&&_g(u,dt.memoizedState.deps)?g.memoizedState=tl(s,y,l,u):(Me.flags|=i,g.memoizedState=tl(1|s,y,l,u))}function R_(i,s){mh(8390656,8,i,s)}function Cg(i,s){gh(2048,8,i,s)}function x1(i){Me.flags|=4;var s=Me.updateQueue;if(s===null)s=dh(),Me.updateQueue=s,s.events=[i];else{var l=s.events;l===null?s.events=[i]:l.push(i)}}function k_(i){var s=qt().memoizedState;return x1({ref:s,nextImpl:i}),function(){if((st&2)!==0)throw Error(r(440));return s.impl.apply(void 0,arguments)}}function D_(i,s){return gh(4,2,i,s)}function j_(i,s){return gh(4,4,i,s)}function O_(i,s){if(typeof s=="function"){i=i();var l=s(i);return function(){typeof l=="function"?l():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function P_(i,s,l){l=l!=null?l.concat([i]):null,gh(4,4,O_.bind(null,s,i),l)}function Rg(){}function V_(i,s){var l=qt();s=s===void 0?null:s;var u=l.memoizedState;return s!==null&&_g(s,u[1])?u[0]:(l.memoizedState=[i,s],i)}function M_(i,s){var l=qt();s=s===void 0?null:s;var u=l.memoizedState;if(s!==null&&_g(s,u[1]))return u[0];if(u=i(),Ha){cr(!0);try{i()}finally{cr(!1)}}return l.memoizedState=[u,s],u}function kg(i,s,l){return l===void 0||(wi&1073741824)!==0&&(He&261930)===0?i.memoizedState=s:(i.memoizedState=l,i=Lb(),Me.lanes|=i,js|=i,l)}function L_(i,s,l,u){return Xn(l,s)?l:Jo.current!==null?(i=kg(i,l,u),Xn(i,s)||(Wt=!0),i):(wi&42)===0||(wi&1073741824)!==0&&(He&261930)===0?(Wt=!0,i.memoizedState=l):(i=Lb(),Me.lanes|=i,js|=i,s)}function U_(i,s,l,u,g){var y=ue.p;ue.p=y!==0&&8>y?y:8;var x=B.T,T={};B.T=T,Og(i,!1,s,l);try{var U=g(),Z=B.S;if(Z!==null&&Z(T,U),U!==null&&typeof U=="object"&&typeof U.then=="function"){var ae=p1(U,u);Gc(i,s,ae,rr(i))}else Gc(i,s,u,rr(i))}catch(ce){Gc(i,s,{then:function(){},status:"rejected",reason:ce},rr())}finally{ue.p=y,x!==null&&T.types!==null&&(x.types=T.types),B.T=x}}function w1(){}function Dg(i,s,l,u){if(i.tag!==5)throw Error(r(476));var g=z_(i).queue;U_(i,g,s,pe,l===null?w1:function(){return F_(i),l(u)})}function z_(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:pe,baseState:pe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:pe},next:null};var l={};return s.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:l},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function F_(i){var s=z_(i);s.next===null&&(s=i.alternate.memoizedState),Gc(i,s.next.queue,{},rr())}function jg(){return _n(ou)}function B_(){return qt().memoizedState}function q_(){return qt().memoizedState}function E1(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var l=rr();i=As(l);var u=Ns(s,i,l);u!==null&&($n(u,s,l),Uc(u,s,l)),s={cache:lg()},i.payload=s;return}s=s.return}}function T1(i,s,l){var u=rr();l={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},ph(i)?$_(s,l):(l=Xm(i,s,l,u),l!==null&&($n(l,i,u),H_(l,s,u)))}function G_(i,s,l){var u=rr();Gc(i,s,l,u)}function Gc(i,s,l,u){var g={lane:u,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(ph(i))$_(s,g);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var x=s.lastRenderedState,T=y(x,l);if(g.hasEagerState=!0,g.eagerState=T,Xn(T,x))return Wd(i,s,g,0),pt===null&&Yd(),!1}catch{}finally{}if(l=Xm(i,s,g,u),l!==null)return $n(l,i,u),H_(l,s,u),!0}return!1}function Og(i,s,l,u){if(u={lane:2,revertLane:hp(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},ph(i)){if(s)throw Error(r(479))}else s=Xm(i,l,u,2),s!==null&&$n(s,i,2)}function ph(i){var s=i.alternate;return i===Me||s!==null&&s===Me}function $_(i,s){Zo=ch=!0;var l=i.pending;l===null?s.next=s:(s.next=l.next,l.next=s),i.pending=s}function H_(i,s,l){if((l&4194048)!==0){var u=s.lanes;u&=i.pendingLanes,l|=u,s.lanes=l,as(i,l)}}var $c={readContext:_n,use:hh,useCallback:Vt,useContext:Vt,useEffect:Vt,useImperativeHandle:Vt,useLayoutEffect:Vt,useInsertionEffect:Vt,useMemo:Vt,useReducer:Vt,useRef:Vt,useState:Vt,useDebugValue:Vt,useDeferredValue:Vt,useTransition:Vt,useSyncExternalStore:Vt,useId:Vt,useHostTransitionStatus:Vt,useFormState:Vt,useActionState:Vt,useOptimistic:Vt,useMemoCache:Vt,useCacheRefresh:Vt};$c.useEffectEvent=Vt;var K_={readContext:_n,use:hh,useCallback:function(i,s){return Mn().memoizedState=[i,s===void 0?null:s],i},useContext:_n,useEffect:R_,useImperativeHandle:function(i,s,l){l=l!=null?l.concat([i]):null,mh(4194308,4,O_.bind(null,s,i),l)},useLayoutEffect:function(i,s){return mh(4194308,4,i,s)},useInsertionEffect:function(i,s){mh(4,2,i,s)},useMemo:function(i,s){var l=Mn();s=s===void 0?null:s;var u=i();if(Ha){cr(!0);try{i()}finally{cr(!1)}}return l.memoizedState=[u,s],u},useReducer:function(i,s,l){var u=Mn();if(l!==void 0){var g=l(s);if(Ha){cr(!0);try{l(s)}finally{cr(!1)}}}else g=s;return u.memoizedState=u.baseState=g,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:g},u.queue=i,i=i.dispatch=T1.bind(null,Me,i),[u.memoizedState,i]},useRef:function(i){var s=Mn();return i={current:i},s.memoizedState=i},useState:function(i){i=Ag(i);var s=i.queue,l=G_.bind(null,Me,s);return s.dispatch=l,[i.memoizedState,l]},useDebugValue:Rg,useDeferredValue:function(i,s){var l=Mn();return kg(l,i,s)},useTransition:function(){var i=Ag(!1);return i=U_.bind(null,Me,i.queue,!0,!1),Mn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,l){var u=Me,g=Mn();if(Xe){if(l===void 0)throw Error(r(407));l=l()}else{if(l=s(),pt===null)throw Error(r(349));(He&127)!==0||m_(u,s,l)}g.memoizedState=l;var y={value:l,getSnapshot:s};return g.queue=y,R_(p_.bind(null,u,y,i),[i]),u.flags|=2048,tl(9,{destroy:void 0},g_.bind(null,u,y,l,s),null),l},useId:function(){var i=Mn(),s=pt.identifierPrefix;if(Xe){var l=Yr,u=Qr;l=(u&~(1<<32-Dn(u)-1)).toString(32)+l,s="_"+s+"R_"+l,l=uh++,0<l&&(s+="H"+l.toString(32)),s+="_"}else l=y1++,s="_"+s+"r_"+l.toString(32)+"_";return i.memoizedState=s},useHostTransitionStatus:jg,useFormState:S_,useActionState:S_,useOptimistic:function(i){var s=Mn();s.memoizedState=s.baseState=i;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=l,s=Og.bind(null,Me,!0,l),l.dispatch=s,[i,s]},useMemoCache:Tg,useCacheRefresh:function(){return Mn().memoizedState=E1.bind(null,Me)},useEffectEvent:function(i){var s=Mn(),l={impl:i};return s.memoizedState=l,function(){if((st&2)!==0)throw Error(r(440));return l.impl.apply(void 0,arguments)}}},Pg={readContext:_n,use:hh,useCallback:V_,useContext:_n,useEffect:Cg,useImperativeHandle:P_,useInsertionEffect:D_,useLayoutEffect:j_,useMemo:M_,useReducer:fh,useRef:C_,useState:function(){return fh(Ei)},useDebugValue:Rg,useDeferredValue:function(i,s){var l=qt();return L_(l,dt.memoizedState,i,s)},useTransition:function(){var i=fh(Ei)[0],s=qt().memoizedState;return[typeof i=="boolean"?i:qc(i),s]},useSyncExternalStore:f_,useId:B_,useHostTransitionStatus:jg,useFormState:I_,useActionState:I_,useOptimistic:function(i,s){var l=qt();return __(l,dt,i,s)},useMemoCache:Tg,useCacheRefresh:q_};Pg.useEffectEvent=k_;var Q_={readContext:_n,use:hh,useCallback:V_,useContext:_n,useEffect:Cg,useImperativeHandle:P_,useInsertionEffect:D_,useLayoutEffect:j_,useMemo:M_,useReducer:Ig,useRef:C_,useState:function(){return Ig(Ei)},useDebugValue:Rg,useDeferredValue:function(i,s){var l=qt();return dt===null?kg(l,i,s):L_(l,dt.memoizedState,i,s)},useTransition:function(){var i=Ig(Ei)[0],s=qt().memoizedState;return[typeof i=="boolean"?i:qc(i),s]},useSyncExternalStore:f_,useId:B_,useHostTransitionStatus:jg,useFormState:N_,useActionState:N_,useOptimistic:function(i,s){var l=qt();return dt!==null?__(l,dt,i,s):(l.baseState=i,[i,l.queue.dispatch])},useMemoCache:Tg,useCacheRefresh:q_};Q_.useEffectEvent=k_;function Vg(i,s,l,u){s=i.memoizedState,l=l(u,s),l=l==null?s:b({},s,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var Mg={enqueueSetState:function(i,s,l){i=i._reactInternals;var u=rr(),g=As(u);g.payload=s,l!=null&&(g.callback=l),s=Ns(i,g,u),s!==null&&($n(s,i,u),Uc(s,i,u))},enqueueReplaceState:function(i,s,l){i=i._reactInternals;var u=rr(),g=As(u);g.tag=1,g.payload=s,l!=null&&(g.callback=l),s=Ns(i,g,u),s!==null&&($n(s,i,u),Uc(s,i,u))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var l=rr(),u=As(l);u.tag=2,s!=null&&(u.callback=s),s=Ns(i,u,l),s!==null&&($n(s,i,l),Uc(s,i,l))}};function Y_(i,s,l,u,g,y,x){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(u,y,x):s.prototype&&s.prototype.isPureReactComponent?!kc(l,u)||!kc(g,y):!0}function W_(i,s,l,u){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,u),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,u),s.state!==i&&Mg.enqueueReplaceState(s,s.state,null)}function Ka(i,s){var l=s;if("ref"in s){l={};for(var u in s)u!=="ref"&&(l[u]=s[u])}if(i=i.defaultProps){l===s&&(l=b({},l));for(var g in i)l[g]===void 0&&(l[g]=i[g])}return l}function X_(i){Qd(i)}function J_(i){console.error(i)}function Z_(i){Qd(i)}function yh(i,s){try{var l=i.onUncaughtError;l(s.value,{componentStack:s.stack})}catch(u){setTimeout(function(){throw u})}}function eb(i,s,l){try{var u=i.onCaughtError;u(l.value,{componentStack:l.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Lg(i,s,l){return l=As(l),l.tag=3,l.payload={element:null},l.callback=function(){yh(i,s)},l}function tb(i){return i=As(i),i.tag=3,i}function nb(i,s,l,u){var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var y=u.value;i.payload=function(){return g(y)},i.callback=function(){eb(s,l,u)}}var x=l.stateNode;x!==null&&typeof x.componentDidCatch=="function"&&(i.callback=function(){eb(s,l,u),typeof g!="function"&&(Os===null?Os=new Set([this]):Os.add(this));var T=u.stack;this.componentDidCatch(u.value,{componentStack:T!==null?T:""})})}function S1(i,s,l,u,g){if(l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(s=l.alternate,s!==null&&Ko(s,l,g,!0),l=Zn.current,l!==null){switch(l.tag){case 31:case 13:return vr===null?Ch():l.alternate===null&&Mt===0&&(Mt=3),l.flags&=-257,l.flags|=65536,l.lanes=g,u===ih?l.flags|=16384:(s=l.updateQueue,s===null?l.updateQueue=new Set([u]):s.add(u),cp(i,u,g)),!1;case 22:return l.flags|=65536,u===ih?l.flags|=16384:(s=l.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([u])},l.updateQueue=s):(l=s.retryQueue,l===null?s.retryQueue=new Set([u]):l.add(u)),cp(i,u,g)),!1}throw Error(r(435,l.tag))}return cp(i,u,g),Ch(),!1}if(Xe)return s=Zn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,u!==rg&&(i=Error(r(422),{cause:u}),Oc(mr(i,l)))):(u!==rg&&(s=Error(r(423),{cause:u}),Oc(mr(s,l))),i=i.current.alternate,i.flags|=65536,g&=-g,i.lanes|=g,u=mr(u,l),g=Lg(i.stateNode,u,g),mg(i,g),Mt!==4&&(Mt=2)),!1;var y=Error(r(520),{cause:u});if(y=mr(y,l),Zc===null?Zc=[y]:Zc.push(y),Mt!==4&&(Mt=2),s===null)return!0;u=mr(u,l),l=s;do{switch(l.tag){case 3:return l.flags|=65536,i=g&-g,l.lanes|=i,i=Lg(l.stateNode,u,i),mg(l,i),!1;case 1:if(s=l.type,y=l.stateNode,(l.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Os===null||!Os.has(y))))return l.flags|=65536,g&=-g,l.lanes|=g,g=tb(g),nb(g,i,l,u),mg(l,g),!1}l=l.return}while(l!==null);return!1}var Ug=Error(r(461)),Wt=!1;function bn(i,s,l,u){s.child=i===null?a_(s,null,l,u):$a(s,i.child,l,u)}function rb(i,s,l,u,g){l=l.render;var y=s.ref;if("ref"in u){var x={};for(var T in u)T!=="ref"&&(x[T]=u[T])}else x=u;return Fa(s),u=bg(i,s,l,x,y,g),T=xg(),i!==null&&!Wt?(wg(i,s,g),Ti(i,s,g)):(Xe&&T&&tg(s),s.flags|=1,bn(i,s,u,g),s.child)}function ib(i,s,l,u,g){if(i===null){var y=l.type;return typeof y=="function"&&!Jm(y)&&y.defaultProps===void 0&&l.compare===null?(s.tag=15,s.type=y,sb(i,s,y,u,g)):(i=Jd(l.type,null,u,s,s.mode,g),i.ref=s.ref,i.return=s,s.child=i)}if(y=i.child,!Kg(i,g)){var x=y.memoizedProps;if(l=l.compare,l=l!==null?l:kc,l(x,u)&&i.ref===s.ref)return Ti(i,s,g)}return s.flags|=1,i=vi(y,u),i.ref=s.ref,i.return=s,s.child=i}function sb(i,s,l,u,g){if(i!==null){var y=i.memoizedProps;if(kc(y,u)&&i.ref===s.ref)if(Wt=!1,s.pendingProps=u=y,Kg(i,g))(i.flags&131072)!==0&&(Wt=!0);else return s.lanes=i.lanes,Ti(i,s,g)}return zg(i,s,l,u,g)}function ab(i,s,l,u){var g=u.children,y=i!==null?i.memoizedState:null;if(i===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((s.flags&128)!==0){if(y=y!==null?y.baseLanes|l:l,i!==null){for(u=s.child=i.child,g=0;u!==null;)g=g|u.lanes|u.childLanes,u=u.sibling;u=g&~y}else u=0,s.child=null;return ob(i,s,y,l,u)}if((l&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&nh(s,y!==null?y.cachePool:null),y!==null?c_(s,y):pg(),u_(s);else return u=s.lanes=536870912,ob(i,s,y!==null?y.baseLanes|l:l,l,u)}else y!==null?(nh(s,y.cachePool),c_(s,y),Rs(),s.memoizedState=null):(i!==null&&nh(s,null),pg(),Rs());return bn(i,s,g,l),s.child}function Hc(i,s){return i!==null&&i.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function ob(i,s,l,u,g){var y=ug();return y=y===null?null:{parent:Qt._currentValue,pool:y},s.memoizedState={baseLanes:l,cachePool:y},i!==null&&nh(s,null),pg(),u_(s),i!==null&&Ko(i,s,u,!0),s.childLanes=g,null}function vh(i,s){return s=bh({mode:s.mode,children:s.children},i.mode),s.ref=i.ref,i.child=s,s.return=i,s}function lb(i,s,l){return $a(s,i.child,null,l),i=vh(s,s.pendingProps),i.flags|=2,er(s),s.memoizedState=null,i}function I1(i,s,l){var u=s.pendingProps,g=(s.flags&128)!==0;if(s.flags&=-129,i===null){if(Xe){if(u.mode==="hidden")return i=vh(s,u),s.lanes=536870912,Hc(null,i);if(vg(s),(i=bt)?(i=bx(i,yr),i=i!==null&&i.data==="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:ws!==null?{id:Qr,overflow:Yr}:null,retryLane:536870912,hydrationErrors:null},l=$v(i),l.return=s,s.child=l,vn=s,bt=null)):i=null,i===null)throw Ts(s);return s.lanes=536870912,null}return vh(s,u)}var y=i.memoizedState;if(y!==null){var x=y.dehydrated;if(vg(s),g)if(s.flags&256)s.flags&=-257,s=lb(i,s,l);else if(s.memoizedState!==null)s.child=i.child,s.flags|=128,s=null;else throw Error(r(558));else if(Wt||Ko(i,s,l,!1),g=(l&i.childLanes)!==0,Wt||g){if(u=pt,u!==null&&(x=os(u,l),x!==0&&x!==y.retryLane))throw y.retryLane=x,Ma(i,x),$n(u,i,x),Ug;Ch(),s=lb(i,s,l)}else i=y.treeContext,bt=_r(x.nextSibling),vn=s,Xe=!0,Es=null,yr=!1,i!==null&&Qv(s,i),s=vh(s,u),s.flags|=4096;return s}return i=vi(i.child,{mode:u.mode,children:u.children}),i.ref=s.ref,s.child=i,i.return=s,i}function _h(i,s){var l=s.ref;if(l===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(r(284));(i===null||i.ref!==l)&&(s.flags|=4194816)}}function zg(i,s,l,u,g){return Fa(s),l=bg(i,s,l,u,void 0,g),u=xg(),i!==null&&!Wt?(wg(i,s,g),Ti(i,s,g)):(Xe&&u&&tg(s),s.flags|=1,bn(i,s,l,g),s.child)}function cb(i,s,l,u,g,y){return Fa(s),s.updateQueue=null,l=h_(s,u,l,g),d_(i),u=xg(),i!==null&&!Wt?(wg(i,s,y),Ti(i,s,y)):(Xe&&u&&tg(s),s.flags|=1,bn(i,s,l,y),s.child)}function ub(i,s,l,u,g){if(Fa(s),s.stateNode===null){var y=qo,x=l.contextType;typeof x=="object"&&x!==null&&(y=_n(x)),y=new l(u,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Mg,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=u,y.state=s.memoizedState,y.refs={},hg(s),x=l.contextType,y.context=typeof x=="object"&&x!==null?_n(x):qo,y.state=s.memoizedState,x=l.getDerivedStateFromProps,typeof x=="function"&&(Vg(s,l,x,u),y.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(x=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),x!==y.state&&Mg.enqueueReplaceState(y,y.state,null),Fc(s,u,y,g),zc(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!0}else if(i===null){y=s.stateNode;var T=s.memoizedProps,U=Ka(l,T);y.props=U;var Z=y.context,ae=l.contextType;x=qo,typeof ae=="object"&&ae!==null&&(x=_n(ae));var ce=l.getDerivedStateFromProps;ae=typeof ce=="function"||typeof y.getSnapshotBeforeUpdate=="function",T=s.pendingProps!==T,ae||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(T||Z!==x)&&W_(s,y,u,x),Is=!1;var ee=s.memoizedState;y.state=ee,Fc(s,u,y,g),zc(),Z=s.memoizedState,T||ee!==Z||Is?(typeof ce=="function"&&(Vg(s,l,ce,u),Z=s.memoizedState),(U=Is||Y_(s,l,U,u,ee,Z,x))?(ae||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=u,s.memoizedState=Z),y.props=u,y.state=Z,y.context=x,u=U):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),u=!1)}else{y=s.stateNode,fg(i,s),x=s.memoizedProps,ae=Ka(l,x),y.props=ae,ce=s.pendingProps,ee=y.context,Z=l.contextType,U=qo,typeof Z=="object"&&Z!==null&&(U=_n(Z)),T=l.getDerivedStateFromProps,(Z=typeof T=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(x!==ce||ee!==U)&&W_(s,y,u,U),Is=!1,ee=s.memoizedState,y.state=ee,Fc(s,u,y,g),zc();var re=s.memoizedState;x!==ce||ee!==re||Is||i!==null&&i.dependencies!==null&&eh(i.dependencies)?(typeof T=="function"&&(Vg(s,l,T,u),re=s.memoizedState),(ae=Is||Y_(s,l,ae,u,ee,re,U)||i!==null&&i.dependencies!==null&&eh(i.dependencies))?(Z||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(u,re,U),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(u,re,U)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||x===i.memoizedProps&&ee===i.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||x===i.memoizedProps&&ee===i.memoizedState||(s.flags|=1024),s.memoizedProps=u,s.memoizedState=re),y.props=u,y.state=re,y.context=U,u=ae):(typeof y.componentDidUpdate!="function"||x===i.memoizedProps&&ee===i.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||x===i.memoizedProps&&ee===i.memoizedState||(s.flags|=1024),u=!1)}return y=u,_h(i,s),u=(s.flags&128)!==0,y||u?(y=s.stateNode,l=u&&typeof l.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,i!==null&&u?(s.child=$a(s,i.child,null,g),s.child=$a(s,null,l,g)):bn(i,s,l,g),s.memoizedState=y.state,i=s.child):i=Ti(i,s,g),i}function db(i,s,l,u){return Ua(),s.flags|=256,bn(i,s,l,u),s.child}var Fg={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Bg(i){return{baseLanes:i,cachePool:e_()}}function qg(i,s,l){return i=i!==null?i.childLanes&~l:0,s&&(i|=nr),i}function hb(i,s,l){var u=s.pendingProps,g=!1,y=(s.flags&128)!==0,x;if((x=y)||(x=i!==null&&i.memoizedState===null?!1:(Bt.current&2)!==0),x&&(g=!0,s.flags&=-129),x=(s.flags&32)!==0,s.flags&=-33,i===null){if(Xe){if(g?Cs(s):Rs(),(i=bt)?(i=bx(i,yr),i=i!==null&&i.data!=="&"?i:null,i!==null&&(s.memoizedState={dehydrated:i,treeContext:ws!==null?{id:Qr,overflow:Yr}:null,retryLane:536870912,hydrationErrors:null},l=$v(i),l.return=s,s.child=l,vn=s,bt=null)):i=null,i===null)throw Ts(s);return Sp(i)?s.lanes=32:s.lanes=536870912,null}var T=u.children;return u=u.fallback,g?(Rs(),g=s.mode,T=bh({mode:"hidden",children:T},g),u=La(u,g,l,null),T.return=s,u.return=s,T.sibling=u,s.child=T,u=s.child,u.memoizedState=Bg(l),u.childLanes=qg(i,x,l),s.memoizedState=Fg,Hc(null,u)):(Cs(s),Gg(s,T))}var U=i.memoizedState;if(U!==null&&(T=U.dehydrated,T!==null)){if(y)s.flags&256?(Cs(s),s.flags&=-257,s=$g(i,s,l)):s.memoizedState!==null?(Rs(),s.child=i.child,s.flags|=128,s=null):(Rs(),T=u.fallback,g=s.mode,u=bh({mode:"visible",children:u.children},g),T=La(T,g,l,null),T.flags|=2,u.return=s,T.return=s,u.sibling=T,s.child=u,$a(s,i.child,null,l),u=s.child,u.memoizedState=Bg(l),u.childLanes=qg(i,x,l),s.memoizedState=Fg,s=Hc(null,u));else if(Cs(s),Sp(T)){if(x=T.nextSibling&&T.nextSibling.dataset,x)var Z=x.dgst;x=Z,u=Error(r(419)),u.stack="",u.digest=x,Oc({value:u,source:null,stack:null}),s=$g(i,s,l)}else if(Wt||Ko(i,s,l,!1),x=(l&i.childLanes)!==0,Wt||x){if(x=pt,x!==null&&(u=os(x,l),u!==0&&u!==U.retryLane))throw U.retryLane=u,Ma(i,u),$n(x,i,u),Ug;Tp(T)||Ch(),s=$g(i,s,l)}else Tp(T)?(s.flags|=192,s.child=i.child,s=null):(i=U.treeContext,bt=_r(T.nextSibling),vn=s,Xe=!0,Es=null,yr=!1,i!==null&&Qv(s,i),s=Gg(s,u.children),s.flags|=4096);return s}return g?(Rs(),T=u.fallback,g=s.mode,U=i.child,Z=U.sibling,u=vi(U,{mode:"hidden",children:u.children}),u.subtreeFlags=U.subtreeFlags&65011712,Z!==null?T=vi(Z,T):(T=La(T,g,l,null),T.flags|=2),T.return=s,u.return=s,u.sibling=T,s.child=u,Hc(null,u),u=s.child,T=i.child.memoizedState,T===null?T=Bg(l):(g=T.cachePool,g!==null?(U=Qt._currentValue,g=g.parent!==U?{parent:U,pool:U}:g):g=e_(),T={baseLanes:T.baseLanes|l,cachePool:g}),u.memoizedState=T,u.childLanes=qg(i,x,l),s.memoizedState=Fg,Hc(i.child,u)):(Cs(s),l=i.child,i=l.sibling,l=vi(l,{mode:"visible",children:u.children}),l.return=s,l.sibling=null,i!==null&&(x=s.deletions,x===null?(s.deletions=[i],s.flags|=16):x.push(i)),s.child=l,s.memoizedState=null,l)}function Gg(i,s){return s=bh({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function bh(i,s){return i=Jn(22,i,null,s),i.lanes=0,i}function $g(i,s,l){return $a(s,i.child,null,l),i=Gg(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function fb(i,s,l){i.lanes|=s;var u=i.alternate;u!==null&&(u.lanes|=s),ag(i.return,s,l)}function Hg(i,s,l,u,g,y){var x=i.memoizedState;x===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:u,tail:l,tailMode:g,treeForkCount:y}:(x.isBackwards=s,x.rendering=null,x.renderingStartTime=0,x.last=u,x.tail=l,x.tailMode=g,x.treeForkCount=y)}function mb(i,s,l){var u=s.pendingProps,g=u.revealOrder,y=u.tail;u=u.children;var x=Bt.current,T=(x&2)!==0;if(T?(x=x&1|2,s.flags|=128):x&=1,L(Bt,x),bn(i,s,u,l),u=Xe?jc:0,!T&&i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&fb(i,l,s);else if(i.tag===19)fb(i,l,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}switch(g){case"forwards":for(l=s.child,g=null;l!==null;)i=l.alternate,i!==null&&lh(i)===null&&(g=l),l=l.sibling;l=g,l===null?(g=s.child,s.child=null):(g=l.sibling,l.sibling=null),Hg(s,!1,g,l,y,u);break;case"backwards":case"unstable_legacy-backwards":for(l=null,g=s.child,s.child=null;g!==null;){if(i=g.alternate,i!==null&&lh(i)===null){s.child=g;break}i=g.sibling,g.sibling=l,l=g,g=i}Hg(s,!0,l,null,y,u);break;case"together":Hg(s,!1,null,null,void 0,u);break;default:s.memoizedState=null}return s.child}function Ti(i,s,l){if(i!==null&&(s.dependencies=i.dependencies),js|=s.lanes,(l&s.childLanes)===0)if(i!==null){if(Ko(i,s,l,!1),(l&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(r(153));if(s.child!==null){for(i=s.child,l=vi(i,i.pendingProps),s.child=l,l.return=s;i.sibling!==null;)i=i.sibling,l=l.sibling=vi(i,i.pendingProps),l.return=s;l.sibling=null}return s.child}function Kg(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&eh(i)))}function A1(i,s,l){switch(s.tag){case 3:W(s,s.stateNode.containerInfo),Ss(s,Qt,i.memoizedState.cache),Ua();break;case 27:case 5:Se(s);break;case 4:W(s,s.stateNode.containerInfo);break;case 10:Ss(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,vg(s),null;break;case 13:var u=s.memoizedState;if(u!==null)return u.dehydrated!==null?(Cs(s),s.flags|=128,null):(l&s.child.childLanes)!==0?hb(i,s,l):(Cs(s),i=Ti(i,s,l),i!==null?i.sibling:null);Cs(s);break;case 19:var g=(i.flags&128)!==0;if(u=(l&s.childLanes)!==0,u||(Ko(i,s,l,!1),u=(l&s.childLanes)!==0),g){if(u)return mb(i,s,l);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),L(Bt,Bt.current),u)break;return null;case 22:return s.lanes=0,ab(i,s,l,s.pendingProps);case 24:Ss(s,Qt,i.memoizedState.cache)}return Ti(i,s,l)}function gb(i,s,l){if(i!==null)if(i.memoizedProps!==s.pendingProps)Wt=!0;else{if(!Kg(i,l)&&(s.flags&128)===0)return Wt=!1,A1(i,s,l);Wt=(i.flags&131072)!==0}else Wt=!1,Xe&&(s.flags&1048576)!==0&&Kv(s,jc,s.index);switch(s.lanes=0,s.tag){case 16:e:{var u=s.pendingProps;if(i=qa(s.elementType),s.type=i,typeof i=="function")Jm(i)?(u=Ka(i,u),s.tag=1,s=ub(null,s,i,u,l)):(s.tag=0,s=zg(null,s,i,u,l));else{if(i!=null){var g=i.$$typeof;if(g===de){s.tag=11,s=rb(null,s,i,u,l);break e}else if(g===D){s.tag=14,s=ib(null,s,i,u,l);break e}}throw s=Ne(i)||i,Error(r(306,s,""))}}return s;case 0:return zg(i,s,s.type,s.pendingProps,l);case 1:return u=s.type,g=Ka(u,s.pendingProps),ub(i,s,u,g,l);case 3:e:{if(W(s,s.stateNode.containerInfo),i===null)throw Error(r(387));u=s.pendingProps;var y=s.memoizedState;g=y.element,fg(i,s),Fc(s,u,null,l);var x=s.memoizedState;if(u=x.cache,Ss(s,Qt,u),u!==y.cache&&og(s,[Qt],l,!0),zc(),u=x.element,y.isDehydrated)if(y={element:u,isDehydrated:!1,cache:x.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=db(i,s,u,l);break e}else if(u!==g){g=mr(Error(r(424)),s),Oc(g),s=db(i,s,u,l);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(bt=_r(i.firstChild),vn=s,Xe=!0,Es=null,yr=!0,l=a_(s,null,u,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Ua(),u===g){s=Ti(i,s,l);break e}bn(i,s,u,l)}s=s.child}return s;case 26:return _h(i,s),i===null?(l=Ix(s.type,null,s.pendingProps,null))?s.memoizedState=l:Xe||(l=s.type,i=s.pendingProps,u=Vh(se.current).createElement(l),u[Ot]=s,u[yn]=i,xn(u,l,i),Ft(u),s.stateNode=u):s.memoizedState=Ix(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Se(s),i===null&&Xe&&(u=s.stateNode=Ex(s.type,s.pendingProps,se.current),vn=s,yr=!0,g=bt,Ls(s.type)?(Ip=g,bt=_r(u.firstChild)):bt=g),bn(i,s,s.pendingProps.children,l),_h(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&Xe&&((g=u=bt)&&(u=rC(u,s.type,s.pendingProps,yr),u!==null?(s.stateNode=u,vn=s,bt=_r(u.firstChild),yr=!1,g=!0):g=!1),g||Ts(s)),Se(s),g=s.type,y=s.pendingProps,x=i!==null?i.memoizedProps:null,u=y.children,xp(g,y)?u=null:x!==null&&xp(g,x)&&(s.flags|=32),s.memoizedState!==null&&(g=bg(i,s,v1,null,null,l),ou._currentValue=g),_h(i,s),bn(i,s,u,l),s.child;case 6:return i===null&&Xe&&((i=l=bt)&&(l=iC(l,s.pendingProps,yr),l!==null?(s.stateNode=l,vn=s,bt=null,i=!0):i=!1),i||Ts(s)),null;case 13:return hb(i,s,l);case 4:return W(s,s.stateNode.containerInfo),u=s.pendingProps,i===null?s.child=$a(s,null,u,l):bn(i,s,u,l),s.child;case 11:return rb(i,s,s.type,s.pendingProps,l);case 7:return bn(i,s,s.pendingProps,l),s.child;case 8:return bn(i,s,s.pendingProps.children,l),s.child;case 12:return bn(i,s,s.pendingProps.children,l),s.child;case 10:return u=s.pendingProps,Ss(s,s.type,u.value),bn(i,s,u.children,l),s.child;case 9:return g=s.type._context,u=s.pendingProps.children,Fa(s),g=_n(g),u=u(g),s.flags|=1,bn(i,s,u,l),s.child;case 14:return ib(i,s,s.type,s.pendingProps,l);case 15:return sb(i,s,s.type,s.pendingProps,l);case 19:return mb(i,s,l);case 31:return I1(i,s,l);case 22:return ab(i,s,l,s.pendingProps);case 24:return Fa(s),u=_n(Qt),i===null?(g=ug(),g===null&&(g=pt,y=lg(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=l),g=y),s.memoizedState={parent:u,cache:g},hg(s),Ss(s,Qt,g)):((i.lanes&l)!==0&&(fg(i,s),Fc(s,null,null,l),zc()),g=i.memoizedState,y=s.memoizedState,g.parent!==u?(g={parent:u,cache:u},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),Ss(s,Qt,u)):(u=y.cache,Ss(s,Qt,u),u!==g.cache&&og(s,[Qt],l,!0))),bn(i,s,s.pendingProps.children,l),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function Si(i){i.flags|=4}function Qg(i,s,l,u,g){if((s=(i.mode&32)!==0)&&(s=!1),s){if(i.flags|=16777216,(g&335544128)===g)if(i.stateNode.complete)i.flags|=8192;else if(Bb())i.flags|=8192;else throw Ga=ih,dg}else i.flags&=-16777217}function pb(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!kx(s))if(Bb())i.flags|=8192;else throw Ga=ih,dg}function xh(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?fc():536870912,i.lanes|=s,sl|=s)}function Kc(i,s){if(!Xe)switch(i.tailMode){case"hidden":s=i.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var u=null;l!==null;)l.alternate!==null&&(u=l),l=l.sibling;u===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:u.sibling=null}}function xt(i){var s=i.alternate!==null&&i.alternate.child===i.child,l=0,u=0;if(s)for(var g=i.child;g!==null;)l|=g.lanes|g.childLanes,u|=g.subtreeFlags&65011712,u|=g.flags&65011712,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)l|=g.lanes|g.childLanes,u|=g.subtreeFlags,u|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=u,i.childLanes=l,s}function N1(i,s,l){var u=s.pendingProps;switch(ng(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xt(s),null;case 1:return xt(s),null;case 3:return l=s.stateNode,u=null,i!==null&&(u=i.memoizedState.cache),s.memoizedState.cache!==u&&(s.flags|=2048),xi(Qt),me(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(i===null||i.child===null)&&(Ho(s)?Si(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,ig())),xt(s),null;case 26:var g=s.type,y=s.memoizedState;return i===null?(Si(s),y!==null?(xt(s),pb(s,y)):(xt(s),Qg(s,g,null,u,l))):y?y!==i.memoizedState?(Si(s),xt(s),pb(s,y)):(xt(s),s.flags&=-16777217):(i=i.memoizedProps,i!==u&&Si(s),xt(s),Qg(s,g,i,u,l)),null;case 27:if(Fe(s),l=se.current,g=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==u&&Si(s);else{if(!u){if(s.stateNode===null)throw Error(r(166));return xt(s),null}i=Q.current,Ho(s)?Yv(s):(i=Ex(g,u,l),s.stateNode=i,Si(s))}return xt(s),null;case 5:if(Fe(s),g=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==u&&Si(s);else{if(!u){if(s.stateNode===null)throw Error(r(166));return xt(s),null}if(y=Q.current,Ho(s))Yv(s);else{var x=Vh(se.current);switch(y){case 1:y=x.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:y=x.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":y=x.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":y=x.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":y=x.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof u.is=="string"?x.createElement("select",{is:u.is}):x.createElement("select"),u.multiple?y.multiple=!0:u.size&&(y.size=u.size);break;default:y=typeof u.is=="string"?x.createElement(g,{is:u.is}):x.createElement(g)}}y[Ot]=s,y[yn]=u;e:for(x=s.child;x!==null;){if(x.tag===5||x.tag===6)y.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===s)break e;for(;x.sibling===null;){if(x.return===null||x.return===s)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}s.stateNode=y;e:switch(xn(y,g,u),g){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&Si(s)}}return xt(s),Qg(s,s.type,i===null?null:i.memoizedProps,s.pendingProps,l),null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==u&&Si(s);else{if(typeof u!="string"&&s.stateNode===null)throw Error(r(166));if(i=se.current,Ho(s)){if(i=s.stateNode,l=s.memoizedProps,u=null,g=vn,g!==null)switch(g.tag){case 27:case 5:u=g.memoizedProps}i[Ot]=s,i=!!(i.nodeValue===l||u!==null&&u.suppressHydrationWarning===!0||hx(i.nodeValue,l)),i||Ts(s,!0)}else i=Vh(i).createTextNode(u),i[Ot]=s,s.stateNode=i}return xt(s),null;case 31:if(l=s.memoizedState,i===null||i.memoizedState!==null){if(u=Ho(s),l!==null){if(i===null){if(!u)throw Error(r(318));if(i=s.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(557));i[Ot]=s}else Ua(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;xt(s),i=!1}else l=ig(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=l),i=!0;if(!i)return s.flags&256?(er(s),s):(er(s),null);if((s.flags&128)!==0)throw Error(r(558))}return xt(s),null;case 13:if(u=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(g=Ho(s),u!==null&&u.dehydrated!==null){if(i===null){if(!g)throw Error(r(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(r(317));g[Ot]=s}else Ua(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;xt(s),g=!1}else g=ig(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(er(s),s):(er(s),null)}return er(s),(s.flags&128)!==0?(s.lanes=l,s):(l=u!==null,i=i!==null&&i.memoizedState!==null,l&&(u=s.child,g=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(g=u.alternate.memoizedState.cachePool.pool),y=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),y!==g&&(u.flags|=2048)),l!==i&&l&&(s.child.flags|=8192),xh(s,s.updateQueue),xt(s),null);case 4:return me(),i===null&&pp(s.stateNode.containerInfo),xt(s),null;case 10:return xi(s.type),xt(s),null;case 19:if(F(Bt),u=s.memoizedState,u===null)return xt(s),null;if(g=(s.flags&128)!==0,y=u.rendering,y===null)if(g)Kc(u,!1);else{if(Mt!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(y=lh(i),y!==null){for(s.flags|=128,Kc(u,!1),i=y.updateQueue,s.updateQueue=i,xh(s,i),s.subtreeFlags=0,i=l,l=s.child;l!==null;)Gv(l,i),l=l.sibling;return L(Bt,Bt.current&1|2),Xe&&_i(s,u.treeForkCount),s.child}i=i.sibling}u.tail!==null&&gn()>Ih&&(s.flags|=128,g=!0,Kc(u,!1),s.lanes=4194304)}else{if(!g)if(i=lh(y),i!==null){if(s.flags|=128,g=!0,i=i.updateQueue,s.updateQueue=i,xh(s,i),Kc(u,!0),u.tail===null&&u.tailMode==="hidden"&&!y.alternate&&!Xe)return xt(s),null}else 2*gn()-u.renderingStartTime>Ih&&l!==536870912&&(s.flags|=128,g=!0,Kc(u,!1),s.lanes=4194304);u.isBackwards?(y.sibling=s.child,s.child=y):(i=u.last,i!==null?i.sibling=y:s.child=y,u.last=y)}return u.tail!==null?(i=u.tail,u.rendering=i,u.tail=i.sibling,u.renderingStartTime=gn(),i.sibling=null,l=Bt.current,L(Bt,g?l&1|2:l&1),Xe&&_i(s,u.treeForkCount),i):(xt(s),null);case 22:case 23:return er(s),yg(),u=s.memoizedState!==null,i!==null?i.memoizedState!==null!==u&&(s.flags|=8192):u&&(s.flags|=8192),u?(l&536870912)!==0&&(s.flags&128)===0&&(xt(s),s.subtreeFlags&6&&(s.flags|=8192)):xt(s),l=s.updateQueue,l!==null&&xh(s,l.retryQueue),l=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),u=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),u!==l&&(s.flags|=2048),i!==null&&F(Ba),null;case 24:return l=null,i!==null&&(l=i.memoizedState.cache),s.memoizedState.cache!==l&&(s.flags|=2048),xi(Qt),xt(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function C1(i,s){switch(ng(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return xi(Qt),me(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Fe(s),null;case 31:if(s.memoizedState!==null){if(er(s),s.alternate===null)throw Error(r(340));Ua()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 13:if(er(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(r(340));Ua()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return F(Bt),null;case 4:return me(),null;case 10:return xi(s.type),null;case 22:case 23:return er(s),yg(),i!==null&&F(Ba),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return xi(Qt),null;case 25:return null;default:return null}}function yb(i,s){switch(ng(s),s.tag){case 3:xi(Qt),me();break;case 26:case 27:case 5:Fe(s);break;case 4:me();break;case 31:s.memoizedState!==null&&er(s);break;case 13:er(s);break;case 19:F(Bt);break;case 10:xi(s.type);break;case 22:case 23:er(s),yg(),i!==null&&F(Ba);break;case 24:xi(Qt)}}function Qc(i,s){try{var l=s.updateQueue,u=l!==null?l.lastEffect:null;if(u!==null){var g=u.next;l=g;do{if((l.tag&i)===i){u=void 0;var y=l.create,x=l.inst;u=y(),x.destroy=u}l=l.next}while(l!==g)}}catch(T){lt(s,s.return,T)}}function ks(i,s,l){try{var u=s.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var y=g.next;u=y;do{if((u.tag&i)===i){var x=u.inst,T=x.destroy;if(T!==void 0){x.destroy=void 0,g=s;var U=l,Z=T;try{Z()}catch(ae){lt(g,U,ae)}}}u=u.next}while(u!==y)}}catch(ae){lt(s,s.return,ae)}}function vb(i){var s=i.updateQueue;if(s!==null){var l=i.stateNode;try{l_(s,l)}catch(u){lt(i,i.return,u)}}}function _b(i,s,l){l.props=Ka(i.type,i.memoizedProps),l.state=i.memoizedState;try{l.componentWillUnmount()}catch(u){lt(i,s,u)}}function Yc(i,s){try{var l=i.ref;if(l!==null){switch(i.tag){case 26:case 27:case 5:var u=i.stateNode;break;case 30:u=i.stateNode;break;default:u=i.stateNode}typeof l=="function"?i.refCleanup=l(u):l.current=u}}catch(g){lt(i,s,g)}}function Wr(i,s){var l=i.ref,u=i.refCleanup;if(l!==null)if(typeof u=="function")try{u()}catch(g){lt(i,s,g)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(g){lt(i,s,g)}else l.current=null}function bb(i){var s=i.type,l=i.memoizedProps,u=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":l.autoFocus&&u.focus();break e;case"img":l.src?u.src=l.src:l.srcSet&&(u.srcset=l.srcSet)}}catch(g){lt(i,i.return,g)}}function Yg(i,s,l){try{var u=i.stateNode;X1(u,i.type,l,s),u[yn]=s}catch(g){lt(i,i.return,g)}}function xb(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Ls(i.type)||i.tag===4}function Wg(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||xb(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Ls(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Xg(i,s,l){var u=i.tag;if(u===5||u===6)i=i.stateNode,s?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(i,s):(s=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,s.appendChild(i),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=on));else if(u!==4&&(u===27&&Ls(i.type)&&(l=i.stateNode,s=null),i=i.child,i!==null))for(Xg(i,s,l),i=i.sibling;i!==null;)Xg(i,s,l),i=i.sibling}function wh(i,s,l){var u=i.tag;if(u===5||u===6)i=i.stateNode,s?l.insertBefore(i,s):l.appendChild(i);else if(u!==4&&(u===27&&Ls(i.type)&&(l=i.stateNode),i=i.child,i!==null))for(wh(i,s,l),i=i.sibling;i!==null;)wh(i,s,l),i=i.sibling}function wb(i){var s=i.stateNode,l=i.memoizedProps;try{for(var u=i.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);xn(s,u,l),s[Ot]=i,s[yn]=l}catch(y){lt(i,i.return,y)}}var Ii=!1,Xt=!1,Jg=!1,Eb=typeof WeakSet=="function"?WeakSet:Set,un=null;function R1(i,s){if(i=i.containerInfo,_p=qh,i=Pv(i),$m(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else e:{l=(l=i.ownerDocument)&&l.defaultView||window;var u=l.getSelection&&l.getSelection();if(u&&u.rangeCount!==0){l=u.anchorNode;var g=u.anchorOffset,y=u.focusNode;u=u.focusOffset;try{l.nodeType,y.nodeType}catch{l=null;break e}var x=0,T=-1,U=-1,Z=0,ae=0,ce=i,ee=null;t:for(;;){for(var re;ce!==l||g!==0&&ce.nodeType!==3||(T=x+g),ce!==y||u!==0&&ce.nodeType!==3||(U=x+u),ce.nodeType===3&&(x+=ce.nodeValue.length),(re=ce.firstChild)!==null;)ee=ce,ce=re;for(;;){if(ce===i)break t;if(ee===l&&++Z===g&&(T=x),ee===y&&++ae===u&&(U=x),(re=ce.nextSibling)!==null)break;ce=ee,ee=ce.parentNode}ce=re}l=T===-1||U===-1?null:{start:T,end:U}}else l=null}l=l||{start:0,end:0}}else l=null;for(bp={focusedElem:i,selectionRange:l},qh=!1,un=s;un!==null;)if(s=un,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,un=i;else for(;un!==null;){switch(s=un,y=s.alternate,i=s.flags,s.tag){case 0:if((i&4)!==0&&(i=s.updateQueue,i=i!==null?i.events:null,i!==null))for(l=0;l<i.length;l++)g=i[l],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((i&1024)!==0&&y!==null){i=void 0,l=s,g=y.memoizedProps,y=y.memoizedState,u=l.stateNode;try{var Ee=Ka(l.type,g);i=u.getSnapshotBeforeUpdate(Ee,y),u.__reactInternalSnapshotBeforeUpdate=i}catch(ke){lt(l,l.return,ke)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,l=i.nodeType,l===9)Ep(i);else if(l===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Ep(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=s.sibling,i!==null){i.return=s.return,un=i;break}un=s.return}}function Tb(i,s,l){var u=l.flags;switch(l.tag){case 0:case 11:case 15:Ni(i,l),u&4&&Qc(5,l);break;case 1:if(Ni(i,l),u&4)if(i=l.stateNode,s===null)try{i.componentDidMount()}catch(x){lt(l,l.return,x)}else{var g=Ka(l.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(g,s,i.__reactInternalSnapshotBeforeUpdate)}catch(x){lt(l,l.return,x)}}u&64&&vb(l),u&512&&Yc(l,l.return);break;case 3:if(Ni(i,l),u&64&&(i=l.updateQueue,i!==null)){if(s=null,l.child!==null)switch(l.child.tag){case 27:case 5:s=l.child.stateNode;break;case 1:s=l.child.stateNode}try{l_(i,s)}catch(x){lt(l,l.return,x)}}break;case 27:s===null&&u&4&&wb(l);case 26:case 5:Ni(i,l),s===null&&u&4&&bb(l),u&512&&Yc(l,l.return);break;case 12:Ni(i,l);break;case 31:Ni(i,l),u&4&&Ab(i,l);break;case 13:Ni(i,l),u&4&&Nb(i,l),u&64&&(i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(l=U1.bind(null,l),sC(i,l))));break;case 22:if(u=l.memoizedState!==null||Ii,!u){s=s!==null&&s.memoizedState!==null||Xt,g=Ii;var y=Xt;Ii=u,(Xt=s)&&!y?Ci(i,l,(l.subtreeFlags&8772)!==0):Ni(i,l),Ii=g,Xt=y}break;case 30:break;default:Ni(i,l)}}function Sb(i){var s=i.alternate;s!==null&&(i.alternate=null,Sb(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&Sa(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var St=null,Fn=!1;function Ai(i,s,l){for(l=l.child;l!==null;)Ib(i,s,l),l=l.sibling}function Ib(i,s,l){if(Sn&&typeof Sn.onCommitFiberUnmount=="function")try{Sn.onCommitFiberUnmount(ns,l)}catch{}switch(l.tag){case 26:Xt||Wr(l,s),Ai(i,s,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:Xt||Wr(l,s);var u=St,g=Fn;Ls(l.type)&&(St=l.stateNode,Fn=!1),Ai(i,s,l),iu(l.stateNode),St=u,Fn=g;break;case 5:Xt||Wr(l,s);case 6:if(u=St,g=Fn,St=null,Ai(i,s,l),St=u,Fn=g,St!==null)if(Fn)try{(St.nodeType===9?St.body:St.nodeName==="HTML"?St.ownerDocument.body:St).removeChild(l.stateNode)}catch(y){lt(l,s,y)}else try{St.removeChild(l.stateNode)}catch(y){lt(l,s,y)}break;case 18:St!==null&&(Fn?(i=St,vx(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,l.stateNode),fl(i)):vx(St,l.stateNode));break;case 4:u=St,g=Fn,St=l.stateNode.containerInfo,Fn=!0,Ai(i,s,l),St=u,Fn=g;break;case 0:case 11:case 14:case 15:ks(2,l,s),Xt||ks(4,l,s),Ai(i,s,l);break;case 1:Xt||(Wr(l,s),u=l.stateNode,typeof u.componentWillUnmount=="function"&&_b(l,s,u)),Ai(i,s,l);break;case 21:Ai(i,s,l);break;case 22:Xt=(u=Xt)||l.memoizedState!==null,Ai(i,s,l),Xt=u;break;default:Ai(i,s,l)}}function Ab(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null))){i=i.dehydrated;try{fl(i)}catch(l){lt(s,s.return,l)}}}function Nb(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{fl(i)}catch(l){lt(s,s.return,l)}}function k1(i){switch(i.tag){case 31:case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new Eb),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new Eb),s;default:throw Error(r(435,i.tag))}}function Eh(i,s){var l=k1(i);s.forEach(function(u){if(!l.has(u)){l.add(u);var g=z1.bind(null,i,u);u.then(g,g)}})}function Bn(i,s){var l=s.deletions;if(l!==null)for(var u=0;u<l.length;u++){var g=l[u],y=i,x=s,T=x;e:for(;T!==null;){switch(T.tag){case 27:if(Ls(T.type)){St=T.stateNode,Fn=!1;break e}break;case 5:St=T.stateNode,Fn=!1;break e;case 3:case 4:St=T.stateNode.containerInfo,Fn=!0;break e}T=T.return}if(St===null)throw Error(r(160));Ib(y,x,g),St=null,Fn=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)Cb(s,i),s=s.sibling}var Rr=null;function Cb(i,s){var l=i.alternate,u=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Bn(s,i),qn(i),u&4&&(ks(3,i,i.return),Qc(3,i),ks(5,i,i.return));break;case 1:Bn(s,i),qn(i),u&512&&(Xt||l===null||Wr(l,l.return)),u&64&&Ii&&(i=i.updateQueue,i!==null&&(u=i.callbacks,u!==null&&(l=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=l===null?u:l.concat(u))));break;case 26:var g=Rr;if(Bn(s,i),qn(i),u&512&&(Xt||l===null||Wr(l,l.return)),u&4){var y=l!==null?l.memoizedState:null;if(u=i.memoizedState,l===null)if(u===null)if(i.stateNode===null){e:{u=i.type,l=i.memoizedProps,g=g.ownerDocument||g;t:switch(u){case"title":y=g.getElementsByTagName("title")[0],(!y||y[ui]||y[Ot]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(u),g.head.insertBefore(y,g.querySelector("head > title"))),xn(y,u,l),y[Ot]=i,Ft(y),u=y;break e;case"link":var x=Cx("link","href",g).get(u+(l.href||""));if(x){for(var T=0;T<x.length;T++)if(y=x[T],y.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&y.getAttribute("rel")===(l.rel==null?null:l.rel)&&y.getAttribute("title")===(l.title==null?null:l.title)&&y.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){x.splice(T,1);break t}}y=g.createElement(u),xn(y,u,l),g.head.appendChild(y);break;case"meta":if(x=Cx("meta","content",g).get(u+(l.content||""))){for(T=0;T<x.length;T++)if(y=x[T],y.getAttribute("content")===(l.content==null?null:""+l.content)&&y.getAttribute("name")===(l.name==null?null:l.name)&&y.getAttribute("property")===(l.property==null?null:l.property)&&y.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&y.getAttribute("charset")===(l.charSet==null?null:l.charSet)){x.splice(T,1);break t}}y=g.createElement(u),xn(y,u,l),g.head.appendChild(y);break;default:throw Error(r(468,u))}y[Ot]=i,Ft(y),u=y}i.stateNode=u}else Rx(g,i.type,i.stateNode);else i.stateNode=Nx(g,u,i.memoizedProps);else y!==u?(y===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):y.count--,u===null?Rx(g,i.type,i.stateNode):Nx(g,u,i.memoizedProps)):u===null&&i.stateNode!==null&&Yg(i,i.memoizedProps,l.memoizedProps)}break;case 27:Bn(s,i),qn(i),u&512&&(Xt||l===null||Wr(l,l.return)),l!==null&&u&4&&Yg(i,i.memoizedProps,l.memoizedProps);break;case 5:if(Bn(s,i),qn(i),u&512&&(Xt||l===null||Wr(l,l.return)),i.flags&32){g=i.stateNode;try{hr(g,"")}catch(Ee){lt(i,i.return,Ee)}}u&4&&i.stateNode!=null&&(g=i.memoizedProps,Yg(i,g,l!==null?l.memoizedProps:g)),u&1024&&(Jg=!0);break;case 6:if(Bn(s,i),qn(i),u&4){if(i.stateNode===null)throw Error(r(162));u=i.memoizedProps,l=i.stateNode;try{l.nodeValue=u}catch(Ee){lt(i,i.return,Ee)}}break;case 3:if(Uh=null,g=Rr,Rr=Mh(s.containerInfo),Bn(s,i),Rr=g,qn(i),u&4&&l!==null&&l.memoizedState.isDehydrated)try{fl(s.containerInfo)}catch(Ee){lt(i,i.return,Ee)}Jg&&(Jg=!1,Rb(i));break;case 4:u=Rr,Rr=Mh(i.stateNode.containerInfo),Bn(s,i),qn(i),Rr=u;break;case 12:Bn(s,i),qn(i);break;case 31:Bn(s,i),qn(i),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,Eh(i,u)));break;case 13:Bn(s,i),qn(i),i.child.flags&8192&&i.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Sh=gn()),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,Eh(i,u)));break;case 22:g=i.memoizedState!==null;var U=l!==null&&l.memoizedState!==null,Z=Ii,ae=Xt;if(Ii=Z||g,Xt=ae||U,Bn(s,i),Xt=ae,Ii=Z,qn(i),u&8192)e:for(s=i.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(l===null||U||Ii||Xt||Qa(i)),l=null,s=i;;){if(s.tag===5||s.tag===26){if(l===null){U=l=s;try{if(y=U.stateNode,g)x=y.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none";else{T=U.stateNode;var ce=U.memoizedProps.style,ee=ce!=null&&ce.hasOwnProperty("display")?ce.display:null;T.style.display=ee==null||typeof ee=="boolean"?"":(""+ee).trim()}}catch(Ee){lt(U,U.return,Ee)}}}else if(s.tag===6){if(l===null){U=s;try{U.stateNode.nodeValue=g?"":U.memoizedProps}catch(Ee){lt(U,U.return,Ee)}}}else if(s.tag===18){if(l===null){U=s;try{var re=U.stateNode;g?_x(re,!0):_x(U.stateNode,!1)}catch(Ee){lt(U,U.return,Ee)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;l===s&&(l=null),s=s.return}l===s&&(l=null),s.sibling.return=s.return,s=s.sibling}u&4&&(u=i.updateQueue,u!==null&&(l=u.retryQueue,l!==null&&(u.retryQueue=null,Eh(i,l))));break;case 19:Bn(s,i),qn(i),u&4&&(u=i.updateQueue,u!==null&&(i.updateQueue=null,Eh(i,u)));break;case 30:break;case 21:break;default:Bn(s,i),qn(i)}}function qn(i){var s=i.flags;if(s&2){try{for(var l,u=i.return;u!==null;){if(xb(u)){l=u;break}u=u.return}if(l==null)throw Error(r(160));switch(l.tag){case 27:var g=l.stateNode,y=Wg(i);wh(i,y,g);break;case 5:var x=l.stateNode;l.flags&32&&(hr(x,""),l.flags&=-33);var T=Wg(i);wh(i,T,x);break;case 3:case 4:var U=l.stateNode.containerInfo,Z=Wg(i);Xg(i,Z,U);break;default:throw Error(r(161))}}catch(ae){lt(i,i.return,ae)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function Rb(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;Rb(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function Ni(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Tb(i,s.alternate,s),s=s.sibling}function Qa(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:ks(4,s,s.return),Qa(s);break;case 1:Wr(s,s.return);var l=s.stateNode;typeof l.componentWillUnmount=="function"&&_b(s,s.return,l),Qa(s);break;case 27:iu(s.stateNode);case 26:case 5:Wr(s,s.return),Qa(s);break;case 22:s.memoizedState===null&&Qa(s);break;case 30:Qa(s);break;default:Qa(s)}i=i.sibling}}function Ci(i,s,l){for(l=l&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var u=s.alternate,g=i,y=s,x=y.flags;switch(y.tag){case 0:case 11:case 15:Ci(g,y,l),Qc(4,y);break;case 1:if(Ci(g,y,l),u=y,g=u.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(Z){lt(u,u.return,Z)}if(u=y,g=u.updateQueue,g!==null){var T=u.stateNode;try{var U=g.shared.hiddenCallbacks;if(U!==null)for(g.shared.hiddenCallbacks=null,g=0;g<U.length;g++)o_(U[g],T)}catch(Z){lt(u,u.return,Z)}}l&&x&64&&vb(y),Yc(y,y.return);break;case 27:wb(y);case 26:case 5:Ci(g,y,l),l&&u===null&&x&4&&bb(y),Yc(y,y.return);break;case 12:Ci(g,y,l);break;case 31:Ci(g,y,l),l&&x&4&&Ab(g,y);break;case 13:Ci(g,y,l),l&&x&4&&Nb(g,y);break;case 22:y.memoizedState===null&&Ci(g,y,l),Yc(y,y.return);break;case 30:break;default:Ci(g,y,l)}s=s.sibling}}function Zg(i,s){var l=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==l&&(i!=null&&i.refCount++,l!=null&&Pc(l))}function ep(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Pc(i))}function kr(i,s,l,u){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)kb(i,s,l,u),s=s.sibling}function kb(i,s,l,u){var g=s.flags;switch(s.tag){case 0:case 11:case 15:kr(i,s,l,u),g&2048&&Qc(9,s);break;case 1:kr(i,s,l,u);break;case 3:kr(i,s,l,u),g&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Pc(i)));break;case 12:if(g&2048){kr(i,s,l,u),i=s.stateNode;try{var y=s.memoizedProps,x=y.id,T=y.onPostCommit;typeof T=="function"&&T(x,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(U){lt(s,s.return,U)}}else kr(i,s,l,u);break;case 31:kr(i,s,l,u);break;case 13:kr(i,s,l,u);break;case 23:break;case 22:y=s.stateNode,x=s.alternate,s.memoizedState!==null?y._visibility&2?kr(i,s,l,u):Wc(i,s):y._visibility&2?kr(i,s,l,u):(y._visibility|=2,nl(i,s,l,u,(s.subtreeFlags&10256)!==0||!1)),g&2048&&Zg(x,s);break;case 24:kr(i,s,l,u),g&2048&&ep(s.alternate,s);break;default:kr(i,s,l,u)}}function nl(i,s,l,u,g){for(g=g&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var y=i,x=s,T=l,U=u,Z=x.flags;switch(x.tag){case 0:case 11:case 15:nl(y,x,T,U,g),Qc(8,x);break;case 23:break;case 22:var ae=x.stateNode;x.memoizedState!==null?ae._visibility&2?nl(y,x,T,U,g):Wc(y,x):(ae._visibility|=2,nl(y,x,T,U,g)),g&&Z&2048&&Zg(x.alternate,x);break;case 24:nl(y,x,T,U,g),g&&Z&2048&&ep(x.alternate,x);break;default:nl(y,x,T,U,g)}s=s.sibling}}function Wc(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var l=i,u=s,g=u.flags;switch(u.tag){case 22:Wc(l,u),g&2048&&Zg(u.alternate,u);break;case 24:Wc(l,u),g&2048&&ep(u.alternate,u);break;default:Wc(l,u)}s=s.sibling}}var Xc=8192;function rl(i,s,l){if(i.subtreeFlags&Xc)for(i=i.child;i!==null;)Db(i,s,l),i=i.sibling}function Db(i,s,l){switch(i.tag){case 26:rl(i,s,l),i.flags&Xc&&i.memoizedState!==null&&yC(l,Rr,i.memoizedState,i.memoizedProps);break;case 5:rl(i,s,l);break;case 3:case 4:var u=Rr;Rr=Mh(i.stateNode.containerInfo),rl(i,s,l),Rr=u;break;case 22:i.memoizedState===null&&(u=i.alternate,u!==null&&u.memoizedState!==null?(u=Xc,Xc=16777216,rl(i,s,l),Xc=u):rl(i,s,l));break;default:rl(i,s,l)}}function jb(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function Jc(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var u=s[l];un=u,Pb(u,i)}jb(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Ob(i),i=i.sibling}function Ob(i){switch(i.tag){case 0:case 11:case 15:Jc(i),i.flags&2048&&ks(9,i,i.return);break;case 3:Jc(i);break;case 12:Jc(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,Th(i)):Jc(i);break;default:Jc(i)}}function Th(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var u=s[l];un=u,Pb(u,i)}jb(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:ks(8,s,s.return),Th(s);break;case 22:l=s.stateNode,l._visibility&2&&(l._visibility&=-3,Th(s));break;default:Th(s)}i=i.sibling}}function Pb(i,s){for(;un!==null;){var l=un;switch(l.tag){case 0:case 11:case 15:ks(8,l,s);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var u=l.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Pc(l.memoizedState.cache)}if(u=l.child,u!==null)u.return=l,un=u;else e:for(l=i;un!==null;){u=un;var g=u.sibling,y=u.return;if(Sb(u),u===l){un=null;break e}if(g!==null){g.return=y,un=g;break e}un=y}}}var D1={getCacheForType:function(i){var s=_n(Qt),l=s.data.get(i);return l===void 0&&(l=i(),s.data.set(i,l)),l},cacheSignal:function(){return _n(Qt).controller.signal}},j1=typeof WeakMap=="function"?WeakMap:Map,st=0,pt=null,Ge=null,He=0,ot=0,tr=null,Ds=!1,il=!1,tp=!1,Ri=0,Mt=0,js=0,Ya=0,np=0,nr=0,sl=0,Zc=null,Gn=null,rp=!1,Sh=0,Vb=0,Ih=1/0,Ah=null,Os=null,tn=0,Ps=null,al=null,ki=0,ip=0,sp=null,Mb=null,eu=0,ap=null;function rr(){return(st&2)!==0&&He!==0?He&-He:B.T!==null?hp():ci()}function Lb(){if(nr===0)if((He&536870912)===0||Xe){var i=zr;zr<<=1,(zr&3932160)===0&&(zr=262144),nr=i}else nr=536870912;return i=Zn.current,i!==null&&(i.flags|=32),nr}function $n(i,s,l){(i===pt&&(ot===2||ot===9)||i.cancelPendingCommit!==null)&&(ol(i,0),Vs(i,He,nr,!1)),ss(i,l),((st&2)===0||i!==pt)&&(i===pt&&((st&2)===0&&(Ya|=l),Mt===4&&Vs(i,He,nr,!1)),Xr(i))}function Ub(i,s,l){if((st&6)!==0)throw Error(r(327));var u=!l&&(s&127)===0&&(s&i.expiredLanes)===0||is(i,s),g=u?V1(i,s):lp(i,s,!0),y=u;do{if(g===0){il&&!u&&Vs(i,s,0,!1);break}else{if(l=i.current.alternate,y&&!O1(l)){g=lp(i,s,!1),y=!1;continue}if(g===2){if(y=s,i.errorRecoveryDisabledLanes&y)var x=0;else x=i.pendingLanes&-536870913,x=x!==0?x:x&536870912?536870912:0;if(x!==0){s=x;e:{var T=i;g=Zc;var U=T.current.memoizedState.isDehydrated;if(U&&(ol(T,x).flags|=256),x=lp(T,x,!1),x!==2){if(tp&&!U){T.errorRecoveryDisabledLanes|=y,Ya|=y,g=4;break e}y=Gn,Gn=g,y!==null&&(Gn===null?Gn=y:Gn.push.apply(Gn,y))}g=x}if(y=!1,g!==2)continue}}if(g===1){ol(i,0),Vs(i,s,0,!0);break}e:{switch(u=i,y=g,y){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:Vs(u,s,nr,!Ds);break e;case 2:Gn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(g=Sh+300-gn(),10<g)){if(Vs(u,s,nr,!Ds),ur(u,0,!0)!==0)break e;ki=s,u.timeoutHandle=px(zb.bind(null,u,l,Gn,Ah,rp,s,nr,Ya,sl,Ds,y,"Throttled",-0,0),g);break e}zb(u,l,Gn,Ah,rp,s,nr,Ya,sl,Ds,y,null,-0,0)}}break}while(!0);Xr(i)}function zb(i,s,l,u,g,y,x,T,U,Z,ae,ce,ee,re){if(i.timeoutHandle=-1,ce=s.subtreeFlags,ce&8192||(ce&16785408)===16785408){ce={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:on},Db(s,y,ce);var Ee=(y&62914560)===y?Sh-gn():(y&4194048)===y?Vb-gn():0;if(Ee=vC(ce,Ee),Ee!==null){ki=y,i.cancelPendingCommit=Ee(Qb.bind(null,i,s,y,l,u,g,x,T,U,ae,ce,null,ee,re)),Vs(i,y,x,!Z);return}}Qb(i,s,y,l,u,g,x,T,U)}function O1(i){for(var s=i;;){var l=s.tag;if((l===0||l===11||l===15)&&s.flags&16384&&(l=s.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var u=0;u<l.length;u++){var g=l[u],y=g.getSnapshot;g=g.value;try{if(!Xn(y(),g))return!1}catch{return!1}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Vs(i,s,l,u){s&=~np,s&=~Ya,i.suspendedLanes|=s,i.pingedLanes&=~s,u&&(i.warmLanes|=s),u=i.expirationTimes;for(var g=s;0<g;){var y=31-Dn(g),x=1<<y;u[y]=-1,g&=~x}l!==0&&mc(i,l,s)}function Nh(){return(st&6)===0?(tu(0),!1):!0}function op(){if(Ge!==null){if(ot===0)var i=Ge.return;else i=Ge,bi=za=null,Eg(i),Xo=null,Mc=0,i=Ge;for(;i!==null;)yb(i.alternate,i),i=i.return;Ge=null}}function ol(i,s){var l=i.timeoutHandle;l!==-1&&(i.timeoutHandle=-1,eC(l)),l=i.cancelPendingCommit,l!==null&&(i.cancelPendingCommit=null,l()),ki=0,op(),pt=i,Ge=l=vi(i.current,null),He=s,ot=0,tr=null,Ds=!1,il=is(i,s),tp=!1,sl=nr=np=Ya=js=Mt=0,Gn=Zc=null,rp=!1,(s&8)!==0&&(s|=s&32);var u=i.entangledLanes;if(u!==0)for(i=i.entanglements,u&=s;0<u;){var g=31-Dn(u),y=1<<g;s|=i[g],u&=~y}return Ri=s,Yd(),l}function Fb(i,s){Me=null,B.H=$c,s===Wo||s===rh?(s=r_(),ot=3):s===dg?(s=r_(),ot=4):ot=s===Ug?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,tr=s,Ge===null&&(Mt=1,yh(i,mr(s,i.current)))}function Bb(){var i=Zn.current;return i===null?!0:(He&4194048)===He?vr===null:(He&62914560)===He||(He&536870912)!==0?i===vr:!1}function qb(){var i=B.H;return B.H=$c,i===null?$c:i}function Gb(){var i=B.A;return B.A=D1,i}function Ch(){Mt=4,Ds||(He&4194048)!==He&&Zn.current!==null||(il=!0),(js&134217727)===0&&(Ya&134217727)===0||pt===null||Vs(pt,He,nr,!1)}function lp(i,s,l){var u=st;st|=2;var g=qb(),y=Gb();(pt!==i||He!==s)&&(Ah=null,ol(i,s)),s=!1;var x=Mt;e:do try{if(ot!==0&&Ge!==null){var T=Ge,U=tr;switch(ot){case 8:op(),x=6;break e;case 3:case 2:case 9:case 6:Zn.current===null&&(s=!0);var Z=ot;if(ot=0,tr=null,ll(i,T,U,Z),l&&il){x=0;break e}break;default:Z=ot,ot=0,tr=null,ll(i,T,U,Z)}}P1(),x=Mt;break}catch(ae){Fb(i,ae)}while(!0);return s&&i.shellSuspendCounter++,bi=za=null,st=u,B.H=g,B.A=y,Ge===null&&(pt=null,He=0,Yd()),x}function P1(){for(;Ge!==null;)$b(Ge)}function V1(i,s){var l=st;st|=2;var u=qb(),g=Gb();pt!==i||He!==s?(Ah=null,Ih=gn()+500,ol(i,s)):il=is(i,s);e:do try{if(ot!==0&&Ge!==null){s=Ge;var y=tr;t:switch(ot){case 1:ot=0,tr=null,ll(i,s,y,1);break;case 2:case 9:if(t_(y)){ot=0,tr=null,Hb(s);break}s=function(){ot!==2&&ot!==9||pt!==i||(ot=7),Xr(i)},y.then(s,s);break e;case 3:ot=7;break e;case 4:ot=5;break e;case 7:t_(y)?(ot=0,tr=null,Hb(s)):(ot=0,tr=null,ll(i,s,y,7));break;case 5:var x=null;switch(Ge.tag){case 26:x=Ge.memoizedState;case 5:case 27:var T=Ge;if(x?kx(x):T.stateNode.complete){ot=0,tr=null;var U=T.sibling;if(U!==null)Ge=U;else{var Z=T.return;Z!==null?(Ge=Z,Rh(Z)):Ge=null}break t}}ot=0,tr=null,ll(i,s,y,5);break;case 6:ot=0,tr=null,ll(i,s,y,6);break;case 8:op(),Mt=6;break e;default:throw Error(r(462))}}M1();break}catch(ae){Fb(i,ae)}while(!0);return bi=za=null,B.H=u,B.A=g,st=l,Ge!==null?0:(pt=null,He=0,Yd(),Mt)}function M1(){for(;Ge!==null&&!Om();)$b(Ge)}function $b(i){var s=gb(i.alternate,i,Ri);i.memoizedProps=i.pendingProps,s===null?Rh(i):Ge=s}function Hb(i){var s=i,l=s.alternate;switch(s.tag){case 15:case 0:s=cb(l,s,s.pendingProps,s.type,void 0,He);break;case 11:s=cb(l,s,s.pendingProps,s.type.render,s.ref,He);break;case 5:Eg(s);default:yb(l,s),s=Ge=Gv(s,Ri),s=gb(l,s,Ri)}i.memoizedProps=i.pendingProps,s===null?Rh(i):Ge=s}function ll(i,s,l,u){bi=za=null,Eg(s),Xo=null,Mc=0;var g=s.return;try{if(S1(i,g,s,l,He)){Mt=1,yh(i,mr(l,i.current)),Ge=null;return}}catch(y){if(g!==null)throw Ge=g,y;Mt=1,yh(i,mr(l,i.current)),Ge=null;return}s.flags&32768?(Xe||u===1?i=!0:il||(He&536870912)!==0?i=!1:(Ds=i=!0,(u===2||u===9||u===3||u===6)&&(u=Zn.current,u!==null&&u.tag===13&&(u.flags|=16384))),Kb(s,i)):Rh(s)}function Rh(i){var s=i;do{if((s.flags&32768)!==0){Kb(s,Ds);return}i=s.return;var l=N1(s.alternate,s,Ri);if(l!==null){Ge=l;return}if(s=s.sibling,s!==null){Ge=s;return}Ge=s=i}while(s!==null);Mt===0&&(Mt=5)}function Kb(i,s){do{var l=C1(i.alternate,i);if(l!==null){l.flags&=32767,Ge=l;return}if(l=i.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!s&&(i=i.sibling,i!==null)){Ge=i;return}Ge=i=l}while(i!==null);Mt=6,Ge=null}function Qb(i,s,l,u,g,y,x,T,U){i.cancelPendingCommit=null;do kh();while(tn!==0);if((st&6)!==0)throw Error(r(327));if(s!==null){if(s===i.current)throw Error(r(177));if(y=s.lanes|s.childLanes,y|=Wm,pn(i,l,y,x,T,U),i===pt&&(Ge=pt=null,He=0),al=s,Ps=i,ki=l,ip=y,sp=g,Mb=u,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,F1(oi,function(){return Zb(),null})):(i.callbackNode=null,i.callbackPriority=0),u=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||u){u=B.T,B.T=null,g=ue.p,ue.p=2,x=st,st|=4;try{R1(i,s,l)}finally{st=x,ue.p=g,B.T=u}}tn=1,Yb(),Wb(),Xb()}}function Yb(){if(tn===1){tn=0;var i=Ps,s=al,l=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||l){l=B.T,B.T=null;var u=ue.p;ue.p=2;var g=st;st|=4;try{Cb(s,i);var y=bp,x=Pv(i.containerInfo),T=y.focusedElem,U=y.selectionRange;if(x!==T&&T&&T.ownerDocument&&Ov(T.ownerDocument.documentElement,T)){if(U!==null&&$m(T)){var Z=U.start,ae=U.end;if(ae===void 0&&(ae=Z),"selectionStart"in T)T.selectionStart=Z,T.selectionEnd=Math.min(ae,T.value.length);else{var ce=T.ownerDocument||document,ee=ce&&ce.defaultView||window;if(ee.getSelection){var re=ee.getSelection(),Ee=T.textContent.length,ke=Math.min(U.start,Ee),ft=U.end===void 0?ke:Math.min(U.end,Ee);!re.extend&&ke>ft&&(x=ft,ft=ke,ke=x);var H=jv(T,ke),G=jv(T,ft);if(H&&G&&(re.rangeCount!==1||re.anchorNode!==H.node||re.anchorOffset!==H.offset||re.focusNode!==G.node||re.focusOffset!==G.offset)){var J=ce.createRange();J.setStart(H.node,H.offset),re.removeAllRanges(),ke>ft?(re.addRange(J),re.extend(G.node,G.offset)):(J.setEnd(G.node,G.offset),re.addRange(J))}}}}for(ce=[],re=T;re=re.parentNode;)re.nodeType===1&&ce.push({element:re,left:re.scrollLeft,top:re.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<ce.length;T++){var le=ce[T];le.element.scrollLeft=le.left,le.element.scrollTop=le.top}}qh=!!_p,bp=_p=null}finally{st=g,ue.p=u,B.T=l}}i.current=s,tn=2}}function Wb(){if(tn===2){tn=0;var i=Ps,s=al,l=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||l){l=B.T,B.T=null;var u=ue.p;ue.p=2;var g=st;st|=4;try{Tb(i,s.alternate,s)}finally{st=g,ue.p=u,B.T=l}}tn=3}}function Xb(){if(tn===4||tn===3){tn=0,uc();var i=Ps,s=al,l=ki,u=Mb;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?tn=5:(tn=0,al=Ps=null,Jb(i,i.pendingLanes));var g=i.pendingLanes;if(g===0&&(Os=null),pc(l),s=s.stateNode,Sn&&typeof Sn.onCommitFiberRoot=="function")try{Sn.onCommitFiberRoot(ns,s,void 0,(s.current.flags&128)===128)}catch{}if(u!==null){s=B.T,g=ue.p,ue.p=2,B.T=null;try{for(var y=i.onRecoverableError,x=0;x<u.length;x++){var T=u[x];y(T.value,{componentStack:T.stack})}}finally{B.T=s,ue.p=g}}(ki&3)!==0&&kh(),Xr(i),g=i.pendingLanes,(l&261930)!==0&&(g&42)!==0?i===ap?eu++:(eu=0,ap=i):eu=0,tu(0)}}function Jb(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Pc(s)))}function kh(){return Yb(),Wb(),Xb(),Zb()}function Zb(){if(tn!==5)return!1;var i=Ps,s=ip;ip=0;var l=pc(ki),u=B.T,g=ue.p;try{ue.p=32>l?32:l,B.T=null,l=sp,sp=null;var y=Ps,x=ki;if(tn=0,al=Ps=null,ki=0,(st&6)!==0)throw Error(r(331));var T=st;if(st|=4,Ob(y.current),kb(y,y.current,x,l),st=T,tu(0,!1),Sn&&typeof Sn.onPostCommitFiberRoot=="function")try{Sn.onPostCommitFiberRoot(ns,y)}catch{}return!0}finally{ue.p=g,B.T=u,Jb(i,s)}}function ex(i,s,l){s=mr(l,s),s=Lg(i.stateNode,s,2),i=Ns(i,s,2),i!==null&&(ss(i,2),Xr(i))}function lt(i,s,l){if(i.tag===3)ex(i,i,l);else for(;s!==null;){if(s.tag===3){ex(s,i,l);break}else if(s.tag===1){var u=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(Os===null||!Os.has(u))){i=mr(l,i),l=tb(2),u=Ns(s,l,2),u!==null&&(nb(l,u,s,i),ss(u,2),Xr(u));break}}s=s.return}}function cp(i,s,l){var u=i.pingCache;if(u===null){u=i.pingCache=new j1;var g=new Set;u.set(s,g)}else g=u.get(s),g===void 0&&(g=new Set,u.set(s,g));g.has(l)||(tp=!0,g.add(l),i=L1.bind(null,i,s,l),s.then(i,i))}function L1(i,s,l){var u=i.pingCache;u!==null&&u.delete(s),i.pingedLanes|=i.suspendedLanes&l,i.warmLanes&=~l,pt===i&&(He&l)===l&&(Mt===4||Mt===3&&(He&62914560)===He&&300>gn()-Sh?(st&2)===0&&ol(i,0):np|=l,sl===He&&(sl=0)),Xr(i)}function tx(i,s){s===0&&(s=fc()),i=Ma(i,s),i!==null&&(ss(i,s),Xr(i))}function U1(i){var s=i.memoizedState,l=0;s!==null&&(l=s.retryLane),tx(i,l)}function z1(i,s){var l=0;switch(i.tag){case 31:case 13:var u=i.stateNode,g=i.memoizedState;g!==null&&(l=g.retryLane);break;case 19:u=i.stateNode;break;case 22:u=i.stateNode._retryCache;break;default:throw Error(r(314))}u!==null&&u.delete(s),tx(i,l)}function F1(i,s){return wa(i,s)}var Dh=null,cl=null,up=!1,jh=!1,dp=!1,Ms=0;function Xr(i){i!==cl&&i.next===null&&(cl===null?Dh=cl=i:cl=cl.next=i),jh=!0,up||(up=!0,q1())}function tu(i,s){if(!dp&&jh){dp=!0;do for(var l=!1,u=Dh;u!==null;){if(i!==0){var g=u.pendingLanes;if(g===0)var y=0;else{var x=u.suspendedLanes,T=u.pingedLanes;y=(1<<31-Dn(42|i)+1)-1,y&=g&~(x&~T),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(l=!0,sx(u,y))}else y=He,y=ur(u,u===pt?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(y&3)===0||is(u,y)||(l=!0,sx(u,y));u=u.next}while(l);dp=!1}}function B1(){nx()}function nx(){jh=up=!1;var i=0;Ms!==0&&Z1()&&(i=Ms);for(var s=gn(),l=null,u=Dh;u!==null;){var g=u.next,y=rx(u,s);y===0?(u.next=null,l===null?Dh=g:l.next=g,g===null&&(cl=l)):(l=u,(i!==0||(y&3)!==0)&&(jh=!0)),u=g}tn!==0&&tn!==5||tu(i),Ms!==0&&(Ms=0)}function rx(i,s){for(var l=i.suspendedLanes,u=i.pingedLanes,g=i.expirationTimes,y=i.pendingLanes&-62914561;0<y;){var x=31-Dn(y),T=1<<x,U=g[x];U===-1?((T&l)===0||(T&u)!==0)&&(g[x]=Co(T,s)):U<=s&&(i.expiredLanes|=T),y&=~T}if(s=pt,l=He,l=ur(i,i===s?l:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u=i.callbackNode,l===0||i===s&&(ot===2||ot===9)||i.cancelPendingCommit!==null)return u!==null&&u!==null&&No(u),i.callbackNode=null,i.callbackPriority=0;if((l&3)===0||is(i,l)){if(s=l&-l,s===i.callbackPriority)return s;switch(u!==null&&No(u),pc(l)){case 2:case 8:l=an;break;case 32:l=oi;break;case 268435456:l=dc;break;default:l=oi}return u=ix.bind(null,i),l=wa(l,u),i.callbackPriority=s,i.callbackNode=l,s}return u!==null&&u!==null&&No(u),i.callbackPriority=2,i.callbackNode=null,2}function ix(i,s){if(tn!==0&&tn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var l=i.callbackNode;if(kh()&&i.callbackNode!==l)return null;var u=He;return u=ur(i,i===pt?u:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),u===0?null:(Ub(i,u,s),rx(i,gn()),i.callbackNode!=null&&i.callbackNode===l?ix.bind(null,i):null)}function sx(i,s){if(kh())return null;Ub(i,s,!0)}function q1(){tC(function(){(st&6)!==0?wa(en,B1):nx()})}function hp(){if(Ms===0){var i=Qo;i===0&&(i=Ta,Ta<<=1,(Ta&261888)===0&&(Ta=256)),Ms=i}return Ms}function ax(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:$r(""+i)}function ox(i,s){var l=s.ownerDocument.createElement("input");return l.name=s.name,l.value=s.value,i.id&&l.setAttribute("form",i.id),s.parentNode.insertBefore(l,s),i=new FormData(i),l.parentNode.removeChild(l),i}function G1(i,s,l,u,g){if(s==="submit"&&l&&l.stateNode===g){var y=ax((g[yn]||null).action),x=u.submitter;x&&(s=(s=x[yn]||null)?ax(s.formAction):x.getAttribute("formAction"),s!==null&&(y=s,x=null));var T=new Ra("action","action",null,u,g);i.push({event:T,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Ms!==0){var U=x?ox(g,x):new FormData(g);Dg(l,{pending:!0,data:U,method:g.method,action:y},null,U)}}else typeof y=="function"&&(T.preventDefault(),U=x?ox(g,x):new FormData(g),Dg(l,{pending:!0,data:U,method:g.method,action:y},y,U))},currentTarget:g}]})}}for(var fp=0;fp<Ym.length;fp++){var mp=Ym[fp],$1=mp.toLowerCase(),H1=mp[0].toUpperCase()+mp.slice(1);Cr($1,"on"+H1)}Cr(Lv,"onAnimationEnd"),Cr(Uv,"onAnimationIteration"),Cr(zv,"onAnimationStart"),Cr("dblclick","onDoubleClick"),Cr("focusin","onFocus"),Cr("focusout","onBlur"),Cr(l1,"onTransitionRun"),Cr(c1,"onTransitionStart"),Cr(u1,"onTransitionCancel"),Cr(Fv,"onTransitionEnd"),Gr("onMouseEnter",["mouseout","mouseover"]),Gr("onMouseLeave",["mouseout","mouseover"]),Gr("onPointerEnter",["pointerout","pointerover"]),Gr("onPointerLeave",["pointerout","pointerover"]),jn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),jn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),jn("onBeforeInput",["compositionend","keypress","textInput","paste"]),jn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),jn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),jn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),K1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(nu));function lx(i,s){s=(s&4)!==0;for(var l=0;l<i.length;l++){var u=i[l],g=u.event;u=u.listeners;e:{var y=void 0;if(s)for(var x=u.length-1;0<=x;x--){var T=u[x],U=T.instance,Z=T.currentTarget;if(T=T.listener,U!==y&&g.isPropagationStopped())break e;y=T,g.currentTarget=Z;try{y(g)}catch(ae){Qd(ae)}g.currentTarget=null,y=U}else for(x=0;x<u.length;x++){if(T=u[x],U=T.instance,Z=T.currentTarget,T=T.listener,U!==y&&g.isPropagationStopped())break e;y=T,g.currentTarget=Z;try{y(g)}catch(ae){Qd(ae)}g.currentTarget=null,y=U}}}}function $e(i,s){var l=s[ls];l===void 0&&(l=s[ls]=new Set);var u=i+"__bubble";l.has(u)||(cx(s,i,2,!1),l.add(u))}function gp(i,s,l){var u=0;s&&(u|=4),cx(l,i,u,s)}var Oh="_reactListening"+Math.random().toString(36).slice(2);function pp(i){if(!i[Oh]){i[Oh]=!0,Ro.forEach(function(l){l!=="selectionchange"&&(K1.has(l)||gp(l,!1,i),gp(l,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Oh]||(s[Oh]=!0,gp("selectionchange",!1,s))}}function cx(i,s,l,u){switch(Lx(s)){case 2:var g=xC;break;case 8:g=wC;break;default:g=kp}l=g.bind(null,s,l,i),g=void 0,!Tc||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),u?g!==void 0?i.addEventListener(s,l,{capture:!0,passive:g}):i.addEventListener(s,l,!0):g!==void 0?i.addEventListener(s,l,{passive:g}):i.addEventListener(s,l,!1)}function yp(i,s,l,u,g){var y=u;if((s&1)===0&&(s&2)===0&&u!==null)e:for(;;){if(u===null)return;var x=u.tag;if(x===3||x===4){var T=u.stateNode.containerInfo;if(T===g)break;if(x===4)for(x=u.return;x!==null;){var U=x.tag;if((U===3||U===4)&&x.stateNode.containerInfo===g)return;x=x.return}for(;T!==null;){if(x=di(T),x===null)return;if(U=x.tag,U===5||U===6||U===26||U===27){u=y=x;continue e}T=T.parentNode}}u=u.return}Dd(function(){var Z=y,ae=Po(l),ce=[];e:{var ee=Bv.get(i);if(ee!==void 0){var re=Ra,Ee=i;switch(i){case"keypress":if(Ca(l)===0)break e;case"keydown":case"keyup":re=Fd;break;case"focusin":Ee="focus",re=vs;break;case"focusout":Ee="blur",re=vs;break;case"beforeblur":case"afterblur":re=vs;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":re=Od;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":re=Pd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":re=qd;break;case Lv:case Uv:case zv:re=Lo;break;case Fv:re=Uo;break;case"scroll":case"scrollend":re=jd;break;case"wheel":re=$d;break;case"copy":case"cut":case"paste":re=Md;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":re=Cc;break;case"toggle":case"beforetoggle":re=bs}var ke=(s&4)!==0,ft=!ke&&(i==="scroll"||i==="scrollend"),H=ke?ee!==null?ee+"Capture":null:ee;ke=[];for(var G=Z,J;G!==null;){var le=G;if(J=le.stateNode,le=le.tag,le!==5&&le!==26&&le!==27||J===null||H===null||(le=Un(G,H),le!=null&&ke.push(ru(G,le,J))),ft)break;G=G.return}0<ke.length&&(ee=new re(ee,Ee,null,l,ae),ce.push({event:ee,listeners:ke}))}}if((s&7)===0){e:{if(ee=i==="mouseover"||i==="pointerover",re=i==="mouseout"||i==="pointerout",ee&&l!==Oo&&(Ee=l.relatedTarget||l.fromElement)&&(di(Ee)||Ee[Br]))break e;if((re||ee)&&(ee=ae.window===ae?ae:(ee=ae.ownerDocument)?ee.defaultView||ee.parentWindow:window,re?(Ee=l.relatedTarget||l.toElement,re=Z,Ee=Ee?di(Ee):null,Ee!==null&&(ft=o(Ee),ke=Ee.tag,Ee!==ft||ke!==5&&ke!==27&&ke!==6)&&(Ee=null)):(re=null,Ee=Z),re!==Ee)){if(ke=Od,le="onMouseLeave",H="onMouseEnter",G="mouse",(i==="pointerout"||i==="pointerover")&&(ke=Cc,le="onPointerLeave",H="onPointerEnter",G="pointer"),ft=re==null?ee:Ia(re),J=Ee==null?ee:Ia(Ee),ee=new ke(le,G+"leave",re,l,ae),ee.target=ft,ee.relatedTarget=J,le=null,di(ae)===Z&&(ke=new ke(H,G+"enter",Ee,l,ae),ke.target=J,ke.relatedTarget=ft,le=ke),ft=le,re&&Ee)t:{for(ke=Q1,H=re,G=Ee,J=0,le=H;le;le=ke(le))J++;le=0;for(var Ce=G;Ce;Ce=ke(Ce))le++;for(;0<J-le;)H=ke(H),J--;for(;0<le-J;)G=ke(G),le--;for(;J--;){if(H===G||G!==null&&H===G.alternate){ke=H;break t}H=ke(H),G=ke(G)}ke=null}else ke=null;re!==null&&ux(ce,ee,re,ke,!1),Ee!==null&&ft!==null&&ux(ce,ft,Ee,ke,!0)}}e:{if(ee=Z?Ia(Z):window,re=ee.nodeName&&ee.nodeName.toLowerCase(),re==="select"||re==="input"&&ee.type==="file")var tt=Av;else if(zn(ee))if(Nv)tt=s1;else{tt=r1;var Ie=n1}else re=ee.nodeName,!re||re.toLowerCase()!=="input"||ee.type!=="checkbox"&&ee.type!=="radio"?Z&&wc(Z.elementType)&&(tt=Av):tt=i1;if(tt&&(tt=tt(i,Z))){Oa(ce,tt,l,ae);break e}Ie&&Ie(i,ee,Z),i==="focusout"&&Z&&ee.type==="number"&&Z.memoizedProps.value!=null&&jo(ee,"number",ee.value)}switch(Ie=Z?Ia(Z):window,i){case"focusin":(zn(Ie)||Ie.contentEditable==="true")&&(zo=Ie,Hm=Z,Dc=null);break;case"focusout":Dc=Hm=zo=null;break;case"mousedown":Km=!0;break;case"contextmenu":case"mouseup":case"dragend":Km=!1,Vv(ce,l,ae);break;case"selectionchange":if(o1)break;case"keydown":case"keyup":Vv(ce,l,ae)}var Ue;if(_)e:{switch(i){case"compositionstart":var Ke="onCompositionStart";break e;case"compositionend":Ke="onCompositionEnd";break e;case"compositionupdate":Ke="onCompositionUpdate";break e}Ke=void 0}else ze?at(i,l)&&(Ke="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&(Ke="onCompositionStart");Ke&&(Y&&l.locale!=="ko"&&(ze||Ke!=="onCompositionStart"?Ke==="onCompositionEnd"&&ze&&(Ue=ms()):(Wn=ae,Vo="value"in Wn?Wn.value:Wn.textContent,ze=!0)),Ie=Ph(Z,Ke),0<Ie.length&&(Ke=new Ic(Ke,i,null,l,ae),ce.push({event:Ke,listeners:Ie}),Ue?Ke.data=Ue:(Ue=Kt(l),Ue!==null&&(Ke.data=Ue)))),(Ue=A?ln(i,l):cn(i,l))&&(Ke=Ph(Z,"onBeforeInput"),0<Ke.length&&(Ie=new Ic("onBeforeInput","beforeinput",null,l,ae),ce.push({event:Ie,listeners:Ke}),Ie.data=Ue)),G1(ce,i,Z,l,ae)}lx(ce,s)})}function ru(i,s,l){return{instance:i,listener:s,currentTarget:l}}function Ph(i,s){for(var l=s+"Capture",u=[];i!==null;){var g=i,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=Un(i,l),g!=null&&u.unshift(ru(i,g,y)),g=Un(i,s),g!=null&&u.push(ru(i,g,y))),i.tag===3)return u;i=i.return}return[]}function Q1(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function ux(i,s,l,u,g){for(var y=s._reactName,x=[];l!==null&&l!==u;){var T=l,U=T.alternate,Z=T.stateNode;if(T=T.tag,U!==null&&U===u)break;T!==5&&T!==26&&T!==27||Z===null||(U=Z,g?(Z=Un(l,y),Z!=null&&x.unshift(ru(l,Z,U))):g||(Z=Un(l,y),Z!=null&&x.push(ru(l,Z,U)))),l=l.return}x.length!==0&&i.push({event:s,listeners:x})}var Y1=/\r\n?/g,W1=/\u0000|\uFFFD/g;function dx(i){return(typeof i=="string"?i:""+i).replace(Y1,`
`).replace(W1,"")}function hx(i,s){return s=dx(s),dx(i)===s}function ht(i,s,l,u,g,y){switch(l){case"children":typeof u=="string"?s==="body"||s==="textarea"&&u===""||hr(i,u):(typeof u=="number"||typeof u=="bigint")&&s!=="body"&&hr(i,""+u);break;case"className":ds(i,"class",u);break;case"tabIndex":ds(i,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":ds(i,l,u);break;case"style":Rd(i,u,y);break;case"data":if(s!=="object"){ds(i,"data",u);break}case"src":case"href":if(u===""&&(s!=="a"||l!=="href")){i.removeAttribute(l);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(l);break}u=$r(""+u),i.setAttribute(l,u);break;case"action":case"formAction":if(typeof u=="function"){i.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(l==="formAction"?(s!=="input"&&ht(i,s,"name",g.name,g,null),ht(i,s,"formEncType",g.formEncType,g,null),ht(i,s,"formMethod",g.formMethod,g,null),ht(i,s,"formTarget",g.formTarget,g,null)):(ht(i,s,"encType",g.encType,g,null),ht(i,s,"method",g.method,g,null),ht(i,s,"target",g.target,g,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){i.removeAttribute(l);break}u=$r(""+u),i.setAttribute(l,u);break;case"onClick":u!=null&&(i.onclick=on);break;case"onScroll":u!=null&&$e("scroll",i);break;case"onScrollEnd":u!=null&&$e("scrollend",i);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(l=u.__html,l!=null){if(g.children!=null)throw Error(r(60));i.innerHTML=l}}break;case"multiple":i.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":i.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){i.removeAttribute("xlink:href");break}l=$r(""+u),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(l,""+u):i.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(l,""):i.removeAttribute(l);break;case"capture":case"download":u===!0?i.setAttribute(l,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?i.setAttribute(l,u):i.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?i.setAttribute(l,u):i.removeAttribute(l);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?i.removeAttribute(l):i.setAttribute(l,u);break;case"popover":$e("beforetoggle",i),$e("toggle",i),us(i,"popover",u);break;case"xlinkActuate":dr(i,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":dr(i,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":dr(i,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":dr(i,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":dr(i,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":dr(i,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":dr(i,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":dr(i,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":dr(i,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":us(i,"is",u);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=zm.get(l)||l,us(i,l,u))}}function vp(i,s,l,u,g,y){switch(l){case"style":Rd(i,u,y);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(r(61));if(l=u.__html,l!=null){if(g.children!=null)throw Error(r(60));i.innerHTML=l}}break;case"children":typeof u=="string"?hr(i,u):(typeof u=="number"||typeof u=="bigint")&&hr(i,""+u);break;case"onScroll":u!=null&&$e("scroll",i);break;case"onScrollEnd":u!=null&&$e("scrollend",i);break;case"onClick":u!=null&&(i.onclick=on);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!cs.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(g=l.endsWith("Capture"),s=l.slice(2,g?l.length-7:void 0),y=i[yn]||null,y=y!=null?y[l]:null,typeof y=="function"&&i.removeEventListener(s,y,g),typeof u=="function")){typeof y!="function"&&y!==null&&(l in i?i[l]=null:i.hasAttribute(l)&&i.removeAttribute(l)),i.addEventListener(s,u,g);break e}l in i?i[l]=u:u===!0?i.setAttribute(l,""):us(i,l,u)}}}function xn(i,s,l){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":$e("error",i),$e("load",i);var u=!1,g=!1,y;for(y in l)if(l.hasOwnProperty(y)){var x=l[y];if(x!=null)switch(y){case"src":u=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:ht(i,s,y,x,l,null)}}g&&ht(i,s,"srcSet",l.srcSet,l,null),u&&ht(i,s,"src",l.src,l,null);return;case"input":$e("invalid",i);var T=y=x=g=null,U=null,Z=null;for(u in l)if(l.hasOwnProperty(u)){var ae=l[u];if(ae!=null)switch(u){case"name":g=ae;break;case"type":x=ae;break;case"checked":U=ae;break;case"defaultChecked":Z=ae;break;case"value":y=ae;break;case"defaultValue":T=ae;break;case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(r(137,s));break;default:ht(i,s,u,ae,l,null)}}Aa(i,y,T,U,Z,x,g,!1);return;case"select":$e("invalid",i),u=x=y=null;for(g in l)if(l.hasOwnProperty(g)&&(T=l[g],T!=null))switch(g){case"value":y=T;break;case"defaultValue":x=T;break;case"multiple":u=T;default:ht(i,s,g,T,l,null)}s=y,l=x,i.multiple=!!u,s!=null?et(i,!!u,s,!1):l!=null&&et(i,!!u,l,!0);return;case"textarea":$e("invalid",i),y=g=u=null;for(x in l)if(l.hasOwnProperty(x)&&(T=l[x],T!=null))switch(x){case"value":u=T;break;case"defaultValue":g=T;break;case"children":y=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(r(91));break;default:ht(i,s,x,T,l,null)}fs(i,u,g,y);return;case"option":for(U in l)if(l.hasOwnProperty(U)&&(u=l[U],u!=null))switch(U){case"selected":i.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:ht(i,s,U,u,l,null)}return;case"dialog":$e("beforetoggle",i),$e("toggle",i),$e("cancel",i),$e("close",i);break;case"iframe":case"object":$e("load",i);break;case"video":case"audio":for(u=0;u<nu.length;u++)$e(nu[u],i);break;case"image":$e("error",i),$e("load",i);break;case"details":$e("toggle",i);break;case"embed":case"source":case"link":$e("error",i),$e("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Z in l)if(l.hasOwnProperty(Z)&&(u=l[Z],u!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:ht(i,s,Z,u,l,null)}return;default:if(wc(s)){for(ae in l)l.hasOwnProperty(ae)&&(u=l[ae],u!==void 0&&vp(i,s,ae,u,l,void 0));return}}for(T in l)l.hasOwnProperty(T)&&(u=l[T],u!=null&&ht(i,s,T,u,l,null))}function X1(i,s,l,u){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,x=null,T=null,U=null,Z=null,ae=null;for(re in l){var ce=l[re];if(l.hasOwnProperty(re)&&ce!=null)switch(re){case"checked":break;case"value":break;case"defaultValue":U=ce;default:u.hasOwnProperty(re)||ht(i,s,re,null,u,ce)}}for(var ee in u){var re=u[ee];if(ce=l[ee],u.hasOwnProperty(ee)&&(re!=null||ce!=null))switch(ee){case"type":y=re;break;case"name":g=re;break;case"checked":Z=re;break;case"defaultChecked":ae=re;break;case"value":x=re;break;case"defaultValue":T=re;break;case"children":case"dangerouslySetInnerHTML":if(re!=null)throw Error(r(137,s));break;default:re!==ce&&ht(i,s,ee,re,u,ce)}}hs(i,x,T,U,Z,ae,y,g);return;case"select":re=x=T=ee=null;for(y in l)if(U=l[y],l.hasOwnProperty(y)&&U!=null)switch(y){case"value":break;case"multiple":re=U;default:u.hasOwnProperty(y)||ht(i,s,y,null,u,U)}for(g in u)if(y=u[g],U=l[g],u.hasOwnProperty(g)&&(y!=null||U!=null))switch(g){case"value":ee=y;break;case"defaultValue":T=y;break;case"multiple":x=y;default:y!==U&&ht(i,s,g,y,u,U)}s=T,l=x,u=re,ee!=null?et(i,!!l,ee,!1):!!u!=!!l&&(s!=null?et(i,!!l,s,!0):et(i,!!l,l?[]:"",!1));return;case"textarea":re=ee=null;for(T in l)if(g=l[T],l.hasOwnProperty(T)&&g!=null&&!u.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:ht(i,s,T,null,u,g)}for(x in u)if(g=u[x],y=l[x],u.hasOwnProperty(x)&&(g!=null||y!=null))switch(x){case"value":ee=g;break;case"defaultValue":re=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(r(91));break;default:g!==y&&ht(i,s,x,g,u,y)}Na(i,ee,re);return;case"option":for(var Ee in l)if(ee=l[Ee],l.hasOwnProperty(Ee)&&ee!=null&&!u.hasOwnProperty(Ee))switch(Ee){case"selected":i.selected=!1;break;default:ht(i,s,Ee,null,u,ee)}for(U in u)if(ee=u[U],re=l[U],u.hasOwnProperty(U)&&ee!==re&&(ee!=null||re!=null))switch(U){case"selected":i.selected=ee&&typeof ee!="function"&&typeof ee!="symbol";break;default:ht(i,s,U,ee,u,re)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ke in l)ee=l[ke],l.hasOwnProperty(ke)&&ee!=null&&!u.hasOwnProperty(ke)&&ht(i,s,ke,null,u,ee);for(Z in u)if(ee=u[Z],re=l[Z],u.hasOwnProperty(Z)&&ee!==re&&(ee!=null||re!=null))switch(Z){case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(r(137,s));break;default:ht(i,s,Z,ee,u,re)}return;default:if(wc(s)){for(var ft in l)ee=l[ft],l.hasOwnProperty(ft)&&ee!==void 0&&!u.hasOwnProperty(ft)&&vp(i,s,ft,void 0,u,ee);for(ae in u)ee=u[ae],re=l[ae],!u.hasOwnProperty(ae)||ee===re||ee===void 0&&re===void 0||vp(i,s,ae,ee,u,re);return}}for(var H in l)ee=l[H],l.hasOwnProperty(H)&&ee!=null&&!u.hasOwnProperty(H)&&ht(i,s,H,null,u,ee);for(ce in u)ee=u[ce],re=l[ce],!u.hasOwnProperty(ce)||ee===re||ee==null&&re==null||ht(i,s,ce,ee,u,re)}function fx(i){switch(i){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function J1(){if(typeof performance.getEntriesByType=="function"){for(var i=0,s=0,l=performance.getEntriesByType("resource"),u=0;u<l.length;u++){var g=l[u],y=g.transferSize,x=g.initiatorType,T=g.duration;if(y&&T&&fx(x)){for(x=0,T=g.responseEnd,u+=1;u<l.length;u++){var U=l[u],Z=U.startTime;if(Z>T)break;var ae=U.transferSize,ce=U.initiatorType;ae&&fx(ce)&&(U=U.responseEnd,x+=ae*(U<T?1:(T-Z)/(U-Z)))}if(--u,s+=8*(y+x)/(g.duration/1e3),i++,10<i)break}}if(0<i)return s/i/1e6}return navigator.connection&&(i=navigator.connection.downlink,typeof i=="number")?i:5}var _p=null,bp=null;function Vh(i){return i.nodeType===9?i:i.ownerDocument}function mx(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function gx(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function xp(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var wp=null;function Z1(){var i=window.event;return i&&i.type==="popstate"?i===wp?!1:(wp=i,!0):(wp=null,!1)}var px=typeof setTimeout=="function"?setTimeout:void 0,eC=typeof clearTimeout=="function"?clearTimeout:void 0,yx=typeof Promise=="function"?Promise:void 0,tC=typeof queueMicrotask=="function"?queueMicrotask:typeof yx<"u"?function(i){return yx.resolve(null).then(i).catch(nC)}:px;function nC(i){setTimeout(function(){throw i})}function Ls(i){return i==="head"}function vx(i,s){var l=s,u=0;do{var g=l.nextSibling;if(i.removeChild(l),g&&g.nodeType===8)if(l=g.data,l==="/$"||l==="/&"){if(u===0){i.removeChild(g),fl(s);return}u--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")u++;else if(l==="html")iu(i.ownerDocument.documentElement);else if(l==="head"){l=i.ownerDocument.head,iu(l);for(var y=l.firstChild;y;){var x=y.nextSibling,T=y.nodeName;y[ui]||T==="SCRIPT"||T==="STYLE"||T==="LINK"&&y.rel.toLowerCase()==="stylesheet"||l.removeChild(y),y=x}}else l==="body"&&iu(i.ownerDocument.body);l=g}while(l);fl(s)}function _x(i,s){var l=i;i=0;do{var u=l.nextSibling;if(l.nodeType===1?s?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(s?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),u&&u.nodeType===8)if(l=u.data,l==="/$"){if(i===0)break;i--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||i++;l=u}while(l)}function Ep(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var l=s;switch(s=s.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Ep(l),Sa(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}i.removeChild(l)}}function rC(i,s,l,u){for(;i.nodeType===1;){var g=l;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!u&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(u){if(!i[ui])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(y=i.getAttribute("rel"),y==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(y!==g.rel||i.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||i.getAttribute("title")!==(g.title==null?null:g.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(y=i.getAttribute("src"),(y!==(g.src==null?null:g.src)||i.getAttribute("type")!==(g.type==null?null:g.type)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&i.getAttribute("name")===y)return i}else return i;if(i=_r(i.nextSibling),i===null)break}return null}function iC(i,s,l){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=_r(i.nextSibling),i===null))return null;return i}function bx(i,s){for(;i.nodeType!==8;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!s||(i=_r(i.nextSibling),i===null))return null;return i}function Tp(i){return i.data==="$?"||i.data==="$~"}function Sp(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState!=="loading"}function sC(i,s){var l=i.ownerDocument;if(i.data==="$~")i._reactRetry=s;else if(i.data!=="$?"||l.readyState!=="loading")s();else{var u=function(){s(),l.removeEventListener("DOMContentLoaded",u)};l.addEventListener("DOMContentLoaded",u),i._reactRetry=u}}function _r(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return i}var Ip=null;function xx(i){i=i.nextSibling;for(var s=0;i;){if(i.nodeType===8){var l=i.data;if(l==="/$"||l==="/&"){if(s===0)return _r(i.nextSibling);s--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||s++}i=i.nextSibling}return null}function wx(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(s===0)return i;s--}else l!=="/$"&&l!=="/&"||s++}i=i.previousSibling}return null}function Ex(i,s,l){switch(s=Vh(l),i){case"html":if(i=s.documentElement,!i)throw Error(r(452));return i;case"head":if(i=s.head,!i)throw Error(r(453));return i;case"body":if(i=s.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function iu(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);Sa(i)}var br=new Map,Tx=new Set;function Mh(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Di=ue.d;ue.d={f:aC,r:oC,D:lC,C:cC,L:uC,m:dC,X:fC,S:hC,M:mC};function aC(){var i=Di.f(),s=Nh();return i||s}function oC(i){var s=hi(i);s!==null&&s.tag===5&&s.type==="form"?F_(s):Di.r(i)}var ul=typeof document>"u"?null:document;function Sx(i,s,l){var u=ul;if(u&&typeof s=="string"&&s){var g=Pt(s);g='link[rel="'+i+'"][href="'+g+'"]',typeof l=="string"&&(g+='[crossorigin="'+l+'"]'),Tx.has(g)||(Tx.add(g),i={rel:i,crossOrigin:l,href:s},u.querySelector(g)===null&&(s=u.createElement("link"),xn(s,"link",i),Ft(s),u.head.appendChild(s)))}}function lC(i){Di.D(i),Sx("dns-prefetch",i,null)}function cC(i,s){Di.C(i,s),Sx("preconnect",i,s)}function uC(i,s,l){Di.L(i,s,l);var u=ul;if(u&&i&&s){var g='link[rel="preload"][as="'+Pt(s)+'"]';s==="image"&&l&&l.imageSrcSet?(g+='[imagesrcset="'+Pt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(g+='[imagesizes="'+Pt(l.imageSizes)+'"]')):g+='[href="'+Pt(i)+'"]';var y=g;switch(s){case"style":y=dl(i);break;case"script":y=hl(i)}br.has(y)||(i=b({rel:"preload",href:s==="image"&&l&&l.imageSrcSet?void 0:i,as:s},l),br.set(y,i),u.querySelector(g)!==null||s==="style"&&u.querySelector(su(y))||s==="script"&&u.querySelector(au(y))||(s=u.createElement("link"),xn(s,"link",i),Ft(s),u.head.appendChild(s)))}}function dC(i,s){Di.m(i,s);var l=ul;if(l&&i){var u=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+Pt(u)+'"][href="'+Pt(i)+'"]',y=g;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=hl(i)}if(!br.has(y)&&(i=b({rel:"modulepreload",href:i},s),br.set(y,i),l.querySelector(g)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(au(y)))return}u=l.createElement("link"),xn(u,"link",i),Ft(u),l.head.appendChild(u)}}}function hC(i,s,l){Di.S(i,s,l);var u=ul;if(u&&i){var g=Ar(u).hoistableStyles,y=dl(i);s=s||"default";var x=g.get(y);if(!x){var T={loading:0,preload:null};if(x=u.querySelector(su(y)))T.loading=5;else{i=b({rel:"stylesheet",href:i,"data-precedence":s},l),(l=br.get(y))&&Ap(i,l);var U=x=u.createElement("link");Ft(U),xn(U,"link",i),U._p=new Promise(function(Z,ae){U.onload=Z,U.onerror=ae}),U.addEventListener("load",function(){T.loading|=1}),U.addEventListener("error",function(){T.loading|=2}),T.loading|=4,Lh(x,s,u)}x={type:"stylesheet",instance:x,count:1,state:T},g.set(y,x)}}}function fC(i,s){Di.X(i,s);var l=ul;if(l&&i){var u=Ar(l).hoistableScripts,g=hl(i),y=u.get(g);y||(y=l.querySelector(au(g)),y||(i=b({src:i,async:!0},s),(s=br.get(g))&&Np(i,s),y=l.createElement("script"),Ft(y),xn(y,"link",i),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(g,y))}}function mC(i,s){Di.M(i,s);var l=ul;if(l&&i){var u=Ar(l).hoistableScripts,g=hl(i),y=u.get(g);y||(y=l.querySelector(au(g)),y||(i=b({src:i,async:!0,type:"module"},s),(s=br.get(g))&&Np(i,s),y=l.createElement("script"),Ft(y),xn(y,"link",i),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},u.set(g,y))}}function Ix(i,s,l,u){var g=(g=se.current)?Mh(g):null;if(!g)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(s=dl(l.href),l=Ar(g).hoistableStyles,u=l.get(s),u||(u={type:"style",instance:null,count:0,state:null},l.set(s,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){i=dl(l.href);var y=Ar(g).hoistableStyles,x=y.get(i);if(x||(g=g.ownerDocument||g,x={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(i,x),(y=g.querySelector(su(i)))&&!y._p&&(x.instance=y,x.state.loading=5),br.has(i)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},br.set(i,l),y||gC(g,i,l,x.state))),s&&u===null)throw Error(r(528,""));return x}if(s&&u!==null)throw Error(r(529,""));return null;case"script":return s=l.async,l=l.src,typeof l=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=hl(l),l=Ar(g).hoistableScripts,u=l.get(s),u||(u={type:"script",instance:null,count:0,state:null},l.set(s,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function dl(i){return'href="'+Pt(i)+'"'}function su(i){return'link[rel="stylesheet"]['+i+"]"}function Ax(i){return b({},i,{"data-precedence":i.precedence,precedence:null})}function gC(i,s,l,u){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?u.loading=1:(s=i.createElement("link"),u.preload=s,s.addEventListener("load",function(){return u.loading|=1}),s.addEventListener("error",function(){return u.loading|=2}),xn(s,"link",l),Ft(s),i.head.appendChild(s))}function hl(i){return'[src="'+Pt(i)+'"]'}function au(i){return"script[async]"+i}function Nx(i,s,l){if(s.count++,s.instance===null)switch(s.type){case"style":var u=i.querySelector('style[data-href~="'+Pt(l.href)+'"]');if(u)return s.instance=u,Ft(u),u;var g=b({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return u=(i.ownerDocument||i).createElement("style"),Ft(u),xn(u,"style",g),Lh(u,l.precedence,i),s.instance=u;case"stylesheet":g=dl(l.href);var y=i.querySelector(su(g));if(y)return s.state.loading|=4,s.instance=y,Ft(y),y;u=Ax(l),(g=br.get(g))&&Ap(u,g),y=(i.ownerDocument||i).createElement("link"),Ft(y);var x=y;return x._p=new Promise(function(T,U){x.onload=T,x.onerror=U}),xn(y,"link",u),s.state.loading|=4,Lh(y,l.precedence,i),s.instance=y;case"script":return y=hl(l.src),(g=i.querySelector(au(y)))?(s.instance=g,Ft(g),g):(u=l,(g=br.get(y))&&(u=b({},l),Np(u,g)),i=i.ownerDocument||i,g=i.createElement("script"),Ft(g),xn(g,"link",u),i.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(u=s.instance,s.state.loading|=4,Lh(u,l.precedence,i));return s.instance}function Lh(i,s,l){for(var u=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=u.length?u[u.length-1]:null,y=g,x=0;x<u.length;x++){var T=u[x];if(T.dataset.precedence===s)y=T;else if(y!==g)break}y?y.parentNode.insertBefore(i,y.nextSibling):(s=l.nodeType===9?l.head:l,s.insertBefore(i,s.firstChild))}function Ap(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function Np(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var Uh=null;function Cx(i,s,l){if(Uh===null){var u=new Map,g=Uh=new Map;g.set(l,u)}else g=Uh,u=g.get(l),u||(u=new Map,g.set(l,u));if(u.has(i))return u;for(u.set(i,null),l=l.getElementsByTagName(i),g=0;g<l.length;g++){var y=l[g];if(!(y[ui]||y[Ot]||i==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var x=y.getAttribute(s)||"";x=i+x;var T=u.get(x);T?T.push(y):u.set(x,[y])}}return u}function Rx(i,s,l){i=i.ownerDocument||i,i.head.insertBefore(l,s==="title"?i.querySelector("head > title"):null)}function pC(i,s,l){if(l===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function kx(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}function yC(i,s,l,u){if(l.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var g=dl(u.href),y=s.querySelector(su(g));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(i.count++,i=zh.bind(i),s.then(i,i)),l.state.loading|=4,l.instance=y,Ft(y);return}y=s.ownerDocument||s,u=Ax(u),(g=br.get(g))&&Ap(u,g),y=y.createElement("link"),Ft(y);var x=y;x._p=new Promise(function(T,U){x.onload=T,x.onerror=U}),xn(y,"link",u),l.instance=y}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(l,s),(s=l.state.preload)&&(l.state.loading&3)===0&&(i.count++,l=zh.bind(i),s.addEventListener("load",l),s.addEventListener("error",l))}}var Cp=0;function vC(i,s){return i.stylesheets&&i.count===0&&Bh(i,i.stylesheets),0<i.count||0<i.imgCount?function(l){var u=setTimeout(function(){if(i.stylesheets&&Bh(i,i.stylesheets),i.unsuspend){var y=i.unsuspend;i.unsuspend=null,y()}},6e4+s);0<i.imgBytes&&Cp===0&&(Cp=62500*J1());var g=setTimeout(function(){if(i.waitingForImages=!1,i.count===0&&(i.stylesheets&&Bh(i,i.stylesheets),i.unsuspend)){var y=i.unsuspend;i.unsuspend=null,y()}},(i.imgBytes>Cp?50:800)+s);return i.unsuspend=l,function(){i.unsuspend=null,clearTimeout(u),clearTimeout(g)}}:null}function zh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Bh(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var Fh=null;function Bh(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,Fh=new Map,s.forEach(_C,i),Fh=null,zh.call(i))}function _C(i,s){if(!(s.state.loading&4)){var l=Fh.get(i);if(l)var u=l.get(null);else{l=new Map,Fh.set(i,l);for(var g=i.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var x=g[y];(x.nodeName==="LINK"||x.getAttribute("media")!=="not all")&&(l.set(x.dataset.precedence,x),u=x)}u&&l.set(null,u)}g=s.instance,x=g.getAttribute("data-precedence"),y=l.get(x)||u,y===u&&l.set(null,g),l.set(x,g),this.count++,u=zh.bind(this),g.addEventListener("load",u),g.addEventListener("error",u),y?y.parentNode.insertBefore(g,y.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(g,i.firstChild)),s.state.loading|=4}}var ou={$$typeof:X,Provider:null,Consumer:null,_currentValue:pe,_currentValue2:pe,_threadCount:0};function bC(i,s,l,u,g,y,x,T,U){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=li(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=li(0),this.hiddenUpdates=li(null),this.identifierPrefix=u,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=x,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function Dx(i,s,l,u,g,y,x,T,U,Z,ae,ce){return i=new bC(i,s,l,x,U,Z,ae,ce,T),s=1,y===!0&&(s|=24),y=Jn(3,null,null,s),i.current=y,y.stateNode=i,s=lg(),s.refCount++,i.pooledCache=s,s.refCount++,y.memoizedState={element:u,isDehydrated:l,cache:s},hg(y),i}function jx(i){return i?(i=qo,i):qo}function Ox(i,s,l,u,g,y){g=jx(g),u.context===null?u.context=g:u.pendingContext=g,u=As(s),u.payload={element:l},y=y===void 0?null:y,y!==null&&(u.callback=y),l=Ns(i,u,s),l!==null&&($n(l,i,s),Uc(l,i,s))}function Px(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<s?l:s}}function Rp(i,s){Px(i,s),(i=i.alternate)&&Px(i,s)}function Vx(i){if(i.tag===13||i.tag===31){var s=Ma(i,67108864);s!==null&&$n(s,i,67108864),Rp(i,67108864)}}function Mx(i){if(i.tag===13||i.tag===31){var s=rr();s=gc(s);var l=Ma(i,s);l!==null&&$n(l,i,s),Rp(i,s)}}var qh=!0;function xC(i,s,l,u){var g=B.T;B.T=null;var y=ue.p;try{ue.p=2,kp(i,s,l,u)}finally{ue.p=y,B.T=g}}function wC(i,s,l,u){var g=B.T;B.T=null;var y=ue.p;try{ue.p=8,kp(i,s,l,u)}finally{ue.p=y,B.T=g}}function kp(i,s,l,u){if(qh){var g=Dp(u);if(g===null)yp(i,s,u,Gh,l),Ux(i,u);else if(TC(g,i,s,l,u))u.stopPropagation();else if(Ux(i,u),s&4&&-1<EC.indexOf(i)){for(;g!==null;){var y=hi(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var x=Ir(y.pendingLanes);if(x!==0){var T=y;for(T.pendingLanes|=2,T.entangledLanes|=2;x;){var U=1<<31-Dn(x);T.entanglements[1]|=U,x&=~U}Xr(y),(st&6)===0&&(Ih=gn()+500,tu(0))}}break;case 31:case 13:T=Ma(y,2),T!==null&&$n(T,y,2),Nh(),Rp(y,2)}if(y=Dp(u),y===null&&yp(i,s,u,Gh,l),y===g)break;g=y}g!==null&&u.stopPropagation()}else yp(i,s,u,null,l)}}function Dp(i){return i=Po(i),jp(i)}var Gh=null;function jp(i){if(Gh=null,i=di(i),i!==null){var s=o(i);if(s===null)i=null;else{var l=s.tag;if(l===13){if(i=c(s),i!==null)return i;i=null}else if(l===31){if(i=d(s),i!==null)return i;i=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return Gh=i,null}function Lx(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ed()){case en:return 2;case an:return 8;case oi:case Td:return 32;case dc:return 268435456;default:return 32}default:return 32}}var Op=!1,Us=null,zs=null,Fs=null,lu=new Map,cu=new Map,Bs=[],EC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ux(i,s){switch(i){case"focusin":case"focusout":Us=null;break;case"dragenter":case"dragleave":zs=null;break;case"mouseover":case"mouseout":Fs=null;break;case"pointerover":case"pointerout":lu.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":cu.delete(s.pointerId)}}function uu(i,s,l,u,g,y){return i===null||i.nativeEvent!==y?(i={blockedOn:s,domEventName:l,eventSystemFlags:u,nativeEvent:y,targetContainers:[g]},s!==null&&(s=hi(s),s!==null&&Vx(s)),i):(i.eventSystemFlags|=u,s=i.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),i)}function TC(i,s,l,u,g){switch(s){case"focusin":return Us=uu(Us,i,s,l,u,g),!0;case"dragenter":return zs=uu(zs,i,s,l,u,g),!0;case"mouseover":return Fs=uu(Fs,i,s,l,u,g),!0;case"pointerover":var y=g.pointerId;return lu.set(y,uu(lu.get(y)||null,i,s,l,u,g)),!0;case"gotpointercapture":return y=g.pointerId,cu.set(y,uu(cu.get(y)||null,i,s,l,u,g)),!0}return!1}function zx(i){var s=di(i.target);if(s!==null){var l=o(s);if(l!==null){if(s=l.tag,s===13){if(s=c(l),s!==null){i.blockedOn=s,Id(i.priority,function(){Mx(l)});return}}else if(s===31){if(s=d(l),s!==null){i.blockedOn=s,Id(i.priority,function(){Mx(l)});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function $h(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var l=Dp(i.nativeEvent);if(l===null){l=i.nativeEvent;var u=new l.constructor(l.type,l);Oo=u,l.target.dispatchEvent(u),Oo=null}else return s=hi(l),s!==null&&Vx(s),i.blockedOn=l,!1;s.shift()}return!0}function Fx(i,s,l){$h(i)&&l.delete(s)}function SC(){Op=!1,Us!==null&&$h(Us)&&(Us=null),zs!==null&&$h(zs)&&(zs=null),Fs!==null&&$h(Fs)&&(Fs=null),lu.forEach(Fx),cu.forEach(Fx)}function Hh(i,s){i.blockedOn===s&&(i.blockedOn=null,Op||(Op=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,SC)))}var Kh=null;function Bx(i){Kh!==i&&(Kh=i,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Kh===i&&(Kh=null);for(var s=0;s<i.length;s+=3){var l=i[s],u=i[s+1],g=i[s+2];if(typeof u!="function"){if(jp(u||l)===null)continue;break}var y=hi(l);y!==null&&(i.splice(s,3),s-=3,Dg(y,{pending:!0,data:g,method:l.method,action:u},u,g))}}))}function fl(i){function s(U){return Hh(U,i)}Us!==null&&Hh(Us,i),zs!==null&&Hh(zs,i),Fs!==null&&Hh(Fs,i),lu.forEach(s),cu.forEach(s);for(var l=0;l<Bs.length;l++){var u=Bs[l];u.blockedOn===i&&(u.blockedOn=null)}for(;0<Bs.length&&(l=Bs[0],l.blockedOn===null);)zx(l),l.blockedOn===null&&Bs.shift();if(l=(i.ownerDocument||i).$$reactFormReplay,l!=null)for(u=0;u<l.length;u+=3){var g=l[u],y=l[u+1],x=g[yn]||null;if(typeof y=="function")x||Bx(l);else if(x){var T=null;if(y&&y.hasAttribute("formAction")){if(g=y,x=y[yn]||null)T=x.formAction;else if(jp(g)!==null)continue}else T=x.action;typeof T=="function"?l[u+1]=T:(l.splice(u,3),u-=3),Bx(l)}}}function qx(){function i(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(x){return g=x})},focusReset:"manual",scroll:"manual"})}function s(){g!==null&&(g(),g=null),u||setTimeout(l,20)}function l(){if(!u&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,g=null;return navigation.addEventListener("navigate",i),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(l,100),function(){u=!0,navigation.removeEventListener("navigate",i),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),g!==null&&(g(),g=null)}}}function Pp(i){this._internalRoot=i}Qh.prototype.render=Pp.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(r(409));var l=s.current,u=rr();Ox(l,u,i,s,null,null)},Qh.prototype.unmount=Pp.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;Ox(i.current,2,null,i,null,null),Nh(),s[Br]=null}};function Qh(i){this._internalRoot=i}Qh.prototype.unstable_scheduleHydration=function(i){if(i){var s=ci();i={blockedOn:null,target:i,priority:s};for(var l=0;l<Bs.length&&s!==0&&s<Bs[l].priority;l++);Bs.splice(l,0,i),l===0&&zx(i)}};var Gx=e.version;if(Gx!=="19.2.0")throw Error(r(527,Gx,"19.2.0"));ue.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=p(s),i=i!==null?v(i):null,i=i===null?null:i.stateNode,i};var IC={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:B,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yh.isDisabled&&Yh.supportsFiber)try{ns=Yh.inject(IC),Sn=Yh}catch{}}return hu.createRoot=function(i,s){if(!a(i))throw Error(r(299));var l=!1,u="",g=X_,y=J_,x=Z_;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(u=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(x=s.onRecoverableError)),s=Dx(i,1,!1,null,null,l,u,null,g,y,x,qx),i[Br]=s.current,pp(i),new Pp(s)},hu.hydrateRoot=function(i,s,l){if(!a(i))throw Error(r(299));var u=!1,g="",y=X_,x=J_,T=Z_,U=null;return l!=null&&(l.unstable_strictMode===!0&&(u=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(x=l.onCaughtError),l.onRecoverableError!==void 0&&(T=l.onRecoverableError),l.formState!==void 0&&(U=l.formState)),s=Dx(i,1,!0,s,l??null,u,g,U,y,x,T,qx),s.context=jx(null),l=s.current,u=rr(),u=gc(u),g=As(u),g.callback=null,Ns(l,g,u),l=u,s.current.lanes=l,ss(s,l),Xr(s),i[Br]=s.current,pp(i),new Qh(s)},hu.version="19.2.0",hu}var tw;function MC(){if(tw)return Lp.exports;tw=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Lp.exports=VC(),Lp.exports}var LC=MC();var nw="popstate";function UC(n={}){function e(r,a){let{pathname:o,search:c,hash:d}=r.location;return ly("",{pathname:o,search:c,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(r,a){return typeof a=="string"?a:Uu(a)}return FC(e,t,null,n)}function Nt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Tr(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function zC(){return Math.random().toString(36).substring(2,10)}function rw(n,e){return{usr:n.state,key:n.key,idx:e}}function ly(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Kl(e):e,state:t,key:e&&e.key||r||zC()}}function Uu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Kl(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function FC(n,e,t,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,c=a.history,d="POP",f=null,p=v();p==null&&(p=0,c.replaceState({...c.state,idx:p},""));function v(){return(c.state||{idx:null}).idx}function b(){d="POP";let N=v(),I=N==null?null:N-p;p=N,f&&f({action:d,location:j.location,delta:I})}function E(N,I){d="PUSH";let te=ly(j.location,N,I);p=v()+1;let X=rw(te,p),de=j.createHref(te);try{c.pushState(X,"",de)}catch(ve){if(ve instanceof DOMException&&ve.name==="DataCloneError")throw ve;a.location.assign(de)}o&&f&&f({action:d,location:j.location,delta:1})}function S(N,I){d="REPLACE";let te=ly(j.location,N,I);p=v();let X=rw(te,p),de=j.createHref(te);c.replaceState(X,"",de),o&&f&&f({action:d,location:j.location,delta:0})}function R(N){return BC(N)}let j={get action(){return d},get location(){return n(a,c)},listen(N){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(nw,b),f=N,()=>{a.removeEventListener(nw,b),f=null}},createHref(N){return e(a,N)},createURL:R,encodeLocation(N){let I=R(N);return{pathname:I.pathname,search:I.search,hash:I.hash}},push:E,replace:S,go(N){return c.go(N)}};return j}function BC(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Nt(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Uu(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function hT(n,e,t="/"){return qC(n,e,t,!1)}function qC(n,e,t,r){let a=typeof e=="string"?Kl(e):e,o=qi(a.pathname||"/",t);if(o==null)return null;let c=fT(n);GC(c);let d=null;for(let f=0;d==null&&f<c.length;++f){let p=tR(o);d=ZC(c[f],p,r)}return d}function fT(n,e=[],t=[],r="",a=!1){let o=(c,d,f=a,p)=>{let v={relativePath:p===void 0?c.path||"":p,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};if(v.relativePath.startsWith("/")){if(!v.relativePath.startsWith(r)&&f)return;Nt(v.relativePath.startsWith(r),`Absolute route path "${v.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),v.relativePath=v.relativePath.slice(r.length)}let b=Fi([r,v.relativePath]),E=t.concat(v);c.children&&c.children.length>0&&(Nt(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${b}".`),fT(c.children,e,E,b,f)),!(c.path==null&&!c.index)&&e.push({path:b,score:XC(b,c.index),routesMeta:E})};return n.forEach((c,d)=>{if(c.path===""||!c.path?.includes("?"))o(c,d);else for(let f of mT(c.path))o(c,d,!0,f)}),e}function mT(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,a=t.endsWith("?"),o=t.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let c=mT(r.join("/")),d=[];return d.push(...c.map(f=>f===""?o:[o,f].join("/"))),a&&d.push(...c),d.map(f=>n.startsWith("/")&&f===""?"/":f)}function GC(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:JC(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var $C=/^:[\w-]+$/,HC=3,KC=2,QC=1,YC=10,WC=-2,iw=n=>n==="*";function XC(n,e){let t=n.split("/"),r=t.length;return t.some(iw)&&(r+=WC),e&&(r+=KC),t.filter(a=>!iw(a)).reduce((a,o)=>a+($C.test(o)?HC:o===""?QC:YC),r)}function JC(n,e){return n.length===e.length&&n.slice(0,-1).every((r,a)=>r===e[a])?n[n.length-1]-e[e.length-1]:0}function ZC(n,e,t=!1){let{routesMeta:r}=n,a={},o="/",c=[];for(let d=0;d<r.length;++d){let f=r[d],p=d===r.length-1,v=o==="/"?e:e.slice(o.length)||"/",b=Tf({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},v),E=f.route;if(!b&&p&&t&&!r[r.length-1].route.index&&(b=Tf({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},v)),!b)return null;Object.assign(a,b.params),c.push({params:a,pathname:Fi([o,b.pathname]),pathnameBase:aR(Fi([o,b.pathnameBase])),route:E}),b.pathnameBase!=="/"&&(o=Fi([o,b.pathnameBase]))}return c}function Tf(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=eR(n.path,n.caseSensitive,n.end),a=e.match(t);if(!a)return null;let o=a[0],c=o.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:r.reduce((p,{paramName:v,isOptional:b},E)=>{if(v==="*"){let R=d[E]||"";c=o.slice(0,o.length-R.length).replace(/(.)\/+$/,"$1")}const S=d[E];return b&&!S?p[v]=void 0:p[v]=(S||"").replace(/%2F/g,"/"),p},{}),pathname:o,pathnameBase:c,pattern:n}}function eR(n,e=!1,t=!0){Tr(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],a="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,d,f)=>(r.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),a+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":n!==""&&n!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function tR(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Tr(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function qi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var nR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,rR=n=>nR.test(n);function iR(n,e="/"){let{pathname:t,search:r="",hash:a=""}=typeof n=="string"?Kl(n):n,o;if(t)if(rR(t))o=t;else{if(t.includes("//")){let c=t;t=t.replace(/\/\/+/g,"/"),Tr(!1,`Pathnames cannot have embedded double slashes - normalizing ${c} -> ${t}`)}t.startsWith("/")?o=sw(t.substring(1),"/"):o=sw(t,e)}else o=e;return{pathname:o,search:oR(r),hash:lR(a)}}function sw(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function Bp(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function sR(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Gy(n){let e=sR(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function $y(n,e,t,r=!1){let a;typeof n=="string"?a=Kl(n):(a={...n},Nt(!a.pathname||!a.pathname.includes("?"),Bp("?","pathname","search",a)),Nt(!a.pathname||!a.pathname.includes("#"),Bp("#","pathname","hash",a)),Nt(!a.search||!a.search.includes("#"),Bp("#","search","hash",a)));let o=n===""||a.pathname==="",c=o?"/":a.pathname,d;if(c==null)d=t;else{let b=e.length-1;if(!r&&c.startsWith("..")){let E=c.split("/");for(;E[0]==="..";)E.shift(),b-=1;a.pathname=E.join("/")}d=b>=0?e[b]:"/"}let f=iR(a,d),p=c&&c!=="/"&&c.endsWith("/"),v=(o||c===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(p||v)&&(f.pathname+="/"),f}var Fi=n=>n.join("/").replace(/\/\/+/g,"/"),aR=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),oR=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,lR=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function cR(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var gT=["POST","PUT","PATCH","DELETE"];new Set(gT);var uR=["GET",...gT];new Set(uR);var Ql=V.createContext(null);Ql.displayName="DataRouter";var Xf=V.createContext(null);Xf.displayName="DataRouterState";V.createContext(!1);var pT=V.createContext({isTransitioning:!1});pT.displayName="ViewTransition";var dR=V.createContext(new Map);dR.displayName="Fetchers";var hR=V.createContext(null);hR.displayName="Await";var Mr=V.createContext(null);Mr.displayName="Navigation";var Zu=V.createContext(null);Zu.displayName="Location";var Lr=V.createContext({outlet:null,matches:[],isDataRoute:!1});Lr.displayName="Route";var Hy=V.createContext(null);Hy.displayName="RouteError";function fR(n,{relative:e}={}){Nt(Yl(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=V.useContext(Mr),{hash:a,pathname:o,search:c}=ed(n,{relative:e}),d=o;return t!=="/"&&(d=o==="/"?t:Fi([t,o])),r.createHref({pathname:d,search:c,hash:a})}function Yl(){return V.useContext(Zu)!=null}function ha(){return Nt(Yl(),"useLocation() may be used only in the context of a <Router> component."),V.useContext(Zu).location}var yT="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function vT(n){V.useContext(Mr).static||V.useLayoutEffect(n)}function _T(){let{isDataRoute:n}=V.useContext(Lr);return n?AR():mR()}function mR(){Nt(Yl(),"useNavigate() may be used only in the context of a <Router> component.");let n=V.useContext(Ql),{basename:e,navigator:t}=V.useContext(Mr),{matches:r}=V.useContext(Lr),{pathname:a}=ha(),o=JSON.stringify(Gy(r)),c=V.useRef(!1);return vT(()=>{c.current=!0}),V.useCallback((f,p={})=>{if(Tr(c.current,yT),!c.current)return;if(typeof f=="number"){t.go(f);return}let v=$y(f,JSON.parse(o),a,p.relative==="path");n==null&&e!=="/"&&(v.pathname=v.pathname==="/"?e:Fi([e,v.pathname])),(p.replace?t.replace:t.push)(v,p.state,p)},[e,t,o,a,n])}V.createContext(null);function gR(){let{matches:n}=V.useContext(Lr),e=n[n.length-1];return e?e.params:{}}function ed(n,{relative:e}={}){let{matches:t}=V.useContext(Lr),{pathname:r}=ha(),a=JSON.stringify(Gy(t));return V.useMemo(()=>$y(n,JSON.parse(a),r,e==="path"),[n,a,r,e])}function pR(n,e){return bT(n,e)}function bT(n,e,t,r,a){Nt(Yl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=V.useContext(Mr),{matches:c}=V.useContext(Lr),d=c[c.length-1],f=d?d.params:{},p=d?d.pathname:"/",v=d?d.pathnameBase:"/",b=d&&d.route;{let te=b&&b.path||"";xT(p,!b||te.endsWith("*")||te.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${te}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${te}"> to <Route path="${te==="/"?"*":`${te}/*`}">.`)}let E=ha(),S;if(e){let te=typeof e=="string"?Kl(e):e;Nt(v==="/"||te.pathname?.startsWith(v),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${v}" but pathname "${te.pathname}" was given in the \`location\` prop.`),S=te}else S=E;let R=S.pathname||"/",j=R;if(v!=="/"){let te=v.replace(/^\//,"").split("/");j="/"+R.replace(/^\//,"").split("/").slice(te.length).join("/")}let N=hT(n,{pathname:j});Tr(b||N!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),Tr(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let I=xR(N&&N.map(te=>Object.assign({},te,{params:Object.assign({},f,te.params),pathname:Fi([v,o.encodeLocation?o.encodeLocation(te.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:te.pathname]),pathnameBase:te.pathnameBase==="/"?v:Fi([v,o.encodeLocation?o.encodeLocation(te.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:te.pathnameBase])})),c,t,r,a);return e&&I?V.createElement(Zu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},I):I}function yR(){let n=IR(),e=cR(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},c=null;return console.error("Error handled by React Router default ErrorBoundary:",n),c=V.createElement(V.Fragment,null,V.createElement("p",null," Hey developer "),V.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",V.createElement("code",{style:o},"ErrorBoundary")," or"," ",V.createElement("code",{style:o},"errorElement")," prop on your route.")),V.createElement(V.Fragment,null,V.createElement("h2",null,"Unexpected Application Error!"),V.createElement("h3",{style:{fontStyle:"italic"}},e),t?V.createElement("pre",{style:a},t):null,c)}var vR=V.createElement(yR,null),_R=class extends V.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){return this.state.error!==void 0?V.createElement(Lr.Provider,{value:this.props.routeContext},V.createElement(Hy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function bR({routeContext:n,match:e,children:t}){let r=V.useContext(Ql);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),V.createElement(Lr.Provider,{value:n},t)}function xR(n,e=[],t=null,r=null,a=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,c=t?.errors;if(c!=null){let v=o.findIndex(b=>b.route.id&&c?.[b.route.id]!==void 0);Nt(v>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),o=o.slice(0,Math.min(o.length,v+1))}let d=!1,f=-1;if(t)for(let v=0;v<o.length;v++){let b=o[v];if((b.route.HydrateFallback||b.route.hydrateFallbackElement)&&(f=v),b.route.id){let{loaderData:E,errors:S}=t,R=b.route.loader&&!E.hasOwnProperty(b.route.id)&&(!S||S[b.route.id]===void 0);if(b.route.lazy||R){d=!0,f>=0?o=o.slice(0,f+1):o=[o[0]];break}}}let p=t&&r?(v,b)=>{r(v,{location:t.location,params:t.matches?.[0]?.params??{},errorInfo:b})}:void 0;return o.reduceRight((v,b,E)=>{let S,R=!1,j=null,N=null;t&&(S=c&&b.route.id?c[b.route.id]:void 0,j=b.route.errorElement||vR,d&&(f<0&&E===0?(xT("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),R=!0,N=null):f===E&&(R=!0,N=b.route.hydrateFallbackElement||null)));let I=e.concat(o.slice(0,E+1)),te=()=>{let X;return S?X=j:R?X=N:b.route.Component?X=V.createElement(b.route.Component,null):b.route.element?X=b.route.element:X=v,V.createElement(bR,{match:b,routeContext:{outlet:v,matches:I,isDataRoute:t!=null},children:X})};return t&&(b.route.ErrorBoundary||b.route.errorElement||E===0)?V.createElement(_R,{location:t.location,revalidation:t.revalidation,component:j,error:S,children:te(),routeContext:{outlet:null,matches:I,isDataRoute:!0},onError:p}):te()},null)}function Ky(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function wR(n){let e=V.useContext(Ql);return Nt(e,Ky(n)),e}function ER(n){let e=V.useContext(Xf);return Nt(e,Ky(n)),e}function TR(n){let e=V.useContext(Lr);return Nt(e,Ky(n)),e}function Qy(n){let e=TR(n),t=e.matches[e.matches.length-1];return Nt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function SR(){return Qy("useRouteId")}function IR(){let n=V.useContext(Hy),e=ER("useRouteError"),t=Qy("useRouteError");return n!==void 0?n:e.errors?.[t]}function AR(){let{router:n}=wR("useNavigate"),e=Qy("useNavigate"),t=V.useRef(!1);return vT(()=>{t.current=!0}),V.useCallback(async(a,o={})=>{Tr(t.current,yT),t.current&&(typeof a=="number"?n.navigate(a):await n.navigate(a,{fromRouteId:e,...o}))},[n,e])}var aw={};function xT(n,e,t){!e&&!aw[n]&&(aw[n]=!0,Tr(!1,t))}V.memo(NR);function NR({routes:n,future:e,state:t,unstable_onError:r}){return bT(n,void 0,t,r,e)}function CR({to:n,replace:e,state:t,relative:r}){Nt(Yl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=V.useContext(Mr);Tr(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=V.useContext(Lr),{pathname:c}=ha(),d=_T(),f=$y(n,Gy(o),c,r==="path"),p=JSON.stringify(f);return V.useEffect(()=>{d(JSON.parse(p),{replace:e,state:t,relative:r})},[d,p,r,e,t]),null}function af(n){Nt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function RR({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:a,static:o=!1}){Nt(!Yl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=n.replace(/^\/*/,"/"),d=V.useMemo(()=>({basename:c,navigator:a,static:o,future:{}}),[c,a,o]);typeof t=="string"&&(t=Kl(t));let{pathname:f="/",search:p="",hash:v="",state:b=null,key:E="default"}=t,S=V.useMemo(()=>{let R=qi(f,c);return R==null?null:{location:{pathname:R,search:p,hash:v,state:b,key:E},navigationType:r}},[c,f,p,v,b,E,r]);return Tr(S!=null,`<Router basename="${c}"> is not able to match the URL "${f}${p}${v}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:V.createElement(Mr.Provider,{value:d},V.createElement(Zu.Provider,{children:e,value:S}))}function kR({children:n,location:e}){return pR(cy(n),e)}function cy(n,e=[]){let t=[];return V.Children.forEach(n,(r,a)=>{if(!V.isValidElement(r))return;let o=[...e,a];if(r.type===V.Fragment){t.push.apply(t,cy(r.props.children,o));return}Nt(r.type===af,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Nt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let c={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(c.children=cy(r.props.children,o)),t.push(c)}),t}var of="get",lf="application/x-www-form-urlencoded";function Jf(n){return n!=null&&typeof n.tagName=="string"}function DR(n){return Jf(n)&&n.tagName.toLowerCase()==="button"}function jR(n){return Jf(n)&&n.tagName.toLowerCase()==="form"}function OR(n){return Jf(n)&&n.tagName.toLowerCase()==="input"}function PR(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function VR(n,e){return n.button===0&&(!e||e==="_self")&&!PR(n)}var Wh=null;function MR(){if(Wh===null)try{new FormData(document.createElement("form"),0),Wh=!1}catch{Wh=!0}return Wh}var LR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function qp(n){return n!=null&&!LR.has(n)?(Tr(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${lf}"`),null):n}function UR(n,e){let t,r,a,o,c;if(jR(n)){let d=n.getAttribute("action");r=d?qi(d,e):null,t=n.getAttribute("method")||of,a=qp(n.getAttribute("enctype"))||lf,o=new FormData(n)}else if(DR(n)||OR(n)&&(n.type==="submit"||n.type==="image")){let d=n.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=n.getAttribute("formaction")||d.getAttribute("action");if(r=f?qi(f,e):null,t=n.getAttribute("formmethod")||d.getAttribute("method")||of,a=qp(n.getAttribute("formenctype"))||qp(d.getAttribute("enctype"))||lf,o=new FormData(d,n),!MR()){let{name:p,type:v,value:b}=n;if(v==="image"){let E=p?`${p}.`:"";o.append(`${E}x`,"0"),o.append(`${E}y`,"0")}else p&&o.append(p,b)}}else{if(Jf(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=of,r=null,a=lf,c=n}return o&&a==="text/plain"&&(c=o,o=void 0),{action:r,method:t.toLowerCase(),encType:a,formData:o,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Yy(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function zR(n,e,t){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&qi(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function FR(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function BR(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function qR(n,e,t){let r=await Promise.all(n.map(async a=>{let o=e.routes[a.route.id];if(o){let c=await FR(o,t);return c.links?c.links():[]}return[]}));return KR(r.flat(1).filter(BR).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function ow(n,e,t,r,a,o){let c=(f,p)=>t[p]?f.route.id!==t[p].route.id:!0,d=(f,p)=>t[p].pathname!==f.pathname||t[p].route.path?.endsWith("*")&&t[p].params["*"]!==f.params["*"];return o==="assets"?e.filter((f,p)=>c(f,p)||d(f,p)):o==="data"?e.filter((f,p)=>{let v=r.routes[f.route.id];if(!v||!v.hasLoader)return!1;if(c(f,p)||d(f,p))return!0;if(f.route.shouldRevalidate){let b=f.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof b=="boolean")return b}return!0}):[]}function GR(n,e,{includeHydrateFallback:t}={}){return $R(n.map(r=>{let a=e.routes[r.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),t&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function $R(n){return[...new Set(n)]}function HR(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function KR(n,e){let t=new Set;return new Set(e),n.reduce((r,a)=>{let o=JSON.stringify(HR(a));return t.has(o)||(t.add(o),r.push({key:o,link:a})),r},[])}function wT(){let n=V.useContext(Ql);return Yy(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function QR(){let n=V.useContext(Xf);return Yy(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Wy=V.createContext(void 0);Wy.displayName="FrameworkContext";function ET(){let n=V.useContext(Wy);return Yy(n,"You must render this element inside a <HydratedRouter> element"),n}function YR(n,e){let t=V.useContext(Wy),[r,a]=V.useState(!1),[o,c]=V.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:p,onMouseLeave:v,onTouchStart:b}=e,E=V.useRef(null);V.useEffect(()=>{if(n==="render"&&c(!0),n==="viewport"){let j=I=>{I.forEach(te=>{c(te.isIntersecting)})},N=new IntersectionObserver(j,{threshold:.5});return E.current&&N.observe(E.current),()=>{N.disconnect()}}},[n]),V.useEffect(()=>{if(r){let j=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(j)}}},[r]);let S=()=>{a(!0)},R=()=>{a(!1),c(!1)};return t?n!=="intent"?[o,E,{}]:[o,E,{onFocus:fu(d,S),onBlur:fu(f,R),onMouseEnter:fu(p,S),onMouseLeave:fu(v,R),onTouchStart:fu(b,S)}]:[!1,E,{}]}function fu(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function WR({page:n,...e}){let{router:t}=wT(),r=V.useMemo(()=>hT(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?V.createElement(JR,{page:n,matches:r,...e}):null}function XR(n){let{manifest:e,routeModules:t}=ET(),[r,a]=V.useState([]);return V.useEffect(()=>{let o=!1;return qR(n,e,t).then(c=>{o||a(c)}),()=>{o=!0}},[n,e,t]),r}function JR({page:n,matches:e,...t}){let r=ha(),{manifest:a,routeModules:o}=ET(),{basename:c}=wT(),{loaderData:d,matches:f}=QR(),p=V.useMemo(()=>ow(n,e,f,a,r,"data"),[n,e,f,a,r]),v=V.useMemo(()=>ow(n,e,f,a,r,"assets"),[n,e,f,a,r]),b=V.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let R=new Set,j=!1;if(e.forEach(I=>{let te=a.routes[I.route.id];!te||!te.hasLoader||(!p.some(X=>X.route.id===I.route.id)&&I.route.id in d&&o[I.route.id]?.shouldRevalidate||te.hasClientLoader?j=!0:R.add(I.route.id))}),R.size===0)return[];let N=zR(n,c,"data");return j&&R.size>0&&N.searchParams.set("_routes",e.filter(I=>R.has(I.route.id)).map(I=>I.route.id).join(",")),[N.pathname+N.search]},[c,d,r,a,p,e,n,o]),E=V.useMemo(()=>GR(v,a),[v,a]),S=XR(v);return V.createElement(V.Fragment,null,b.map(R=>V.createElement("link",{key:R,rel:"prefetch",as:"fetch",href:R,...t})),E.map(R=>V.createElement("link",{key:R,rel:"modulepreload",href:R,...t})),S.map(({key:R,link:j})=>V.createElement("link",{key:R,nonce:t.nonce,...j})))}function ZR(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var TT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{TT&&(window.__reactRouterVersion="7.9.6")}catch{}function ek({basename:n,children:e,window:t}){let r=V.useRef();r.current==null&&(r.current=UC({window:t,v5Compat:!0}));let a=r.current,[o,c]=V.useState({action:a.action,location:a.location}),d=V.useCallback(f=>{V.startTransition(()=>c(f))},[c]);return V.useLayoutEffect(()=>a.listen(d),[a,d]),V.createElement(RR,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:a})}var ST=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,IT=V.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:a,reloadDocument:o,replace:c,state:d,target:f,to:p,preventScrollReset:v,viewTransition:b,...E},S){let{basename:R}=V.useContext(Mr),j=typeof p=="string"&&ST.test(p),N,I=!1;if(typeof p=="string"&&j&&(N=p,TT))try{let O=new URL(window.location.href),z=p.startsWith("//")?new URL(O.protocol+p):new URL(p),M=qi(z.pathname,R);z.origin===O.origin&&M!=null?p=M+z.search+z.hash:I=!0}catch{Tr(!1,`<Link to="${p}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let te=fR(p,{relative:a}),[X,de,ve]=YR(r,E),ge=ik(p,{replace:c,state:d,target:f,preventScrollReset:v,relative:a,viewTransition:b});function D(O){e&&e(O),O.defaultPrevented||ge(O)}let C=V.createElement("a",{...E,...ve,href:N||te,onClick:I||o?e:D,ref:ZR(S,de),target:f,"data-discover":!j&&t==="render"?"true":void 0});return X&&!j?V.createElement(V.Fragment,null,C,V.createElement(WR,{page:te})):C});IT.displayName="Link";var tk=V.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:a=!1,style:o,to:c,viewTransition:d,children:f,...p},v){let b=ed(c,{relative:p.relative}),E=ha(),S=V.useContext(Xf),{navigator:R,basename:j}=V.useContext(Mr),N=S!=null&&ck(b)&&d===!0,I=R.encodeLocation?R.encodeLocation(b).pathname:b.pathname,te=E.pathname,X=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;t||(te=te.toLowerCase(),X=X?X.toLowerCase():null,I=I.toLowerCase()),X&&j&&(X=qi(X,j)||X);const de=I!=="/"&&I.endsWith("/")?I.length-1:I.length;let ve=te===I||!a&&te.startsWith(I)&&te.charAt(de)==="/",ge=X!=null&&(X===I||!a&&X.startsWith(I)&&X.charAt(I.length)==="/"),D={isActive:ve,isPending:ge,isTransitioning:N},C=ve?e:void 0,O;typeof r=="function"?O=r(D):O=[r,ve?"active":null,ge?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let z=typeof o=="function"?o(D):o;return V.createElement(IT,{...p,"aria-current":C,className:O,ref:v,style:z,to:c,viewTransition:d},typeof f=="function"?f(D):f)});tk.displayName="NavLink";var nk=V.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:a,state:o,method:c=of,action:d,onSubmit:f,relative:p,preventScrollReset:v,viewTransition:b,...E},S)=>{let R=ok(),j=lk(d,{relative:p}),N=c.toLowerCase()==="get"?"get":"post",I=typeof d=="string"&&ST.test(d),te=X=>{if(f&&f(X),X.defaultPrevented)return;X.preventDefault();let de=X.nativeEvent.submitter,ve=de?.getAttribute("formmethod")||c;R(de||X.currentTarget,{fetcherKey:e,method:ve,navigate:t,replace:a,state:o,relative:p,preventScrollReset:v,viewTransition:b})};return V.createElement("form",{ref:S,method:N,action:j,onSubmit:r?f:te,...E,"data-discover":!I&&n==="render"?"true":void 0})});nk.displayName="Form";function rk(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function AT(n){let e=V.useContext(Ql);return Nt(e,rk(n)),e}function ik(n,{target:e,replace:t,state:r,preventScrollReset:a,relative:o,viewTransition:c}={}){let d=_T(),f=ha(),p=ed(n,{relative:o});return V.useCallback(v=>{if(VR(v,e)){v.preventDefault();let b=t!==void 0?t:Uu(f)===Uu(p);d(n,{replace:b,state:r,preventScrollReset:a,relative:o,viewTransition:c})}},[f,d,p,t,r,e,n,a,o,c])}var sk=0,ak=()=>`__${String(++sk)}__`;function ok(){let{router:n}=AT("useSubmit"),{basename:e}=V.useContext(Mr),t=SR();return V.useCallback(async(r,a={})=>{let{action:o,method:c,encType:d,formData:f,body:p}=UR(r,e);if(a.navigate===!1){let v=a.fetcherKey||ak();await n.fetch(v,t,a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:p,formMethod:a.method||c,formEncType:a.encType||d,flushSync:a.flushSync})}else await n.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:f,body:p,formMethod:a.method||c,formEncType:a.encType||d,replace:a.replace,state:a.state,fromRouteId:t,flushSync:a.flushSync,viewTransition:a.viewTransition})},[n,e,t])}function lk(n,{relative:e}={}){let{basename:t}=V.useContext(Mr),r=V.useContext(Lr);Nt(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...ed(n||".",{relative:e})},c=ha();if(n==null){o.search=c.search;let d=new URLSearchParams(o.search),f=d.getAll("index");if(f.some(v=>v==="")){d.delete("index"),f.filter(b=>b).forEach(b=>d.append("index",b));let v=d.toString();o.search=v?`?${v}`:""}}return(!n||n===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:Fi([t,o.pathname])),Uu(o)}function ck(n,{relative:e}={}){let t=V.useContext(pT);Nt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=AT("useViewTransitionState"),a=ed(n,{relative:e});if(!t.isTransitioning)return!1;let o=qi(t.currentLocation.pathname,r)||t.currentLocation.pathname,c=qi(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Tf(a.pathname,c)!=null||Tf(a.pathname,o)!=null}const uk="modulepreload",dk=function(n){return"/"+n},lw={},kt=function(e,t,r){let a=Promise.resolve();if(t&&t.length>0){let p=function(v){return Promise.all(v.map(b=>Promise.resolve(b).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};var c=p;document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),f=d?.nonce||d?.getAttribute("nonce");a=p(t.map(v=>{if(v=dk(v),v in lw)return;lw[v]=!0;const b=v.endsWith(".css"),E=b?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${v}"]${E}`))return;const S=document.createElement("link");if(S.rel=b?"stylesheet":uk,b||(S.as="script"),S.crossOrigin="",S.href=v,f&&S.setAttribute("nonce",f),document.head.appendChild(S),b)return new Promise((R,j)=>{S.addEventListener("load",R),S.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${v}`)))})}))}function o(d){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=d,window.dispatchEvent(f),!f.defaultPrevented)throw d}return a.then(d=>{for(const f of d||[])f.status==="rejected"&&o(f.reason);return e().catch(o)})};var cw={};const NT=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let a=n.charCodeAt(r);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=a&63|128):(a&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=a&63|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=a&63|128)}return e},hk=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const a=n[t++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const o=n[t++];e[r++]=String.fromCharCode((a&31)<<6|o&63)}else if(a>239&&a<365){const o=n[t++],c=n[t++],d=n[t++],f=((a&7)<<18|(o&63)<<12|(c&63)<<6|d&63)-65536;e[r++]=String.fromCharCode(55296+(f>>10)),e[r++]=String.fromCharCode(56320+(f&1023))}else{const o=n[t++],c=n[t++];e[r++]=String.fromCharCode((a&15)<<12|(o&63)<<6|c&63)}}return e.join("")},CT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<n.length;a+=3){const o=n[a],c=a+1<n.length,d=c?n[a+1]:0,f=a+2<n.length,p=f?n[a+2]:0,v=o>>2,b=(o&3)<<4|d>>4;let E=(d&15)<<2|p>>6,S=p&63;f||(S=64,c||(E=64)),r.push(t[v],t[b],t[E],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(NT(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):hk(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<n.length;){const o=t[n.charAt(a++)],d=a<n.length?t[n.charAt(a)]:0;++a;const p=a<n.length?t[n.charAt(a)]:64;++a;const b=a<n.length?t[n.charAt(a)]:64;if(++a,o==null||d==null||p==null||b==null)throw new fk;const E=o<<2|d>>4;if(r.push(E),p!==64){const S=d<<4&240|p>>2;if(r.push(S),b!==64){const R=p<<6&192|b;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class fk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const mk=function(n){const e=NT(n);return CT.encodeByteArray(e,!0)},Sf=function(n){return mk(n).replace(/\./g,"")},RT=function(n){try{return CT.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function gk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof globalThis<"u")return globalThis;throw new Error("Unable to locate global object.")}const pk=()=>gk().__FIREBASE_DEFAULTS__,yk=()=>{if(typeof process>"u"||typeof cw>"u")return;const n=cw.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},vk=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&RT(n[1]);return e&&JSON.parse(e)},Zf=()=>{try{return pk()||yk()||vk()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},kT=n=>{var e,t;return(t=(e=Zf())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},_k=n=>{const e=kT(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},DT=()=>{var n;return(n=Zf())===null||n===void 0?void 0:n.config},jT=n=>{var e;return(e=Zf())===null||e===void 0?void 0:e[`_${n}`]};class bk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}function xk(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",a=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Sf(JSON.stringify(t)),Sf(JSON.stringify(c)),""].join(".")}function rn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function wk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(rn())}function Ek(){var n;const e=(n=Zf())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(globalThis.process)==="[object process]"}catch{return!1}}function Tk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function OT(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Sk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ik(){const n=rn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function PT(){return!Ek()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Xy(){try{return typeof indexedDB=="object"}catch{return!1}}function VT(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},a.onupgradeneeded=()=>{t=!1},a.onerror=()=>{var o;e(((o=a.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}function Ak(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const Nk="FirebaseError";class Ur extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Nk,Object.setPrototypeOf(this,Ur.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xo.prototype.create)}}class xo{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},a=`${this.service}/${e}`,o=this.errors[e],c=o?Ck(o,r):"Error",d=`${this.serviceName}: ${c} (${a}).`;return new Ur(a,d,r)}}function Ck(n,e){return n.replace(Rk,(t,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const Rk=/\{\$([^}]+)}/g;function kk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Gi(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const a of t){if(!r.includes(a))return!1;const o=n[a],c=e[a];if(uw(o)&&uw(c)){if(!Gi(o,c))return!1}else if(o!==c)return!1}for(const a of r)if(!t.includes(a))return!1;return!0}function uw(n){return n!==null&&typeof n=="object"}function td(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(a=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function xu(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[a,o]=r.split("=");e[decodeURIComponent(a)]=decodeURIComponent(o)}}),e}function wu(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Dk(n,e){const t=new jk(n,e);return t.subscribe.bind(t)}class jk{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let a;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Ok(e,["next","error","complete"])?a=e:a={next:e,error:t,complete:r},a.next===void 0&&(a.next=Gp),a.error===void 0&&(a.error=Gp),a.complete===void 0&&(a.complete=Gp);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Ok(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Gp(){}const Pk=1e3,Vk=2,Mk=14400*1e3,Lk=.5;function dw(n,e=Pk,t=Vk){const r=e*Math.pow(t,n),a=Math.round(Lk*r*(Math.random()-.5)*2);return Math.min(Mk,r+a)}function it(n){return n&&n._delegate?n._delegate:n}class Vr{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Xa="[DEFAULT]";class Uk{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new bk;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:t});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e?.identifier),a=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(a)return null;throw o}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Fk(e))try{this.getOrInitializeService({instanceIdentifier:Xa})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:a});r.resolve(o)}catch{}}}}clearInstance(e=Xa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xa){return this.instances.has(e)}getOptions(e=Xa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[o,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(o);r===d&&c.resolve(a)}return a}onInit(e,t){var r;const a=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(a))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(a,o);const c=this.instances.get(a);return c&&e(c,a),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const a of r)try{a(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:zk(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Xa){return this.component?this.component.multipleInstances?e:Xa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function zk(n){return n===Xa?void 0:n}function Fk(n){return n.instantiationMode==="EAGER"}class Bk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Uk(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Qe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Qe||(Qe={}));const qk={debug:Qe.DEBUG,verbose:Qe.VERBOSE,info:Qe.INFO,warn:Qe.WARN,error:Qe.ERROR,silent:Qe.SILENT},Gk=Qe.INFO,$k={[Qe.DEBUG]:"log",[Qe.VERBOSE]:"log",[Qe.INFO]:"info",[Qe.WARN]:"warn",[Qe.ERROR]:"error"},Hk=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),a=$k[e];if(a)console[a](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class em{constructor(e){this.name=e,this._logLevel=Gk,this._logHandler=Hk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Qe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?qk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Qe.DEBUG,...e),this._logHandler(this,Qe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Qe.VERBOSE,...e),this._logHandler(this,Qe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Qe.INFO,...e),this._logHandler(this,Qe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Qe.WARN,...e),this._logHandler(this,Qe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Qe.ERROR,...e),this._logHandler(this,Qe.ERROR,...e)}}const Kk=(n,e)=>e.some(t=>n instanceof t);let hw,fw;function Qk(){return hw||(hw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Yk(){return fw||(fw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const MT=new WeakMap,uy=new WeakMap,LT=new WeakMap,$p=new WeakMap,Jy=new WeakMap;function Wk(n){const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("success",o),n.removeEventListener("error",c)},o=()=>{t(Zs(n.result)),a()},c=()=>{r(n.error),a()};n.addEventListener("success",o),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&MT.set(t,n)}).catch(()=>{}),Jy.set(e,n),e}function Xk(n){if(uy.has(n))return;const e=new Promise((t,r)=>{const a=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",c),n.removeEventListener("abort",c)},o=()=>{t(),a()},c=()=>{r(n.error||new DOMException("AbortError","AbortError")),a()};n.addEventListener("complete",o),n.addEventListener("error",c),n.addEventListener("abort",c)});uy.set(n,e)}let dy={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return uy.get(n);if(e==="objectStoreNames")return n.objectStoreNames||LT.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Zs(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Jk(n){dy=n(dy)}function Zk(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Hp(this),e,...t);return LT.set(r,e.sort?e.sort():[e]),Zs(r)}:Yk().includes(n)?function(...e){return n.apply(Hp(this),e),Zs(MT.get(this))}:function(...e){return Zs(n.apply(Hp(this),e))}}function eD(n){return typeof n=="function"?Zk(n):(n instanceof IDBTransaction&&Xk(n),Kk(n,Qk())?new Proxy(n,dy):n)}function Zs(n){if(n instanceof IDBRequest)return Wk(n);if($p.has(n))return $p.get(n);const e=eD(n);return e!==n&&($p.set(n,e),Jy.set(e,n)),e}const Hp=n=>Jy.get(n);function UT(n,e,{blocked:t,upgrade:r,blocking:a,terminated:o}={}){const c=indexedDB.open(n,e),d=Zs(c);return r&&c.addEventListener("upgradeneeded",f=>{r(Zs(c.result),f.oldVersion,f.newVersion,Zs(c.transaction),f)}),t&&c.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),d.then(f=>{o&&f.addEventListener("close",()=>o()),a&&f.addEventListener("versionchange",p=>a(p.oldVersion,p.newVersion,p))}).catch(()=>{}),d}const tD=["get","getKey","getAll","getAllKeys","count"],nD=["put","add","delete","clear"],Kp=new Map;function mw(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Kp.get(e))return Kp.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,a=nD.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(a||tD.includes(t)))return;const o=async function(c,...d){const f=this.transaction(c,a?"readwrite":"readonly");let p=f.store;return r&&(p=p.index(d.shift())),(await Promise.all([p[t](...d),a&&f.done]))[0]};return Kp.set(e,o),o}Jk(n=>({...n,get:(e,t,r)=>mw(e,t)||n.get(e,t,r),has:(e,t)=>!!mw(e,t)||n.has(e,t)}));class rD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(iD(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function iD(n){const e=n.getComponent();return e?.type==="VERSION"}const hy="@firebase/app",gw="0.10.13";const $i=new em("@firebase/app"),sD="@firebase/app-compat",aD="@firebase/analytics-compat",oD="@firebase/analytics",lD="@firebase/app-check-compat",cD="@firebase/app-check",uD="@firebase/auth",dD="@firebase/auth-compat",hD="@firebase/database",fD="@firebase/data-connect",mD="@firebase/database-compat",gD="@firebase/functions",pD="@firebase/functions-compat",yD="@firebase/installations",vD="@firebase/installations-compat",_D="@firebase/messaging",bD="@firebase/messaging-compat",xD="@firebase/performance",wD="@firebase/performance-compat",ED="@firebase/remote-config",TD="@firebase/remote-config-compat",SD="@firebase/storage",ID="@firebase/storage-compat",AD="@firebase/firestore",ND="@firebase/vertexai-preview",CD="@firebase/firestore-compat",RD="firebase",kD="10.14.1";const If="[DEFAULT]",DD={[hy]:"fire-core",[sD]:"fire-core-compat",[oD]:"fire-analytics",[aD]:"fire-analytics-compat",[cD]:"fire-app-check",[lD]:"fire-app-check-compat",[uD]:"fire-auth",[dD]:"fire-auth-compat",[hD]:"fire-rtdb",[fD]:"fire-data-connect",[mD]:"fire-rtdb-compat",[gD]:"fire-fn",[pD]:"fire-fn-compat",[yD]:"fire-iid",[vD]:"fire-iid-compat",[_D]:"fire-fcm",[bD]:"fire-fcm-compat",[xD]:"fire-perf",[wD]:"fire-perf-compat",[ED]:"fire-rc",[TD]:"fire-rc-compat",[SD]:"fire-gcs",[ID]:"fire-gcs-compat",[AD]:"fire-fst",[CD]:"fire-fst-compat",[ND]:"fire-vertex","fire-js":"fire-js",[RD]:"fire-js-all"};const Af=new Map,jD=new Map,fy=new Map;function pw(n,e){try{n.container.addComponent(e)}catch(t){$i.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function ii(n){const e=n.name;if(fy.has(e))return $i.debug(`There were multiple attempts to register component ${e}.`),!1;fy.set(e,n);for(const t of Af.values())pw(t,n);for(const t of jD.values())pw(t,n);return!0}function Wi(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function OD(n,e,t=If){Wi(n,e).clearInstance(t)}function jr(n){return n.settings!==void 0}const PD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ea=new xo("app","Firebase",PD);class VD{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Vr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ea.create("app-deleted",{appName:this._name})}}const Wl=kD;function zT(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:If,automaticDataCollectionEnabled:!1},e),a=r.name;if(typeof a!="string"||!a)throw ea.create("bad-app-name",{appName:String(a)});if(t||(t=DT()),!t)throw ea.create("no-options");const o=Af.get(a);if(o){if(Gi(t,o.options)&&Gi(r,o.config))return o;throw ea.create("duplicate-app",{appName:a})}const c=new Bk(a);for(const f of fy.values())c.addComponent(f);const d=new VD(t,r,c);return Af.set(a,d),d}function Zy(n=If){const e=Af.get(n);if(!e&&n===If&&DT())return zT();if(!e)throw ea.create("no-app",{appName:n});return e}function Er(n,e,t){var r;let a=(r=DD[n])!==null&&r!==void 0?r:n;t&&(a+=`-${t}`);const o=a.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const d=[`Unable to register library "${a}" with version "${e}":`];o&&d.push(`library name "${a}" contains illegal characters (whitespace or "/")`),o&&c&&d.push("and"),c&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),$i.warn(d.join(" "));return}ii(new Vr(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}const MD="firebase-heartbeat-database",LD=1,zu="firebase-heartbeat-store";let Qp=null;function FT(){return Qp||(Qp=UT(MD,LD,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(zu)}catch(t){console.warn(t)}}}}).catch(n=>{throw ea.create("idb-open",{originalErrorMessage:n.message})})),Qp}async function UD(n){try{const t=(await FT()).transaction(zu),r=await t.objectStore(zu).get(BT(n));return await t.done,r}catch(e){if(e instanceof Ur)$i.warn(e.message);else{const t=ea.create("idb-get",{originalErrorMessage:e?.message});$i.warn(t.message)}}}async function yw(n,e){try{const r=(await FT()).transaction(zu,"readwrite");await r.objectStore(zu).put(e,BT(n)),await r.done}catch(t){if(t instanceof Ur)$i.warn(t.message);else{const r=ea.create("idb-set",{originalErrorMessage:t?.message});$i.warn(r.message)}}}function BT(n){return`${n.name}!${n.options.appId}`}const zD=1024,FD=720*60*60*1e3;class BD{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new GD(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=vw();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(c=>c.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:a}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(c=>{const d=new Date(c.date).valueOf();return Date.now()-d<=FD}),this._storage.overwrite(this._heartbeatsCache))}catch(r){$i.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=vw(),{heartbeatsToSend:r,unsentEntries:a}=qD(this._heartbeatsCache.heartbeats),o=Sf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return $i.warn(t),""}}}function vw(){return new Date().toISOString().substring(0,10)}function qD(n,e=zD){const t=[];let r=n.slice();for(const a of n){const o=t.find(c=>c.agent===a.agent);if(o){if(o.dates.push(a.date),_w(t)>e){o.dates.pop();break}}else if(t.push({agent:a.agent,dates:[a.date]}),_w(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class GD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Xy()?VT().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await UD(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return yw(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return yw(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function _w(n){return Sf(JSON.stringify({version:2,heartbeats:n})).length}function $D(n){ii(new Vr("platform-logger",e=>new rD(e),"PRIVATE")),ii(new Vr("heartbeat",e=>new BD(e),"PRIVATE")),Er(hy,gw,n),Er(hy,gw,"esm2017"),Er("fire-js","")}$D("");function e0(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(n);a<r.length;a++)e.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(n,r[a])&&(t[r[a]]=n[r[a]]);return t}function qT(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const GT=qT,$T=new xo("auth","Firebase",qT());const Nf=new em("@firebase/auth");function HD(n,...e){Nf.logLevel<=Qe.WARN&&Nf.warn(`Auth (${Wl}): ${n}`,...e)}function cf(n,...e){Nf.logLevel<=Qe.ERROR&&Nf.error(`Auth (${Wl}): ${n}`,...e)}function Sr(n,...e){throw n0(n,...e)}function Or(n,...e){return n0(n,...e)}function t0(n,e,t){const r=Object.assign(Object.assign({},GT()),{[e]:t});return new xo("auth","Firebase",r).create(e,{appName:n.name})}function Bi(n){return t0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function KD(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Sr(n,"argument-error"),t0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function n0(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return $T.create(n,...e)}function De(n,e,...t){if(!n)throw n0(e,...t)}function Mi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw cf(e),new Error(e)}function Hi(n,e){n||Mi(e)}function my(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function QD(){return bw()==="http:"||bw()==="https:"}function bw(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function YD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(QD()||OT()||"connection"in navigator)?navigator.onLine:!0}function WD(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class nd{constructor(e,t){this.shortDelay=e,this.longDelay=t,Hi(t>e,"Short delay should be less than long delay!"),this.isMobile=wk()||Sk()}get(){return YD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function r0(n,e){Hi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class HT{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Mi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Mi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Mi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const XD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const JD=new nd(3e4,6e4);function fa(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Xi(n,e,t,r,a={}){return KT(n,a,async()=>{let o={},c={};r&&(e==="GET"?c=r:o={body:JSON.stringify(r)});const d=td(Object.assign({key:n.config.apiKey},c)).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const p=Object.assign({method:e,headers:f},o);return Tk()||(p.referrerPolicy="no-referrer"),HT.fetch()(QT(n,n.config.apiHost,t,d),p)})}async function KT(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},XD),e);try{const a=new ej(n),o=await Promise.race([t(),a.promise]);a.clearNetworkTimeout();const c=await o.json();if("needConfirmation"in c)throw Xh(n,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{const d=o.ok?c.errorMessage:c.error.message,[f,p]=d.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xh(n,"credential-already-in-use",c);if(f==="EMAIL_EXISTS")throw Xh(n,"email-already-in-use",c);if(f==="USER_DISABLED")throw Xh(n,"user-disabled",c);const v=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw t0(n,v,p);Sr(n,v)}}catch(a){if(a instanceof Ur)throw a;Sr(n,"network-request-failed",{message:String(a)})}}async function rd(n,e,t,r,a={}){const o=await Xi(n,e,t,r,a);return"mfaPendingCredential"in o&&Sr(n,"multi-factor-auth-required",{_serverResponse:o}),o}function QT(n,e,t,r){const a=`${e}${t}?${r}`;return n.config.emulator?r0(n.config,a):`${n.config.apiScheme}://${a}`}function ZD(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ej{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Or(this.auth,"network-request-failed")),JD.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Xh(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const a=Or(n,e,r);return a.customData._tokenResponse=t,a}function xw(n){return n!==void 0&&n.enterprise!==void 0}class tj{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return ZD(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function nj(n,e){return Xi(n,"GET","/v2/recaptchaConfig",fa(n,e))}async function rj(n,e){return Xi(n,"POST","/v1/accounts:delete",e)}async function YT(n,e){return Xi(n,"POST","/v1/accounts:lookup",e)}function Cu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function WT(n,e=!1){const t=it(n),r=await t.getIdToken(e),a=i0(r);De(a&&a.exp&&a.auth_time&&a.iat,t.auth,"internal-error");const o=typeof a.firebase=="object"?a.firebase:void 0,c=o?.sign_in_provider;return{claims:a,token:r,authTime:Cu(Yp(a.auth_time)),issuedAtTime:Cu(Yp(a.iat)),expirationTime:Cu(Yp(a.exp)),signInProvider:c||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Yp(n){return Number(n)*1e3}function i0(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return cf("JWT malformed, contained fewer than 3 sections"),null;try{const a=RT(t);return a?JSON.parse(a):(cf("Failed to decode base64 JWT payload"),null)}catch(a){return cf("Caught error parsing JWT payload as JSON",a?.toString()),null}}function ww(n){const e=i0(n);return De(e,"internal-error"),De(typeof e.exp<"u","internal-error"),De(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Cl(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Ur&&ij(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function ij({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class sj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const a=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,a)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class gy{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Cu(this.lastLoginAt),this.creationTime=Cu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Cf(n){var e;const t=n.auth,r=await n.getIdToken(),a=await Cl(n,YT(t,{idToken:r}));De(a?.users.length,t,"internal-error");const o=a.users[0];n._notifyReloadListener(o);const c=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?JT(o.providerUserInfo):[],d=aj(n.providerData,c),f=n.isAnonymous,p=!(n.email&&o.passwordHash)&&!d?.length,v=f?p:!1,b={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:d,metadata:new gy(o.createdAt,o.lastLoginAt),isAnonymous:v};Object.assign(n,b)}async function XT(n){const e=it(n);await Cf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function aj(n,e){return[...n.filter(r=>!e.some(a=>a.providerId===r.providerId)),...e]}function JT(n){return n.map(e=>{var{providerId:t}=e,r=e0(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function oj(n,e){const t=await KT(n,{},async()=>{const r=td({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:o}=n.config,c=QT(n,a,"/v1/token",`key=${o}`),d=await n._getAdditionalHeaders();return d["Content-Type"]="application/x-www-form-urlencoded",HT.fetch()(c,{method:"POST",headers:d,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function lj(n,e){return Xi(n,"POST","/v2/accounts:revokeToken",fa(n,e))}class El{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){De(e.idToken,"internal-error"),De(typeof e.idToken<"u","internal-error"),De(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ww(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){De(e.length!==0,"internal-error");const t=ww(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(De(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:a,expiresIn:o}=await oj(e,t);this.updateTokensAndExpiration(r,a,Number(o))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:a,expirationTime:o}=t,c=new El;return r&&(De(typeof r=="string","internal-error",{appName:e}),c.refreshToken=r),a&&(De(typeof a=="string","internal-error",{appName:e}),c.accessToken=a),o&&(De(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new El,this.toJSON())}_performRefresh(){return Mi("not implemented")}}function Gs(n,e){De(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Li{constructor(e){var{uid:t,auth:r,stsTokenManager:a}=e,o=e0(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new sj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new gy(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const t=await Cl(this,this.stsTokenManager.getToken(this.auth,e));return De(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return WT(this,e)}reload(){return XT(this)}_assign(e){this!==e&&(De(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Li(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){De(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Cf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(jr(this.auth.app))return Promise.reject(Bi(this.auth));const e=await this.getIdToken();return await Cl(this,rj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,a,o,c,d,f,p,v;const b=(r=t.displayName)!==null&&r!==void 0?r:void 0,E=(a=t.email)!==null&&a!==void 0?a:void 0,S=(o=t.phoneNumber)!==null&&o!==void 0?o:void 0,R=(c=t.photoURL)!==null&&c!==void 0?c:void 0,j=(d=t.tenantId)!==null&&d!==void 0?d:void 0,N=(f=t._redirectEventId)!==null&&f!==void 0?f:void 0,I=(p=t.createdAt)!==null&&p!==void 0?p:void 0,te=(v=t.lastLoginAt)!==null&&v!==void 0?v:void 0,{uid:X,emailVerified:de,isAnonymous:ve,providerData:ge,stsTokenManager:D}=t;De(X&&D,e,"internal-error");const C=El.fromJSON(this.name,D);De(typeof X=="string",e,"internal-error"),Gs(b,e.name),Gs(E,e.name),De(typeof de=="boolean",e,"internal-error"),De(typeof ve=="boolean",e,"internal-error"),Gs(S,e.name),Gs(R,e.name),Gs(j,e.name),Gs(N,e.name),Gs(I,e.name),Gs(te,e.name);const O=new Li({uid:X,auth:e,email:E,emailVerified:de,displayName:b,isAnonymous:ve,photoURL:R,phoneNumber:S,tenantId:j,stsTokenManager:C,createdAt:I,lastLoginAt:te});return ge&&Array.isArray(ge)&&(O.providerData=ge.map(z=>Object.assign({},z))),N&&(O._redirectEventId=N),O}static async _fromIdTokenResponse(e,t,r=!1){const a=new El;a.updateFromServerResponse(t);const o=new Li({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await Cf(o),o}static async _fromGetAccountInfoResponse(e,t,r){const a=t.users[0];De(a.localId!==void 0,"internal-error");const o=a.providerUserInfo!==void 0?JT(a.providerUserInfo):[],c=!(a.email&&a.passwordHash)&&!o?.length,d=new El;d.updateFromIdToken(r);const f=new Li({uid:a.localId,auth:e,stsTokenManager:d,isAnonymous:c}),p={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:o,metadata:new gy(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!o?.length};return Object.assign(f,p),f}}const Ew=new Map;function Ui(n){Hi(n instanceof Function,"Expected a class definition");let e=Ew.get(n);return e?(Hi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Ew.set(n,e),e)}class ZT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ZT.type="NONE";const py=ZT;function uf(n,e,t){return`firebase:${n}:${e}:${t}`}class Tl{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:a,name:o}=this.auth;this.fullUserKey=uf(this.userKey,a.apiKey,o),this.fullPersistenceKey=uf("persistence",a.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Li._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Tl(Ui(py),e,r);const a=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let o=a[0]||Ui(py);const c=uf(r,e.config.apiKey,e.name);let d=null;for(const p of t)try{const v=await p._get(c);if(v){const b=Li._fromJSON(e,v);p!==o&&(d=b),o=p;break}}catch{}const f=a.filter(p=>p._shouldAllowMigration);return!o._shouldAllowMigration||!f.length?new Tl(o,e,r):(o=f[0],d&&await o._set(c,d.toJSON()),await Promise.all(t.map(async p=>{if(p!==o)try{await p._remove(c)}catch{}})),new Tl(o,e,r))}}function Tw(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(rS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(eS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(sS(e))return"Blackberry";if(aS(e))return"Webos";if(tS(e))return"Safari";if((e.includes("chrome/")||nS(e))&&!e.includes("edge/"))return"Chrome";if(iS(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function eS(n=rn()){return/firefox\//i.test(n)}function tS(n=rn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function nS(n=rn()){return/crios\//i.test(n)}function rS(n=rn()){return/iemobile/i.test(n)}function iS(n=rn()){return/android/i.test(n)}function sS(n=rn()){return/blackberry/i.test(n)}function aS(n=rn()){return/webos/i.test(n)}function s0(n=rn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function cj(n=rn()){var e;return s0(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function uj(){return Ik()&&document.documentMode===10}function oS(n=rn()){return s0(n)||iS(n)||aS(n)||sS(n)||/windows phone/i.test(n)||rS(n)}function lS(n,e=[]){let t;switch(n){case"Browser":t=Tw(rn());break;case"Worker":t=`${Tw(rn())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Wl}/${r}`}class dj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=o=>new Promise((c,d)=>{try{const f=e(o);c(f)}catch(f){d(f)}});r.onAbort=t,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const a of t)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}}async function hj(n,e={}){return Xi(n,"GET","/v2/passwordPolicy",fa(n,e))}const fj=6;class mj{constructor(e){var t,r,a,o;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=c.minPasswordLength)!==null&&t!==void 0?t:fj,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(a=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&a!==void 0?a:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,a,o,c,d;const f={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,f),this.validatePasswordCharacterOptions(e,f),f.isValid&&(f.isValid=(t=f.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),f.isValid&&(f.isValid=(r=f.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),f.isValid&&(f.isValid=(a=f.containsLowercaseLetter)!==null&&a!==void 0?a:!0),f.isValid&&(f.isValid=(o=f.containsUppercaseLetter)!==null&&o!==void 0?o:!0),f.isValid&&(f.isValid=(c=f.containsNumericCharacter)!==null&&c!==void 0?c:!0),f.isValid&&(f.isValid=(d=f.containsNonAlphanumericCharacter)!==null&&d!==void 0?d:!0),f}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let a=0;a<e.length;a++)r=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,a,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}class gj{constructor(e,t,r,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Sw(this),this.idTokenSubscription=new Sw(this),this.beforeStateQueue=new dj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$T,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ui(t)),this._initializationPromise=this.queue(async()=>{var r,a;if(!this._deleted&&(this.persistenceManager=await Tl.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await YT(this,{idToken:e}),r=await Li._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(jr(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let a=r,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,d=a?._redirectEventId,f=await this.tryRedirectSignIn(e);(!c||c===d)&&f?.user&&(a=f.user,o=!0)}if(!a)return this.directlySetCurrentUser(null);if(!a._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(a)}catch(c){a=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return a?this.reloadAndSetCurrentUserOrClear(a):this.directlySetCurrentUser(null)}return De(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===a._redirectEventId?this.directlySetCurrentUser(a):this.reloadAndSetCurrentUserOrClear(a)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Cf(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=WD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(jr(this.app))return Promise.reject(Bi(this));const t=e?it(e):null;return t&&De(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&De(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return jr(this.app)?Promise.reject(Bi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return jr(this.app)?Promise.reject(Bi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ui(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await hj(this),t=new mj(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new xo("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await lj(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ui(e)||this._popupRedirectResolver;De(t,this,"argument-error"),this.redirectPersistenceManager=await Tl.create(this,[Ui(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,a){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(De(d,this,"internal-error"),d.then(()=>{c||o(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,r,a);return()=>{c=!0,f()}}else{const f=e.addObserver(t);return()=>{c=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return De(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=lS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&HD(`Error while retrieving App Check token: ${t.error}`),t?.token}}function ma(n){return it(n)}class Sw{constructor(e){this.auth=e,this.observer=null,this.addObserver=Dk(t=>this.observer=t)}get next(){return De(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let tm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pj(n){tm=n}function cS(n){return tm.loadJS(n)}function yj(){return tm.recaptchaEnterpriseScript}function vj(){return tm.gapiScript}function _j(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const bj="recaptcha-enterprise",xj="NO_RECAPTCHA";class wj{constructor(e){this.type=bj,this.auth=ma(e)}async verify(e="verify",t=!1){async function r(o){if(!t){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(c,d)=>{nj(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(f=>{if(f.recaptchaKey===void 0)d(new Error("recaptcha Enterprise site key undefined"));else{const p=new tj(f);return o.tenantId==null?o._agentRecaptchaConfig=p:o._tenantRecaptchaConfigs[o.tenantId]=p,c(p.siteKey)}}).catch(f=>{d(f)})})}function a(o,c,d){const f=window.grecaptcha;xw(f)?f.enterprise.ready(()=>{f.enterprise.execute(o,{action:e}).then(p=>{c(p)}).catch(()=>{c(xj)})}):d(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((o,c)=>{r(this.auth).then(d=>{if(!t&&xw(window.grecaptcha))a(d,o,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let f=yj();f.length!==0&&(f+=d),cS(f).then(()=>{a(d,o,c)}).catch(p=>{c(p)})}}).catch(d=>{c(d)})})}}async function Iw(n,e,t,r=!1){const a=new wj(n);let o;try{o=await a.verify(t)}catch{o=await a.verify(t,!0)}const c=Object.assign({},e);return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function yy(n,e,t,r){var a;if(!((a=n._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Iw(n,e,t,t==="getOobCode");return r(n,o)}else return r(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await Iw(n,e,t,t==="getOobCode");return r(n,c)}else return Promise.reject(o)})}function uS(n,e){const t=Wi(n,"auth");if(t.isInitialized()){const a=t.getImmediate(),o=t.getOptions();if(Gi(o,e??{}))return a;Sr(a,"already-initialized")}return t.initialize({options:e})}function Ej(n,e){const t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Ui);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function dS(n,e,t){const r=ma(n);De(r._canInitEmulator,r,"emulator-config-failed"),De(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const a=!1,o=hS(e),{host:c,port:d}=Tj(e),f=d===null?"":`:${d}`;r.config.emulator={url:`${o}//${c}${f}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:c,port:d,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:a})}),Sj()}function hS(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function Tj(n){const e=hS(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(r);if(a){const o=a[1];return{host:o,port:Aw(r.substr(o.length+1))}}else{const[o,c]=r.split(":");return{host:o,port:Aw(c)}}}function Aw(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function Sj(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class nm{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Mi("not implemented")}_getIdTokenResponse(e){return Mi("not implemented")}_linkToIdToken(e,t){return Mi("not implemented")}_getReauthenticationResolver(e){return Mi("not implemented")}}async function Ij(n,e){return Xi(n,"POST","/v1/accounts:signUp",e)}async function Aj(n,e){return rd(n,"POST","/v1/accounts:signInWithPassword",fa(n,e))}async function Nj(n,e){return rd(n,"POST","/v1/accounts:signInWithEmailLink",fa(n,e))}async function Cj(n,e){return rd(n,"POST","/v1/accounts:signInWithEmailLink",fa(n,e))}class Rl extends nm{constructor(e,t,r,a=null){super("password",r),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Rl(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Rl(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return yy(e,t,"signInWithPassword",Aj);case"emailLink":return Nj(e,{email:this._email,oobCode:this._password});default:Sr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return yy(e,r,"signUpPassword",Ij);case"emailLink":return Cj(e,{idToken:t,email:this._email,oobCode:this._password});default:Sr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Sl(n,e){return rd(n,"POST","/v1/accounts:signInWithIdp",fa(n,e))}const Rj="http://localhost";class na extends nm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new na(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Sr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:a}=t,o=e0(t,["providerId","signInMethod"]);if(!r||!a)return null;const c=new na(r,a);return c.idToken=o.idToken||void 0,c.accessToken=o.accessToken||void 0,c.secret=o.secret,c.nonce=o.nonce,c.pendingToken=o.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return Sl(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Sl(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Sl(e,t)}buildRequest(){const e={requestUri:Rj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=td(t)}return e}}function kj(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Dj(n){const e=xu(wu(n)).link,t=e?xu(wu(e)).deep_link_id:null,r=xu(wu(n)).deep_link_id;return(r?xu(wu(r)).link:null)||r||t||e||n}class rm{constructor(e){var t,r,a,o,c,d;const f=xu(wu(e)),p=(t=f.apiKey)!==null&&t!==void 0?t:null,v=(r=f.oobCode)!==null&&r!==void 0?r:null,b=kj((a=f.mode)!==null&&a!==void 0?a:null);De(p&&v&&b,"argument-error"),this.apiKey=p,this.operation=b,this.code=v,this.continueUrl=(o=f.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(c=f.languageCode)!==null&&c!==void 0?c:null,this.tenantId=(d=f.tenantId)!==null&&d!==void 0?d:null}static parseLink(e){const t=Dj(e);try{return new rm(t)}catch{return null}}}class wo{constructor(){this.providerId=wo.PROVIDER_ID}static credential(e,t){return Rl._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=rm.parseLink(t);return De(r,"argument-error"),Rl._fromEmailAndCode(e,r.code,r.tenantId)}}wo.PROVIDER_ID="password";wo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";wo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class a0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class id extends a0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Oi extends id{constructor(){super("facebook.com")}static credential(e){return na._fromParams({providerId:Oi.PROVIDER_ID,signInMethod:Oi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Oi.credentialFromTaggedObject(e)}static credentialFromError(e){return Oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Oi.credential(e.oauthAccessToken)}catch{return null}}}Oi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Oi.PROVIDER_ID="facebook.com";class Jr extends id{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return na._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Jr.credentialFromTaggedObject(e)}static credentialFromError(e){return Jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Jr.credential(t,r)}catch{return null}}}Jr.GOOGLE_SIGN_IN_METHOD="google.com";Jr.PROVIDER_ID="google.com";class Pi extends id{constructor(){super("github.com")}static credential(e){return na._fromParams({providerId:Pi.PROVIDER_ID,signInMethod:Pi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pi.credentialFromTaggedObject(e)}static credentialFromError(e){return Pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Pi.credential(e.oauthAccessToken)}catch{return null}}}Pi.GITHUB_SIGN_IN_METHOD="github.com";Pi.PROVIDER_ID="github.com";class Vi extends id{constructor(){super("twitter.com")}static credential(e,t){return na._fromParams({providerId:Vi.PROVIDER_ID,signInMethod:Vi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Vi.credentialFromTaggedObject(e)}static credentialFromError(e){return Vi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Vi.credential(t,r)}catch{return null}}}Vi.TWITTER_SIGN_IN_METHOD="twitter.com";Vi.PROVIDER_ID="twitter.com";async function jj(n,e){return rd(n,"POST","/v1/accounts:signUp",fa(n,e))}class lo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,a=!1){const o=await Li._fromIdTokenResponse(e,r,a),c=Nw(r);return new lo({user:o,providerId:c,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const a=Nw(r);return new lo({user:e,providerId:a,_tokenResponse:r,operationType:t})}}function Nw(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class Rf extends Ur{constructor(e,t,r,a){var o;super(t.code,t.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,Rf.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,a){return new Rf(e,t,r,a)}}function fS(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?Rf._fromErrorAndOperation(n,o,e,r):o})}async function Oj(n,e,t=!1){const r=await Cl(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return lo._forOperation(n,"link",r)}async function Pj(n,e,t=!1){const{auth:r}=n;if(jr(r.app))return Promise.reject(Bi(r));const a="reauthenticate";try{const o=await Cl(n,fS(r,a,e,n),t);De(o.idToken,r,"internal-error");const c=i0(o.idToken);De(c,r,"internal-error");const{sub:d}=c;return De(n.uid===d,r,"user-mismatch"),lo._forOperation(n,a,o)}catch(o){throw o?.code==="auth/user-not-found"&&Sr(r,"user-mismatch"),o}}async function mS(n,e,t=!1){if(jr(n.app))return Promise.reject(Bi(n));const r="signIn",a=await fS(n,r,e),o=await lo._fromIdTokenResponse(n,r,a);return t||await n._updateCurrentUser(o.user),o}async function gS(n,e){return mS(ma(n),e)}async function pS(n){const e=ma(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function yS(n,e,t){if(jr(n.app))return Promise.reject(Bi(n));const r=ma(n),c=await yy(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",jj).catch(f=>{throw f.code==="auth/password-does-not-meet-requirements"&&pS(n),f}),d=await lo._fromIdTokenResponse(r,"signIn",c);return await r._updateCurrentUser(d.user),d}function vS(n,e,t){return jr(n.app)?Promise.reject(Bi(n)):gS(it(n),wo.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&pS(n),r})}async function Vj(n,e){return Xi(n,"POST","/v1/accounts:update",e)}async function _S(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;const r=it(n),o={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},c=await Cl(r,Vj(r.auth,o));r.displayName=c.displayName||null,r.photoURL=c.photoUrl||null;const d=r.providerData.find(({providerId:f})=>f==="password");d&&(d.displayName=r.displayName,d.photoURL=r.photoURL),await r._updateTokensIfNecessary(c)}function vy(n,e){return it(n).setPersistence(e)}function bS(n,e,t,r){return it(n).onIdTokenChanged(e,t,r)}function xS(n,e,t){return it(n).beforeAuthStateChanged(e,t)}function wS(n,e,t,r){return it(n).onAuthStateChanged(e,t,r)}function ES(n){return it(n).signOut()}const kf="__sak";class TS{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(kf,"1"),this.storage.removeItem(kf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const Mj=1e3,Lj=10;class SS extends TS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=oS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),a=this.localCache[t];r!==a&&e(t,a,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,d,f)=>{this.notifyListeners(c,f)});return}const r=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const c=this.storage.getItem(r);!t&&this.localCache[r]===c||this.notifyListeners(r,c)},o=this.storage.getItem(r);uj()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,Lj):a()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},Mj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}SS.type="LOCAL";const Df=SS;class IS extends TS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}IS.type="SESSION";const o0=IS;function Uj(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class im{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(a=>a.isListeningto(e));if(t)return t;const r=new im(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:a,data:o}=t.data,c=this.handlersMap[a];if(!c?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const d=Array.from(c).map(async p=>p(t.origin,o)),f=await Uj(d);t.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}im.receivers=[];function l0(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}class zj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let o,c;return new Promise((d,f)=>{const p=l0("",20);a.port1.start();const v=setTimeout(()=>{f(new Error("unsupported_event"))},r);c={messageChannel:a,onMessage(b){const E=b;if(E.data.eventId===p)switch(E.data.status){case"ack":clearTimeout(v),o=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),d(E.data.response);break;default:clearTimeout(v),clearTimeout(o),f(new Error("invalid_response"));break}}},this.handlers.add(c),a.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[a.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}function ti(){return window}function Fj(n){ti().location.href=n}function AS(){return typeof ti().WorkerGlobalScope<"u"&&typeof ti().importScripts=="function"}async function Bj(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function qj(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Gj(){return AS()?self:null}const NS="firebaseLocalStorageDb",$j=1,jf="firebaseLocalStorage",CS="fbase_key";class sd{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function sm(n,e){return n.transaction([jf],e?"readwrite":"readonly").objectStore(jf)}function Hj(){const n=indexedDB.deleteDatabase(NS);return new sd(n).toPromise()}function _y(){const n=indexedDB.open(NS,$j);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(jf,{keyPath:CS})}catch(a){t(a)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(jf)?e(r):(r.close(),await Hj(),e(await _y()))})})}async function Cw(n,e,t){const r=sm(n,!0).put({[CS]:e,value:t});return new sd(r).toPromise()}async function Kj(n,e){const t=sm(n,!1).get(e),r=await new sd(t).toPromise();return r===void 0?null:r.value}function Rw(n,e){const t=sm(n,!0).delete(e);return new sd(t).toPromise()}const Qj=800,Yj=3;class RS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await _y(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>Yj)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return AS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=im._getInstance(Gj()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Bj(),!this.activeServiceWorker)return;this.sender=new zj(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||qj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await _y();return await Cw(e,kf,"1"),await Rw(e,kf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Cw(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>Kj(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Rw(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const o=sm(a,!1).getAll();return new sd(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:a,value:o}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(o)&&(this.notifyListeners(a,o),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Qj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}RS.type="LOCAL";const kS=RS;new nd(3e4,6e4);function DS(n,e){return e?Ui(e):(De(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class c0 extends nm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Sl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Sl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Sl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Wj(n){return mS(n.auth,new c0(n),n.bypassAuthState)}function Xj(n){const{auth:e,user:t}=n;return De(t,e,"internal-error"),Pj(t,new c0(n),n.bypassAuthState)}async function Jj(n){const{auth:e,user:t}=n;return De(t,e,"internal-error"),Oj(t,new c0(n),n.bypassAuthState)}class jS{constructor(e,t,r,a,o=!1){this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:a,tenantId:o,error:c,type:d}=e;if(c){this.reject(c);return}const f={auth:this.auth,requestUri:t,sessionId:r,tenantId:o||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Wj;case"linkViaPopup":case"linkViaRedirect":return Jj;case"reauthViaPopup":case"reauthViaRedirect":return Xj;default:Sr(this.auth,"internal-error")}}resolve(e){Hi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Hi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Zj=new nd(2e3,1e4);async function OS(n,e,t){if(jr(n.app))return Promise.reject(Or(n,"operation-not-supported-in-this-environment"));const r=ma(n);KD(n,e,a0);const a=DS(r,t);return new io(r,"signInViaPopup",e,a).executeNotNull()}class io extends jS{constructor(e,t,r,a,o){super(e,t,a,o),this.provider=r,this.authWindow=null,this.pollId=null,io.currentPopupAction&&io.currentPopupAction.cancel(),io.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return De(e,this.auth,"internal-error"),e}async onExecution(){Hi(this.filter.length===1,"Popup operations only handle one event");const e=l0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Or(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Or(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,io.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Or(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Zj.get())};e()}}io.currentPopupAction=null;const e4="pendingRedirect",df=new Map;class t4 extends jS{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=df.get(this.auth._key());if(!e){try{const r=await n4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}df.set(this.auth._key(),e)}return this.bypassAuthState||df.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function n4(n,e){const t=s4(e),r=i4(n);if(!await r._isAvailable())return!1;const a=await r._get(t)==="true";return await r._remove(t),a}function r4(n,e){df.set(n._key(),e)}function i4(n){return Ui(n._redirectPersistence)}function s4(n){return uf(e4,n.config.apiKey,n.name)}async function a4(n,e,t=!1){if(jr(n.app))return Promise.reject(Bi(n));const r=ma(n),a=DS(r,e),c=await new t4(r,a,t).execute();return c&&!t&&(delete c.user._redirectEventId,await r._persistUserIfCurrent(c.user),await r._setRedirectUser(null,e)),c}const o4=600*1e3;class l4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!c4(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!PS(e)){const a=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Or(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=o4&&this.cachedEventUids.clear(),this.cachedEventUids.has(kw(e))}saveEventToCache(e){this.cachedEventUids.add(kw(e)),this.lastProcessedEventTime=Date.now()}}function kw(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function PS({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function c4(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return PS(n);default:return!1}}async function u4(n,e={}){return Xi(n,"GET","/v1/projects",e)}const d4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,h4=/^https?/;async function f4(n){if(n.config.emulator)return;const{authorizedDomains:e}=await u4(n);for(const t of e)try{if(m4(t))return}catch{}Sr(n,"unauthorized-domain")}function m4(n){const e=my(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===r}if(!h4.test(t))return!1;if(d4.test(n))return r===n;const a=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(r)}const g4=new nd(3e4,6e4);function Dw(){const n=ti().___jsl;if(n?.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function p4(n){return new Promise((e,t)=>{var r,a,o;function c(){Dw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Dw(),t(Or(n,"network-request-failed"))},timeout:g4.get()})}if(!((a=(r=ti().gapi)===null||r===void 0?void 0:r.iframes)===null||a===void 0)&&a.Iframe)e(gapi.iframes.getContext());else if(!((o=ti().gapi)===null||o===void 0)&&o.load)c();else{const d=_j("iframefcb");return ti()[d]=()=>{gapi.load?c():t(Or(n,"network-request-failed"))},cS(`${vj()}?onload=${d}`).catch(f=>t(f))}}).catch(e=>{throw hf=null,e})}let hf=null;function y4(n){return hf=hf||p4(n),hf}const v4=new nd(5e3,15e3),_4="__/auth/iframe",b4="emulator/auth/iframe",x4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},w4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function E4(n){const e=n.config;De(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?r0(e,b4):`https://${n.config.authDomain}/${_4}`,r={apiKey:e.apiKey,appName:n.name,v:Wl},a=w4.get(n.config.apiHost);a&&(r.eid=a);const o=n._getFrameworks();return o.length&&(r.fw=o.join(",")),`${t}?${td(r).slice(1)}`}async function T4(n){const e=await y4(n),t=ti().gapi;return De(t,n,"internal-error"),e.open({where:document.body,url:E4(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:x4,dontclear:!0},r=>new Promise(async(a,o)=>{await r.restyle({setHideOnLeave:!1});const c=Or(n,"network-request-failed"),d=ti().setTimeout(()=>{o(c)},v4.get());function f(){ti().clearTimeout(d),a(r)}r.ping(f).then(f,()=>{o(c)})}))}const S4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},I4=500,A4=600,N4="_blank",C4="http://localhost";class jw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function R4(n,e,t,r=I4,a=A4){const o=Math.max((window.screen.availHeight-a)/2,0).toString(),c=Math.max((window.screen.availWidth-r)/2,0).toString();let d="";const f=Object.assign(Object.assign({},S4),{width:r.toString(),height:a.toString(),top:o,left:c}),p=rn().toLowerCase();t&&(d=nS(p)?N4:t),eS(p)&&(e=e||C4,f.scrollbars="yes");const v=Object.entries(f).reduce((E,[S,R])=>`${E}${S}=${R},`,"");if(cj(p)&&d!=="_self")return k4(e||"",d),new jw(null);const b=window.open(e||"",d,v);De(b,n,"popup-blocked");try{b.focus()}catch{}return new jw(b)}function k4(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}const D4="__/auth/handler",j4="emulator/auth/handler",O4=encodeURIComponent("fac");async function Ow(n,e,t,r,a,o){De(n.config.authDomain,n,"auth-domain-config-required"),De(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Wl,eventId:a};if(e instanceof a0){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",kk(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[v,b]of Object.entries({}))c[v]=b}if(e instanceof id){const v=e.getScopes().filter(b=>b!=="");v.length>0&&(c.scopes=v.join(","))}n.tenantId&&(c.tid=n.tenantId);const d=c;for(const v of Object.keys(d))d[v]===void 0&&delete d[v];const f=await n._getAppCheckToken(),p=f?`#${O4}=${encodeURIComponent(f)}`:"";return`${P4(n)}?${td(d).slice(1)}${p}`}function P4({config:n}){return n.emulator?r0(n,j4):`https://${n.authDomain}/${D4}`}const Wp="webStorageSupport";class V4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=o0,this._completeRedirectFn=a4,this._overrideRedirectResult=r4}async _openPopup(e,t,r,a){var o;Hi((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const c=await Ow(e,t,r,my(),a);return R4(e,c,l0())}async _openRedirect(e,t,r,a){await this._originValidation(e);const o=await Ow(e,t,r,my(),a);return Fj(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:a,promise:o}=this.eventManagers[t];return a?Promise.resolve(a):(Hi(o,"If manager is not set, promise should be"),o)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await T4(e),r=new l4(e);return t.register("authEvent",a=>(De(a?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Wp,{type:Wp},a=>{var o;const c=(o=a?.[0])===null||o===void 0?void 0:o[Wp];c!==void 0&&t(!!c),Sr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=f4(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return oS()||tS()||s0()}}const VS=V4;var Pw="@firebase/auth",Vw="1.7.9";class M4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){De(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function L4(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function U4(n){ii(new Vr("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=r.options;De(c&&!c.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:c,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lS(n)},p=new gj(r,a,o,f);return Ej(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),ii(new Vr("auth-internal",e=>{const t=ma(e.getProvider("auth").getImmediate());return(r=>new M4(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Er(Pw,Vw,L4(n)),Er(Pw,Vw,"esm2017")}const z4=300,F4=jT("authIdTokenMaxAge")||z4;let Mw=null;const B4=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>F4)return;const a=t?.token;Mw!==a&&(Mw=a,await fetch(n,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function MS(n=Zy()){const e=Wi(n,"auth");if(e.isInitialized())return e.getImmediate();const t=uS(n,{popupRedirectResolver:VS,persistence:[kS,Df,o0]}),r=jT("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(r,location.origin);if(location.origin===o.origin){const c=B4(o.toString());xS(t,c,()=>c(t.currentUser)),bS(t,d=>c(d))}}const a=kT("auth");return a&&dS(t,`http://${a}`),t}function q4(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}pj({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=a=>{const o=Or("internal-error");o.customData=a,t(o)},r.type="text/javascript",r.charset="UTF-8",q4().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});U4("Browser");const G4=Object.freeze(Object.defineProperty({__proto__:null,ActionCodeURL:rm,AuthCredential:nm,EmailAuthCredential:Rl,EmailAuthProvider:wo,FacebookAuthProvider:Oi,GithubAuthProvider:Pi,GoogleAuthProvider:Jr,OAuthCredential:na,TwitterAuthProvider:Vi,beforeAuthStateChanged:xS,browserLocalPersistence:Df,browserPopupRedirectResolver:VS,browserSessionPersistence:o0,connectAuthEmulator:dS,createUserWithEmailAndPassword:yS,getAuth:MS,getIdTokenResult:WT,inMemoryPersistence:py,indexedDBLocalPersistence:kS,initializeAuth:uS,onAuthStateChanged:wS,onIdTokenChanged:bS,prodErrorMap:GT,reload:XT,setPersistence:vy,signInWithCredential:gS,signInWithEmailAndPassword:vS,signInWithPopup:OS,signOut:ES,updateProfile:_S},Symbol.toStringTag,{value:"Module"}));var $4="firebase",H4="10.14.1";Er($4,H4,"app");var Lw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};var ao,LS;(function(){var n;function e(D,C){function O(){}O.prototype=C.prototype,D.D=C.prototype,D.prototype=new O,D.prototype.constructor=D,D.C=function(z,M,P){for(var k=Array(arguments.length-2),Ne=2;Ne<arguments.length;Ne++)k[Ne-2]=arguments[Ne];return C.prototype[M].apply(z,k)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(D,C,O){O||(O=0);var z=Array(16);if(typeof C=="string")for(var M=0;16>M;++M)z[M]=C.charCodeAt(O++)|C.charCodeAt(O++)<<8|C.charCodeAt(O++)<<16|C.charCodeAt(O++)<<24;else for(M=0;16>M;++M)z[M]=C[O++]|C[O++]<<8|C[O++]<<16|C[O++]<<24;C=D.g[0],O=D.g[1],M=D.g[2];var P=D.g[3],k=C+(P^O&(M^P))+z[0]+3614090360&4294967295;C=O+(k<<7&4294967295|k>>>25),k=P+(M^C&(O^M))+z[1]+3905402710&4294967295,P=C+(k<<12&4294967295|k>>>20),k=M+(O^P&(C^O))+z[2]+606105819&4294967295,M=P+(k<<17&4294967295|k>>>15),k=O+(C^M&(P^C))+z[3]+3250441966&4294967295,O=M+(k<<22&4294967295|k>>>10),k=C+(P^O&(M^P))+z[4]+4118548399&4294967295,C=O+(k<<7&4294967295|k>>>25),k=P+(M^C&(O^M))+z[5]+1200080426&4294967295,P=C+(k<<12&4294967295|k>>>20),k=M+(O^P&(C^O))+z[6]+2821735955&4294967295,M=P+(k<<17&4294967295|k>>>15),k=O+(C^M&(P^C))+z[7]+4249261313&4294967295,O=M+(k<<22&4294967295|k>>>10),k=C+(P^O&(M^P))+z[8]+1770035416&4294967295,C=O+(k<<7&4294967295|k>>>25),k=P+(M^C&(O^M))+z[9]+2336552879&4294967295,P=C+(k<<12&4294967295|k>>>20),k=M+(O^P&(C^O))+z[10]+4294925233&4294967295,M=P+(k<<17&4294967295|k>>>15),k=O+(C^M&(P^C))+z[11]+2304563134&4294967295,O=M+(k<<22&4294967295|k>>>10),k=C+(P^O&(M^P))+z[12]+1804603682&4294967295,C=O+(k<<7&4294967295|k>>>25),k=P+(M^C&(O^M))+z[13]+4254626195&4294967295,P=C+(k<<12&4294967295|k>>>20),k=M+(O^P&(C^O))+z[14]+2792965006&4294967295,M=P+(k<<17&4294967295|k>>>15),k=O+(C^M&(P^C))+z[15]+1236535329&4294967295,O=M+(k<<22&4294967295|k>>>10),k=C+(M^P&(O^M))+z[1]+4129170786&4294967295,C=O+(k<<5&4294967295|k>>>27),k=P+(O^M&(C^O))+z[6]+3225465664&4294967295,P=C+(k<<9&4294967295|k>>>23),k=M+(C^O&(P^C))+z[11]+643717713&4294967295,M=P+(k<<14&4294967295|k>>>18),k=O+(P^C&(M^P))+z[0]+3921069994&4294967295,O=M+(k<<20&4294967295|k>>>12),k=C+(M^P&(O^M))+z[5]+3593408605&4294967295,C=O+(k<<5&4294967295|k>>>27),k=P+(O^M&(C^O))+z[10]+38016083&4294967295,P=C+(k<<9&4294967295|k>>>23),k=M+(C^O&(P^C))+z[15]+3634488961&4294967295,M=P+(k<<14&4294967295|k>>>18),k=O+(P^C&(M^P))+z[4]+3889429448&4294967295,O=M+(k<<20&4294967295|k>>>12),k=C+(M^P&(O^M))+z[9]+568446438&4294967295,C=O+(k<<5&4294967295|k>>>27),k=P+(O^M&(C^O))+z[14]+3275163606&4294967295,P=C+(k<<9&4294967295|k>>>23),k=M+(C^O&(P^C))+z[3]+4107603335&4294967295,M=P+(k<<14&4294967295|k>>>18),k=O+(P^C&(M^P))+z[8]+1163531501&4294967295,O=M+(k<<20&4294967295|k>>>12),k=C+(M^P&(O^M))+z[13]+2850285829&4294967295,C=O+(k<<5&4294967295|k>>>27),k=P+(O^M&(C^O))+z[2]+4243563512&4294967295,P=C+(k<<9&4294967295|k>>>23),k=M+(C^O&(P^C))+z[7]+1735328473&4294967295,M=P+(k<<14&4294967295|k>>>18),k=O+(P^C&(M^P))+z[12]+2368359562&4294967295,O=M+(k<<20&4294967295|k>>>12),k=C+(O^M^P)+z[5]+4294588738&4294967295,C=O+(k<<4&4294967295|k>>>28),k=P+(C^O^M)+z[8]+2272392833&4294967295,P=C+(k<<11&4294967295|k>>>21),k=M+(P^C^O)+z[11]+1839030562&4294967295,M=P+(k<<16&4294967295|k>>>16),k=O+(M^P^C)+z[14]+4259657740&4294967295,O=M+(k<<23&4294967295|k>>>9),k=C+(O^M^P)+z[1]+2763975236&4294967295,C=O+(k<<4&4294967295|k>>>28),k=P+(C^O^M)+z[4]+1272893353&4294967295,P=C+(k<<11&4294967295|k>>>21),k=M+(P^C^O)+z[7]+4139469664&4294967295,M=P+(k<<16&4294967295|k>>>16),k=O+(M^P^C)+z[10]+3200236656&4294967295,O=M+(k<<23&4294967295|k>>>9),k=C+(O^M^P)+z[13]+681279174&4294967295,C=O+(k<<4&4294967295|k>>>28),k=P+(C^O^M)+z[0]+3936430074&4294967295,P=C+(k<<11&4294967295|k>>>21),k=M+(P^C^O)+z[3]+3572445317&4294967295,M=P+(k<<16&4294967295|k>>>16),k=O+(M^P^C)+z[6]+76029189&4294967295,O=M+(k<<23&4294967295|k>>>9),k=C+(O^M^P)+z[9]+3654602809&4294967295,C=O+(k<<4&4294967295|k>>>28),k=P+(C^O^M)+z[12]+3873151461&4294967295,P=C+(k<<11&4294967295|k>>>21),k=M+(P^C^O)+z[15]+530742520&4294967295,M=P+(k<<16&4294967295|k>>>16),k=O+(M^P^C)+z[2]+3299628645&4294967295,O=M+(k<<23&4294967295|k>>>9),k=C+(M^(O|~P))+z[0]+4096336452&4294967295,C=O+(k<<6&4294967295|k>>>26),k=P+(O^(C|~M))+z[7]+1126891415&4294967295,P=C+(k<<10&4294967295|k>>>22),k=M+(C^(P|~O))+z[14]+2878612391&4294967295,M=P+(k<<15&4294967295|k>>>17),k=O+(P^(M|~C))+z[5]+4237533241&4294967295,O=M+(k<<21&4294967295|k>>>11),k=C+(M^(O|~P))+z[12]+1700485571&4294967295,C=O+(k<<6&4294967295|k>>>26),k=P+(O^(C|~M))+z[3]+2399980690&4294967295,P=C+(k<<10&4294967295|k>>>22),k=M+(C^(P|~O))+z[10]+4293915773&4294967295,M=P+(k<<15&4294967295|k>>>17),k=O+(P^(M|~C))+z[1]+2240044497&4294967295,O=M+(k<<21&4294967295|k>>>11),k=C+(M^(O|~P))+z[8]+1873313359&4294967295,C=O+(k<<6&4294967295|k>>>26),k=P+(O^(C|~M))+z[15]+4264355552&4294967295,P=C+(k<<10&4294967295|k>>>22),k=M+(C^(P|~O))+z[6]+2734768916&4294967295,M=P+(k<<15&4294967295|k>>>17),k=O+(P^(M|~C))+z[13]+1309151649&4294967295,O=M+(k<<21&4294967295|k>>>11),k=C+(M^(O|~P))+z[4]+4149444226&4294967295,C=O+(k<<6&4294967295|k>>>26),k=P+(O^(C|~M))+z[11]+3174756917&4294967295,P=C+(k<<10&4294967295|k>>>22),k=M+(C^(P|~O))+z[2]+718787259&4294967295,M=P+(k<<15&4294967295|k>>>17),k=O+(P^(M|~C))+z[9]+3951481745&4294967295,D.g[0]=D.g[0]+C&4294967295,D.g[1]=D.g[1]+(M+(k<<21&4294967295|k>>>11))&4294967295,D.g[2]=D.g[2]+M&4294967295,D.g[3]=D.g[3]+P&4294967295}r.prototype.u=function(D,C){C===void 0&&(C=D.length);for(var O=C-this.blockSize,z=this.B,M=this.h,P=0;P<C;){if(M==0)for(;P<=O;)a(this,D,P),P+=this.blockSize;if(typeof D=="string"){for(;P<C;)if(z[M++]=D.charCodeAt(P++),M==this.blockSize){a(this,z),M=0;break}}else for(;P<C;)if(z[M++]=D[P++],M==this.blockSize){a(this,z),M=0;break}}this.h=M,this.o+=C},r.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var C=1;C<D.length-8;++C)D[C]=0;var O=8*this.o;for(C=D.length-8;C<D.length;++C)D[C]=O&255,O/=256;for(this.u(D),D=Array(16),C=O=0;4>C;++C)for(var z=0;32>z;z+=8)D[O++]=this.g[C]>>>z&255;return D};function o(D,C){var O=d;return Object.prototype.hasOwnProperty.call(O,D)?O[D]:O[D]=C(D)}function c(D,C){this.h=C;for(var O=[],z=!0,M=D.length-1;0<=M;M--){var P=D[M]|0;z&&P==C||(O[M]=P,z=!1)}this.g=O}var d={};function f(D){return-128<=D&&128>D?o(D,function(C){return new c([C|0],0>C?-1:0)}):new c([D|0],0>D?-1:0)}function p(D){if(isNaN(D)||!isFinite(D))return b;if(0>D)return N(p(-D));for(var C=[],O=1,z=0;D>=O;z++)C[z]=D/O|0,O*=4294967296;return new c(C,0)}function v(D,C){if(D.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(D.charAt(0)=="-")return N(v(D.substring(1),C));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var O=p(Math.pow(C,8)),z=b,M=0;M<D.length;M+=8){var P=Math.min(8,D.length-M),k=parseInt(D.substring(M,M+P),C);8>P?(P=p(Math.pow(C,P)),z=z.j(P).add(p(k))):(z=z.j(O),z=z.add(p(k)))}return z}var b=f(0),E=f(1),S=f(16777216);n=c.prototype,n.m=function(){if(j(this))return-N(this).m();for(var D=0,C=1,O=0;O<this.g.length;O++){var z=this.i(O);D+=(0<=z?z:4294967296+z)*C,C*=4294967296}return D},n.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(R(this))return"0";if(j(this))return"-"+N(this).toString(D);for(var C=p(Math.pow(D,6)),O=this,z="";;){var M=de(O,C).g;O=I(O,M.j(C));var P=((0<O.g.length?O.g[0]:O.h)>>>0).toString(D);if(O=M,R(O))return P+z;for(;6>P.length;)P="0"+P;z=P+z}},n.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function R(D){if(D.h!=0)return!1;for(var C=0;C<D.g.length;C++)if(D.g[C]!=0)return!1;return!0}function j(D){return D.h==-1}n.l=function(D){return D=I(this,D),j(D)?-1:R(D)?0:1};function N(D){for(var C=D.g.length,O=[],z=0;z<C;z++)O[z]=~D.g[z];return new c(O,~D.h).add(E)}n.abs=function(){return j(this)?N(this):this},n.add=function(D){for(var C=Math.max(this.g.length,D.g.length),O=[],z=0,M=0;M<=C;M++){var P=z+(this.i(M)&65535)+(D.i(M)&65535),k=(P>>>16)+(this.i(M)>>>16)+(D.i(M)>>>16);z=k>>>16,P&=65535,k&=65535,O[M]=k<<16|P}return new c(O,O[O.length-1]&-2147483648?-1:0)};function I(D,C){return D.add(N(C))}n.j=function(D){if(R(this)||R(D))return b;if(j(this))return j(D)?N(this).j(N(D)):N(N(this).j(D));if(j(D))return N(this.j(N(D)));if(0>this.l(S)&&0>D.l(S))return p(this.m()*D.m());for(var C=this.g.length+D.g.length,O=[],z=0;z<2*C;z++)O[z]=0;for(z=0;z<this.g.length;z++)for(var M=0;M<D.g.length;M++){var P=this.i(z)>>>16,k=this.i(z)&65535,Ne=D.i(M)>>>16,Ze=D.i(M)&65535;O[2*z+2*M]+=k*Ze,te(O,2*z+2*M),O[2*z+2*M+1]+=P*Ze,te(O,2*z+2*M+1),O[2*z+2*M+1]+=k*Ne,te(O,2*z+2*M+1),O[2*z+2*M+2]+=P*Ne,te(O,2*z+2*M+2)}for(z=0;z<C;z++)O[z]=O[2*z+1]<<16|O[2*z];for(z=C;z<2*C;z++)O[z]=0;return new c(O,0)};function te(D,C){for(;(D[C]&65535)!=D[C];)D[C+1]+=D[C]>>>16,D[C]&=65535,C++}function X(D,C){this.g=D,this.h=C}function de(D,C){if(R(C))throw Error("division by zero");if(R(D))return new X(b,b);if(j(D))return C=de(N(D),C),new X(N(C.g),N(C.h));if(j(C))return C=de(D,N(C)),new X(N(C.g),C.h);if(30<D.g.length){if(j(D)||j(C))throw Error("slowDivide_ only works with positive integers.");for(var O=E,z=C;0>=z.l(D);)O=ve(O),z=ve(z);var M=ge(O,1),P=ge(z,1);for(z=ge(z,2),O=ge(O,2);!R(z);){var k=P.add(z);0>=k.l(D)&&(M=M.add(O),P=k),z=ge(z,1),O=ge(O,1)}return C=I(D,M.j(C)),new X(M,C)}for(M=b;0<=D.l(C);){for(O=Math.max(1,Math.floor(D.m()/C.m())),z=Math.ceil(Math.log(O)/Math.LN2),z=48>=z?1:Math.pow(2,z-48),P=p(O),k=P.j(C);j(k)||0<k.l(D);)O-=z,P=p(O),k=P.j(C);R(P)&&(P=E),M=M.add(P),D=I(D,k)}return new X(M,D)}n.A=function(D){return de(this,D).h},n.and=function(D){for(var C=Math.max(this.g.length,D.g.length),O=[],z=0;z<C;z++)O[z]=this.i(z)&D.i(z);return new c(O,this.h&D.h)},n.or=function(D){for(var C=Math.max(this.g.length,D.g.length),O=[],z=0;z<C;z++)O[z]=this.i(z)|D.i(z);return new c(O,this.h|D.h)},n.xor=function(D){for(var C=Math.max(this.g.length,D.g.length),O=[],z=0;z<C;z++)O[z]=this.i(z)^D.i(z);return new c(O,this.h^D.h)};function ve(D){for(var C=D.g.length+1,O=[],z=0;z<C;z++)O[z]=D.i(z)<<1|D.i(z-1)>>>31;return new c(O,D.h)}function ge(D,C){var O=C>>5;C%=32;for(var z=D.g.length-O,M=[],P=0;P<z;P++)M[P]=0<C?D.i(P+O)>>>C|D.i(P+O+1)<<32-C:D.i(P+O);return new c(M,D.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,LS=r,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=p,c.fromString=v,ao=c}).apply(typeof Lw<"u"?Lw:typeof self<"u"?self:typeof window<"u"?window:{});var Jh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};var US,Eu,zS,ff,by,FS,BS,qS;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,_,w){return h==Array.prototype||h==Object.prototype||(h[_]=w.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Jh=="object"&&Jh];for(var _=0;_<h.length;++_){var w=h[_];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var r=t(this);function a(h,_){if(_)e:{var w=r;h=h.split(".");for(var A=0;A<h.length-1;A++){var Y=h[A];if(!(Y in w))break e;w=w[Y]}h=h[h.length-1],A=w[h],_=_(A),_!=A&&_!=null&&e(w,h,{configurable:!0,writable:!0,value:_})}}function o(h,_){h instanceof String&&(h+="");var w=0,A=!1,Y={next:function(){if(!A&&w<h.length){var ie=w++;return{value:_(ie,h[ie]),done:!1}}return A=!0,{done:!0,value:void 0}}};return Y[Symbol.iterator]=function(){return Y},Y}a("Array.prototype.values",function(h){return h||function(){return o(this,function(_,w){return w})}});var c=c||{},d=this||self;function f(h){var _=typeof h;return _=_!="object"?_:h?Array.isArray(h)?"array":_:"null",_=="array"||_=="object"&&typeof h.length=="number"}function p(h){var _=typeof h;return _=="object"&&h!=null||_=="function"}function v(h,_,w){return h.call.apply(h.bind,arguments)}function b(h,_,w){if(!h)throw Error();if(2<arguments.length){var A=Array.prototype.slice.call(arguments,2);return function(){var Y=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Y,A),h.apply(_,Y)}}return function(){return h.apply(_,arguments)}}function E(h,_,w){return E=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?v:b,E.apply(null,arguments)}function S(h,_){var w=Array.prototype.slice.call(arguments,1);return function(){var A=w.slice();return A.push.apply(A,arguments),h.apply(this,A)}}function R(h,_){function w(){}w.prototype=_.prototype,h.aa=_.prototype,h.prototype=new w,h.prototype.constructor=h,h.Qb=function(A,Y,ie){for(var ye=Array(arguments.length-2),at=2;at<arguments.length;at++)ye[at-2]=arguments[at];return _.prototype[Y].apply(A,ye)}}function j(h){const _=h.length;if(0<_){const w=Array(_);for(let A=0;A<_;A++)w[A]=h[A];return w}return[]}function N(h,_){for(let w=1;w<arguments.length;w++){const A=arguments[w];if(f(A)){const Y=h.length||0,ie=A.length||0;h.length=Y+ie;for(let ye=0;ye<ie;ye++)h[Y+ye]=A[ye]}else h.push(A)}}class I{constructor(_,w){this.i=_,this.j=w,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function te(h){return/^[\s\xa0]*$/.test(h)}function X(){var h=d.navigator;return h&&(h=h.userAgent)?h:""}function de(h){return de[" "](h),h}de[" "]=function(){};var ve=X().indexOf("Gecko")!=-1&&!(X().toLowerCase().indexOf("webkit")!=-1&&X().indexOf("Edge")==-1)&&!(X().indexOf("Trident")!=-1||X().indexOf("MSIE")!=-1)&&X().indexOf("Edge")==-1;function ge(h,_,w){for(const A in h)_.call(w,h[A],A,h)}function D(h,_){for(const w in h)_.call(void 0,h[w],w,h)}function C(h){const _={};for(const w in h)_[w]=h[w];return _}const O="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function z(h,_){let w,A;for(let Y=1;Y<arguments.length;Y++){A=arguments[Y];for(w in A)h[w]=A[w];for(let ie=0;ie<O.length;ie++)w=O[ie],Object.prototype.hasOwnProperty.call(A,w)&&(h[w]=A[w])}}function M(h){var _=1;h=h.split(":");const w=[];for(;0<_&&h.length;)w.push(h.shift()),_--;return h.length&&w.push(h.join(":")),w}function P(h){d.setTimeout(()=>{throw h},0)}function k(){var h=Re;let _=null;return h.g&&(_=h.g,h.g=h.g.next,h.g||(h.h=null),_.next=null),_}class Ne{constructor(){this.h=this.g=null}add(_,w){const A=Ze.get();A.set(_,w),this.h?this.h.next=A:this.g=A,this.h=A}}var Ze=new I(()=>new B,h=>h.reset());class B{constructor(){this.next=this.g=this.h=null}set(_,w){this.h=_,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let ue,pe=!1,Re=new Ne,Pe=()=>{const h=d.Promise.resolve(void 0);ue=()=>{h.then(q)}};var q=()=>{for(var h;h=k();){try{h.h.call(h.g)}catch(w){P(w)}var _=Ze;_.j(h),100>_.h&&(_.h++,h.next=_.g,_.g=h)}pe=!1};function F(){this.s=this.s,this.C=this.C}F.prototype.s=!1,F.prototype.ma=function(){this.s||(this.s=!0,this.N())},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(h,_){this.type=h,this.g=this.target=_,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var Q=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var h=!1,_=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const w=()=>{};d.addEventListener("test",w,_),d.removeEventListener("test",w,_)}catch{}return h})();function oe(h,_){if(L.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var w=this.type=h.type,A=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=_,_=h.relatedTarget){if(ve){e:{try{de(_.nodeName);var Y=!0;break e}catch{}Y=!1}Y||(_=null)}}else w=="mouseover"?_=h.fromElement:w=="mouseout"&&(_=h.toElement);this.relatedTarget=_,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:se[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&oe.aa.h.call(this)}}R(oe,L);var se={2:"touch",3:"pen",4:"mouse"};oe.prototype.h=function(){oe.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var $="closure_listenable_"+(1e6*Math.random()|0),W=0;function me(h,_,w,A,Y){this.listener=h,this.proxy=null,this.src=_,this.type=w,this.capture=!!A,this.ha=Y,this.key=++W,this.da=this.fa=!1}function Se(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Fe(h){this.src=h,this.g={},this.h=0}Fe.prototype.add=function(h,_,w,A,Y){var ie=h.toString();h=this.g[ie],h||(h=this.g[ie]=[],this.h++);var ye=zt(h,_,A,Y);return-1<ye?(_=h[ye],w||(_.fa=!1)):(_=new me(_,this.src,ie,!!A,Y),_.fa=w,h.push(_)),_};function jt(h,_){var w=_.type;if(w in h.g){var A=h.g[w],Y=Array.prototype.indexOf.call(A,_,void 0),ie;(ie=0<=Y)&&Array.prototype.splice.call(A,Y,1),ie&&(Se(_),h.g[w].length==0&&(delete h.g[w],h.h--))}}function zt(h,_,w,A){for(var Y=0;Y<h.length;++Y){var ie=h[Y];if(!ie.da&&ie.listener==_&&ie.capture==!!w&&ie.ha==A)return Y}return-1}var Rt="closure_lm_"+(1e6*Math.random()|0),ai={};function Io(h,_,w,A,Y){if(Array.isArray(_)){for(var ie=0;ie<_.length;ie++)Io(h,_[ie],w,A,Y);return null}return w=Ed(w),h&&h[$]?h.K(_,w,p(A)?!!A.capture:!1,Y):jm(h,_,w,!1,A,Y)}function jm(h,_,w,A,Y,ie){if(!_)throw Error("Invalid event type");var ye=p(Y)?!!Y.capture:!!Y,at=uc(h);if(at||(h[Rt]=at=new Fe(h)),w=at.add(_,w,A,ye,ie),w.proxy)return w;if(A=wd(),w.proxy=A,A.src=h,A.listener=w,h.addEventListener)Q||(Y=ye),Y===void 0&&(Y=!1),h.addEventListener(_.toString(),A,Y);else if(h.attachEvent)h.attachEvent(No(_.toString()),A);else if(h.addListener&&h.removeListener)h.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return w}function wd(){function h(w){return _.call(h.src,h.listener,w)}const _=Om;return h}function Ao(h,_,w,A,Y){if(Array.isArray(_))for(var ie=0;ie<_.length;ie++)Ao(h,_[ie],w,A,Y);else A=p(A)?!!A.capture:!!A,w=Ed(w),h&&h[$]?(h=h.i,_=String(_).toString(),_ in h.g&&(ie=h.g[_],w=zt(ie,w,A,Y),-1<w&&(Se(ie[w]),Array.prototype.splice.call(ie,w,1),ie.length==0&&(delete h.g[_],h.h--)))):h&&(h=uc(h))&&(_=h.g[_.toString()],h=-1,_&&(h=zt(_,w,A,Y)),(w=-1<h?_[h]:null)&&wa(w))}function wa(h){if(typeof h!="number"&&h&&!h.da){var _=h.src;if(_&&_[$])jt(_.i,h);else{var w=h.type,A=h.proxy;_.removeEventListener?_.removeEventListener(w,A,h.capture):_.detachEvent?_.detachEvent(No(w),A):_.addListener&&_.removeListener&&_.removeListener(A),(w=uc(_))?(jt(w,h),w.h==0&&(w.src=null,_[Rt]=null)):Se(h)}}}function No(h){return h in ai?ai[h]:ai[h]="on"+h}function Om(h,_){if(h.da)h=!0;else{_=new oe(_,this);var w=h.listener,A=h.ha||h.src;h.fa&&wa(h),h=w.call(A,_)}return h}function uc(h){return h=h[Rt],h instanceof Fe?h:null}var gn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ed(h){return typeof h=="function"?h:(h[gn]||(h[gn]=function(_){return h.handleEvent(_)}),h[gn])}function en(){F.call(this),this.i=new Fe(this),this.M=this,this.F=null}R(en,F),en.prototype[$]=!0,en.prototype.removeEventListener=function(h,_,w,A){Ao(this,h,_,w,A)};function an(h,_){var w,A=h.F;if(A)for(w=[];A;A=A.F)w.push(A);if(h=h.M,A=_.type||_,typeof _=="string")_=new L(_,h);else if(_ instanceof L)_.target=_.target||h;else{var Y=_;_=new L(A,h),z(_,Y)}if(Y=!0,w)for(var ie=w.length-1;0<=ie;ie--){var ye=_.g=w[ie];Y=oi(ye,A,!0,_)&&Y}if(ye=_.g=h,Y=oi(ye,A,!0,_)&&Y,Y=oi(ye,A,!1,_)&&Y,w)for(ie=0;ie<w.length;ie++)ye=_.g=w[ie],Y=oi(ye,A,!1,_)&&Y}en.prototype.N=function(){if(en.aa.N.call(this),this.i){var h=this.i,_;for(_ in h.g){for(var w=h.g[_],A=0;A<w.length;A++)Se(w[A]);delete h.g[_],h.h--}}this.F=null},en.prototype.K=function(h,_,w,A){return this.i.add(String(h),_,!1,w,A)},en.prototype.L=function(h,_,w,A){return this.i.add(String(h),_,!0,w,A)};function oi(h,_,w,A){if(_=h.i.g[String(_)],!_)return!0;_=_.concat();for(var Y=!0,ie=0;ie<_.length;++ie){var ye=_[ie];if(ye&&!ye.da&&ye.capture==w){var at=ye.listener,Kt=ye.ha||ye.src;ye.fa&&jt(h.i,ye),Y=at.call(Kt,A)!==!1&&Y}}return Y&&!A.defaultPrevented}function Td(h,_,w){if(typeof h=="function")w&&(h=E(h,w));else if(h&&typeof h.handleEvent=="function")h=E(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:d.setTimeout(h,_||0)}function dc(h){h.g=Td(()=>{h.g=null,h.i&&(h.i=!1,dc(h))},h.l);const _=h.h;h.h=null,h.m.apply(null,_)}class Pm extends F{constructor(_,w){super(),this.m=_,this.l=w,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:dc(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ea(h){F.call(this),this.h=h,this.g={}}R(Ea,F);var ns=[];function Sn(h){ge(h.g,function(_,w){this.g.hasOwnProperty(w)&&wa(_)},h),h.g={}}Ea.prototype.N=function(){Ea.aa.N.call(this),Sn(this)},Ea.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var cr=d.JSON.stringify,Dn=d.JSON.parse,Vm=class{stringify(h){return d.JSON.stringify(h,void 0)}parse(h){return d.JSON.parse(h,void 0)}};function hc(){}hc.prototype.h=null;function Sd(h){return h.h||(h.h=h.i())}function Ta(){}var zr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function rs(){L.call(this,"d")}R(rs,L);function Ir(){L.call(this,"c")}R(Ir,L);var ur={},is=null;function Co(){return is=is||new en}ur.La="serverreachability";function fc(h){L.call(this,ur.La,h)}R(fc,L);function li(h){const _=Co();an(_,new fc(_))}ur.STAT_EVENT="statevent";function ss(h,_){L.call(this,ur.STAT_EVENT,h),this.stat=_}R(ss,L);function pn(h){const _=Co();an(_,new ss(_,h))}ur.Ma="timingevent";function mc(h,_){L.call(this,ur.Ma,h),this.size=_}R(mc,L);function as(h,_){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){h()},_)}function os(){this.g=!0}os.prototype.xa=function(){this.g=!1};function gc(h,_,w,A,Y,ie){h.info(function(){if(h.g)if(ie)for(var ye="",at=ie.split("&"),Kt=0;Kt<at.length;Kt++){var ze=at[Kt].split("=");if(1<ze.length){var ln=ze[0];ze=ze[1];var cn=ln.split("_");ye=2<=cn.length&&cn[1]=="type"?ye+(ln+"="+ze+"&"):ye+(ln+"=redacted&")}}else ye=null;else ye=ie;return"XMLHTTP REQ ("+A+") [attempt "+Y+"]: "+_+`
`+w+`
`+ye})}function pc(h,_,w,A,Y,ie,ye){h.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+Y+"]: "+_+`
`+w+`
`+ie+" "+ye})}function ci(h,_,w,A){h.info(function(){return"XMLHTTP TEXT ("+_+"): "+Fr(h,w)+(A?" "+A:"")})}function Id(h,_){h.info(function(){return"TIMEOUT: "+_})}os.prototype.info=function(){};function Fr(h,_){if(!h.g)return _;if(!_)return null;try{var w=JSON.parse(_);if(w){for(h=0;h<w.length;h++)if(Array.isArray(w[h])){var A=w[h];if(!(2>A.length)){var Y=A[1];if(Array.isArray(Y)&&!(1>Y.length)){var ie=Y[0];if(ie!="noop"&&ie!="stop"&&ie!="close")for(var ye=1;ye<Y.length;ye++)Y[ye]=""}}}}return cr(w)}catch{return _}}var Ot={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},yn={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Br;function ls(){}R(ls,hc),ls.prototype.g=function(){return new XMLHttpRequest},ls.prototype.i=function(){return{}},Br=new ls;function qr(h,_,w,A){this.j=h,this.i=_,this.l=w,this.R=A||1,this.U=new Ea(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ad}function Ad(){this.i=null,this.g="",this.h=!1}var yc={},ui={};function Sa(h,_,w){h.L=1,h.v=Na(Pt(_)),h.m=w,h.P=!0,di(h,null)}function di(h,_){h.F=Date.now(),Ar(h),h.A=Pt(h.v);var w=h.A,A=h.R;Array.isArray(A)||(A=[String(A)]),mi(w.i,"t",A),h.C=0,w=h.j.J,h.h=new Ad,h.g=qd(h.j,w?_:null,!h.m),0<h.O&&(h.M=new Pm(E(h.Y,h,h.g),h.O)),_=h.U,w=h.g,A=h.ca;var Y="readystatechange";Array.isArray(Y)||(Y&&(ns[0]=Y.toString()),Y=ns);for(var ie=0;ie<Y.length;ie++){var ye=Io(w,Y[ie],A||_.handleEvent,!1,_.h||_);if(!ye)break;_.g[ye.key]=ye}_=h.H?C(h.H):{},h.m?(h.u||(h.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,_)):(h.u="GET",h.g.ea(h.A,h.u,null,_)),li(),gc(h.i,h.u,h.A,h.l,h.R,h.m)}qr.prototype.ca=function(h){h=h.target;const _=this.M;_&&Pn(h)==3?_.j():this.Y(h)},qr.prototype.Y=function(h){try{if(h==this.g)e:{const cn=Pn(this.g);var _=this.g.Ba();const xs=this.g.Z();if(!(3>cn)&&(cn!=3||this.g&&(this.h.h||this.g.oa()||ka(this.g)))){this.J||cn!=4||_==7||(_==8||0>=xs?li(3):li(2)),Ro(this);var w=this.g.Z();this.X=w;t:if(hi(this)){var A=ka(this.g);h="";var Y=A.length,ie=Pn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){jn(this),cs(this);var ye="";break t}this.h.i=new d.TextDecoder}for(_=0;_<Y;_++)this.h.h=!0,h+=this.h.i.decode(A[_],{stream:!(ie&&_==Y-1)});A.length=0,this.h.g+=h,this.C=0,ye=this.h.g}else ye=this.g.oa();if(this.o=w==200,pc(this.i,this.u,this.A,this.l,this.R,cn,w),this.o){if(this.T&&!this.K){t:{if(this.g){var at,Kt=this.g;if((at=Kt.g?Kt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!te(at)){var ze=at;break t}}ze=null}if(w=ze)ci(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Gr(this,w);else{this.o=!1,this.s=3,pn(12),jn(this),cs(this);break e}}if(this.P){w=!0;let zn;for(;!this.J&&this.C<ye.length;)if(zn=Ia(this,ye),zn==ui){cn==4&&(this.s=4,pn(14),w=!1),ci(this.i,this.l,null,"[Incomplete Response]");break}else if(zn==yc){this.s=4,pn(15),ci(this.i,this.l,ye,"[Invalid Chunk]"),w=!1;break}else ci(this.i,this.l,zn,null),Gr(this,zn);if(hi(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),cn!=4||ye.length!=0||this.h.h||(this.s=1,pn(16),w=!1),this.o=this.o&&w,!w)ci(this.i,this.l,ye,"[Invalid Chunked Response]"),jn(this),cs(this);else if(0<ye.length&&!this.W){this.W=!0;var ln=this.j;ln.g==this&&ln.ba&&!ln.M&&(ln.j.info("Great, no buffering proxy detected. Bytes received: "+ye.length),Nc(ln),ln.M=!0,pn(11))}}else ci(this.i,this.l,ye,null),Gr(this,ye);cn==4&&jn(this),this.o&&!this.J&&(cn==4?zd(this.j,this):(this.o=!1,Ar(this)))}else Od(this.g),w==400&&0<ye.indexOf("Unknown SID")?(this.s=3,pn(12)):(this.s=0,pn(13)),jn(this),cs(this)}}}catch{}finally{}};function hi(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Ia(h,_){var w=h.C,A=_.indexOf(`
`,w);return A==-1?ui:(w=Number(_.substring(w,A)),isNaN(w)?yc:(A+=1,A+w>_.length?ui:(_=_.slice(A,A+w),h.C=A+w,_)))}qr.prototype.cancel=function(){this.J=!0,jn(this)};function Ar(h){h.S=Date.now()+h.I,Ft(h,h.I)}function Ft(h,_){if(h.B!=null)throw Error("WatchDog timer not null");h.B=as(E(h.ba,h),_)}function Ro(h){h.B&&(d.clearTimeout(h.B),h.B=null)}qr.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(Id(this.i,this.A),this.L!=2&&(li(),pn(17)),jn(this),this.s=2,cs(this)):Ft(this,this.S-h)};function cs(h){h.j.G==0||h.J||zd(h.j,h)}function jn(h){Ro(h);var _=h.M;_&&typeof _.ma=="function"&&_.ma(),h.M=null,Sn(h.U),h.g&&(_=h.g,h.g=null,_.abort(),_.ma())}function Gr(h,_){try{var w=h.j;if(w.G!=0&&(w.g==h||us(w.h,h))){if(!h.K&&us(w.h,h)&&w.G==3){try{var A=w.Da.g.parse(_)}catch{A=null}if(Array.isArray(A)&&A.length==3){var Y=A;if(Y[0]==0){e:if(!w.u){if(w.g)if(w.g.F+3e3<h.F)_s(w),vs(w);else break e;Ac(w),pn(18)}}else w.za=Y[1],0<w.za-w.T&&37500>Y[2]&&w.F&&w.v==0&&!w.C&&(w.C=as(E(w.Za,w),6e3));if(1>=Nd(w.h)&&w.ca){try{w.ca()}catch{}w.ca=void 0}}else pi(w,11)}else if((h.K||w.g==h)&&_s(w),!te(_))for(Y=w.Da.g.parse(_),_=0;_<Y.length;_++){let ze=Y[_];if(w.T=ze[0],ze=ze[1],w.G==2)if(ze[0]=="c"){w.K=ze[1],w.ia=ze[2];const ln=ze[3];ln!=null&&(w.la=ln,w.j.info("VER="+w.la));const cn=ze[4];cn!=null&&(w.Aa=cn,w.j.info("SVER="+w.Aa));const xs=ze[5];xs!=null&&typeof xs=="number"&&0<xs&&(A=1.5*xs,w.L=A,w.j.info("backChannelRequestTimeoutMs_="+A)),A=w;const zn=h.g;if(zn){const Oa=zn.g?zn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Oa){var ie=A.h;ie.g||Oa.indexOf("spdy")==-1&&Oa.indexOf("quic")==-1&&Oa.indexOf("h2")==-1||(ie.j=ie.l,ie.g=new Set,ie.h&&(ds(ie,ie.h),ie.h=null))}if(A.D){const yi=zn.g?zn.g.getResponseHeader("X-HTTP-Session-Id"):null;yi&&(A.ya=yi,et(A.I,A.D,yi))}}w.G=3,w.l&&w.l.ua(),w.ba&&(w.R=Date.now()-h.F,w.j.info("Handshake RTT: "+w.R+"ms")),A=w;var ye=h;if(A.qa=Bd(A,A.J?A.ia:null,A.W),ye.K){dr(A.h,ye);var at=ye,Kt=A.L;Kt&&(at.I=Kt),at.B&&(Ro(at),Ar(at)),A.g=ye}else Ld(A);0<w.i.length&&Lo(w)}else ze[0]!="stop"&&ze[0]!="close"||pi(w,7);else w.G==3&&(ze[0]=="stop"||ze[0]=="close"?ze[0]=="stop"?pi(w,7):Sc(w):ze[0]!="noop"&&w.l&&w.l.ta(ze),w.v=0)}}li(4)}catch{}}var Mm=class{constructor(h,_){this.g=h,this.map=_}};function vc(h){this.l=h||10,d.PerformanceNavigationTiming?(h=d.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function _c(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Nd(h){return h.h?1:h.g?h.g.size:0}function us(h,_){return h.h?h.h==_:h.g?h.g.has(_):!1}function ds(h,_){h.g?h.g.add(_):h.h=_}function dr(h,_){h.h&&h.h==_?h.h=null:h.g&&h.g.has(_)&&h.g.delete(_)}vc.prototype.cancel=function(){if(this.i=On(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function On(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let _=h.i;for(const w of h.g.values())_=_.concat(w.D);return _}return j(h.i)}function Cd(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(f(h)){for(var _=[],w=h.length,A=0;A<w;A++)_.push(h[A]);return _}_=[],w=0;for(A in h)_[w++]=h[A];return _}function Lm(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(f(h)||typeof h=="string"){var _=[];h=h.length;for(var w=0;w<h;w++)_.push(w);return _}_=[],w=0;for(const A in h)_[w++]=A;return _}}}function ko(h,_){if(h.forEach&&typeof h.forEach=="function")h.forEach(_,void 0);else if(f(h)||typeof h=="string")Array.prototype.forEach.call(h,_,void 0);else for(var w=Lm(h),A=Cd(h),Y=A.length,ie=0;ie<Y;ie++)_.call(void 0,A[ie],w&&w[ie],h)}var bc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Do(h,_){if(h){h=h.split("&");for(var w=0;w<h.length;w++){var A=h[w].indexOf("="),Y=null;if(0<=A){var ie=h[w].substring(0,A);Y=h[w].substring(A+1)}else ie=h[w];_(ie,Y?decodeURIComponent(Y.replace(/\+/g," ")):"")}}}function fi(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof fi){this.h=h.h,hs(this,h.j),this.o=h.o,this.g=h.g,Aa(this,h.s),this.l=h.l;var _=h.i,w=new $r;w.i=_.i,_.g&&(w.g=new Map(_.g),w.h=_.h),jo(this,w),this.m=h.m}else h&&(_=String(h).match(bc))?(this.h=!1,hs(this,_[1]||"",!0),this.o=fs(_[2]||""),this.g=fs(_[3]||"",!0),Aa(this,_[4]),this.l=fs(_[5]||"",!0),jo(this,_[6]||"",!0),this.m=fs(_[7]||"")):(this.h=!1,this.i=new $r(null,this.h))}fi.prototype.toString=function(){var h=[],_=this.j;_&&h.push(hr(_,xc,!0),":");var w=this.g;return(w||_=="file")&&(h.push("//"),(_=this.o)&&h.push(hr(_,xc,!0),"@"),h.push(encodeURIComponent(String(w)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.s,w!=null&&h.push(":",String(w))),(w=this.l)&&(this.g&&w.charAt(0)!="/"&&h.push("/"),h.push(hr(w,w.charAt(0)=="/"?wc:Rd,!0))),(w=this.i.toString())&&h.push("?",w),(w=this.m)&&h.push("#",hr(w,Fm)),h.join("")};function Pt(h){return new fi(h)}function hs(h,_,w){h.j=w?fs(_,!0):_,h.j&&(h.j=h.j.replace(/:$/,""))}function Aa(h,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);h.s=_}else h.s=null}function jo(h,_,w){_ instanceof $r?(h.i=_,kd(h.i,h.h)):(w||(_=hr(_,zm)),h.i=new $r(_,h.h))}function et(h,_,w){h.i.set(_,w)}function Na(h){return et(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function fs(h,_){return h?_?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function hr(h,_,w){return typeof h=="string"?(h=encodeURI(h).replace(_,Um),w&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function Um(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var xc=/[#\/\?@]/g,Rd=/[#\?:]/g,wc=/[#\?]/g,zm=/[#\?@]/g,Fm=/#/g;function $r(h,_){this.h=this.g=null,this.i=h||null,this.j=!!_}function on(h){h.g||(h.g=new Map,h.h=0,h.i&&Do(h.i,function(_,w){h.add(decodeURIComponent(_.replace(/\+/g," ")),w)}))}n=$r.prototype,n.add=function(h,_){on(this),this.i=null,h=Yn(this,h);var w=this.g.get(h);return w||this.g.set(h,w=[]),w.push(_),this.h+=1,this};function Oo(h,_){on(h),_=Yn(h,_),h.g.has(_)&&(h.i=null,h.h-=h.g.get(_).length,h.g.delete(_))}function Po(h,_){return on(h),_=Yn(h,_),h.g.has(_)}n.forEach=function(h,_){on(this),this.g.forEach(function(w,A){w.forEach(function(Y){h.call(_,Y,A,this)},this)},this)},n.na=function(){on(this);const h=Array.from(this.g.values()),_=Array.from(this.g.keys()),w=[];for(let A=0;A<_.length;A++){const Y=h[A];for(let ie=0;ie<Y.length;ie++)w.push(_[A])}return w},n.V=function(h){on(this);let _=[];if(typeof h=="string")Po(this,h)&&(_=_.concat(this.g.get(Yn(this,h))));else{h=Array.from(this.g.values());for(let w=0;w<h.length;w++)_=_.concat(h[w])}return _},n.set=function(h,_){return on(this),this.i=null,h=Yn(this,h),Po(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[_]),this.h+=1,this},n.get=function(h,_){return h?(h=this.V(h),0<h.length?String(h[0]):_):_};function mi(h,_,w){Oo(h,_),0<w.length&&(h.i=null,h.g.set(Yn(h,_),j(w)),h.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],_=Array.from(this.g.keys());for(var w=0;w<_.length;w++){var A=_[w];const ie=encodeURIComponent(String(A)),ye=this.V(A);for(A=0;A<ye.length;A++){var Y=ie;ye[A]!==""&&(Y+="="+encodeURIComponent(String(ye[A]))),h.push(Y)}}return this.i=h.join("&")};function Yn(h,_){return _=String(_),h.j&&(_=_.toLowerCase()),_}function kd(h,_){_&&!h.j&&(on(h),h.i=null,h.g.forEach(function(w,A){var Y=A.toLowerCase();A!=Y&&(Oo(this,A),mi(this,Y,w))},h)),h.j=_}function Ec(h,_){const w=new os;if(d.Image){const A=new Image;A.onload=S(Un,w,"TestLoadImage: loaded",!0,_,A),A.onerror=S(Un,w,"TestLoadImage: error",!1,_,A),A.onabort=S(Un,w,"TestLoadImage: abort",!1,_,A),A.ontimeout=S(Un,w,"TestLoadImage: timeout",!1,_,A),d.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=h}else _(!1)}function Dd(h,_){const w=new os,A=new AbortController,Y=setTimeout(()=>{A.abort(),Un(w,"TestPingServer: timeout",!1,_)},1e4);fetch(h,{signal:A.signal}).then(ie=>{clearTimeout(Y),ie.ok?Un(w,"TestPingServer: ok",!0,_):Un(w,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(Y),Un(w,"TestPingServer: error",!1,_)})}function Un(h,_,w,A,Y){try{Y&&(Y.onload=null,Y.onerror=null,Y.onabort=null,Y.ontimeout=null),A(w)}catch{}}function Nr(){this.g=new Vm}function Tc(h,_,w){const A=w||"";try{ko(h,function(Y,ie){let ye=Y;p(Y)&&(ye=cr(Y)),_.push(A+ie+"="+encodeURIComponent(ye))})}catch(Y){throw _.push(A+"type="+encodeURIComponent("_badmap")),Y}}function Hr(h){this.l=h.Ub||null,this.j=h.eb||!1}R(Hr,hc),Hr.prototype.g=function(){return new Wn(this.l,this.j)},Hr.prototype.i=(function(h){return function(){return h}})({});function Wn(h,_){en.call(this),this.D=h,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(Wn,en),n=Wn.prototype,n.open=function(h,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=_,this.readyState=1,ms(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(_.body=h),(this.D||d).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Kr(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,ms(this)),this.g&&(this.readyState=3,ms(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vo(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Vo(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var _=h.value?h.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!h.done}))&&(this.response=this.responseText+=_)}h.done?Kr(this):ms(this),this.readyState==3&&Vo(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,Kr(this))},n.Qa=function(h){this.g&&(this.response=h,Kr(this))},n.ga=function(){this.g&&Kr(this)};function Kr(h){h.readyState=4,h.l=null,h.j=null,h.v=null,ms(h)}n.setRequestHeader=function(h,_){this.u.append(h,_)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],_=this.h.entries();for(var w=_.next();!w.done;)w=w.value,h.push(w[0]+": "+w[1]),w=_.next();return h.join(`\r
`)};function ms(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Wn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Ca(h){let _="";return ge(h,function(w,A){_+=A,_+=":",_+=w,_+=`\r
`}),_}function gs(h,_,w){e:{for(A in w){var A=!1;break e}A=!0}A||(w=Ca(w),typeof h=="string"?w!=null&&encodeURIComponent(String(w)):et(h,_,w))}function _t(h){en.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(_t,en);var In=/^https?$/i,gi=["POST","PUT"];n=_t.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,_,w,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);_=_?_.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Br.g(),this.v=this.o?Sd(this.o):Sd(Br),this.g.onreadystatechange=E(this.Ea,this);try{this.B=!0,this.g.open(_,String(h),!0),this.B=!1}catch(ie){Ra(this,ie);return}if(h=w||"",w=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var Y in A)w.set(Y,A[Y]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const ie of A.keys())w.set(ie,A.get(ie));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(w.keys()).find(ie=>ie.toLowerCase()=="content-type"),Y=d.FormData&&h instanceof d.FormData,!(0<=Array.prototype.indexOf.call(gi,_,void 0))||A||Y||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ie,ye]of w)this.g.setRequestHeader(ie,ye);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Mo(this),this.u=!0,this.g.send(h),this.u=!1}catch(ie){Ra(this,ie)}};function Ra(h,_){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=_,h.m=5,ps(h),ys(h)}function ps(h){h.A||(h.A=!0,an(h,"complete"),an(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,an(this,"complete"),an(this,"abort"),ys(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ys(this,!0)),_t.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?jd(this):this.bb())},n.bb=function(){jd(this)};function jd(h){if(h.h&&typeof c<"u"&&(!h.v[1]||Pn(h)!=4||h.Z()!=2)){if(h.u&&Pn(h)==4)Td(h.Ea,0,h);else if(an(h,"readystatechange"),Pn(h)==4){h.h=!1;try{const ye=h.Z();e:switch(ye){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var w;if(!(w=_)){var A;if(A=ye===0){var Y=String(h.D).match(bc)[1]||null;!Y&&d.self&&d.self.location&&(Y=d.self.location.protocol.slice(0,-1)),A=!In.test(Y?Y.toLowerCase():"")}w=A}if(w)an(h,"complete"),an(h,"success");else{h.m=6;try{var ie=2<Pn(h)?h.g.statusText:""}catch{ie=""}h.l=ie+" ["+h.Z()+"]",ps(h)}}finally{ys(h)}}}}function ys(h,_){if(h.g){Mo(h);const w=h.g,A=h.v[0]?()=>{}:null;h.g=null,h.v=null,_||an(h,"ready");try{w.onreadystatechange=A}catch{}}}function Mo(h){h.I&&(d.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function Pn(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<Pn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var _=this.g.responseText;return h&&_.indexOf(h)==0&&(_=_.substring(h.length)),Dn(_)}};function ka(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function Od(h){const _={};h=(h.g&&2<=Pn(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<h.length;A++){if(te(h[A]))continue;var w=M(h[A]);const Y=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const ie=_[Y]||[];_[Y]=ie,ie.push(w)}D(_,function(A){return A.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Da(h,_,w){return w&&w.internalChannelParams&&w.internalChannelParams[h]||_}function Pd(h){this.Aa=0,this.i=[],this.j=new os,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Da("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Da("baseRetryDelayMs",5e3,h),this.cb=Da("retryDelaySeedMs",1e4,h),this.Wa=Da("forwardChannelMaxRetries",2,h),this.wa=Da("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new vc(h&&h.concurrentRequestLimit),this.Da=new Nr,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Pd.prototype,n.la=8,n.G=1,n.connect=function(h,_,w,A){pn(0),this.W=h,this.H=_||{},w&&A!==void 0&&(this.H.OSID=w,this.H.OAID=A),this.F=this.X,this.I=Bd(this,null,this.W),Lo(this)};function Sc(h){if(Vd(h),h.G==3){var _=h.U++,w=Pt(h.I);if(et(w,"SID",h.K),et(w,"RID",_),et(w,"TYPE","terminate"),ja(h,w),_=new qr(h,h.j,_),_.L=2,_.v=Na(Pt(w)),w=!1,d.navigator&&d.navigator.sendBeacon)try{w=d.navigator.sendBeacon(_.v.toString(),"")}catch{}!w&&d.Image&&(new Image().src=_.v,w=!0),w||(_.g=qd(_.j,null),_.g.ea(_.v)),_.F=Date.now(),Ar(_)}Cc(h)}function vs(h){h.g&&(Nc(h),h.g.cancel(),h.g=null)}function Vd(h){vs(h),h.u&&(d.clearTimeout(h.u),h.u=null),_s(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&d.clearTimeout(h.s),h.s=null)}function Lo(h){if(!_c(h.h)&&!h.s){h.s=!0;var _=h.Ga;ue||Pe(),pe||(ue(),pe=!0),Re.add(_,h),h.B=0}}function Bm(h,_){return Nd(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=_.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=as(E(h.Ga,h,_),Fd(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const Y=new qr(this,this.j,h);let ie=this.o;if(this.S&&(ie?(ie=C(ie),z(ie,this.S)):ie=this.S),this.m!==null||this.O||(Y.H=ie,ie=null),this.P)e:{for(var _=0,w=0;w<this.i.length;w++){t:{var A=this.i[w];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(_+=A,4096<_){_=w;break e}if(_===4096||w===this.i.length-1){_=w+1;break e}}_=1e3}else _=1e3;_=Ic(this,Y,_),w=Pt(this.I),et(w,"RID",h),et(w,"CVER",22),this.D&&et(w,"X-HTTP-Session-Id",this.D),ja(this,w),ie&&(this.O?_="headers="+encodeURIComponent(String(Ca(ie)))+"&"+_:this.m&&gs(w,this.m,ie)),ds(this.h,Y),this.Ua&&et(w,"TYPE","init"),this.P?(et(w,"$req",_),et(w,"SID","null"),Y.T=!0,Sa(Y,w,null)):Sa(Y,w,_),this.G=2}}else this.G==3&&(h?Md(this,h):this.i.length==0||_c(this.h)||Md(this))};function Md(h,_){var w;_?w=_.l:w=h.U++;const A=Pt(h.I);et(A,"SID",h.K),et(A,"RID",w),et(A,"AID",h.T),ja(h,A),h.m&&h.o&&gs(A,h.m,h.o),w=new qr(h,h.j,w,h.B+1),h.m===null&&(w.H=h.o),_&&(h.i=_.D.concat(h.i)),_=Ic(h,w,1e3),w.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),ds(h.h,w),Sa(w,A,_)}function ja(h,_){h.H&&ge(h.H,function(w,A){et(_,A,w)}),h.l&&ko({},function(w,A){et(_,A,w)})}function Ic(h,_,w){w=Math.min(h.i.length,w);var A=h.l?E(h.l.Na,h.l,h):null;e:{var Y=h.i;let ie=-1;for(;;){const ye=["count="+w];ie==-1?0<w?(ie=Y[0].g,ye.push("ofs="+ie)):ie=0:ye.push("ofs="+ie);let at=!0;for(let Kt=0;Kt<w;Kt++){let ze=Y[Kt].g;const ln=Y[Kt].map;if(ze-=ie,0>ze)ie=Math.max(0,Y[Kt].g-100),at=!1;else try{Tc(ln,ye,"req"+ze+"_")}catch{A&&A(ln)}}if(at){A=ye.join("&");break e}}}return h=h.i.splice(0,w),_.D=h,A}function Ld(h){if(!h.g&&!h.u){h.Y=1;var _=h.Fa;ue||Pe(),pe||(ue(),pe=!0),Re.add(_,h),h.v=0}}function Ac(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=as(E(h.Fa,h),Fd(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,Ud(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=as(E(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,pn(10),vs(this),Ud(this))};function Nc(h){h.A!=null&&(d.clearTimeout(h.A),h.A=null)}function Ud(h){h.g=new qr(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var _=Pt(h.qa);et(_,"RID","rpc"),et(_,"SID",h.K),et(_,"AID",h.T),et(_,"CI",h.F?"0":"1"),!h.F&&h.ja&&et(_,"TO",h.ja),et(_,"TYPE","xmlhttp"),ja(h,_),h.m&&h.o&&gs(_,h.m,h.o),h.L&&(h.g.I=h.L);var w=h.g;h=h.ia,w.L=1,w.v=Na(Pt(_)),w.m=null,w.P=!0,di(w,h)}n.Za=function(){this.C!=null&&(this.C=null,vs(this),Ac(this),pn(19))};function _s(h){h.C!=null&&(d.clearTimeout(h.C),h.C=null)}function zd(h,_){var w=null;if(h.g==_){_s(h),Nc(h),h.g=null;var A=2}else if(us(h.h,_))w=_.D,dr(h.h,_),A=1;else return;if(h.G!=0){if(_.o)if(A==1){w=_.m?_.m.length:0,_=Date.now()-_.F;var Y=h.B;A=Co(),an(A,new mc(A,w)),Lo(h)}else Ld(h);else if(Y=_.s,Y==3||Y==0&&0<_.X||!(A==1&&Bm(h,_)||A==2&&Ac(h)))switch(w&&0<w.length&&(_=h.h,_.i=_.i.concat(w)),Y){case 1:pi(h,5);break;case 4:pi(h,10);break;case 3:pi(h,6);break;default:pi(h,2)}}}function Fd(h,_){let w=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(w*=2),w*_}function pi(h,_){if(h.j.info("Error code "+_),_==2){var w=E(h.fb,h),A=h.Xa;const Y=!A;A=new fi(A||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||hs(A,"https"),Na(A),Y?Ec(A.toString(),w):Dd(A.toString(),w)}else pn(2);h.G=0,h.l&&h.l.sa(_),Cc(h),Vd(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),pn(2)):(this.j.info("Failed to ping google.com"),pn(1))};function Cc(h){if(h.G=0,h.ka=[],h.l){const _=On(h.h);(_.length!=0||h.i.length!=0)&&(N(h.ka,_),N(h.ka,h.i),h.h.i.length=0,j(h.i),h.i.length=0),h.l.ra()}}function Bd(h,_,w){var A=w instanceof fi?Pt(w):new fi(w);if(A.g!="")_&&(A.g=_+"."+A.g),Aa(A,A.s);else{var Y=d.location;A=Y.protocol,_=_?_+"."+Y.hostname:Y.hostname,Y=+Y.port;var ie=new fi(null);A&&hs(ie,A),_&&(ie.g=_),Y&&Aa(ie,Y),w&&(ie.l=w),A=ie}return w=h.D,_=h.ya,w&&_&&et(A,w,_),et(A,"VER",h.la),ja(h,A),A}function qd(h,_,w){if(_&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=h.Ca&&!h.pa?new _t(new Hr({eb:w})):new _t(h.pa),_.Ha(h.J),_}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gd(){}n=Gd.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Uo(){}Uo.prototype.g=function(h,_){return new Vn(h,_)};function Vn(h,_){en.call(this),this.g=new Pd(_),this.l=h,this.h=_&&_.messageUrlParams||null,h=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(h?h["X-WebChannel-Content-Type"]=_.messageContentType:h={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(h?h["X-WebChannel-Client-Profile"]=_.va:h={"X-WebChannel-Client-Profile":_.va}),this.g.S=h,(h=_&&_.Sb)&&!te(h)&&(this.g.m=h),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!te(_)&&(this.g.D=_,h=this.h,h!==null&&_ in h&&(h=this.h,_ in h&&delete h[_])),this.j=new bs(this)}R(Vn,en),Vn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Vn.prototype.close=function(){Sc(this.g)},Vn.prototype.o=function(h){var _=this.g;if(typeof h=="string"){var w={};w.__data__=h,h=w}else this.u&&(w={},w.__data__=cr(h),h=w);_.i.push(new Mm(_.Ya++,h)),_.G==3&&Lo(_)},Vn.prototype.N=function(){this.g.l=null,delete this.j,Sc(this.g),delete this.g,Vn.aa.N.call(this)};function $d(h){rs.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var _=h.__sm__;if(_){e:{for(const w in _){h=w;break e}h=void 0}(this.i=h)&&(h=this.i,_=_!==null&&h in _?_[h]:void 0),this.data=_}else this.data=h}R($d,rs);function Hd(){Ir.call(this),this.status=1}R(Hd,Ir);function bs(h){this.g=h}R(bs,Gd),bs.prototype.ua=function(){an(this.g,"a")},bs.prototype.ta=function(h){an(this.g,new $d(h))},bs.prototype.sa=function(h){an(this.g,new Hd)},bs.prototype.ra=function(){an(this.g,"b")},Uo.prototype.createWebChannel=Uo.prototype.g,Vn.prototype.send=Vn.prototype.o,Vn.prototype.open=Vn.prototype.m,Vn.prototype.close=Vn.prototype.close,qS=function(){return new Uo},BS=function(){return Co()},FS=ur,by={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ot.NO_ERROR=0,Ot.TIMEOUT=8,Ot.HTTP_ERROR=6,ff=Ot,yn.COMPLETE="complete",zS=yn,Ta.EventType=zr,zr.OPEN="a",zr.CLOSE="b",zr.ERROR="c",zr.MESSAGE="d",en.prototype.listen=en.prototype.K,Eu=Ta,_t.prototype.listenOnce=_t.prototype.L,_t.prototype.getLastError=_t.prototype.Ka,_t.prototype.getLastErrorCode=_t.prototype.Ba,_t.prototype.getStatus=_t.prototype.Z,_t.prototype.getResponseJson=_t.prototype.Oa,_t.prototype.getResponseText=_t.prototype.oa,_t.prototype.send=_t.prototype.ea,_t.prototype.setWithCredentials=_t.prototype.Ha,US=_t}).apply(typeof Jh<"u"?Jh:typeof self<"u"?self:typeof window<"u"?window:{});const Uw="@firebase/firestore";class hn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}hn.UNAUTHENTICATED=new hn(null),hn.GOOGLE_CREDENTIALS=new hn("google-credentials-uid"),hn.FIRST_PARTY=new hn("first-party-uid"),hn.MOCK_USER=new hn("mock-user");let Xl="10.14.0";const ra=new em("@firebase/firestore");function vl(){return ra.logLevel}function K4(n){ra.setLogLevel(n)}function fe(n,...e){if(ra.logLevel<=Qe.DEBUG){const t=e.map(u0);ra.debug(`Firestore (${Xl}): ${n}`,...t)}}function $t(n,...e){if(ra.logLevel<=Qe.ERROR){const t=e.map(u0);ra.error(`Firestore (${Xl}): ${n}`,...t)}}function sr(n,...e){if(ra.logLevel<=Qe.WARN){const t=e.map(u0);ra.warn(`Firestore (${Xl}): ${n}`,...t)}}function u0(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function we(n="Unexpected state"){const e=`FIRESTORE (${Xl}) INTERNAL ASSERTION FAILED: `+n;throw $t(e),new Error(e)}function Te(n,e){n||we()}function Q4(n,e){n||we()}function _e(n,e){return n}const ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class he extends Ur{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class fn{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class GS{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class $S{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(hn.UNAUTHENTICATED)))}shutdown(){}}class Y4{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class W4{constructor(e){this.t=e,this.currentUser=hn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Te(this.o===void 0);let r=this.i;const a=f=>this.i!==r?(r=this.i,t(f)):Promise.resolve();let o=new fn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new fn,e.enqueueRetryable((()=>a(this.currentUser)))};const c=()=>{const f=o;e.enqueueRetryable((async()=>{await f.promise,await a(this.currentUser)}))},d=f=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((f=>d(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new fn)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Te(typeof r.accessToken=="string"),new GS(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Te(e===null||typeof e=="string"),new hn(e)}}class X4{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=hn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class J4{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new X4(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(hn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class HS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Z4{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Te(this.o===void 0);const r=o=>{o.error!=null&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const c=o.token!==this.R;return this.R=o.token,fe("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>r(o)))};const a=o=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((o=>a(o))),setTimeout((()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?a(o):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(Te(typeof t.token=="string"),this.R=t.token,new HS(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class eO{getToken(){return Promise.resolve(new HS(""))}invalidateToken(){}start(e,t){}shutdown(){}}function tO(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class d0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const a=tO(40);for(let o=0;o<a.length;++o)r.length<20&&a[o]<t&&(r+=e.charAt(a[o]%e.length))}return r}}function je(n,e){return n<e?-1:n>e?1:0}function kl(n,e,t){return n.length===e.length&&n.every(((r,a)=>t(r,e[a])))}function KS(n){return n+"\0"}class Be{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new he(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new he(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new he(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new he(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Be.fromMillis(Date.now())}static fromDate(e){return Be.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Be(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?je(this.nanoseconds,e.nanoseconds):je(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ae{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ae(e)}static min(){return new Ae(new Be(0,0))}static max(){return new Ae(new Be(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Fu{constructor(e,t,r){t===void 0?t=0:t>e.length&&we(),r===void 0?r=e.length-t:r>e.length-t&&we(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Fu.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Fu?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let a=0;a<r;a++){const o=e.get(a),c=t.get(a);if(o<c)return-1;if(o>c)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ye extends Fu{construct(e,t,r){return new Ye(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new he(ne.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((a=>a.length>0)))}return new Ye(t)}static emptyPath(){return new Ye([])}}const nO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Tt extends Fu{construct(e,t,r){return new Tt(e,t,r)}static isValidIdentifier(e){return nO.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Tt.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Tt(["__name__"])}static fromServerFormat(e){const t=[];let r="",a=0;const o=()=>{if(r.length===0)throw new he(ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let c=!1;for(;a<e.length;){const d=e[a];if(d==="\\"){if(a+1===e.length)throw new he(ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[a+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new he(ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,a+=2}else d==="`"?(c=!c,a++):d!=="."||c?(r+=d,a++):(o(),a++)}if(o(),c)throw new he(ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Tt(t)}static emptyPath(){return new Tt([])}}class be{constructor(e){this.path=e}static fromPath(e){return new be(Ye.fromString(e))}static fromName(e){return new be(Ye.fromString(e).popFirst(5))}static empty(){return new be(Ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ye.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new be(new Ye(e.slice()))}}class Dl{constructor(e,t,r,a){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=a}}function xy(n){return n.fields.find((e=>e.kind===2))}function Ja(n){return n.fields.filter((e=>e.kind!==2))}function rO(n,e){let t=je(n.collectionGroup,e.collectionGroup);if(t!==0)return t;for(let r=0;r<Math.min(n.fields.length,e.fields.length);++r)if(t=iO(n.fields[r],e.fields[r]),t!==0)return t;return je(n.fields.length,e.fields.length)}Dl.UNKNOWN_ID=-1;class oo{constructor(e,t){this.fieldPath=e,this.kind=t}}function iO(n,e){const t=Tt.comparator(n.fieldPath,e.fieldPath);return t!==0?t:je(n.kind,e.kind)}class jl{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new jl(0,ar.min())}}function QS(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,a=Ae.fromTimestamp(r===1e9?new Be(t+1,0):new Be(t,r));return new ar(a,be.empty(),e)}function YS(n){return new ar(n.readTime,n.key,-1)}class ar{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ar(Ae.min(),be.empty(),-1)}static max(){return new ar(Ae.max(),be.empty(),-1)}}function h0(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=be.comparator(n.documentKey,e.documentKey),t!==0?t:je(n.largestBatchId,e.largestBatchId))}const WS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class XS{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function ga(n){if(n.code!==ne.FAILED_PRECONDITION||n.message!==WS)throw n;fe("LocalStore","Unexpectedly lost primary lease")}class K{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&we(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new K(((r,a)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,a)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,a)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof K?t:K.resolve(t)}catch(t){return K.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):K.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):K.reject(t)}static resolve(e){return new K(((t,r)=>{t(e)}))}static reject(e){return new K(((t,r)=>{r(e)}))}static waitFor(e){return new K(((t,r)=>{let a=0,o=0,c=!1;e.forEach((d=>{++a,d.next((()=>{++o,c&&o===a&&t()}),(f=>r(f)))})),c=!0,o===a&&t()}))}static or(e){let t=K.resolve(!1);for(const r of e)t=t.next((a=>a?K.resolve(a):r()));return t}static forEach(e,t){const r=[];return e.forEach(((a,o)=>{r.push(t.call(this,a,o))})),this.waitFor(r)}static mapArray(e,t){return new K(((r,a)=>{const o=e.length,c=new Array(o);let d=0;for(let f=0;f<o;f++){const p=f;t(e[p]).next((v=>{c[p]=v,++d,d===o&&r(c)}),(v=>a(v)))}}))}static doWhile(e,t){return new K(((r,a)=>{const o=()=>{e()===!0?t().next((()=>{o()}),a):r()};o()}))}}class am{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new fn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Ru(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const a=f0(r.target.error);this.V.reject(new Ru(e,a))}}static open(e,t,r,a){try{return new am(t,e.transaction(a,r))}catch(o){throw new Ru(t,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(fe("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new aO(t)}}class ni{constructor(e,t,r){this.name=e,this.version=t,this.p=r,ni.S(rn())===12.2&&$t("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return fe("SimpleDb","Removing database:",e),Za(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Xy())return!1;if(ni.v())return!0;const e=rn(),t=ni.S(e),r=0<t&&t<10,a=JS(e),o=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(fe("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,r)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=o=>{const c=o.target.result;t(c)},a.onblocked=()=>{r(new Ru(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=o=>{const c=o.target.error;c.name==="VersionError"?r(new he(ne.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):c.name==="InvalidStateError"?r(new he(ne.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c)):r(new Ru(e,c))},a.onupgradeneeded=o=>{fe("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const c=o.target.result;this.p.O(c,a.transaction,o.oldVersion,this.version).next((()=>{fe("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,a){const o=t==="readonly";let c=0;for(;;){++c;try{this.db=await this.M(e);const d=am.open(this.db,e,o?"readonly":"readwrite",r),f=a(d).next((p=>(d.g(),p))).catch((p=>(d.abort(p),K.reject(p)))).toPromise();return f.catch((()=>{})),await d.m,f}catch(d){const f=d,p=f.name!=="FirebaseError"&&c<3;if(fe("SimpleDb","Transaction failed with error:",f.message,"Retrying:",p),this.close(),!p)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function JS(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class sO{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Za(this.B.delete())}}class Ru extends he{constructor(e,t){super(ne.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function pa(n){return n.name==="IndexedDbTransactionError"}class aO{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(fe("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(fe("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Za(r)}add(e){return fe("SimpleDb","ADD",this.store.name,e,e),Za(this.store.add(e))}get(e){return Za(this.store.get(e)).next((t=>(t===void 0&&(t=null),fe("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return fe("SimpleDb","DELETE",this.store.name,e),Za(this.store.delete(e))}count(){return fe("SimpleDb","COUNT",this.store.name),Za(this.store.count())}U(e,t){const r=this.options(e,t),a=r.index?this.store.index(r.index):this.store;if(typeof a.getAll=="function"){const o=a.getAll(r.range);return new K(((c,d)=>{o.onerror=f=>{d(f.target.error)},o.onsuccess=f=>{c(f.target.result)}}))}{const o=this.cursor(r),c=[];return this.W(o,((d,f)=>{c.push(f)})).next((()=>c))}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new K(((a,o)=>{r.onerror=c=>{o(c.target.error)},r.onsuccess=c=>{a(c.target.result)}}))}j(e,t){fe("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const a=this.cursor(r);return this.W(a,((o,c,d)=>d.delete()))}J(e,t){let r;t?r=e:(r={},t=e);const a=this.cursor(r);return this.W(a,t)}Y(e){const t=this.cursor({});return new K(((r,a)=>{t.onerror=o=>{const c=f0(o.target.error);a(c)},t.onsuccess=o=>{const c=o.target.result;c?e(c.primaryKey,c.value).next((d=>{d?c.continue():r()})):r()}}))}W(e,t){const r=[];return new K(((a,o)=>{e.onerror=c=>{o(c.target.error)},e.onsuccess=c=>{const d=c.target.result;if(!d)return void a();const f=new sO(d),p=t(d.primaryKey,d.value,f);if(p instanceof K){const v=p.catch((b=>(f.done(),K.reject(b))));r.push(v)}f.isDone?a():f.K===null?d.continue():d.continue(f.K)}})).next((()=>K.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Za(n){return new K(((e,t)=>{n.onsuccess=r=>{const a=r.target.result;e(a)},n.onerror=r=>{const a=f0(r.target.error);t(a)}}))}let zw=!1;function f0(n){const e=ni.S(rn());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new he("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return zw||(zw=!0,setTimeout((()=>{throw r}),0)),r}}return n}class oO{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){fe("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{fe("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){pa(t)?fe("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await ga(t)}await this.X(6e4)}))}}class lO{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.te(t,e)))}te(e,t){const r=new Set;let a=t,o=!0;return K.doWhile((()=>o===!0&&a>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((c=>{if(c!==null&&!r.has(c))return fe("IndexBackfiller",`Processing collection: ${c}`),this.ne(e,c,a).next((d=>{a-=d,r.add(c)}));o=!1})))).next((()=>t-a))}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((a=>this.localStore.localDocuments.getNextDocuments(e,t,a,r).next((o=>{const c=o.changes;return this.localStore.indexManager.updateIndexEntries(e,c).next((()=>this.re(a,o))).next((d=>(fe("IndexBackfiller",`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d)))).next((()=>c.size))}))))}re(e,t){let r=e;return t.changes.forEach(((a,o)=>{const c=YS(o);h0(c,r)>0&&(r=c)})),new ar(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Hn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Hn.oe=-1;function ad(n){return n==null}function Bu(n){return n===0&&1/n==-1/0}function ZS(n){return typeof n=="number"&&Number.isInteger(n)&&!Bu(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Rn(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Fw(e)),e=cO(n.get(t),e);return Fw(e)}function cO(n,e){let t=e;const r=n.length;for(let a=0;a<r;a++){const o=n.charAt(a);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function Fw(n){return n+""}function Zr(n){const e=n.length;if(Te(e>=2),e===2)return Te(n.charAt(0)===""&&n.charAt(1)===""),Ye.emptyPath();const t=e-2,r=[];let a="";for(let o=0;o<e;){const c=n.indexOf("",o);switch((c<0||c>t)&&we(),n.charAt(c+1)){case"":const d=n.substring(o,c);let f;a.length===0?f=d:(a+=d,f=a,a=""),r.push(f);break;case"":a+=n.substring(o,c),a+="\0";break;case"":a+=n.substring(o,c+1);break;default:we()}o=c+2}return new Ye(r)}const Bw=["userId","batchId"];function mf(n,e){return[n,Rn(e)]}function eI(n,e,t){return[n,Rn(e),t]}const uO={},dO=["prefixPath","collectionGroup","readTime","documentId"],hO=["prefixPath","collectionGroup","documentId"],fO=["collectionGroup","readTime","prefixPath","documentId"],mO=["canonicalId","targetId"],gO=["targetId","path"],pO=["path","targetId"],yO=["collectionId","parent"],vO=["indexId","uid"],_O=["uid","sequenceNumber"],bO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],xO=["indexId","uid","orderedDocumentKey"],wO=["userId","collectionPath","documentId"],EO=["userId","collectionPath","largestBatchId"],TO=["userId","collectionGroup","largestBatchId"],tI=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],SO=[...tI,"documentOverlays"],nI=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],rI=nI,m0=[...rI,"indexConfiguration","indexState","indexEntries"],IO=m0,AO=[...m0,"globals"];class wy extends XS{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function sn(n,e){const t=_e(n);return ni.F(t._e,e)}function qw(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ya(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function iI(n,e){const t=[];for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function sI(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class vt{constructor(e,t){this.comparator=e,this.root=t||wn.EMPTY}insert(e,t){return new vt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,wn.BLACK,null,null))}remove(e){return new vt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,wn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return t+r.left.size;a<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zh(this.root,e,this.comparator,!0)}}class Zh{constructor(e,t,r,a){this.isReverse=a,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&a&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class wn{constructor(e,t,r,a,o){this.key=e,this.value=t,this.color=r??wn.RED,this.left=a??wn.EMPTY,this.right=o??wn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,a,o){return new wn(e??this.key,t??this.value,r??this.color,a??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let a=this;const o=r(e,a.key);return a=o<0?a.copy(null,null,null,a.left.insert(e,t,r),null):o===0?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return wn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),t(e,a.key)===0){if(a.right.isEmpty())return wn.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,wn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,wn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw we();const e=this.left.check();if(e!==this.right.check())throw we();return e+(this.isRed()?0:1)}}wn.EMPTY=null,wn.RED=!0,wn.BLACK=!1;wn.EMPTY=new class{constructor(){this.size=0}get key(){throw we()}get value(){throw we()}get color(){throw we()}get left(){throw we()}get right(){throw we()}copy(e,t,r,a,o){return this}insert(e,t,r){return new wn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class mt{constructor(e){this.comparator=e,this.data=new vt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Gw(this.data.getIterator())}getIteratorFrom(e){return new Gw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof mt)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const a=t.getNext().key,o=r.getNext().key;if(this.comparator(a,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new mt(this.comparator);return t.data=e,t}}class Gw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ml(n){return n.hasNext()?n.getNext():void 0}class Kn{constructor(e){this.fields=e,e.sort(Tt.comparator)}static empty(){return new Kn([])}unionWith(e){let t=new mt(Tt.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Kn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return kl(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}class aI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function NO(){return typeof atob<"u"}class Dt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(a){try{return atob(a)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new aI("Invalid base64 string: "+o):o}})(e);return new Dt(t)}static fromUint8Array(e){const t=(function(a){let o="";for(let c=0;c<a.length;++c)o+=String.fromCharCode(a[c]);return o})(e);return new Dt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let a=0;a<t.length;a++)r[a]=t.charCodeAt(a);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return je(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Dt.EMPTY_BYTE_STRING=new Dt("");const CO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ki(n){if(Te(!!n),typeof n=="string"){let e=0;const t=CO.exec(n);if(Te(!!t),t[1]){let a=t[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:It(n.seconds),nanos:It(n.nanos)}}function It(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Qi(n){return typeof n=="string"?Dt.fromBase64String(n):Dt.fromUint8Array(n)}function om(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function lm(n){const e=n.mapValue.fields.__previous_value__;return om(e)?lm(e):e}function qu(n){const e=Ki(n.mapValue.fields.__local_write_time__.timestampValue);return new Be(e.seconds,e.nanos)}class RO{constructor(e,t,r,a,o,c,d,f,p){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=a,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=p}}class ia{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new ia("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ia&&e.projectId===this.projectId&&e.database===this.database}}const Xs={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},gf={nullValue:"NULL_VALUE"};function sa(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?om(n)?4:oI(n)?9007199254740991:cm(n)?10:11:we()}function si(n,e){if(n===e)return!0;const t=sa(n);if(t!==sa(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return qu(n).isEqual(qu(e));case 3:return(function(a,o){if(typeof a.timestampValue=="string"&&typeof o.timestampValue=="string"&&a.timestampValue.length===o.timestampValue.length)return a.timestampValue===o.timestampValue;const c=Ki(a.timestampValue),d=Ki(o.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(a,o){return Qi(a.bytesValue).isEqual(Qi(o.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(a,o){return It(a.geoPointValue.latitude)===It(o.geoPointValue.latitude)&&It(a.geoPointValue.longitude)===It(o.geoPointValue.longitude)})(n,e);case 2:return(function(a,o){if("integerValue"in a&&"integerValue"in o)return It(a.integerValue)===It(o.integerValue);if("doubleValue"in a&&"doubleValue"in o){const c=It(a.doubleValue),d=It(o.doubleValue);return c===d?Bu(c)===Bu(d):isNaN(c)&&isNaN(d)}return!1})(n,e);case 9:return kl(n.arrayValue.values||[],e.arrayValue.values||[],si);case 10:case 11:return(function(a,o){const c=a.mapValue.fields||{},d=o.mapValue.fields||{};if(qw(c)!==qw(d))return!1;for(const f in c)if(c.hasOwnProperty(f)&&(d[f]===void 0||!si(c[f],d[f])))return!1;return!0})(n,e);default:return we()}}function Gu(n,e){return(n.values||[]).find((t=>si(t,e)))!==void 0}function aa(n,e){if(n===e)return 0;const t=sa(n),r=sa(e);if(t!==r)return je(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return je(n.booleanValue,e.booleanValue);case 2:return(function(o,c){const d=It(o.integerValue||o.doubleValue),f=It(c.integerValue||c.doubleValue);return d<f?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1})(n,e);case 3:return $w(n.timestampValue,e.timestampValue);case 4:return $w(qu(n),qu(e));case 5:return je(n.stringValue,e.stringValue);case 6:return(function(o,c){const d=Qi(o),f=Qi(c);return d.compareTo(f)})(n.bytesValue,e.bytesValue);case 7:return(function(o,c){const d=o.split("/"),f=c.split("/");for(let p=0;p<d.length&&p<f.length;p++){const v=je(d[p],f[p]);if(v!==0)return v}return je(d.length,f.length)})(n.referenceValue,e.referenceValue);case 8:return(function(o,c){const d=je(It(o.latitude),It(c.latitude));return d!==0?d:je(It(o.longitude),It(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Hw(n.arrayValue,e.arrayValue);case 10:return(function(o,c){var d,f,p,v;const b=o.fields||{},E=c.fields||{},S=(d=b.value)===null||d===void 0?void 0:d.arrayValue,R=(f=E.value)===null||f===void 0?void 0:f.arrayValue,j=je(((p=S?.values)===null||p===void 0?void 0:p.length)||0,((v=R?.values)===null||v===void 0?void 0:v.length)||0);return j!==0?j:Hw(S,R)})(n.mapValue,e.mapValue);case 11:return(function(o,c){if(o===Xs.mapValue&&c===Xs.mapValue)return 0;if(o===Xs.mapValue)return 1;if(c===Xs.mapValue)return-1;const d=o.fields||{},f=Object.keys(d),p=c.fields||{},v=Object.keys(p);f.sort(),v.sort();for(let b=0;b<f.length&&b<v.length;++b){const E=je(f[b],v[b]);if(E!==0)return E;const S=aa(d[f[b]],p[v[b]]);if(S!==0)return S}return je(f.length,v.length)})(n.mapValue,e.mapValue);default:throw we()}}function $w(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return je(n,e);const t=Ki(n),r=Ki(e),a=je(t.seconds,r.seconds);return a!==0?a:je(t.nanos,r.nanos)}function Hw(n,e){const t=n.values||[],r=e.values||[];for(let a=0;a<t.length&&a<r.length;++a){const o=aa(t[a],r[a]);if(o)return o}return je(t.length,r.length)}function Ol(n){return Ey(n)}function Ey(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=Ki(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Qi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return be.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",a=!0;for(const o of t.values||[])a?a=!1:r+=",",r+=Ey(o);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let a="{",o=!0;for(const c of r)o?o=!1:a+=",",a+=`${c}:${Ey(t.fields[c])}`;return a+"}"})(n.mapValue):we()}function pf(n){switch(sa(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=lm(n);return e?16+pf(e):16;case 5:return 2*n.stringValue.length;case 6:return Qi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((a,o)=>a+pf(o)),0)})(n.arrayValue);case 10:case 11:return(function(r){let a=0;return ya(r.fields,((o,c)=>{a+=o.length+pf(c)})),a})(n.mapValue);default:throw we()}}function co(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Ty(n){return!!n&&"integerValue"in n}function $u(n){return!!n&&"arrayValue"in n}function Kw(n){return!!n&&"nullValue"in n}function Qw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function yf(n){return!!n&&"mapValue"in n}function cm(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function ku(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ya(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=ku(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ku(n.arrayValue.values[t]);return e}return Object.assign({},n)}function oI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const lI={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function kO(n){return"nullValue"in n?gf:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?co(ia.empty(),be.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?cm(n)?lI:{mapValue:{}}:we()}function DO(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?co(ia.empty(),be.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?lI:"mapValue"in n?cm(n)?{mapValue:{}}:Xs:we()}function Yw(n,e){const t=aa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Ww(n,e){const t=aa(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class En{constructor(e){this.value=e}static empty(){return new En({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!yf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ku(t)}setAll(e){let t=Tt.emptyPath(),r={},a=[];e.forEach(((c,d)=>{if(!t.isImmediateParentOf(d)){const f=this.getFieldsMap(t);this.applyChanges(f,r,a),r={},a=[],t=d.popLast()}c?r[d.lastSegment()]=ku(c):a.push(d.lastSegment())}));const o=this.getFieldsMap(t);this.applyChanges(o,r,a)}delete(e){const t=this.field(e.popLast());yf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return si(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=t.mapValue.fields[e.get(r)];yf(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,r){ya(t,((a,o)=>e[a]=o));for(const a of r)delete e[a]}clone(){return new En(ku(this.value))}}function cI(n){const e=[];return ya(n.fields,((t,r)=>{const a=new Tt([t]);if(yf(r)){const o=cI(r.mapValue).fields;if(o.length===0)e.push(a);else for(const c of o)e.push(a.child(c))}else e.push(a)})),new Kn(e)}class Et{constructor(e,t,r,a,o,c,d){this.key=e,this.documentType=t,this.version=r,this.readTime=a,this.createTime=o,this.data=c,this.documentState=d}static newInvalidDocument(e){return new Et(e,0,Ae.min(),Ae.min(),Ae.min(),En.empty(),0)}static newFoundDocument(e,t,r,a){return new Et(e,1,t,Ae.min(),r,a,0)}static newNoDocument(e,t){return new Et(e,2,t,Ae.min(),Ae.min(),En.empty(),0)}static newUnknownDocument(e,t){return new Et(e,3,t,Ae.min(),Ae.min(),En.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=En.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=En.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Et&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Et(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class oa{constructor(e,t){this.position=e,this.inclusive=t}}function Xw(n,e,t){let r=0;for(let a=0;a<n.position.length;a++){const o=e[a],c=n.position[a];if(o.field.isKeyField()?r=be.comparator(be.fromName(c.referenceValue),t.key):r=aa(c,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function Jw(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!si(n.position[t],e.position[t]))return!1;return!0}class Hu{constructor(e,t="asc"){this.field=e,this.dir=t}}function jO(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class uI{}class We extends uI{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new OO(e,t,r):t==="array-contains"?new MO(e,r):t==="in"?new pI(e,r):t==="not-in"?new LO(e,r):t==="array-contains-any"?new UO(e,r):new We(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new PO(e,r):new VO(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(aa(t,this.value)):t!==null&&sa(this.value)===sa(t)&&this.matchesComparison(aa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return we()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ut extends uI{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new ut(e,t)}matches(e){return Pl(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Pl(n){return n.op==="and"}function Sy(n){return n.op==="or"}function g0(n){return dI(n)&&Pl(n)}function dI(n){for(const e of n.filters)if(e instanceof ut)return!1;return!0}function Iy(n){if(n instanceof We)return n.field.canonicalString()+n.op.toString()+Ol(n.value);if(g0(n))return n.filters.map((e=>Iy(e))).join(",");{const e=n.filters.map((t=>Iy(t))).join(",");return`${n.op}(${e})`}}function hI(n,e){return n instanceof We?(function(r,a){return a instanceof We&&r.op===a.op&&r.field.isEqual(a.field)&&si(r.value,a.value)})(n,e):n instanceof ut?(function(r,a){return a instanceof ut&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce(((o,c,d)=>o&&hI(c,a.filters[d])),!0):!1})(n,e):void we()}function fI(n,e){const t=n.filters.concat(e);return ut.create(t,n.op)}function mI(n){return n instanceof We?(function(t){return`${t.field.canonicalString()} ${t.op} ${Ol(t.value)}`})(n):n instanceof ut?(function(t){return t.op.toString()+" {"+t.getFilters().map(mI).join(" ,")+"}"})(n):"Filter"}class OO extends We{constructor(e,t,r){super(e,t,r),this.key=be.fromName(r.referenceValue)}matches(e){const t=be.comparator(e.key,this.key);return this.matchesComparison(t)}}class PO extends We{constructor(e,t){super(e,"in",t),this.keys=gI("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class VO extends We{constructor(e,t){super(e,"not-in",t),this.keys=gI("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function gI(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((r=>be.fromName(r.referenceValue)))}class MO extends We{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return $u(t)&&Gu(t.arrayValue,this.value)}}class pI extends We{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Gu(this.value.arrayValue,t)}}class LO extends We{constructor(e,t){super(e,"not-in",t)}matches(e){if(Gu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Gu(this.value.arrayValue,t)}}class UO extends We{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!$u(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Gu(this.value.arrayValue,r)))}}class zO{constructor(e,t=null,r=[],a=[],o=null,c=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=a,this.limit=o,this.startAt=c,this.endAt=d,this.ue=null}}function Ay(n,e=null,t=[],r=[],a=null,o=null,c=null){return new zO(n,e,t,r,a,o,c)}function uo(n){const e=_e(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>Iy(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(o){return o.field.canonicalString()+o.dir})(r))).join(","),ad(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Ol(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Ol(r))).join(",")),e.ue=t}return e.ue}function od(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!jO(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!hI(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Jw(n.startAt,e.startAt)&&Jw(n.endAt,e.endAt)}function Of(n){return be.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Pf(n,e){return n.filters.filter((t=>t instanceof We&&t.field.isEqual(e)))}function Zw(n,e,t){let r=gf,a=!0;for(const o of Pf(n,e)){let c=gf,d=!0;switch(o.op){case"<":case"<=":c=kO(o.value);break;case"==":case"in":case">=":c=o.value;break;case">":c=o.value,d=!1;break;case"!=":case"not-in":c=gf}Yw({value:r,inclusive:a},{value:c,inclusive:d})<0&&(r=c,a=d)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const c=t.position[o];Yw({value:r,inclusive:a},{value:c,inclusive:t.inclusive})<0&&(r=c,a=t.inclusive);break}}return{value:r,inclusive:a}}function eE(n,e,t){let r=Xs,a=!0;for(const o of Pf(n,e)){let c=Xs,d=!0;switch(o.op){case">=":case">":c=DO(o.value),d=!1;break;case"==":case"in":case"<=":c=o.value;break;case"<":c=o.value,d=!1;break;case"!=":case"not-in":c=Xs}Ww({value:r,inclusive:a},{value:c,inclusive:d})>0&&(r=c,a=d)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const c=t.position[o];Ww({value:r,inclusive:a},{value:c,inclusive:t.inclusive})>0&&(r=c,a=t.inclusive);break}}return{value:r,inclusive:a}}class Ji{constructor(e,t=null,r=[],a=[],o=null,c="F",d=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=a,this.limit=o,this.limitType=c,this.startAt=d,this.endAt=f,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function yI(n,e,t,r,a,o,c,d){return new Ji(n,e,t,r,a,o,c,d)}function Jl(n){return new Ji(n)}function tE(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function p0(n){return n.collectionGroup!==null}function Il(n){const e=_e(n);if(e.ce===null){e.ce=[];const t=new Set;for(const o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new mt(Tt.comparator);return c.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(d=d.add(p.field))}))})),d})(e).forEach((o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Hu(o,r))})),t.has(Tt.keyField().canonicalString())||e.ce.push(new Hu(Tt.keyField(),r))}return e.ce}function kn(n){const e=_e(n);return e.le||(e.le=_I(e,Il(n))),e.le}function vI(n){const e=_e(n);return e.he||(e.he=_I(e,n.explicitOrderBy)),e.he}function _I(n,e){if(n.limitType==="F")return Ay(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((a=>{const o=a.dir==="desc"?"asc":"desc";return new Hu(a.field,o)}));const t=n.endAt?new oa(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new oa(n.startAt.position,n.startAt.inclusive):null;return Ay(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Ny(n,e){const t=n.filters.concat([e]);return new Ji(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Vf(n,e,t){return new Ji(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function ld(n,e){return od(kn(n),kn(e))&&n.limitType===e.limitType}function bI(n){return`${uo(kn(n))}|lt:${n.limitType}`}function _l(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((a=>mI(a))).join(", ")}]`),ad(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((a=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(a))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((a=>Ol(a))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((a=>Ol(a))).join(",")),`Target(${r})`})(kn(n))}; limitType=${n.limitType})`}function cd(n,e){return e.isFoundDocument()&&(function(r,a){const o=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):be.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)})(n,e)&&(function(r,a){for(const o of Il(r))if(!o.field.isKeyField()&&a.data.field(o.field)===null)return!1;return!0})(n,e)&&(function(r,a){for(const o of r.filters)if(!o.matches(a))return!1;return!0})(n,e)&&(function(r,a){return!(r.startAt&&!(function(c,d,f){const p=Xw(c,d,f);return c.inclusive?p<=0:p<0})(r.startAt,Il(r),a)||r.endAt&&!(function(c,d,f){const p=Xw(c,d,f);return c.inclusive?p>=0:p>0})(r.endAt,Il(r),a))})(n,e)}function xI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function wI(n){return(e,t)=>{let r=!1;for(const a of Il(n)){const o=FO(a,e,t);if(o!==0)return o;r=r||a.field.isKeyField()}return 0}}function FO(n,e,t){const r=n.field.isKeyField()?be.comparator(e.key,t.key):(function(o,c,d){const f=c.data.field(o),p=d.data.field(o);return f!==null&&p!==null?aa(f,p):we()})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return we()}}class Zi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[a,o]of r)if(this.equalsFn(a,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return void(a[o]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[t]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){ya(this.inner,((t,r)=>{for(const[a,o]of r)e(a,o)}))}isEmpty(){return sI(this.inner)}size(){return this.innerSize}}const BO=new vt(be.comparator);function Qn(){return BO}const EI=new vt(be.comparator);function Tu(...n){let e=EI;for(const t of n)e=e.insert(t.key,t);return e}function TI(n){let e=EI;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function ei(){return Du()}function SI(){return Du()}function Du(){return new Zi((n=>n.toString()),((n,e)=>n.isEqual(e)))}const qO=new vt(be.comparator),GO=new mt(be.comparator);function Le(...n){let e=GO;for(const t of n)e=e.add(t);return e}const $O=new mt(je);function y0(){return $O}function v0(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bu(e)?"-0":e}}function II(n){return{integerValue:""+n}}function AI(n,e){return ZS(e)?II(e):v0(n,e)}class um{constructor(){this._=void 0}}function HO(n,e,t){return n instanceof Vl?(function(a,o){const c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return o&&om(o)&&(o=lm(o)),o&&(c.fields.__previous_value__=o),{mapValue:c}})(t,e):n instanceof ho?CI(n,e):n instanceof fo?RI(n,e):(function(a,o){const c=NI(a,o),d=nE(c)+nE(a.Pe);return Ty(c)&&Ty(a.Pe)?II(d):v0(a.serializer,d)})(n,e)}function KO(n,e,t){return n instanceof ho?CI(n,e):n instanceof fo?RI(n,e):t}function NI(n,e){return n instanceof Ml?(function(r){return Ty(r)||(function(o){return!!o&&"doubleValue"in o})(r)})(e)?e:{integerValue:0}:null}class Vl extends um{}class ho extends um{constructor(e){super(),this.elements=e}}function CI(n,e){const t=kI(e);for(const r of n.elements)t.some((a=>si(a,r)))||t.push(r);return{arrayValue:{values:t}}}class fo extends um{constructor(e){super(),this.elements=e}}function RI(n,e){let t=kI(e);for(const r of n.elements)t=t.filter((a=>!si(a,r)));return{arrayValue:{values:t}}}class Ml extends um{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function nE(n){return It(n.integerValue||n.doubleValue)}function kI(n){return $u(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class ud{constructor(e,t){this.field=e,this.transform=t}}function QO(n,e){return n.field.isEqual(e.field)&&(function(r,a){return r instanceof ho&&a instanceof ho||r instanceof fo&&a instanceof fo?kl(r.elements,a.elements,si):r instanceof Ml&&a instanceof Ml?si(r.Pe,a.Pe):r instanceof Vl&&a instanceof Vl})(n.transform,e.transform)}class YO{constructor(e,t){this.version=e,this.transformResults=t}}class At{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new At}static exists(e){return new At(void 0,e)}static updateTime(e){return new At(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function vf(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class dm{}function DI(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new ec(n.key,At.none()):new Zl(n.key,n.data,At.none());{const t=n.data,r=En.empty();let a=new mt(Tt.comparator);for(let o of e.fields)if(!a.has(o)){let c=t.field(o);c===null&&o.length>1&&(o=o.popLast(),c=t.field(o)),c===null?r.delete(o):r.set(o,c),a=a.add(o)}return new es(n.key,r,new Kn(a.toArray()),At.none())}}function WO(n,e,t){n instanceof Zl?(function(a,o,c){const d=a.value.clone(),f=iE(a.fieldTransforms,o,c.transformResults);d.setAll(f),o.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(n,e,t):n instanceof es?(function(a,o,c){if(!vf(a.precondition,o))return void o.convertToUnknownDocument(c.version);const d=iE(a.fieldTransforms,o,c.transformResults),f=o.data;f.setAll(jI(a)),f.setAll(d),o.convertToFoundDocument(c.version,f).setHasCommittedMutations()})(n,e,t):(function(a,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function ju(n,e,t,r){return n instanceof Zl?(function(o,c,d,f){if(!vf(o.precondition,c))return d;const p=o.value.clone(),v=sE(o.fieldTransforms,f,c);return p.setAll(v),c.convertToFoundDocument(c.version,p).setHasLocalMutations(),null})(n,e,t,r):n instanceof es?(function(o,c,d,f){if(!vf(o.precondition,c))return d;const p=sE(o.fieldTransforms,f,c),v=c.data;return v.setAll(jI(o)),v.setAll(p),c.convertToFoundDocument(c.version,v).setHasLocalMutations(),d===null?null:d.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((b=>b.field)))})(n,e,t,r):(function(o,c,d){return vf(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d})(n,e,t)}function XO(n,e){let t=null;for(const r of n.fieldTransforms){const a=e.data.field(r.field),o=NI(r.transform,a||null);o!=null&&(t===null&&(t=En.empty()),t.set(r.field,o))}return t||null}function rE(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&kl(r,a,((o,c)=>QO(o,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Zl extends dm{constructor(e,t,r,a=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class es extends dm{constructor(e,t,r,a,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=a,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function jI(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function iE(n,e,t){const r=new Map;Te(n.length===t.length);for(let a=0;a<t.length;a++){const o=n[a],c=o.transform,d=e.data.field(o.field);r.set(o.field,KO(c,d,t[a]))}return r}function sE(n,e,t){const r=new Map;for(const a of n){const o=a.transform,c=t.data.field(a.field);r.set(a.field,HO(o,c,e))}return r}class ec extends dm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _0 extends dm{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class b0{constructor(e,t,r,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const o=this.mutations[a];o.key.isEqual(e.key)&&WO(o,e,r[a])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ju(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ju(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=SI();return this.mutations.forEach((a=>{const o=e.get(a.key),c=o.overlayedDocument;let d=this.applyToLocalView(c,o.mutatedFields);d=t.has(a.key)?null:d;const f=DI(c,d);f!==null&&r.set(a.key,f),c.isValidDocument()||c.convertToNoDocument(Ae.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Le())}isEqual(e){return this.batchId===e.batchId&&kl(this.mutations,e.mutations,((t,r)=>rE(t,r)))&&kl(this.baseMutations,e.baseMutations,((t,r)=>rE(t,r)))}}class x0{constructor(e,t,r,a){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=a}static from(e,t,r){Te(e.mutations.length===r.length);let a=(function(){return qO})();const o=e.mutations;for(let c=0;c<o.length;c++)a=a.insert(o[c].key,r[c].version);return new x0(e,t,r,a)}}class w0{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class OI{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}class JO{constructor(e,t){this.count=e,this.unchangedNames=t}}var Jt,Je;function PI(n){switch(n){default:return we();case ne.CANCELLED:case ne.UNKNOWN:case ne.DEADLINE_EXCEEDED:case ne.RESOURCE_EXHAUSTED:case ne.INTERNAL:case ne.UNAVAILABLE:case ne.UNAUTHENTICATED:return!1;case ne.INVALID_ARGUMENT:case ne.NOT_FOUND:case ne.ALREADY_EXISTS:case ne.PERMISSION_DENIED:case ne.FAILED_PRECONDITION:case ne.ABORTED:case ne.OUT_OF_RANGE:case ne.UNIMPLEMENTED:case ne.DATA_LOSS:return!0}}function VI(n){if(n===void 0)return $t("GRPC error has no .code"),ne.UNKNOWN;switch(n){case Jt.OK:return ne.OK;case Jt.CANCELLED:return ne.CANCELLED;case Jt.UNKNOWN:return ne.UNKNOWN;case Jt.DEADLINE_EXCEEDED:return ne.DEADLINE_EXCEEDED;case Jt.RESOURCE_EXHAUSTED:return ne.RESOURCE_EXHAUSTED;case Jt.INTERNAL:return ne.INTERNAL;case Jt.UNAVAILABLE:return ne.UNAVAILABLE;case Jt.UNAUTHENTICATED:return ne.UNAUTHENTICATED;case Jt.INVALID_ARGUMENT:return ne.INVALID_ARGUMENT;case Jt.NOT_FOUND:return ne.NOT_FOUND;case Jt.ALREADY_EXISTS:return ne.ALREADY_EXISTS;case Jt.PERMISSION_DENIED:return ne.PERMISSION_DENIED;case Jt.FAILED_PRECONDITION:return ne.FAILED_PRECONDITION;case Jt.ABORTED:return ne.ABORTED;case Jt.OUT_OF_RANGE:return ne.OUT_OF_RANGE;case Jt.UNIMPLEMENTED:return ne.UNIMPLEMENTED;case Jt.DATA_LOSS:return ne.DATA_LOSS;default:return we()}}(Je=Jt||(Jt={}))[Je.OK=0]="OK",Je[Je.CANCELLED=1]="CANCELLED",Je[Je.UNKNOWN=2]="UNKNOWN",Je[Je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Je[Je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Je[Je.NOT_FOUND=5]="NOT_FOUND",Je[Je.ALREADY_EXISTS=6]="ALREADY_EXISTS",Je[Je.PERMISSION_DENIED=7]="PERMISSION_DENIED",Je[Je.UNAUTHENTICATED=16]="UNAUTHENTICATED",Je[Je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Je[Je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Je[Je.ABORTED=10]="ABORTED",Je[Je.OUT_OF_RANGE=11]="OUT_OF_RANGE",Je[Je.UNIMPLEMENTED=12]="UNIMPLEMENTED",Je[Je.INTERNAL=13]="INTERNAL",Je[Je.UNAVAILABLE=14]="UNAVAILABLE",Je[Je.DATA_LOSS=15]="DATA_LOSS";let Mf=null;function MI(){return new TextEncoder}const ZO=new ao([4294967295,4294967295],0);function aE(n){const e=MI().encode(n),t=new LS;return t.update(e),new Uint8Array(t.digest())}function oE(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new ao([t,r],0),new ao([a,o],0)]}class E0{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Su(`Invalid padding: ${t}`);if(r<0)throw new Su(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Su(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Su(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=ao.fromNumber(this.Ie)}Ee(e,t,r){let a=e.add(t.multiply(ao.fromNumber(r)));return a.compare(ZO)===1&&(a=new ao([a.getBits(0),a.getBits(1)],0)),a.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=aE(e),[r,a]=oE(t);for(let o=0;o<this.hashCount;o++){const c=this.Ee(r,a,o);if(!this.de(c))return!1}return!0}static create(e,t,r){const a=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),c=new E0(o,a,t);return r.forEach((d=>c.insert(d))),c}insert(e){if(this.Ie===0)return;const t=aE(e),[r,a]=oE(t);for(let o=0;o<this.hashCount;o++){const c=this.Ee(r,a,o);this.Ae(c)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Su extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class dd{constructor(e,t,r,a,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const a=new Map;return a.set(e,hd.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new dd(Ae.min(),a,new vt(je),Qn(),Le())}}class hd{constructor(e,t,r,a,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new hd(r,t,Le(),Le(),Le())}}class _f{constructor(e,t,r,a){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=a}}class LI{constructor(e,t){this.targetId=e,this.me=t}}class UI{constructor(e,t,r=Dt.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=a}}class lE{constructor(){this.fe=0,this.ge=uE(),this.pe=Dt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Le(),t=Le(),r=Le();return this.ge.forEach(((a,o)=>{switch(o){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:r=r.add(a);break;default:we()}})),new hd(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=uE()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Te(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class eP{constructor(e){this.Le=e,this.Be=new Map,this.ke=Qn(),this.qe=cE(),this.Qe=new vt(je)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:we()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((r,a)=>{this.ze(a)&&t(a)}))}He(e){const t=e.targetId,r=e.me.count,a=this.Je(t);if(a){const o=a.target;if(Of(o))if(r===0){const c=new be(o.path);this.Ue(t,c,Et.newNoDocument(c,Ae.min()))}else Te(r===1);else{const c=this.Ye(t);if(c!==r){const d=this.Ze(e),f=d?this.Xe(d,e,c):1;if(f!==0){this.je(t);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,p)}Mf?.et((function(v,b,E,S,R){var j,N,I,te,X,de;const ve={localCacheCount:v,existenceFilterCount:b.count,databaseId:E.database,projectId:E.projectId},ge=b.unchangedNames;return ge&&(ve.bloomFilter={applied:R===0,hashCount:(j=ge?.hashCount)!==null&&j!==void 0?j:0,bitmapLength:(te=(I=(N=ge?.bits)===null||N===void 0?void 0:N.bitmap)===null||I===void 0?void 0:I.length)!==null&&te!==void 0?te:0,padding:(de=(X=ge?.bits)===null||X===void 0?void 0:X.padding)!==null&&de!==void 0?de:0,mightContain:D=>{var C;return(C=S?.mightContain(D))!==null&&C!==void 0&&C}}),ve})(c,e.me,this.Le.tt(),d,f))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:o=0}=t;let c,d;try{c=Qi(r).toUint8Array()}catch(f){if(f instanceof aI)return sr("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{d=new E0(c,a,o)}catch(f){return sr(f instanceof Su?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return d.Ie===0?null:d}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let a=0;return r.forEach((o=>{const c=this.Le.tt(),d=`projects/${c.projectId}/databases/${c.database}/documents/${o.path.canonicalString()}`;e.mightContain(d)||(this.Ue(t,o,null),a++)})),a}rt(e){const t=new Map;this.Be.forEach(((o,c)=>{const d=this.Je(c);if(d){if(o.current&&Of(d.target)){const f=new be(d.target.path);this.ke.get(f)!==null||this.it(c,f)||this.Ue(c,f,Et.newNoDocument(f,e))}o.be&&(t.set(c,o.ve()),o.Ce())}}));let r=Le();this.qe.forEach(((o,c)=>{let d=!0;c.forEachWhile((f=>{const p=this.Je(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(r=r.add(o))})),this.ke.forEach(((o,c)=>c.setReadTime(e)));const a=new dd(e,t,this.Qe,this.ke,r);return this.ke=Qn(),this.qe=cE(),this.Qe=new vt(je),a}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const a=this.Ge(e);this.it(e,t)?a.Fe(t,1):a.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new lE,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new mt(je),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||fe("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new lE),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function cE(){return new vt(be.comparator)}function uE(){return new vt(be.comparator)}const tP={asc:"ASCENDING",desc:"DESCENDING"},nP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},rP={and:"AND",or:"OR"};class iP{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Cy(n,e){return n.useProto3Json||ad(e)?e:{value:e}}function Ll(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zI(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function sP(n,e){return Ll(n,e.toTimestamp())}function Ht(n){return Te(!!n),Ae.fromTimestamp((function(t){const r=Ki(t);return new Be(r.seconds,r.nanos)})(n))}function T0(n,e){return Ry(n,e).canonicalString()}function Ry(n,e){const t=(function(a){return new Ye(["projects",a.projectId,"databases",a.database])})(n).child("documents");return e===void 0?t:t.child(e)}function FI(n){const e=Ye.fromString(n);return Te(XI(e)),e}function Ku(n,e){return T0(n.databaseId,e.path)}function ri(n,e){const t=FI(e);if(t.get(1)!==n.databaseId.projectId)throw new he(ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new he(ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new be(GI(t))}function BI(n,e){return T0(n.databaseId,e)}function qI(n){const e=FI(n);return e.length===4?Ye.emptyPath():GI(e)}function ky(n){return new Ye(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function GI(n){return Te(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function dE(n,e,t){return{name:Ku(n,e),fields:t.value.mapValue.fields}}function $I(n,e,t){const r=ri(n,e.name),a=Ht(e.updateTime),o=e.createTime?Ht(e.createTime):Ae.min(),c=new En({mapValue:{fields:e.fields}}),d=Et.newFoundDocument(r,a,o,c);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function aP(n,e){return"found"in e?(function(r,a){Te(!!a.found),a.found.name,a.found.updateTime;const o=ri(r,a.found.name),c=Ht(a.found.updateTime),d=a.found.createTime?Ht(a.found.createTime):Ae.min(),f=new En({mapValue:{fields:a.found.fields}});return Et.newFoundDocument(o,c,d,f)})(n,e):"missing"in e?(function(r,a){Te(!!a.missing),Te(!!a.readTime);const o=ri(r,a.missing),c=Ht(a.readTime);return Et.newNoDocument(o,c)})(n,e):we()}function oP(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:we()})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],o=(function(p,v){return p.useProto3Json?(Te(v===void 0||typeof v=="string"),Dt.fromBase64String(v||"")):(Te(v===void 0||v instanceof Buffer||v instanceof Uint8Array),Dt.fromUint8Array(v||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&(function(p){const v=p.code===void 0?ne.UNKNOWN:VI(p.code);return new he(v,p.message||"")})(c);t=new UI(r,a,o,d||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=ri(n,r.document.name),o=Ht(r.document.updateTime),c=r.document.createTime?Ht(r.document.createTime):Ae.min(),d=new En({mapValue:{fields:r.document.fields}}),f=Et.newFoundDocument(a,o,c,d),p=r.targetIds||[],v=r.removedTargetIds||[];t=new _f(p,v,f.key,f)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=ri(n,r.document),o=r.readTime?Ht(r.readTime):Ae.min(),c=Et.newNoDocument(a,o),d=r.removedTargetIds||[];t=new _f([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=ri(n,r.document),o=r.removedTargetIds||[];t=new _f([],o,a,null)}else{if(!("filter"in e))return we();{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:o}=r,c=new JO(a,o),d=r.targetId;t=new LI(d,c)}}return t}function Qu(n,e){let t;if(e instanceof Zl)t={update:dE(n,e.key,e.value)};else if(e instanceof ec)t={delete:Ku(n,e.key)};else if(e instanceof es)t={update:dE(n,e.key,e.data),updateMask:fP(e.fieldMask)};else{if(!(e instanceof _0))return we();t={verify:Ku(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(o,c){const d=c.transform;if(d instanceof Vl)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof ho)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof fo)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Ml)return{fieldPath:c.field.canonicalString(),increment:d.Pe};throw we()})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(a,o){return o.updateTime!==void 0?{updateTime:sP(a,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:we()})(n,e.precondition)),t}function Dy(n,e){const t=e.currentDocument?(function(o){return o.updateTime!==void 0?At.updateTime(Ht(o.updateTime)):o.exists!==void 0?At.exists(o.exists):At.none()})(e.currentDocument):At.none(),r=e.updateTransforms?e.updateTransforms.map((a=>(function(c,d){let f=null;if("setToServerValue"in d)Te(d.setToServerValue==="REQUEST_TIME"),f=new Vl;else if("appendMissingElements"in d){const v=d.appendMissingElements.values||[];f=new ho(v)}else if("removeAllFromArray"in d){const v=d.removeAllFromArray.values||[];f=new fo(v)}else"increment"in d?f=new Ml(c,d.increment):we();const p=Tt.fromServerFormat(d.fieldPath);return new ud(p,f)})(n,a))):[];if(e.update){e.update.name;const a=ri(n,e.update.name),o=new En({mapValue:{fields:e.update.fields}});if(e.updateMask){const c=(function(f){const p=f.fieldPaths||[];return new Kn(p.map((v=>Tt.fromServerFormat(v))))})(e.updateMask);return new es(a,o,c,t,r)}return new Zl(a,o,t,r)}if(e.delete){const a=ri(n,e.delete);return new ec(a,t)}if(e.verify){const a=ri(n,e.verify);return new _0(a,t)}return we()}function lP(n,e){return n&&n.length>0?(Te(e!==void 0),n.map((t=>(function(a,o){let c=a.updateTime?Ht(a.updateTime):Ht(o);return c.isEqual(Ae.min())&&(c=Ht(o)),new YO(c,a.transformResults||[])})(t,e)))):[]}function HI(n,e){return{documents:[BI(n,e.path)]}}function hm(n,e){const t={structuredQuery:{}},r=e.path;let a;e.collectionGroup!==null?(a=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=BI(n,a);const o=(function(p){if(p.length!==0)return WI(ut.create(p,"and"))})(e.filters);o&&(t.structuredQuery.where=o);const c=(function(p){if(p.length!==0)return p.map((v=>(function(E){return{field:Qs(E.field),direction:uP(E.dir)}})(v)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const d=Cy(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{_t:t,parent:a}}function KI(n,e,t,r){const{_t:a,parent:o}=hm(n,e),c={},d=[];let f=0;return t.forEach((p=>{const v=r?p.alias:"aggregate_"+f++;c[v]=p.alias,p.aggregateType==="count"?d.push({alias:v,count:{}}):p.aggregateType==="avg"?d.push({alias:v,avg:{field:Qs(p.fieldPath)}}):p.aggregateType==="sum"&&d.push({alias:v,sum:{field:Qs(p.fieldPath)}})})),{request:{structuredAggregationQuery:{aggregations:d,structuredQuery:a.structuredQuery},parent:a.parent},ut:c,parent:o}}function QI(n){let e=qI(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let a=null;if(r>0){Te(r===1);const v=t.from[0];v.allDescendants?a=v.collectionId:e=e.child(v.collectionId)}let o=[];t.where&&(o=(function(b){const E=YI(b);return E instanceof ut&&g0(E)?E.getFilters():[E]})(t.where));let c=[];t.orderBy&&(c=(function(b){return b.map((E=>(function(R){return new Hu(bl(R.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(R.direction))})(E)))})(t.orderBy));let d=null;t.limit&&(d=(function(b){let E;return E=typeof b=="object"?b.value:b,ad(E)?null:E})(t.limit));let f=null;t.startAt&&(f=(function(b){const E=!!b.before,S=b.values||[];return new oa(S,E)})(t.startAt));let p=null;return t.endAt&&(p=(function(b){const E=!b.before,S=b.values||[];return new oa(S,E)})(t.endAt)),yI(e,a,c,o,d,"F",f,p)}function cP(n,e){const t=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return we()}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function YI(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=bl(t.unaryFilter.field);return We.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=bl(t.unaryFilter.field);return We.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=bl(t.unaryFilter.field);return We.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=bl(t.unaryFilter.field);return We.create(c,"!=",{nullValue:"NULL_VALUE"});default:return we()}})(n):n.fieldFilter!==void 0?(function(t){return We.create(bl(t.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return we()}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ut.create(t.compositeFilter.filters.map((r=>YI(r))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return we()}})(t.compositeFilter.op))})(n):we()}function uP(n){return tP[n]}function dP(n){return nP[n]}function hP(n){return rP[n]}function Qs(n){return{fieldPath:n.canonicalString()}}function bl(n){return Tt.fromServerFormat(n.fieldPath)}function WI(n){return n instanceof We?(function(t){if(t.op==="=="){if(Qw(t.value))return{unaryFilter:{field:Qs(t.field),op:"IS_NAN"}};if(Kw(t.value))return{unaryFilter:{field:Qs(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Qw(t.value))return{unaryFilter:{field:Qs(t.field),op:"IS_NOT_NAN"}};if(Kw(t.value))return{unaryFilter:{field:Qs(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Qs(t.field),op:dP(t.op),value:t.value}}})(n):n instanceof ut?(function(t){const r=t.getFilters().map((a=>WI(a)));return r.length===1?r[0]:{compositeFilter:{op:hP(t.op),filters:r}}})(n):we()}function fP(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function XI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class zi{constructor(e,t,r,a,o=Ae.min(),c=Ae.min(),d=Dt.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new zi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new zi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new zi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class JI{constructor(e){this.ct=e}}function mP(n,e){let t;if(e.document)t=$I(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=be.fromSegments(e.noDocument.path),a=go(e.noDocument.readTime);t=Et.newNoDocument(r,a),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return we();{const r=be.fromSegments(e.unknownDocument.path),a=go(e.unknownDocument.version);t=Et.newUnknownDocument(r,a)}}return e.readTime&&t.setReadTime((function(a){const o=new Be(a[0],a[1]);return Ae.fromTimestamp(o)})(e.readTime)),t}function hE(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Lf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(o,c){return{name:Ku(o,c.key),fields:c.data.value.mapValue.fields,updateTime:Ll(o,c.version.toTimestamp()),createTime:Ll(o,c.createTime.toTimestamp())}})(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:mo(e.version)};else{if(!e.isUnknownDocument())return we();r.unknownDocument={path:t.path.toArray(),version:mo(e.version)}}return r}function Lf(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function mo(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function go(n){const e=new Be(n.seconds,n.nanoseconds);return Ae.fromTimestamp(e)}function eo(n,e){const t=(e.baseMutations||[]).map((o=>Dy(n.ct,o)));for(let o=0;o<e.mutations.length-1;++o){const c=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const d=e.mutations[o+1];c.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const r=e.mutations.map((o=>Dy(n.ct,o))),a=Be.fromMillis(e.localWriteTimeMs);return new b0(e.batchId,a,t,r)}function Iu(n){const e=go(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?go(n.lastLimboFreeSnapshotVersion):Ae.min();let r;return r=(function(o){return o.documents!==void 0})(n.query)?(function(o){return Te(o.documents.length===1),kn(Jl(qI(o.documents[0])))})(n.query):(function(o){return kn(QI(o))})(n.query),new zi(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Dt.fromBase64String(n.resumeToken))}function ZI(n,e){const t=mo(e.snapshotVersion),r=mo(e.lastLimboFreeSnapshotVersion);let a;a=Of(e.target)?HI(n.ct,e.target):hm(n.ct,e.target)._t;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:uo(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:a}}function S0(n){const e=QI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Vf(e,e.limit,"L"):e}function Xp(n,e){return new w0(e.largestBatchId,Dy(n.ct,e.overlayMutation))}function fE(n,e){const t=e.path.lastSegment();return[n,Rn(e.path.popLast()),t]}function mE(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:mo(r.readTime),documentKey:Rn(r.documentKey.path),largestBatchId:r.largestBatchId}}class gP{getBundleMetadata(e,t){return gE(e).get(t).next((r=>{if(r)return(function(o){return{id:o.bundleId,createTime:go(o.createTime),version:o.version}})(r)}))}saveBundleMetadata(e,t){return gE(e).put((function(a){return{bundleId:a.id,createTime:mo(Ht(a.createTime)),version:a.version}})(t))}getNamedQuery(e,t){return pE(e).get(t).next((r=>{if(r)return(function(o){return{name:o.name,query:S0(o.bundledQuery),readTime:go(o.readTime)}})(r)}))}saveNamedQuery(e,t){return pE(e).put((function(a){return{name:a.name,readTime:mo(Ht(a.readTime)),bundledQuery:a.bundledQuery}})(t))}}function gE(n){return sn(n,"bundles")}function pE(n){return sn(n,"namedQueries")}class fm{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new fm(e,r)}getOverlay(e,t){return mu(e).get(fE(this.userId,t)).next((r=>r?Xp(this.serializer,r):null))}getOverlays(e,t){const r=ei();return K.forEach(t,(a=>this.getOverlay(e,a).next((o=>{o!==null&&r.set(a,o)})))).next((()=>r))}saveOverlays(e,t,r){const a=[];return r.forEach(((o,c)=>{const d=new w0(t,c);a.push(this.ht(e,d))})),K.waitFor(a)}removeOverlaysForBatchId(e,t,r){const a=new Set;t.forEach((c=>a.add(Rn(c.getCollectionPath()))));const o=[];return a.forEach((c=>{const d=IDBKeyRange.bound([this.userId,c,r],[this.userId,c,r+1],!1,!0);o.push(mu(e).j("collectionPathOverlayIndex",d))})),K.waitFor(o)}getOverlaysForCollection(e,t,r){const a=ei(),o=Rn(t),c=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return mu(e).U("collectionPathOverlayIndex",c).next((d=>{for(const f of d){const p=Xp(this.serializer,f);a.set(p.getKey(),p)}return a}))}getOverlaysForCollectionGroup(e,t,r,a){const o=ei();let c;const d=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return mu(e).J({index:"collectionGroupOverlayIndex",range:d},((f,p,v)=>{const b=Xp(this.serializer,p);o.size()<a||b.largestBatchId===c?(o.set(b.getKey(),b),c=b.largestBatchId):v.done()})).next((()=>o))}ht(e,t){return mu(e).put((function(a,o,c){const[d,f,p]=fE(o,c.mutation.key);return{userId:o,collectionPath:f,documentId:p,collectionGroup:c.mutation.key.getCollectionGroup(),largestBatchId:c.largestBatchId,overlayMutation:Qu(a.ct,c.mutation)}})(this.serializer,this.userId,t))}}function mu(n){return sn(n,"documentOverlays")}class pP{Pt(e){return sn(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next((t=>{const r=t?.value;return r?Dt.fromUint8Array(r):Dt.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class to{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(It(e.integerValue));else if("doubleValue"in e){const r=It(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Bu(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Ki(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Qi(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?oI(e)?this.dt(t,Number.MAX_SAFE_INTEGER):cm(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):we()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const a of Object.keys(r))this.Vt(a,t),this.Tt(r[a],t)}wt(e,t){var r,a;const o=e.fields||{};this.dt(t,53);const c="value",d=((a=(r=o[c].arrayValue)===null||r===void 0?void 0:r.values)===null||a===void 0?void 0:a.length)||0;this.dt(t,15),t.At(It(d)),this.Vt(c,t),this.Tt(o[c],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const a of r)this.Tt(a,t)}yt(e,t){this.dt(t,37),be.fromName(e).path.forEach((r=>{this.dt(t,60),this.Dt(r,t)}))}dt(e,t){e.At(t)}ft(e){e.At(2)}}to.vt=new to;function yP(n){if(n===0)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function yE(n){const e=64-(function(r){let a=0;for(let o=0;o<8;++o){const c=yP(255&r[o]);if(a+=c,c!==8)break}return a})(n);return Math.ceil(e/8)}class vP{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const a=t.codePointAt(0);this.Ft(240|a>>>18),this.Ft(128|63&a>>>12),this.Ft(128|63&a>>>6),this.Ft(128|63&a)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const a=t.codePointAt(0);this.Ot(240|a>>>18),this.Ot(128|63&a>>>12),this.Ot(128|63&a>>>6),this.Ot(128|63&a)}}this.Nt()}kt(e){const t=this.qt(e),r=yE(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=255&t[a]}Kt(e){const t=this.qt(e),r=yE(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=~(255&t[a])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=(function(o){const c=new DataView(new ArrayBuffer(8));return c.setFloat64(0,o,!1),new Uint8Array(c.buffer)})(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let a=1;a<t.length;++a)t[a]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const a=new Uint8Array(r);a.set(this.buffer),this.buffer=a}}class _P{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class bP{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class gu{constructor(){this.jt=new vP,this.Ht=new _P(this.jt),this.Jt=new bP(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}class no{constructor(e,t,r,a){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=a}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new no(this.indexId,this.documentKey,this.arrayValue,r)}}function $s(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=vE(n.arrayValue,e.arrayValue),t!==0?t:(t=vE(n.directionalValue,e.directionalValue),t!==0?t:be.comparator(n.documentKey,e.documentKey)))}function vE(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}class _E{constructor(e){this.Xt=new mt(((t,r)=>Tt.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Te(e.collectionGroup===this.collectionId),this.nn)return!1;const t=xy(e);if(t!==void 0&&!this.sn(t))return!1;const r=Ja(e);let a=new Set,o=0,c=0;for(;o<r.length&&this.sn(r[o]);++o)a=a.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Xt.size>0){const d=this.Xt.getIterator().getNext();if(!a.has(d.field.canonicalString())){const f=r[o];if(!this.on(d,f)||!this._n(this.en[c++],f))return!1}++o}for(;o<r.length;++o){const d=r[o];if(c>=this.en.length||!this._n(this.en[c++],d))return!1}return!0}an(){if(this.nn)return null;let e=new mt(Tt.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new oo(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new oo(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new oo(r.field,r.dir==="asc"?0:1)));return new Dl(Dl.UNKNOWN_ID,this.collectionId,t,jl.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}function eA(n){var e,t;if(Te(n instanceof We||n instanceof ut),n instanceof We){if(n instanceof pI){const a=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map((o=>We.create(n.field,"==",o))))||[];return ut.create(a,"or")}return n}const r=n.filters.map((a=>eA(a)));return ut.create(r,n.op)}function xP(n){if(n.getFilters().length===0)return[];const e=Py(eA(n));return Te(tA(e)),jy(e)||Oy(e)?[e]:e.getFilters()}function jy(n){return n instanceof We}function Oy(n){return n instanceof ut&&g0(n)}function tA(n){return jy(n)||Oy(n)||(function(t){if(t instanceof ut&&Sy(t)){for(const r of t.getFilters())if(!jy(r)&&!Oy(r))return!1;return!0}return!1})(n)}function Py(n){if(Te(n instanceof We||n instanceof ut),n instanceof We)return n;if(n.filters.length===1)return Py(n.filters[0]);const e=n.filters.map((r=>Py(r)));let t=ut.create(e,n.op);return t=Uf(t),tA(t)?t:(Te(t instanceof ut),Te(Pl(t)),Te(t.filters.length>1),t.filters.reduce(((r,a)=>I0(r,a))))}function I0(n,e){let t;return Te(n instanceof We||n instanceof ut),Te(e instanceof We||e instanceof ut),t=n instanceof We?e instanceof We?(function(a,o){return ut.create([a,o],"and")})(n,e):bE(n,e):e instanceof We?bE(e,n):(function(a,o){if(Te(a.filters.length>0&&o.filters.length>0),Pl(a)&&Pl(o))return fI(a,o.getFilters());const c=Sy(a)?a:o,d=Sy(a)?o:a,f=c.filters.map((p=>I0(p,d)));return ut.create(f,"or")})(n,e),Uf(t)}function bE(n,e){if(Pl(e))return fI(e,n.getFilters());{const t=e.filters.map((r=>I0(n,r)));return ut.create(t,"or")}}function Uf(n){if(Te(n instanceof We||n instanceof ut),n instanceof We)return n;const e=n.getFilters();if(e.length===1)return Uf(e[0]);if(dI(n))return n;const t=e.map((a=>Uf(a))),r=[];return t.forEach((a=>{a instanceof We?r.push(a):a instanceof ut&&(a.op===n.op?r.push(...a.filters):r.push(a))})),r.length===1?r[0]:ut.create(r,n.op)}class wP{constructor(){this.un=new A0}addToCollectionParentIndex(e,t){return this.un.add(t),K.resolve()}getCollectionParents(e,t){return K.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return K.resolve()}deleteFieldIndex(e,t){return K.resolve()}deleteAllFieldIndexes(e){return K.resolve()}createTargetIndexes(e,t){return K.resolve()}getDocumentsMatchingTarget(e,t){return K.resolve(null)}getIndexType(e,t){return K.resolve(0)}getFieldIndexes(e,t){return K.resolve([])}getNextCollectionGroupToUpdate(e){return K.resolve(null)}getMinOffset(e,t){return K.resolve(ar.min())}getMinOffsetFromCollectionGroup(e,t){return K.resolve(ar.min())}updateCollectionGroup(e,t,r){return K.resolve()}updateIndexEntries(e,t){return K.resolve()}}class A0{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t]||new mt(Ye.comparator),o=!a.has(r);return this.index[t]=a.add(r),o}has(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t];return a&&a.has(r)}getEntries(e){return(this.index[e]||new mt(Ye.comparator)).toArray()}}const ef=new Uint8Array(0);class EP{constructor(e,t){this.databaseId=t,this.cn=new A0,this.ln=new Zi((r=>uo(r)),((r,a)=>od(r,a))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),a=t.popLast();e.addOnCommittedListener((()=>{this.cn.add(t)}));const o={collectionId:r,parent:Rn(a)};return xE(e).put(o)}return K.resolve()}getCollectionParents(e,t){const r=[],a=IDBKeyRange.bound([t,""],[KS(t),""],!1,!0);return xE(e).U(a).next((o=>{for(const c of o){if(c.collectionId!==t)break;r.push(Zr(c.parent))}return r}))}addFieldIndex(e,t){const r=pu(e),a=(function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete a.indexId;const o=r.add(a);if(t.indexState){const c=pl(e);return o.next((d=>{c.put(mE(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return o.next()}deleteFieldIndex(e,t){const r=pu(e),a=pl(e),o=gl(e);return r.delete(t.indexId).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=pu(e),r=gl(e),a=pl(e);return t.j().next((()=>r.j())).next((()=>a.j()))}createTargetIndexes(e,t){return K.forEach(this.hn(t),(r=>this.getIndexType(e,r).next((a=>{if(a===0||a===1){const o=new _E(r).an();if(o!=null)return this.addFieldIndex(e,o)}}))))}getDocumentsMatchingTarget(e,t){const r=gl(e);let a=!0;const o=new Map;return K.forEach(this.hn(t),(c=>this.Pn(e,c).next((d=>{a&&(a=!!d),o.set(c,d)})))).next((()=>{if(a){let c=Le();const d=[];return K.forEach(o,((f,p)=>{fe("IndexedDbIndexManager",`Using index ${(function(X){return`id=${X.indexId}|cg=${X.collectionGroup}|f=${X.fields.map((de=>`${de.fieldPath}:${de.kind}`)).join(",")}`})(f)} to execute ${uo(t)}`);const v=(function(X,de){const ve=xy(de);if(ve===void 0)return null;for(const ge of Pf(X,ve.fieldPath))switch(ge.op){case"array-contains-any":return ge.value.arrayValue.values||[];case"array-contains":return[ge.value]}return null})(p,f),b=(function(X,de){const ve=new Map;for(const ge of Ja(de))for(const D of Pf(X,ge.fieldPath))switch(D.op){case"==":case"in":ve.set(ge.fieldPath.canonicalString(),D.value);break;case"not-in":case"!=":return ve.set(ge.fieldPath.canonicalString(),D.value),Array.from(ve.values())}return null})(p,f),E=(function(X,de){const ve=[];let ge=!0;for(const D of Ja(de)){const C=D.kind===0?Zw(X,D.fieldPath,X.startAt):eE(X,D.fieldPath,X.startAt);ve.push(C.value),ge&&(ge=C.inclusive)}return new oa(ve,ge)})(p,f),S=(function(X,de){const ve=[];let ge=!0;for(const D of Ja(de)){const C=D.kind===0?eE(X,D.fieldPath,X.endAt):Zw(X,D.fieldPath,X.endAt);ve.push(C.value),ge&&(ge=C.inclusive)}return new oa(ve,ge)})(p,f),R=this.In(f,p,E),j=this.In(f,p,S),N=this.Tn(f,p,b),I=this.En(f.indexId,v,R,E.inclusive,j,S.inclusive,N);return K.forEach(I,(te=>r.G(te,t.limit).next((X=>{X.forEach((de=>{const ve=be.fromSegments(de.documentKey);c.has(ve)||(c=c.add(ve),d.push(ve))}))}))))})).next((()=>d))}return K.resolve(null)}))}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=xP(ut.create(e.filters,"and")).map((r=>Ay(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.ln.set(e,t),t)}En(e,t,r,a,o,c,d){const f=(t!=null?t.length:1)*Math.max(r.length,o.length),p=f/(t!=null?t.length:1),v=[];for(let b=0;b<f;++b){const E=t?this.dn(t[b/p]):ef,S=this.An(e,E,r[b%p],a),R=this.Rn(e,E,o[b%p],c),j=d.map((N=>this.An(e,E,N,!0)));v.push(...this.createRange(S,R,j))}return v}An(e,t,r,a){const o=new no(e,be.empty(),t,r);return a?o:o.Zt()}Rn(e,t,r,a){const o=new no(e,be.empty(),t,r);return a?o.Zt():o}Pn(e,t){const r=new _E(t),a=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,a).next((o=>{let c=null;for(const d of o)r.rn(d)&&(!c||d.fields.length>c.fields.length)&&(c=d);return c}))}getIndexType(e,t){let r=2;const a=this.hn(t);return K.forEach(a,(o=>this.Pn(e,o).next((c=>{c?r!==0&&c.fields.length<(function(f){let p=new mt(Tt.comparator),v=!1;for(const b of f.filters)for(const E of b.getFlattenedFilters())E.field.isKeyField()||(E.op==="array-contains"||E.op==="array-contains-any"?v=!0:p=p.add(E.field));for(const b of f.orderBy)b.field.isKeyField()||(p=p.add(b.field));return p.size+(v?1:0)})(o)&&(r=1):r=0})))).next((()=>(function(c){return c.limit!==null})(t)&&a.length>1&&r===2?1:r))}Vn(e,t){const r=new gu;for(const a of Ja(e)){const o=t.data.field(a.fieldPath);if(o==null)return null;const c=r.Yt(a.kind);to.vt.It(o,c)}return r.zt()}dn(e){const t=new gu;return to.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new gu;return to.vt.It(co(this.databaseId,t),r.Yt((function(o){const c=Ja(o);return c.length===0?0:c[c.length-1].kind})(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let a=[];a.push(new gu);let o=0;for(const c of Ja(e)){const d=r[o++];for(const f of a)if(this.fn(t,c.fieldPath)&&$u(d))a=this.gn(a,c,d);else{const p=f.Yt(c.kind);to.vt.It(d,p)}}return this.pn(a)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const a=[...e],o=[];for(const c of r.arrayValue.values||[])for(const d of a){const f=new gu;f.seed(d.zt()),to.vt.It(c,f.Yt(t.kind)),o.push(f)}return o}fn(e,t){return!!e.filters.find((r=>r instanceof We&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=pu(e),a=pl(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next((o=>{const c=[];return K.forEach(o,(d=>a.get([d.indexId,this.uid]).next((f=>{c.push((function(v,b){const E=b?new jl(b.sequenceNumber,new ar(go(b.readTime),new be(Zr(b.documentKey)),b.largestBatchId)):jl.empty(),S=v.fields.map((([R,j])=>new oo(Tt.fromServerFormat(R),j)));return new Dl(v.indexId,v.collectionGroup,S,E)})(d,f))})))).next((()=>c))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,a)=>{const o=r.indexState.sequenceNumber-a.indexState.sequenceNumber;return o!==0?o:je(r.collectionGroup,a.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const a=pu(e),o=pl(e);return this.yn(e).next((c=>a.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((d=>K.forEach(d,(f=>o.put(mE(f.indexId,this.uid,c,r))))))))}updateIndexEntries(e,t){const r=new Map;return K.forEach(t,((a,o)=>{const c=r.get(a.collectionGroup);return(c?K.resolve(c):this.getFieldIndexes(e,a.collectionGroup)).next((d=>(r.set(a.collectionGroup,d),K.forEach(d,(f=>this.wn(e,a,f).next((p=>{const v=this.Sn(o,f);return p.isEqual(v)?K.resolve():this.bn(e,o,f,p,v)})))))))}))}Dn(e,t,r,a){return gl(e).put({indexId:a.indexId,uid:this.uid,arrayValue:a.arrayValue,directionalValue:a.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,a){return gl(e).delete([a.indexId,this.uid,a.arrayValue,a.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const a=gl(e);let o=new mt($s);return a.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},((c,d)=>{o=o.add(new no(r.indexId,t,d.arrayValue,d.directionalValue))})).next((()=>o))}Sn(e,t){let r=new mt($s);const a=this.Vn(t,e);if(a==null)return r;const o=xy(t);if(o!=null){const c=e.data.field(o.fieldPath);if($u(c))for(const d of c.arrayValue.values||[])r=r.add(new no(t.indexId,e.key,this.dn(d),a))}else r=r.add(new no(t.indexId,e.key,ef,a));return r}bn(e,t,r,a,o){fe("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const c=[];return(function(f,p,v,b,E){const S=f.getIterator(),R=p.getIterator();let j=ml(S),N=ml(R);for(;j||N;){let I=!1,te=!1;if(j&&N){const X=v(j,N);X<0?te=!0:X>0&&(I=!0)}else j!=null?te=!0:I=!0;I?(b(N),N=ml(R)):te?(E(j),j=ml(S)):(j=ml(S),N=ml(R))}})(a,o,$s,(d=>{c.push(this.Dn(e,t,r,d))}),(d=>{c.push(this.vn(e,t,r,d))})),K.waitFor(c)}yn(e){let t=1;return pl(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,a,o)=>{o.done(),t=a.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((c,d)=>$s(c,d))).filter(((c,d,f)=>!d||$s(c,f[d-1])!==0));const a=[];a.push(e);for(const c of r){const d=$s(c,e),f=$s(c,t);if(d===0)a[0]=e.Zt();else if(d>0&&f<0)a.push(c),a.push(c.Zt());else if(f>0)break}a.push(t);const o=[];for(let c=0;c<a.length;c+=2){if(this.Cn(a[c],a[c+1]))return[];const d=[a[c].indexId,this.uid,a[c].arrayValue,a[c].directionalValue,ef,[]],f=[a[c+1].indexId,this.uid,a[c+1].arrayValue,a[c+1].directionalValue,ef,[]];o.push(IDBKeyRange.bound(d,f))}return o}Cn(e,t){return $s(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(wE)}getMinOffset(e,t){return K.mapArray(this.hn(t),(r=>this.Pn(e,r).next((a=>a||we())))).next(wE)}}function xE(n){return sn(n,"collectionParents")}function gl(n){return sn(n,"indexEntries")}function pu(n){return sn(n,"indexConfiguration")}function pl(n){return sn(n,"indexState")}function wE(n){Te(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const a=n[r].indexState.offset;h0(a,e)<0&&(e=a),t<a.largestBatchId&&(t=a.largestBatchId)}return new ar(e.readTime,e.documentKey,t)}const EE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Cn{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Cn(e,Cn.DEFAULT_COLLECTION_PERCENTILE,Cn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function nA(n,e,t){const r=n.store("mutations"),a=n.store("documentMutations"),o=[],c=IDBKeyRange.only(t.batchId);let d=0;const f=r.J({range:c},((v,b,E)=>(d++,E.delete())));o.push(f.next((()=>{Te(d===1)})));const p=[];for(const v of t.mutations){const b=eI(e,v.key.path,t.batchId);o.push(a.delete(b)),p.push(v.key)}return K.waitFor(o).next((()=>p))}function zf(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw we();e=n.noDocument}return JSON.stringify(e).length}Cn.DEFAULT_COLLECTION_PERCENTILE=10,Cn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Cn.DEFAULT=new Cn(41943040,Cn.DEFAULT_COLLECTION_PERCENTILE,Cn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Cn.DISABLED=new Cn(-1,0,0);class mm{constructor(e,t,r,a){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=a,this.Fn={}}static lt(e,t,r,a){Te(e.uid!=="");const o=e.isAuthenticated()?e.uid:"";return new mm(o,t,r,a)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Hs(e).J({index:"userMutationsIndex",range:r},((a,o,c)=>{t=!1,c.done()})).next((()=>t))}addMutationBatch(e,t,r,a){const o=xl(e),c=Hs(e);return c.add({}).next((d=>{Te(typeof d=="number");const f=new b0(d,t,r,a),p=(function(S,R,j){const N=j.baseMutations.map((te=>Qu(S.ct,te))),I=j.mutations.map((te=>Qu(S.ct,te)));return{userId:R,batchId:j.batchId,localWriteTimeMs:j.localWriteTime.toMillis(),baseMutations:N,mutations:I}})(this.serializer,this.userId,f),v=[];let b=new mt(((E,S)=>je(E.canonicalString(),S.canonicalString())));for(const E of a){const S=eI(this.userId,E.key.path,d);b=b.add(E.key.path.popLast()),v.push(c.put(p)),v.push(o.put(S,uO))}return b.forEach((E=>{v.push(this.indexManager.addToCollectionParentIndex(e,E))})),e.addOnCommittedListener((()=>{this.Fn[d]=f.keys()})),K.waitFor(v).next((()=>f))}))}lookupMutationBatch(e,t){return Hs(e).get(t).next((r=>r?(Te(r.userId===this.userId),eo(this.serializer,r)):null))}Mn(e,t){return this.Fn[t]?K.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const a=r.keys();return this.Fn[t]=a,a}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=IDBKeyRange.lowerBound([this.userId,r]);let o=null;return Hs(e).J({index:"userMutationsIndex",range:a},((c,d,f)=>{d.userId===this.userId&&(Te(d.batchId>=r),o=eo(this.serializer,d)),f.done()})).next((()=>o))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Hs(e).J({index:"userMutationsIndex",range:t,reverse:!0},((a,o,c)=>{r=o.batchId,c.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Hs(e).U("userMutationsIndex",t).next((r=>r.map((a=>eo(this.serializer,a)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=mf(this.userId,t.path),a=IDBKeyRange.lowerBound(r),o=[];return xl(e).J({range:a},((c,d,f)=>{const[p,v,b]=c,E=Zr(v);if(p===this.userId&&t.path.isEqual(E))return Hs(e).get(b).next((S=>{if(!S)throw we();Te(S.userId===this.userId),o.push(eo(this.serializer,S))}));f.done()})).next((()=>o))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new mt(je);const a=[];return t.forEach((o=>{const c=mf(this.userId,o.path),d=IDBKeyRange.lowerBound(c),f=xl(e).J({range:d},((p,v,b)=>{const[E,S,R]=p,j=Zr(S);E===this.userId&&o.path.isEqual(j)?r=r.add(R):b.done()}));a.push(f)})),K.waitFor(a).next((()=>this.xn(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1,o=mf(this.userId,r),c=IDBKeyRange.lowerBound(o);let d=new mt(je);return xl(e).J({range:c},((f,p,v)=>{const[b,E,S]=f,R=Zr(E);b===this.userId&&r.isPrefixOf(R)?R.length===a&&(d=d.add(S)):v.done()})).next((()=>this.xn(e,d)))}xn(e,t){const r=[],a=[];return t.forEach((o=>{a.push(Hs(e).get(o).next((c=>{if(c===null)throw we();Te(c.userId===this.userId),r.push(eo(this.serializer,c))})))})),K.waitFor(a).next((()=>r))}removeMutationBatch(e,t){return nA(e._e,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.On(t.batchId)})),K.forEach(r,(a=>this.referenceDelegate.markPotentiallyOrphaned(e,a))))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return K.resolve();const r=IDBKeyRange.lowerBound((function(c){return[c]})(this.userId)),a=[];return xl(e).J({range:r},((o,c,d)=>{if(o[0]===this.userId){const f=Zr(o[1]);a.push(f)}else d.done()})).next((()=>{Te(a.length===0)}))}))}containsKey(e,t){return rA(e,this.userId,t)}Nn(e){return iA(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function rA(n,e,t){const r=mf(e,t.path),a=r[1],o=IDBKeyRange.lowerBound(r);let c=!1;return xl(n).J({range:o,H:!0},((d,f,p)=>{const[v,b,E]=d;v===e&&b===a&&(c=!0),p.done()})).next((()=>c))}function Hs(n){return sn(n,"mutations")}function xl(n){return sn(n,"documentMutations")}function iA(n){return sn(n,"mutationQueues")}class po{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new po(0)}static kn(){return new po(-1)}}class TP{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next((t=>{const r=new po(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.qn(e).next((t=>Ae.fromTimestamp(new Be(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.qn(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.qn(e).next((a=>(a.highestListenSequenceNumber=t,r&&(a.lastRemoteSnapshotVersion=r.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),this.Qn(e,a))))}addTargetData(e,t){return this.Kn(e,t).next((()=>this.qn(e).next((r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>yl(e).delete(t.targetId))).next((()=>this.qn(e))).next((r=>(Te(r.targetCount>0),r.targetCount-=1,this.Qn(e,r))))}removeTargets(e,t,r){let a=0;const o=[];return yl(e).J(((c,d)=>{const f=Iu(d);f.sequenceNumber<=t&&r.get(f.targetId)===null&&(a++,o.push(this.removeTargetData(e,f)))})).next((()=>K.waitFor(o))).next((()=>a))}forEachTarget(e,t){return yl(e).J(((r,a)=>{const o=Iu(a);t(o)}))}qn(e){return TE(e).get("targetGlobalKey").next((t=>(Te(t!==null),t)))}Qn(e,t){return TE(e).put("targetGlobalKey",t)}Kn(e,t){return yl(e).put(ZI(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next((t=>t.targetCount))}getTargetData(e,t){const r=uo(t),a=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let o=null;return yl(e).J({range:a,index:"queryTargetsIndex"},((c,d,f)=>{const p=Iu(d);od(t,p.target)&&(o=p,f.done())})).next((()=>o))}addMatchingKeys(e,t,r){const a=[],o=Ys(e);return t.forEach((c=>{const d=Rn(c.path);a.push(o.put({targetId:r,path:d})),a.push(this.referenceDelegate.addReference(e,r,c))})),K.waitFor(a)}removeMatchingKeys(e,t,r){const a=Ys(e);return K.forEach(t,(o=>{const c=Rn(o.path);return K.waitFor([a.delete([r,c]),this.referenceDelegate.removeReference(e,r,o)])}))}removeMatchingKeysForTargetId(e,t){const r=Ys(e),a=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(a)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),a=Ys(e);let o=Le();return a.J({range:r,H:!0},((c,d,f)=>{const p=Zr(c[1]),v=new be(p);o=o.add(v)})).next((()=>o))}containsKey(e,t){const r=Rn(t.path),a=IDBKeyRange.bound([r],[KS(r)],!1,!0);let o=0;return Ys(e).J({index:"documentTargetsIndex",H:!0,range:a},(([c,d],f,p)=>{c!==0&&(o++,p.done())})).next((()=>o>0))}ot(e,t){return yl(e).get(t).next((r=>r?Iu(r):null))}}function yl(n){return sn(n,"targets")}function TE(n){return sn(n,"targetGlobal")}function Ys(n){return sn(n,"targetDocuments")}function SE([n,e],[t,r]){const a=je(n,t);return a===0?je(e,r):a}class SP{constructor(e){this.Un=e,this.buffer=new mt(SE),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();SE(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class sA{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){fe("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){pa(t)?fe("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await ga(t)}await this.Hn(3e5)}))}}class IP{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return K.resolve(Hn.oe);const r=new SP(t);return this.Jn.forEachTarget(e,(a=>r.zn(a.sequenceNumber))).next((()=>this.Jn.Zn(e,(a=>r.zn(a))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),K.resolve(EE)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),EE):this.Xn(e,t)))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,a,o,c,d,f,p;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((b=>(b>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),a=this.params.maximumSequenceNumbersToCollect):a=b,c=Date.now(),this.nthSequenceNumber(e,a)))).next((b=>(r=b,d=Date.now(),this.removeTargets(e,r,t)))).next((b=>(o=b,f=Date.now(),this.removeOrphanedDocuments(e,r)))).next((b=>(p=Date.now(),vl()<=Qe.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-v}ms
	Determined least recently used ${a} in `+(d-c)+`ms
	Removed ${o} targets in `+(f-d)+`ms
	Removed ${b} documents in `+(p-f)+`ms
Total Duration: ${p-v}ms`),K.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:o,documentsRemoved:b}))))}}function aA(n,e){return new IP(n,e)}class AP{constructor(e,t){this.db=e,this.garbageCollector=aA(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((a=>r+a))))}er(e){let t=0;return this.Zn(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,((r,a)=>t(a)))}addReference(e,t,r){return tf(e,r)}removeReference(e,t,r){return tf(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return tf(e,t)}nr(e,t){return(function(a,o){let c=!1;return iA(a).Y((d=>rA(a,d,o).next((f=>(f&&(c=!0),K.resolve(!f)))))).next((()=>c))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let o=0;return this.tr(e,((c,d)=>{if(d<=t){const f=this.nr(e,c).next((p=>{if(!p)return o++,r.getEntry(e,c).next((()=>(r.removeEntry(c,Ae.min()),Ys(e).delete((function(b){return[0,Rn(b.path)]})(c)))))}));a.push(f)}})).next((()=>K.waitFor(a))).next((()=>r.apply(e))).next((()=>o))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return tf(e,t)}tr(e,t){const r=Ys(e);let a,o=Hn.oe;return r.J({index:"documentTargetsIndex"},(([c,d],{path:f,sequenceNumber:p})=>{c===0?(o!==Hn.oe&&t(new be(Zr(a)),o),o=p,a=f):o=Hn.oe})).next((()=>{o!==Hn.oe&&t(new be(Zr(a)),o)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function tf(n,e){return Ys(n).put((function(r,a){return{targetId:0,path:Rn(r.path),sequenceNumber:a}})(e,n.currentSequenceNumber))}class oA{constructor(){this.changes=new Zi((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Et.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?K.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class NP{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Wa(e).put(r)}removeEntry(e,t,r){return Wa(e).delete((function(o,c){const d=o.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],Lf(c),d[d.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.rr(e,r))))}getEntry(e,t){let r=Et.newInvalidDocument(t);return Wa(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(yu(t))},((a,o)=>{r=this.ir(t,o)})).next((()=>r))}sr(e,t){let r={size:0,document:Et.newInvalidDocument(t)};return Wa(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(yu(t))},((a,o)=>{r={document:this.ir(t,o),size:zf(o)}})).next((()=>r))}getEntries(e,t){let r=Qn();return this._r(e,t,((a,o)=>{const c=this.ir(a,o);r=r.insert(a,c)})).next((()=>r))}ar(e,t){let r=Qn(),a=new vt(be.comparator);return this._r(e,t,((o,c)=>{const d=this.ir(o,c);r=r.insert(o,d),a=a.insert(o,zf(c))})).next((()=>({documents:r,ur:a})))}_r(e,t,r){if(t.isEmpty())return K.resolve();let a=new mt(NE);t.forEach((f=>a=a.add(f)));const o=IDBKeyRange.bound(yu(a.first()),yu(a.last())),c=a.getIterator();let d=c.getNext();return Wa(e).J({index:"documentKeyIndex",range:o},((f,p,v)=>{const b=be.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;d&&NE(d,b)<0;)r(d,null),d=c.getNext();d&&d.isEqual(b)&&(r(d,p),d=c.hasNext()?c.getNext():null),d?v.$(yu(d)):v.done()})).next((()=>{for(;d;)r(d,null),d=c.hasNext()?c.getNext():null}))}getDocumentsMatchingQuery(e,t,r,a,o){const c=t.path,d=[c.popLast().toArray(),c.lastSegment(),Lf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],f=[c.popLast().toArray(),c.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Wa(e).U(IDBKeyRange.bound(d,f,!0)).next((p=>{o?.incrementDocumentReadCount(p.length);let v=Qn();for(const b of p){const E=this.ir(be.fromSegments(b.prefixPath.concat(b.collectionGroup,b.documentId)),b);E.isFoundDocument()&&(cd(t,E)||a.has(E.key))&&(v=v.insert(E.key,E))}return v}))}getAllFromCollectionGroup(e,t,r,a){let o=Qn();const c=AE(t,r),d=AE(t,ar.max());return Wa(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(c,d,!0)},((f,p,v)=>{const b=this.ir(be.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);o=o.insert(b.key,b),o.size===a&&v.done()})).next((()=>o))}newChangeBuffer(e){return new CP(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return IE(e).get("remoteDocumentGlobalKey").next((t=>(Te(!!t),t)))}rr(e,t){return IE(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=mP(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(Ae.min())))return r}return Et.newInvalidDocument(e)}}function lA(n){return new NP(n)}class CP extends oA{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Zi((r=>r.toString()),((r,a)=>r.isEqual(a)))}applyChanges(e){const t=[];let r=0,a=new mt(((o,c)=>je(o.canonicalString(),c.canonicalString())));return this.changes.forEach(((o,c)=>{const d=this.lr.get(o);if(t.push(this.cr.removeEntry(e,o,d.readTime)),c.isValidDocument()){const f=hE(this.cr.serializer,c);a=a.add(o.path.popLast());const p=zf(f);r+=p-d.size,t.push(this.cr.addEntry(e,o,f))}else if(r-=d.size,this.trackRemovals){const f=hE(this.cr.serializer,c.convertToNoDocument(Ae.min()));t.push(this.cr.addEntry(e,o,f))}})),a.forEach((o=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,o))})),t.push(this.cr.updateMetadata(e,r)),K.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next((r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.cr.ar(e,t).next((({documents:r,ur:a})=>(a.forEach(((o,c)=>{this.lr.set(o,{size:c,readTime:r.get(o).readTime})})),r)))}}function IE(n){return sn(n,"remoteDocumentGlobal")}function Wa(n){return sn(n,"remoteDocumentsV14")}function yu(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function AE(n,e){const t=e.documentKey.path.toArray();return[n,Lf(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function NE(n,e){const t=n.path.toArray(),r=e.path.toArray();let a=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(a=je(t[o],r[o]),a)return a;return a=je(t.length,r.length),a||(a=je(t[t.length-2],r[r.length-2]),a||je(t[t.length-1],r[r.length-1]))}class RP{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class cA{constructor(e,t,r,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((a=>(r=a,this.remoteDocumentCache.getEntry(e,t)))).next((a=>(r!==null&&ju(r.mutation,a,Kn.empty(),Be.now()),a)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Le()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Le()){const a=ei();return this.populateOverlays(e,a,t).next((()=>this.computeViews(e,t,a,r).next((o=>{let c=Tu();return o.forEach(((d,f)=>{c=c.insert(d,f.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const r=ei();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Le())))}populateOverlays(e,t,r){const a=[];return r.forEach((o=>{t.has(o)||a.push(o)})),this.documentOverlayCache.getOverlays(e,a).next((o=>{o.forEach(((c,d)=>{t.set(c,d)}))}))}computeViews(e,t,r,a){let o=Qn();const c=Du(),d=(function(){return Du()})();return t.forEach(((f,p)=>{const v=r.get(p.key);a.has(p.key)&&(v===void 0||v.mutation instanceof es)?o=o.insert(p.key,p):v!==void 0?(c.set(p.key,v.mutation.getFieldMask()),ju(v.mutation,p,v.mutation.getFieldMask(),Be.now())):c.set(p.key,Kn.empty())})),this.recalculateAndSaveOverlays(e,o).next((f=>(f.forEach(((p,v)=>c.set(p,v))),t.forEach(((p,v)=>{var b;return d.set(p,new RP(v,(b=c.get(p))!==null&&b!==void 0?b:null))})),d)))}recalculateAndSaveOverlays(e,t){const r=Du();let a=new vt(((c,d)=>c-d)),o=Le();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const d of c)d.keys().forEach((f=>{const p=t.get(f);if(p===null)return;let v=r.get(f)||Kn.empty();v=d.applyToLocalView(p,v),r.set(f,v);const b=(a.get(d.batchId)||Le()).add(f);a=a.insert(d.batchId,b)}))})).next((()=>{const c=[],d=a.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),p=f.key,v=f.value,b=SI();v.forEach((E=>{if(!o.has(E)){const S=DI(t.get(E),r.get(E));S!==null&&b.set(E,S),o=o.add(E)}})),c.push(this.documentOverlayCache.saveOverlays(e,p,b))}return K.waitFor(c)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,a){return(function(c){return be.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):p0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,a):this.getDocumentsMatchingCollectionQuery(e,t,r,a)}getNextDocuments(e,t,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,a).next((o=>{const c=a-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,a-o.size):K.resolve(ei());let d=-1,f=o;return c.next((p=>K.forEach(p,((v,b)=>(d<b.largestBatchId&&(d=b.largestBatchId),o.get(v)?K.resolve():this.remoteDocumentCache.getEntry(e,v).next((E=>{f=f.insert(v,E)}))))).next((()=>this.populateOverlays(e,p,o))).next((()=>this.computeViews(e,f,p,Le()))).next((v=>({batchId:d,changes:TI(v)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new be(t)).next((r=>{let a=Tu();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,a){const o=t.collectionGroup;let c=Tu();return this.indexManager.getCollectionParents(e,o).next((d=>K.forEach(d,(f=>{const p=(function(b,E){return new Ji(E,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)})(t,f.child(o));return this.getDocumentsMatchingCollectionQuery(e,p,r,a).next((v=>{v.forEach(((b,E)=>{c=c.insert(b,E)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,r,a){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,a)))).next((c=>{o.forEach(((f,p)=>{const v=p.getKey();c.get(v)===null&&(c=c.insert(v,Et.newInvalidDocument(v)))}));let d=Tu();return c.forEach(((f,p)=>{const v=o.get(f);v!==void 0&&ju(v.mutation,p,Kn.empty(),Be.now()),cd(t,p)&&(d=d.insert(f,p))})),d}))}}class kP{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return K.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,(function(a){return{id:a.id,version:a.version,createTime:Ht(a.createTime)}})(t)),K.resolve()}getNamedQuery(e,t){return K.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,(function(a){return{name:a.name,query:S0(a.bundledQuery),readTime:Ht(a.readTime)}})(t)),K.resolve()}}class DP{constructor(){this.overlays=new vt(be.comparator),this.Ir=new Map}getOverlay(e,t){return K.resolve(this.overlays.get(t))}getOverlays(e,t){const r=ei();return K.forEach(t,(a=>this.getOverlay(e,a).next((o=>{o!==null&&r.set(a,o)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((a,o)=>{this.ht(e,t,o)})),K.resolve()}removeOverlaysForBatchId(e,t,r){const a=this.Ir.get(r);return a!==void 0&&(a.forEach((o=>this.overlays=this.overlays.remove(o))),this.Ir.delete(r)),K.resolve()}getOverlaysForCollection(e,t,r){const a=ei(),o=t.length+1,c=new be(t.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const f=d.getNext().value,p=f.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===o&&f.largestBatchId>r&&a.set(f.getKey(),f)}return K.resolve(a)}getOverlaysForCollectionGroup(e,t,r,a){let o=new vt(((p,v)=>p-v));const c=this.overlays.getIterator();for(;c.hasNext();){const p=c.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>r){let v=o.get(p.largestBatchId);v===null&&(v=ei(),o=o.insert(p.largestBatchId,v)),v.set(p.getKey(),p)}}const d=ei(),f=o.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,v)=>d.set(p,v))),!(d.size()>=a)););return K.resolve(d)}ht(e,t,r){const a=this.overlays.get(r.key);if(a!==null){const c=this.Ir.get(a.largestBatchId).delete(r.key);this.Ir.set(a.largestBatchId,c)}this.overlays=this.overlays.insert(r.key,new w0(t,r));let o=this.Ir.get(t);o===void 0&&(o=Le(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}}class jP{constructor(){this.sessionToken=Dt.EMPTY_BYTE_STRING}getSessionToken(e){return K.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,K.resolve()}}class N0{constructor(){this.Tr=new mt(dn.Er),this.dr=new mt(dn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new dn(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Vr(new dn(e,t))}mr(e,t){e.forEach((r=>this.removeReference(r,t)))}gr(e){const t=new be(new Ye([])),r=new dn(t,e),a=new dn(t,e+1),o=[];return this.dr.forEachInRange([r,a],(c=>{this.Vr(c),o.push(c.key)})),o}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new be(new Ye([])),r=new dn(t,e),a=new dn(t,e+1);let o=Le();return this.dr.forEachInRange([r,a],(c=>{o=o.add(c.key)})),o}containsKey(e){const t=new dn(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class dn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return be.comparator(e.key,t.key)||je(e.wr,t.wr)}static Ar(e,t){return je(e.wr,t.wr)||be.comparator(e.key,t.key)}}class OP{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new mt(dn.Er)}checkEmpty(e){return K.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,a){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new b0(o,t,r,a);this.mutationQueue.push(c);for(const d of a)this.br=this.br.add(new dn(d.key,o)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return K.resolve(c)}lookupMutationBatch(e,t){return K.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=this.vr(r),o=a<0?0:a;return K.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return K.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return K.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new dn(t,0),a=new dn(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,a],(c=>{const d=this.Dr(c.wr);o.push(d)})),K.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new mt(je);return t.forEach((a=>{const o=new dn(a,0),c=new dn(a,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,c],(d=>{r=r.add(d.wr)}))})),K.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1;let o=r;be.isDocumentKey(o)||(o=o.child(""));const c=new dn(new be(o),0);let d=new mt(je);return this.br.forEachWhile((f=>{const p=f.key.path;return!!r.isPrefixOf(p)&&(p.length===a&&(d=d.add(f.wr)),!0)}),c),K.resolve(this.Cr(d))}Cr(e){const t=[];return e.forEach((r=>{const a=this.Dr(r);a!==null&&t.push(a)})),t}removeMutationBatch(e,t){Te(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return K.forEach(t.mutations,(a=>{const o=new dn(a.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.br=r}))}On(e){}containsKey(e,t){const r=new dn(t,0),a=this.br.firstAfterOrEqual(r);return K.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,K.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class PP{constructor(e){this.Mr=e,this.docs=(function(){return new vt(be.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,a=this.docs.get(r),o=a?a.size:0,c=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return K.resolve(r?r.document.mutableCopy():Et.newInvalidDocument(t))}getEntries(e,t){let r=Qn();return t.forEach((a=>{const o=this.docs.get(a);r=r.insert(a,o?o.document.mutableCopy():Et.newInvalidDocument(a))})),K.resolve(r)}getDocumentsMatchingQuery(e,t,r,a){let o=Qn();const c=t.path,d=new be(c.child("")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:p,value:{document:v}}=f.getNext();if(!c.isPrefixOf(p.path))break;p.path.length>c.length+1||h0(YS(v),r)<=0||(a.has(v.key)||cd(t,v))&&(o=o.insert(v.key,v.mutableCopy()))}return K.resolve(o)}getAllFromCollectionGroup(e,t,r,a){we()}Or(e,t){return K.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new VP(this)}getSize(e){return K.resolve(this.size)}}class VP extends oA{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((r,a)=>{a.isValidDocument()?t.push(this.cr.addEntry(e,a)):this.cr.removeEntry(r)})),K.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class MP{constructor(e){this.persistence=e,this.Nr=new Zi((t=>uo(t)),od),this.lastRemoteSnapshotVersion=Ae.min(),this.highestTargetId=0,this.Lr=0,this.Br=new N0,this.targetCount=0,this.kr=po.Bn()}forEachTarget(e,t){return this.Nr.forEach(((r,a)=>t(a))),K.resolve()}getLastRemoteSnapshotVersion(e){return K.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return K.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),K.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),K.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new po(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,K.resolve()}updateTargetData(e,t){return this.Kn(t),K.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,K.resolve()}removeTargets(e,t,r){let a=0;const o=[];return this.Nr.forEach(((c,d)=>{d.sequenceNumber<=t&&r.get(d.targetId)===null&&(this.Nr.delete(c),o.push(this.removeMatchingKeysForTargetId(e,d.targetId)),a++)})),K.waitFor(o).next((()=>a))}getTargetCount(e){return K.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return K.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),K.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const a=this.persistence.referenceDelegate,o=[];return a&&t.forEach((c=>{o.push(a.markPotentiallyOrphaned(e,c))})),K.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),K.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return K.resolve(r)}containsKey(e,t){return K.resolve(this.Br.containsKey(t))}}class C0{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Hn(0),this.Kr=!1,this.Kr=!0,this.$r=new jP,this.referenceDelegate=e(this),this.Ur=new MP(this),this.indexManager=new wP,this.remoteDocumentCache=(function(a){return new PP(a)})((r=>this.referenceDelegate.Wr(r))),this.serializer=new JI(t),this.Gr=new kP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new DP,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new OP(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){fe("MemoryPersistence","Starting transaction:",e);const a=new LP(this.Qr.next());return this.referenceDelegate.zr(),r(a).next((o=>this.referenceDelegate.jr(a).next((()=>o)))).toPromise().then((o=>(a.raiseOnCommittedEvent(),o)))}Hr(e,t){return K.or(Object.values(this.qr).map((r=>()=>r.containsKey(e,t))))}}class LP extends XS{constructor(e){super(),this.currentSequenceNumber=e}}class gm{constructor(e){this.persistence=e,this.Jr=new N0,this.Yr=null}static Zr(e){return new gm(e)}get Xr(){if(this.Yr)return this.Yr;throw we()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),K.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),K.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),K.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((a=>this.Xr.add(a.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((a=>{a.forEach((o=>this.Xr.add(o.toString())))})).next((()=>r.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return K.forEach(this.Xr,(r=>{const a=be.fromPath(r);return this.ei(e,a).next((o=>{o||t.removeEntry(a,Ae.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return K.or([()=>K.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class Ff{constructor(e,t){this.persistence=e,this.ti=new Zi((r=>Rn(r.path)),((r,a)=>r.isEqual(a))),this.garbageCollector=aA(this,t)}static Zr(e,t){return new Ff(e,t)}zr(){}jr(e){return K.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Yn(e){const t=this.er(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((a=>r+a))))}er(e){let t=0;return this.Zn(e,(r=>{t++})).next((()=>t))}Zn(e,t){return K.forEach(this.ti,((r,a)=>this.nr(e,r,a).next((o=>o?K.resolve():t(a)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const a=this.persistence.getRemoteDocumentCache(),o=a.newChangeBuffer();return a.Or(e,(c=>this.nr(e,c,t).next((d=>{d||(r++,o.removeEntry(c,Ae.min()))})))).next((()=>o.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.ti.set(t,e.currentSequenceNumber),K.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),K.resolve()}removeReference(e,t,r){return this.ti.set(r,e.currentSequenceNumber),K.resolve()}updateLimboDocument(e,t){return this.ti.set(t,e.currentSequenceNumber),K.resolve()}Wr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=pf(e.data.value)),t}nr(e,t,r){return K.or([()=>this.persistence.Hr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const a=this.ti.get(t);return K.resolve(a!==void 0&&a>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class UP{constructor(e){this.serializer=e}O(e,t,r,a){const o=new am("createOrUpgrade",t);r<1&&a>=1&&((function(f){f.createObjectStore("owner")})(e),(function(f){f.createObjectStore("mutationQueues",{keyPath:"userId"}),f.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Bw,{unique:!0}),f.createObjectStore("documentMutations")})(e),CE(e),(function(f){f.createObjectStore("remoteDocuments")})(e));let c=K.resolve();return r<3&&a>=3&&(r!==0&&((function(f){f.deleteObjectStore("targetDocuments"),f.deleteObjectStore("targets"),f.deleteObjectStore("targetGlobal")})(e),CE(e)),c=c.next((()=>(function(f){const p=f.store("targetGlobal"),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Ae.min().toTimestamp(),targetCount:0};return p.put("targetGlobalKey",v)})(o)))),r<4&&a>=4&&(r!==0&&(c=c.next((()=>(function(f,p){return p.store("mutations").U().next((v=>{f.deleteObjectStore("mutations"),f.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Bw,{unique:!0});const b=p.store("mutations"),E=v.map((S=>b.put(S)));return K.waitFor(E)}))})(e,o)))),c=c.next((()=>{(function(f){f.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)}))),r<5&&a>=5&&(c=c.next((()=>this.ni(o)))),r<6&&a>=6&&(c=c.next((()=>((function(f){f.createObjectStore("remoteDocumentGlobal")})(e),this.ri(o))))),r<7&&a>=7&&(c=c.next((()=>this.ii(o)))),r<8&&a>=8&&(c=c.next((()=>this.si(e,o)))),r<9&&a>=9&&(c=c.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&a>=10&&(c=c.next((()=>this.oi(o)))),r<11&&a>=11&&(c=c.next((()=>{(function(f){f.createObjectStore("bundles",{keyPath:"bundleId"})})(e),(function(f){f.createObjectStore("namedQueries",{keyPath:"name"})})(e)}))),r<12&&a>=12&&(c=c.next((()=>{(function(f){const p=f.createObjectStore("documentOverlays",{keyPath:wO});p.createIndex("collectionPathOverlayIndex",EO,{unique:!1}),p.createIndex("collectionGroupOverlayIndex",TO,{unique:!1})})(e)}))),r<13&&a>=13&&(c=c.next((()=>(function(f){const p=f.createObjectStore("remoteDocumentsV14",{keyPath:dO});p.createIndex("documentKeyIndex",hO),p.createIndex("collectionGroupIndex",fO)})(e))).next((()=>this._i(e,o))).next((()=>e.deleteObjectStore("remoteDocuments")))),r<14&&a>=14&&(c=c.next((()=>this.ai(e,o)))),r<15&&a>=15&&(c=c.next((()=>(function(f){f.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),f.createObjectStore("indexState",{keyPath:vO}).createIndex("sequenceNumberIndex",_O,{unique:!1}),f.createObjectStore("indexEntries",{keyPath:bO}).createIndex("documentKeyIndex",xO,{unique:!1})})(e)))),r<16&&a>=16&&(c=c.next((()=>{t.objectStore("indexState").clear()})).next((()=>{t.objectStore("indexEntries").clear()}))),r<17&&a>=17&&(c=c.next((()=>{(function(f){f.createObjectStore("globals",{keyPath:"name"})})(e)}))),c}ri(e){let t=0;return e.store("remoteDocuments").J(((r,a)=>{t+=zf(a)})).next((()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)}))}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next((a=>K.forEach(a,(o=>{const c=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",c).next((d=>K.forEach(d,(f=>{Te(f.userId===o.userId);const p=eo(this.serializer,f);return nA(e,o.userId,p).next((()=>{}))}))))}))))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((a=>{const o=[];return r.J(((c,d)=>{const f=new Ye(c),p=(function(b){return[0,Rn(b)]})(f);o.push(t.get(p).next((v=>v?K.resolve():(b=>t.put({targetId:0,path:Rn(b),sequenceNumber:a.highestListenSequenceNumber}))(f))))})).next((()=>K.waitFor(o)))}))}si(e,t){e.createObjectStore("collectionParents",{keyPath:yO});const r=t.store("collectionParents"),a=new A0,o=c=>{if(a.add(c)){const d=c.lastSegment(),f=c.popLast();return r.put({collectionId:d,parent:Rn(f)})}};return t.store("remoteDocuments").J({H:!0},((c,d)=>{const f=new Ye(c);return o(f.popLast())})).next((()=>t.store("documentMutations").J({H:!0},(([c,d,f],p)=>{const v=Zr(d);return o(v.popLast())}))))}oi(e){const t=e.store("targets");return t.J(((r,a)=>{const o=Iu(a),c=ZI(this.serializer,o);return t.put(c)}))}_i(e,t){const r=t.store("remoteDocuments"),a=[];return r.J(((o,c)=>{const d=t.store("remoteDocumentsV14"),f=(function(b){return b.document?new be(Ye.fromString(b.document.name).popFirst(5)):b.noDocument?be.fromSegments(b.noDocument.path):b.unknownDocument?be.fromSegments(b.unknownDocument.path):we()})(c).path.toArray(),p={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:c.readTime||[0,0],unknownDocument:c.unknownDocument,noDocument:c.noDocument,document:c.document,hasCommittedMutations:!!c.hasCommittedMutations};a.push(d.put(p))})).next((()=>K.waitFor(a)))}ai(e,t){const r=t.store("mutations"),a=lA(this.serializer),o=new C0(gm.Zr,this.serializer.ct);return r.U().next((c=>{const d=new Map;return c.forEach((f=>{var p;let v=(p=d.get(f.userId))!==null&&p!==void 0?p:Le();eo(this.serializer,f).keys().forEach((b=>v=v.add(b))),d.set(f.userId,v)})),K.forEach(d,((f,p)=>{const v=new hn(p),b=fm.lt(this.serializer,v),E=o.getIndexManager(v),S=mm.lt(v,this.serializer,E,o.referenceDelegate);return new cA(a,S,b,E).recalculateAndSaveOverlaysForDocumentKeys(new wy(t,Hn.oe),f).next()}))}))}}function CE(n){n.createObjectStore("targetDocuments",{keyPath:gO}).createIndex("documentTargetsIndex",pO,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",mO,{unique:!0}),n.createObjectStore("targetGlobal")}const Jp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class R0{constructor(e,t,r,a,o,c,d,f,p,v,b=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=o,this.window=c,this.document=d,this.ci=p,this.li=v,this.hi=b,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=E=>Promise.resolve(),!R0.D())throw new he(ne.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new AP(this,a),this.Ai=t+"main",this.serializer=new JI(f),this.Ri=new ni(this.Ai,this.hi,new UP(this.serializer)),this.$r=new pP,this.Ur=new TP(this.referenceDelegate,this.serializer),this.remoteDocumentCache=lA(this.serializer),this.Gr=new gP,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,v===!1&&$t("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new he(ne.FAILED_PRECONDITION,Jp);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Ur.getHighestSequenceNumber(e)))})).then((e=>{this.Qr=new Hn(e,this.ci)})).then((()=>{this.Kr=!0})).catch((e=>(this.Ri&&this.Ri.close(),Promise.reject(e))))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget((async()=>{this.started&&await this.mi()})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>nf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.wi(e).next((t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))))}))})).next((()=>this.Si(e))).next((t=>this.isPrimary&&!t?this.bi(e).next((()=>!1)):!!t&&this.Di(e).next((()=>!0)))))).catch((e=>{if(pa(e))return fe("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return fe("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.ui.enqueueRetryable((()=>this.di(e))),this.isPrimary=e}))}wi(e){return vu(e).get("owner").next((t=>K.resolve(this.vi(t))))}Ci(e){return nf(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=sn(t,"clientMetadata");return r.U().next((a=>{const o=this.xi(a,18e5),c=a.filter((d=>o.indexOf(d)===-1));return K.forEach(c,(d=>r.delete(d.clientId))).next((()=>c))}))})).catch((()=>[]));if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.mi().then((()=>this.Fi())).then((()=>this.pi()))))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?K.resolve(!0):vu(e).get("owner").next((t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new he(ne.FAILED_PRECONDITION,Jp);return!1}}return!(!this.networkEnabled||!this.inForeground)||nf(e).U().next((r=>this.xi(r,5e3).find((a=>{if(this.clientId!==a.clientId){const o=!this.networkEnabled&&a.networkEnabled,c=!this.inForeground&&a.inForeground,d=this.networkEnabled===a.networkEnabled;if(o||c&&d)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&fe("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new wy(e,Hn.oe);return this.bi(t).next((()=>this.Ci(t)))})),this.Ri.close(),this.qi()}xi(e,t){return e.filter((r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId)))}Qi(){return this.runTransaction("getActiveClients","readonly",(e=>nf(e).U().next((t=>this.xi(t,18e5).map((r=>r.clientId))))))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return mm.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new EP(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return fm.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){fe("IndexedDbPersistence","Starting transaction:",e);const a=t==="readonly"?"readonly":"readwrite",o=(function(f){return f===17?AO:f===16?IO:f===15?m0:f===14?rI:f===13?nI:f===12?SO:f===11?tI:void we()})(this.hi);let c;return this.Ri.runTransaction(e,a,o,(d=>(c=new wy(d,this.Qr?this.Qr.next():Hn.oe),t==="readwrite-primary"?this.wi(c).next((f=>!!f||this.Si(c))).next((f=>{if(!f)throw $t(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))),new he(ne.FAILED_PRECONDITION,WS);return r(c)})).next((f=>this.Di(c).next((()=>f)))):this.Ki(c).next((()=>r(c)))))).then((d=>(c.raiseOnCommittedEvent(),d)))}Ki(e){return vu(e).get("owner").next((t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new he(ne.FAILED_PRECONDITION,Jp)}))}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return vu(e).put("owner",t)}static D(){return ni.D()}bi(e){const t=vu(e);return t.get("owner").next((r=>this.vi(r)?(fe("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):K.resolve()))}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||($t(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.mi())))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;PT()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return fe("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return $t("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){$t("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function vu(n){return sn(n,"owner")}function nf(n){return sn(n,"clientMetadata")}function k0(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class D0{constructor(e,t,r,a){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=a}static Wi(e,t){let r=Le(),a=Le();for(const o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:a=a.add(o.doc.key)}return new D0(e,t.fromCache,r,a)}}class zP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class uA{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=(function(){return PT()?8:JS(rn())>0?6:4})()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,a){const o={result:null};return this.Yi(e,t).next((c=>{o.result=c})).next((()=>{if(!o.result)return this.Zi(e,t,a,r).next((c=>{o.result=c}))})).next((()=>{if(o.result)return;const c=new zP;return this.Xi(e,t,c).next((d=>{if(o.result=d,this.zi)return this.es(e,t,c,d.size)}))})).next((()=>o.result))}es(e,t,r,a){return r.documentReadCount<this.ji?(vl()<=Qe.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",_l(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),K.resolve()):(vl()<=Qe.DEBUG&&fe("QueryEngine","Query:",_l(t),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.Hi*a?(vl()<=Qe.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",_l(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,kn(t))):K.resolve())}Yi(e,t){if(tE(t))return K.resolve(null);let r=kn(t);return this.indexManager.getIndexType(e,r).next((a=>a===0?null:(t.limit!==null&&a===1&&(t=Vf(t,null,"F"),r=kn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((o=>{const c=Le(...o);return this.Ji.getDocuments(e,c).next((d=>this.indexManager.getMinOffset(e,r).next((f=>{const p=this.ts(t,d);return this.ns(t,p,c,f.readTime)?this.Yi(e,Vf(t,null,"F")):this.rs(e,p,t,f)}))))})))))}Zi(e,t,r,a){return tE(t)||a.isEqual(Ae.min())?K.resolve(null):this.Ji.getDocuments(e,r).next((o=>{const c=this.ts(t,o);return this.ns(t,c,r,a)?K.resolve(null):(vl()<=Qe.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),_l(t)),this.rs(e,c,t,QS(a,-1)).next((d=>d)))}))}ts(e,t){let r=new mt(wI(e));return t.forEach(((a,o)=>{cd(e,o)&&(r=r.add(o))})),r}ns(e,t,r,a){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(a)>0)}Xi(e,t,r){return vl()<=Qe.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",_l(t)),this.Ji.getDocumentsMatchingQuery(e,t,ar.min(),r)}rs(e,t,r,a){return this.Ji.getDocumentsMatchingQuery(e,r,a).next((o=>(t.forEach((c=>{o=o.insert(c.key,c)})),o)))}}class FP{constructor(e,t,r,a){this.persistence=e,this.ss=t,this.serializer=a,this.os=new vt(je),this._s=new Zi((o=>uo(o)),od),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cA(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function dA(n,e,t,r){return new FP(n,e,t,r)}async function hA(n,e){const t=_e(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let a;return t.mutationQueue.getAllMutationBatches(r).next((o=>(a=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r)))).next((o=>{const c=[],d=[];let f=Le();for(const p of a){c.push(p.batchId);for(const v of p.mutations)f=f.add(v.key)}for(const p of o){d.push(p.batchId);for(const v of p.mutations)f=f.add(v.key)}return t.localDocuments.getDocuments(r,f).next((p=>({hs:p,removedBatchIds:c,addedBatchIds:d})))}))}))}function BP(n,e){const t=_e(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const a=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return(function(d,f,p,v){const b=p.batch,E=b.keys();let S=K.resolve();return E.forEach((R=>{S=S.next((()=>v.getEntry(f,R))).next((j=>{const N=p.docVersions.get(R);Te(N!==null),j.version.compareTo(N)<0&&(b.applyToRemoteDocument(j,p),j.isValidDocument()&&(j.setReadTime(p.commitVersion),v.addEntry(j)))}))})),S.next((()=>d.mutationQueue.removeMutationBatch(f,b)))})(t,r,e,o).next((()=>o.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(d){let f=Le();for(let p=0;p<d.mutationResults.length;++p)d.mutationResults[p].transformResults.length>0&&(f=f.add(d.batch.mutations[p].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(r,a)))}))}function fA(n){const e=_e(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Ur.getLastRemoteSnapshotVersion(t)))}function qP(n,e){const t=_e(n),r=e.snapshotVersion;let a=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const c=t.cs.newChangeBuffer({trackRemovals:!0});a=t.os;const d=[];e.targetChanges.forEach(((v,b)=>{const E=a.get(b);if(!E)return;d.push(t.Ur.removeMatchingKeys(o,v.removedDocuments,b).next((()=>t.Ur.addMatchingKeys(o,v.addedDocuments,b))));let S=E.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(b)!==null?S=S.withResumeToken(Dt.EMPTY_BYTE_STRING,Ae.min()).withLastLimboFreeSnapshotVersion(Ae.min()):v.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(v.resumeToken,r)),a=a.insert(b,S),(function(j,N,I){return j.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=3e8?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0})(E,S,v)&&d.push(t.Ur.updateTargetData(o,S))}));let f=Qn(),p=Le();if(e.documentUpdates.forEach((v=>{e.resolvedLimboDocuments.has(v)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(o,v))})),d.push(mA(o,c,e.documentUpdates).next((v=>{f=v.Ps,p=v.Is}))),!r.isEqual(Ae.min())){const v=t.Ur.getLastRemoteSnapshotVersion(o).next((b=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r)));d.push(v)}return K.waitFor(d).next((()=>c.apply(o))).next((()=>t.localDocuments.getLocalViewOfDocuments(o,f,p))).next((()=>f))})).then((o=>(t.os=a,o)))}function mA(n,e,t){let r=Le(),a=Le();return t.forEach((o=>r=r.add(o))),e.getEntries(n,r).next((o=>{let c=Qn();return t.forEach(((d,f)=>{const p=o.get(d);f.isFoundDocument()!==p.isFoundDocument()&&(a=a.add(d)),f.isNoDocument()&&f.version.isEqual(Ae.min())?(e.removeEntry(d,f.readTime),c=c.insert(d,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),c=c.insert(d,f)):fe("LocalStore","Ignoring outdated watch update for ",d,". Current version:",p.version," Watch version:",f.version)})),{Ps:c,Is:a}}))}function GP(n,e){const t=_e(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function Ul(n,e){const t=_e(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let a;return t.Ur.getTargetData(r,e).next((o=>o?(a=o,K.resolve(a)):t.Ur.allocateTargetId(r).next((c=>(a=new zi(e,c,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,a).next((()=>a)))))))})).then((r=>{const a=t.os.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r}))}async function zl(n,e,t){const r=_e(n),a=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",o,(c=>r.persistence.referenceDelegate.removeTarget(c,a)))}catch(c){if(!pa(c))throw c;fe("LocalStore",`Failed to update sequence numbers for target ${e}: ${c}`)}r.os=r.os.remove(e),r._s.delete(a.target)}function Bf(n,e,t){const r=_e(n);let a=Ae.min(),o=Le();return r.persistence.runTransaction("Execute query","readwrite",(c=>(function(f,p,v){const b=_e(f),E=b._s.get(v);return E!==void 0?K.resolve(b.os.get(E)):b.Ur.getTargetData(p,v)})(r,c,kn(e)).next((d=>{if(d)return a=d.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(c,d.targetId).next((f=>{o=f}))})).next((()=>r.ss.getDocumentsMatchingQuery(c,e,t?a:Ae.min(),t?o:Le()))).next((d=>(yA(r,xI(e),d),{documents:d,Ts:o})))))}function gA(n,e){const t=_e(n),r=_e(t.Ur),a=t.os.get(e);return a?Promise.resolve(a.target):t.persistence.runTransaction("Get target data","readonly",(o=>r.ot(o,e).next((c=>c?c.target:null))))}function pA(n,e){const t=_e(n),r=t.us.get(e)||Ae.min();return t.persistence.runTransaction("Get new document changes","readonly",(a=>t.cs.getAllFromCollectionGroup(a,e,QS(r,-1),Number.MAX_SAFE_INTEGER))).then((a=>(yA(t,e,a),a)))}function yA(n,e,t){let r=n.us.get(e)||Ae.min();t.forEach(((a,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)})),n.us.set(e,r)}async function $P(n,e,t,r){const a=_e(n);let o=Le(),c=Qn();for(const p of t){const v=e.Es(p.metadata.name);p.document&&(o=o.add(v));const b=e.ds(p);b.setReadTime(e.As(p.metadata.readTime)),c=c.insert(v,b)}const d=a.cs.newChangeBuffer({trackRemovals:!0}),f=await Ul(a,(function(v){return kn(Jl(Ye.fromString(`__bundle__/docs/${v}`)))})(r));return a.persistence.runTransaction("Apply bundle documents","readwrite",(p=>mA(p,d,c).next((v=>(d.apply(p),v))).next((v=>a.Ur.removeMatchingKeysForTargetId(p,f.targetId).next((()=>a.Ur.addMatchingKeys(p,o,f.targetId))).next((()=>a.localDocuments.getLocalViewOfDocuments(p,v.Ps,v.Is))).next((()=>v.Ps))))))}async function HP(n,e,t=Le()){const r=await Ul(n,kn(S0(e.bundledQuery))),a=_e(n);return a.persistence.runTransaction("Save named query","readwrite",(o=>{const c=Ht(e.readTime);if(r.snapshotVersion.compareTo(c)>=0)return a.Gr.saveNamedQuery(o,e);const d=r.withResumeToken(Dt.EMPTY_BYTE_STRING,c);return a.os=a.os.insert(d.targetId,d),a.Ur.updateTargetData(o,d).next((()=>a.Ur.removeMatchingKeysForTargetId(o,r.targetId))).next((()=>a.Ur.addMatchingKeys(o,t,r.targetId))).next((()=>a.Gr.saveNamedQuery(o,e)))}))}function RE(n,e){return`firestore_clients_${n}_${e}`}function kE(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Zp(n,e){return`firestore_targets_${n}_${e}`}class qf{constructor(e,t,r,a){this.user=e,this.batchId=t,this.state=r,this.error=a}static Rs(e,t,r){const a=JSON.parse(r);let o,c=typeof a=="object"&&["pending","acknowledged","rejected"].indexOf(a.state)!==-1&&(a.error===void 0||typeof a.error=="object");return c&&a.error&&(c=typeof a.error.message=="string"&&typeof a.error.code=="string",c&&(o=new he(a.error.code,a.error.message))),c?new qf(e,t,a.state,o):($t("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ou{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){const r=JSON.parse(t);let a,o=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(a=new he(r.error.code,r.error.message))),o?new Ou(e,r.state,a):($t("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Gf{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const r=JSON.parse(t);let a=typeof r=="object"&&r.activeTargetIds instanceof Array,o=y0();for(let c=0;a&&c<r.activeTargetIds.length;++c)a=ZS(r.activeTargetIds[c]),o=o.add(r.activeTargetIds[c]);return a?new Gf(e,o):($t("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class j0{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new j0(t.clientId,t.onlineState):($t("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Vy{constructor(){this.activeTargetIds=y0()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ey{constructor(e,t,r,a,o){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new vt(je),this.started=!1,this.bs=[];const c=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=o,this.Ds=RE(this.persistenceKey,this.ps),this.vs=(function(f){return`firestore_sequence_number_${f}`})(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Vy),this.Cs=new RegExp(`^firestore_clients_${c}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${c}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${c}_(\\d+)$`),this.xs=(function(f){return`firestore_online_state_${f}`})(this.persistenceKey),this.Os=(function(f){return`firestore_bundle_loaded_v2_${f}`})(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const a=this.getItem(RE(this.persistenceKey,r));if(a){const o=Gf.Rs(r,a);o&&(this.Ss=this.Ss.insert(o.clientId,o))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const r=this.Ls(t);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach(((r,a)=>{a.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const a=this.storage.getItem(Zp(this.persistenceKey,e));if(a){const o=Ou.Rs(e,a);o&&(r=o.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Zp(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach((a=>{this.Qs(a)})),this.currentUser=e,r.forEach((a=>{this.addPendingMutation(a)}))}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return fe("SharedClientState","READ",e,t),t}setItem(e,t){fe("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){fe("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(fe("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void $t("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable((async()=>{if(this.started){if(t.key!==null){if(this.Cs.test(t.key)){if(t.newValue==null){const r=this.Gs(t.key);return this.zs(r,null)}{const r=this.js(t.key,t.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(t.key)){if(t.newValue!==null){const r=this.Hs(t.key,t.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(t.key)){if(t.newValue!==null){const r=this.Ys(t.key,t.newValue);if(r)return this.Zs(r)}}else if(t.key===this.xs){if(t.newValue!==null){const r=this.Ls(t.newValue);if(r)return this.Bs(r)}}else if(t.key===this.vs){const r=(function(o){let c=Hn.oe;if(o!=null)try{const d=JSON.parse(o);Te(typeof d=="number"),c=d}catch(d){$t("SharedClientState","Failed to read sequence number from WebStorage",d)}return c})(t.newValue);r!==Hn.oe&&this.sequenceNumberHandler(r)}else if(t.key===this.Os){const r=this.Xs(t.newValue);await Promise.all(r.map((a=>this.syncEngine.eo(a))))}}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){const a=new qf(this.currentUser,e,t,r),o=kE(this.persistenceKey,this.currentUser,e);this.setItem(o,a.Vs())}Qs(e){const t=kE(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,r){const a=Zp(this.persistenceKey,e),o=new Ou(e,t,r);this.setItem(a,o.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const r=this.Gs(e);return Gf.Rs(r,t)}Hs(e,t){const r=this.Fs.exec(e),a=Number(r[1]),o=r[2]!==void 0?r[2]:null;return qf.Rs(new hn(o),a,t)}Ys(e,t){const r=this.Ms.exec(e),a=Number(r[1]);return Ou.Rs(a,t)}Ls(e){return j0.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);fe("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const r=t?this.Ss.insert(e,t):this.Ss.remove(e),a=this.ks(this.Ss),o=this.ks(r),c=[],d=[];return o.forEach((f=>{a.has(f)||c.push(f)})),a.forEach((f=>{o.has(f)||d.push(f)})),this.syncEngine.io(c,d).then((()=>{this.Ss=r}))}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=y0();return e.forEach(((r,a)=>{t=t.unionWith(a.activeTargetIds)})),t}}class vA{constructor(){this.so=new Vy,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Vy,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class KP{_o(e){}shutdown(){}}class DE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){fe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){fe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let rf=null;function ty(){return rf===null?rf=(function(){return 268435456+Math.round(2147483648*Math.random())})():rf++,"0x"+rf.toString(16)}const QP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class YP{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const Nn="WebChannelConnection";class WP extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",a=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${a}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${a}`:`project_id=${a}&database_id=${o}`}get Fo(){return!1}Mo(t,r,a,o,c){const d=ty(),f=this.xo(t,r.toUriEncodedString());fe("RestConnection",`Sending RPC '${t}' ${d}:`,f,a);const p={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(p,o,c),this.No(t,f,p,a).then((v=>(fe("RestConnection",`Received RPC '${t}' ${d}: `,v),v)),(v=>{throw sr("RestConnection",`RPC '${t}' ${d} failed with error: `,v,"url: ",f,"request:",a),v}))}Lo(t,r,a,o,c,d){return this.Mo(t,r,a,o,c)}Oo(t,r,a){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Xl})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((o,c)=>t[c]=o)),a&&a.headers.forEach(((o,c)=>t[c]=o))}xo(t,r){const a=QP[t];return`${this.Do}/v1/${r}:${a}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,a){const o=ty();return new Promise(((c,d)=>{const f=new US;f.setWithCredentials(!0),f.listenOnce(zS.COMPLETE,(()=>{try{switch(f.getLastErrorCode()){case ff.NO_ERROR:const v=f.getResponseJson();fe(Nn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(v)),c(v);break;case ff.TIMEOUT:fe(Nn,`RPC '${e}' ${o} timed out`),d(new he(ne.DEADLINE_EXCEEDED,"Request time out"));break;case ff.HTTP_ERROR:const b=f.getStatus();if(fe(Nn,`RPC '${e}' ${o} failed with status:`,b,"response text:",f.getResponseText()),b>0){let E=f.getResponseJson();Array.isArray(E)&&(E=E[0]);const S=E?.error;if(S&&S.status&&S.message){const R=(function(N){const I=N.toLowerCase().replace(/_/g,"-");return Object.values(ne).indexOf(I)>=0?I:ne.UNKNOWN})(S.status);d(new he(R,S.message))}else d(new he(ne.UNKNOWN,"Server responded with status "+f.getStatus()))}else d(new he(ne.UNAVAILABLE,"Connection failed."));break;default:we()}}finally{fe(Nn,`RPC '${e}' ${o} completed.`)}}));const p=JSON.stringify(a);fe(Nn,`RPC '${e}' ${o} sending request:`,a),f.send(t,"POST",p,r,15)}))}Bo(e,t,r){const a=ty(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=qS(),d=BS(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.Oo(f.initMessageHeaders,t,r),f.encodeInitMessageHeaders=!0;const v=o.join("");fe(Nn,`Creating RPC '${e}' stream ${a}: ${v}`,f);const b=c.createWebChannel(v,f);let E=!1,S=!1;const R=new YP({Io:N=>{S?fe(Nn,`Not sending because RPC '${e}' stream ${a} is closed:`,N):(E||(fe(Nn,`Opening RPC '${e}' stream ${a} transport.`),b.open(),E=!0),fe(Nn,`RPC '${e}' stream ${a} sending:`,N),b.send(N))},To:()=>b.close()}),j=(N,I,te)=>{N.listen(I,(X=>{try{te(X)}catch(de){setTimeout((()=>{throw de}),0)}}))};return j(b,Eu.EventType.OPEN,(()=>{S||(fe(Nn,`RPC '${e}' stream ${a} transport opened.`),R.yo())})),j(b,Eu.EventType.CLOSE,(()=>{S||(S=!0,fe(Nn,`RPC '${e}' stream ${a} transport closed`),R.So())})),j(b,Eu.EventType.ERROR,(N=>{S||(S=!0,sr(Nn,`RPC '${e}' stream ${a} transport errored:`,N),R.So(new he(ne.UNAVAILABLE,"The operation could not be completed")))})),j(b,Eu.EventType.MESSAGE,(N=>{var I;if(!S){const te=N.data[0];Te(!!te);const X=te,de=X.error||((I=X[0])===null||I===void 0?void 0:I.error);if(de){fe(Nn,`RPC '${e}' stream ${a} received error:`,de);const ve=de.status;let ge=(function(O){const z=Jt[O];if(z!==void 0)return VI(z)})(ve),D=de.message;ge===void 0&&(ge=ne.INTERNAL,D="Unknown error status: "+ve+" with message "+de.message),S=!0,R.So(new he(ge,D)),b.close()}else fe(Nn,`RPC '${e}' stream ${a} received:`,te),R.bo(te)}})),j(d,FS.STAT_EVENT,(N=>{N.stat===by.PROXY?fe(Nn,`RPC '${e}' stream ${a} detected buffering proxy`):N.stat===by.NOPROXY&&fe(Nn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{R.wo()}),0),R}}function _A(){return typeof window<"u"?window:null}function bf(){return typeof document<"u"?document:null}function fd(n){return new iP(n,!0)}class O0{constructor(e,t,r=1e3,a=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=a,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),a=Math.max(0,t-r);a>0&&fe("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,a,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class bA{constructor(e,t,r,a,o,c,d,f){this.ui=e,this.Ho=r,this.Jo=a,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new O0(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===ne.RESOURCE_EXHAUSTED?($t(t.toString()),$t("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,a])=>{this.Yo===t&&this.P_(r,a)}),(r=>{e((()=>{const a=new he(ne.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(a)}))}))}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{r((()=>this.listener.Eo()))})),this.stream.Ro((()=>{r((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((a=>{r((()=>this.I_(a)))})),this.stream.onMessage((a=>{r((()=>++this.e_==1?this.E_(a):this.onNext(a)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return fe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(fe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class XP extends bA{constructor(e,t,r,a,o,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,a,c),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=oP(this.serializer,e),r=(function(o){if(!("targetChange"in o))return Ae.min();const c=o.targetChange;return c.targetIds&&c.targetIds.length?Ae.min():c.readTime?Ht(c.readTime):Ae.min()})(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=ky(this.serializer),t.addTarget=(function(o,c){let d;const f=c.target;if(d=Of(f)?{documents:HI(o,f)}:{query:hm(o,f)._t},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=zI(o,c.resumeToken);const p=Cy(o,c.expectedCount);p!==null&&(d.expectedCount=p)}else if(c.snapshotVersion.compareTo(Ae.min())>0){d.readTime=Ll(o,c.snapshotVersion.toTimestamp());const p=Cy(o,c.expectedCount);p!==null&&(d.expectedCount=p)}return d})(this.serializer,e);const r=cP(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=ky(this.serializer),t.removeTarget=e,this.a_(t)}}class JP extends bA{constructor(e,t,r,a,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,a,c),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Te(!!e.streamToken),this.lastStreamToken=e.streamToken,Te(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Te(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=lP(e.writeResults,e.commitTime),r=Ht(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=ky(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>Qu(this.serializer,r)))};this.a_(t)}}class ZP extends class{}{constructor(e,t,r,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=a,this.y_=!1}w_(){if(this.y_)throw new he(ne.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,a){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Mo(e,Ry(t,r),a,o,c))).catch((o=>{throw o.name==="FirebaseError"?(o.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new he(ne.UNKNOWN,o.toString())}))}Lo(e,t,r,a,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.Lo(e,Ry(t,r),a,c,d,o))).catch((c=>{throw c.name==="FirebaseError"?(c.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new he(ne.UNKNOWN,c.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class eV{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?($t(t),this.D_=!1):fe("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}class tV{constructor(e,t,r,a,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o((c=>{r.enqueueAndForget((async()=>{va(this)&&(fe("RemoteStore","Restarting streams for network reachability change."),await(async function(f){const p=_e(f);p.L_.add(4),await tc(p),p.q_.set("Unknown"),p.L_.delete(4),await md(p)})(this))}))})),this.q_=new eV(r,a)}}async function md(n){if(va(n))for(const e of n.B_)await e(!0)}async function tc(n){for(const e of n.B_)await e(!1)}function pm(n,e){const t=_e(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),M0(t)?V0(t):rc(t).r_()&&P0(t,e))}function Fl(n,e){const t=_e(n),r=rc(t);t.N_.delete(e),r.r_()&&xA(t,e),t.N_.size===0&&(r.r_()?r.o_():va(t)&&t.q_.set("Unknown"))}function P0(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ae.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}rc(n).A_(e)}function xA(n,e){n.Q_.xe(e),rc(n).R_(e)}function V0(n){n.Q_=new eP({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),rc(n).start(),n.q_.v_()}function M0(n){return va(n)&&!rc(n).n_()&&n.N_.size>0}function va(n){return _e(n).L_.size===0}function wA(n){n.Q_=void 0}async function nV(n){n.q_.set("Online")}async function rV(n){n.N_.forEach(((e,t)=>{P0(n,e)}))}async function iV(n,e){wA(n),M0(n)?(n.q_.M_(e),V0(n)):n.q_.set("Unknown")}async function sV(n,e,t){if(n.q_.set("Online"),e instanceof UI&&e.state===2&&e.cause)try{await(async function(a,o){const c=o.cause;for(const d of o.targetIds)a.N_.has(d)&&(await a.remoteSyncer.rejectListen(d,c),a.N_.delete(d),a.Q_.removeTarget(d))})(n,e)}catch(r){fe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await $f(n,r)}else if(e instanceof _f?n.Q_.Ke(e):e instanceof LI?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Ae.min()))try{const r=await fA(n.localStore);t.compareTo(r)>=0&&await(function(o,c){const d=o.Q_.rt(c);return d.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const v=o.N_.get(p);v&&o.N_.set(p,v.withResumeToken(f.resumeToken,c))}})),d.targetMismatches.forEach(((f,p)=>{const v=o.N_.get(f);if(!v)return;o.N_.set(f,v.withResumeToken(Dt.EMPTY_BYTE_STRING,v.snapshotVersion)),xA(o,f);const b=new zi(v.target,f,p,v.sequenceNumber);P0(o,b)})),o.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(r){fe("RemoteStore","Failed to raise snapshot:",r),await $f(n,r)}}async function $f(n,e,t){if(!pa(e))throw e;n.L_.add(1),await tc(n),n.q_.set("Offline"),t||(t=()=>fA(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{fe("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await md(n)}))}function EA(n,e){return e().catch((t=>$f(n,t,e)))}async function nc(n){const e=_e(n),t=la(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;aV(e);)try{const a=await GP(e.localStore,r);if(a===null){e.O_.length===0&&t.o_();break}r=a.batchId,oV(e,a)}catch(a){await $f(e,a)}TA(e)&&SA(e)}function aV(n){return va(n)&&n.O_.length<10}function oV(n,e){n.O_.push(e);const t=la(n);t.r_()&&t.V_&&t.m_(e.mutations)}function TA(n){return va(n)&&!la(n).n_()&&n.O_.length>0}function SA(n){la(n).start()}async function lV(n){la(n).p_()}async function cV(n){const e=la(n);for(const t of n.O_)e.m_(t.mutations)}async function uV(n,e,t){const r=n.O_.shift(),a=x0.from(r,e,t);await EA(n,(()=>n.remoteSyncer.applySuccessfulWrite(a))),await nc(n)}async function dV(n,e){e&&la(n).V_&&await(async function(r,a){if((function(c){return PI(c)&&c!==ne.ABORTED})(a.code)){const o=r.O_.shift();la(r).s_(),await EA(r,(()=>r.remoteSyncer.rejectFailedWrite(o.batchId,a))),await nc(r)}})(n,e),TA(n)&&SA(n)}async function jE(n,e){const t=_e(n);t.asyncQueue.verifyOperationInProgress(),fe("RemoteStore","RemoteStore received new credentials");const r=va(t);t.L_.add(3),await tc(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await md(t)}async function My(n,e){const t=_e(n);e?(t.L_.delete(2),await md(t)):e||(t.L_.add(2),await tc(t),t.q_.set("Unknown"))}function rc(n){return n.K_||(n.K_=(function(t,r,a){const o=_e(t);return o.w_(),new XP(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)})(n.datastore,n.asyncQueue,{Eo:nV.bind(null,n),Ro:rV.bind(null,n),mo:iV.bind(null,n),d_:sV.bind(null,n)}),n.B_.push((async e=>{e?(n.K_.s_(),M0(n)?V0(n):n.q_.set("Unknown")):(await n.K_.stop(),wA(n))}))),n.K_}function la(n){return n.U_||(n.U_=(function(t,r,a){const o=_e(t);return o.w_(),new JP(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)})(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:lV.bind(null,n),mo:dV.bind(null,n),f_:cV.bind(null,n),g_:uV.bind(null,n)}),n.B_.push((async e=>{e?(n.U_.s_(),await nc(n)):(await n.U_.stop(),n.O_.length>0&&(fe("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}class L0{constructor(e,t,r,a,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=a,this.removalCallback=o,this.deferred=new fn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,a,o){const c=Date.now()+r,d=new L0(e,t,c,a,o);return d.start(r),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new he(ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ic(n,e){if($t("AsyncQueue",`${e}: ${n}`),pa(n))return new he(ne.UNAVAILABLE,`${e}: ${n}`);throw n}class Al{constructor(e){this.comparator=e?(t,r)=>e(t,r)||be.comparator(t.key,r.key):(t,r)=>be.comparator(t.key,r.key),this.keyedMap=Tu(),this.sortedSet=new vt(this.comparator)}static emptySet(e){return new Al(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Al)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const a=t.getNext().key,o=r.getNext().key;if(!a.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Al;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class OE{constructor(){this.W_=new vt(be.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):we():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Bl{constructor(e,t,r,a,o,c,d,f,p){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=o,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,t,r,a,o){const c=[];return t.forEach((d=>{c.push({type:0,doc:d})})),new Bl(e,t,Al.emptySet(t),c,r,a,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ld(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==r[a].type||!t[a].doc.isEqual(r[a].doc))return!1;return!0}}class hV{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class fV{constructor(){this.queries=PE(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const a=_e(t),o=a.queries;a.queries=PE(),o.forEach(((c,d)=>{for(const f of d.j_)f.onError(r)}))})(this,new he(ne.ABORTED,"Firestore shutting down"))}}function PE(){return new Zi((n=>bI(n)),ld)}async function U0(n,e){const t=_e(n);let r=3;const a=e.query;let o=t.queries.get(a);o?!o.H_()&&e.J_()&&(r=2):(o=new hV,r=e.J_()?0:1);try{switch(r){case 0:o.z_=await t.onListen(a,!0);break;case 1:o.z_=await t.onListen(a,!1);break;case 2:await t.onFirstRemoteStoreListen(a)}}catch(c){const d=ic(c,`Initialization of query '${_l(e.query)}' failed`);return void e.onError(d)}t.queries.set(a,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&F0(t)}async function z0(n,e){const t=_e(n),r=e.query;let a=3;const o=t.queries.get(r);if(o){const c=o.j_.indexOf(e);c>=0&&(o.j_.splice(c,1),o.j_.length===0?a=e.J_()?0:1:!o.H_()&&e.J_()&&(a=2))}switch(a){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function mV(n,e){const t=_e(n);let r=!1;for(const a of e){const o=a.query,c=t.queries.get(o);if(c){for(const d of c.j_)d.X_(a)&&(r=!0);c.z_=a}}r&&F0(t)}function gV(n,e,t){const r=_e(n),a=r.queries.get(e);if(a)for(const o of a.j_)o.onError(t);r.queries.delete(e)}function F0(n){n.Y_.forEach((e=>{e.next()}))}var Ly,VE;(VE=Ly||(Ly={})).ea="default",VE.Cache="cache";class B0{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new Bl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Bl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Ly.Cache}}class pV{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}class ME{constructor(e){this.serializer=e}Es(e){return ri(this.serializer,e)}ds(e){return e.metadata.exists?$I(this.serializer,e.document,!1):Et.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Ht(e)}}class yV{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=IA(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const r=Ye.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,r=new ME(this.serializer);for(const a of e)if(a.metadata.queries){const o=r.Es(a.metadata.name);for(const c of a.metadata.queries){const d=(t.get(c)||Le()).add(o);t.set(c,d)}}return t}async complete(){const e=await $P(this.localStore,new ME(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const r of this.queries)await HP(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function IA(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class AA{constructor(e){this.key=e}}class NA{constructor(e){this.key=e}}class CA{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Le(),this.mutatedKeys=Le(),this.Aa=wI(e),this.Ra=new Al(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new OE,a=t?t.Ra:this.Ra;let o=t?t.mutatedKeys:this.mutatedKeys,c=a,d=!1;const f=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,p=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((v,b)=>{const E=a.get(v),S=cd(this.query,b)?b:null,R=!!E&&this.mutatedKeys.has(E.key),j=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let N=!1;E&&S?E.data.isEqual(S.data)?R!==j&&(r.track({type:3,doc:S}),N=!0):this.ga(E,S)||(r.track({type:2,doc:S}),N=!0,(f&&this.Aa(S,f)>0||p&&this.Aa(S,p)<0)&&(d=!0)):!E&&S?(r.track({type:0,doc:S}),N=!0):E&&!S&&(r.track({type:1,doc:E}),N=!0,(f||p)&&(d=!0)),N&&(S?(c=c.add(S),o=j?o.add(v):o.delete(v)):(c=c.delete(v),o=o.delete(v)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const v=this.query.limitType==="F"?c.last():c.first();c=c.delete(v.key),o=o.delete(v.key),r.track({type:1,doc:v})}return{Ra:c,fa:r,ns:d,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,a){const o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const c=e.fa.G_();c.sort(((v,b)=>(function(S,R){const j=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return we()}};return j(S)-j(R)})(v.type,b.type)||this.Aa(v.doc,b.doc))),this.pa(r),a=a!=null&&a;const d=t&&!a?this.ya():[],f=this.da.size===0&&this.current&&!a?1:0,p=f!==this.Ea;return this.Ea=f,c.length!==0||p?{snapshot:new Bl(this.query,e.Ra,o,c,e.mutatedKeys,f===0,p,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:d}:{wa:d}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new OE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((t=>this.Ta=this.Ta.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ta=this.Ta.delete(t))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Le(),this.Ra.forEach((r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))}));const t=[];return e.forEach((r=>{this.da.has(r)||t.push(new NA(r))})),this.da.forEach((r=>{e.has(r)||t.push(new AA(r))})),t}ba(e){this.Ta=e.Ts,this.da=Le();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Bl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class vV{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class _V{constructor(e){this.key=e,this.va=!1}}class bV{constructor(e,t,r,a,o,c){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.Ca={},this.Fa=new Zi((d=>bI(d)),ld),this.Ma=new Map,this.xa=new Set,this.Oa=new vt(be.comparator),this.Na=new Map,this.La=new N0,this.Ba={},this.ka=new Map,this.qa=po.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function xV(n,e,t=!0){const r=ym(n);let a;const o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),a=o.view.Da()):a=await RA(r,e,t,!0),a}async function wV(n,e){const t=ym(n);await RA(t,e,!0,!1)}async function RA(n,e,t,r){const a=await Ul(n.localStore,kn(e)),o=a.targetId,c=n.sharedClientState.addLocalQueryTarget(o,t);let d;return r&&(d=await q0(n,e,o,c==="current",a.resumeToken)),n.isPrimaryClient&&t&&pm(n.remoteStore,a),d}async function q0(n,e,t,r,a){n.Ka=(b,E,S)=>(async function(j,N,I,te){let X=N.view.ma(I);X.ns&&(X=await Bf(j.localStore,N.query,!1).then((({documents:D})=>N.view.ma(D,X))));const de=te&&te.targetChanges.get(N.targetId),ve=te&&te.targetMismatches.get(N.targetId)!=null,ge=N.view.applyChanges(X,j.isPrimaryClient,de,ve);return Uy(j,N.targetId,ge.wa),ge.snapshot})(n,b,E,S);const o=await Bf(n.localStore,e,!0),c=new CA(e,o.Ts),d=c.ma(o.documents),f=hd.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",a),p=c.applyChanges(d,n.isPrimaryClient,f);Uy(n,t,p.wa);const v=new vV(e,t,c);return n.Fa.set(e,v),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),p.snapshot}async function EV(n,e,t){const r=_e(n),a=r.Fa.get(e),o=r.Ma.get(a.targetId);if(o.length>1)return r.Ma.set(a.targetId,o.filter((c=>!ld(c,e)))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await zl(r.localStore,a.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(a.targetId),t&&Fl(r.remoteStore,a.targetId),ql(r,a.targetId)})).catch(ga)):(ql(r,a.targetId),await zl(r.localStore,a.targetId,!0))}async function TV(n,e){const t=_e(n),r=t.Fa.get(e),a=t.Ma.get(r.targetId);t.isPrimaryClient&&a.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Fl(t.remoteStore,r.targetId))}async function SV(n,e,t){const r=K0(n);try{const a=await(function(c,d){const f=_e(c),p=Be.now(),v=d.reduce(((S,R)=>S.add(R.key)),Le());let b,E;return f.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let R=Qn(),j=Le();return f.cs.getEntries(S,v).next((N=>{R=N,R.forEach(((I,te)=>{te.isValidDocument()||(j=j.add(I))}))})).next((()=>f.localDocuments.getOverlayedDocuments(S,R))).next((N=>{b=N;const I=[];for(const te of d){const X=XO(te,b.get(te.key).overlayedDocument);X!=null&&I.push(new es(te.key,X,cI(X.value.mapValue),At.exists(!0)))}return f.mutationQueue.addMutationBatch(S,p,I,d)})).next((N=>{E=N;const I=N.applyToLocalDocumentSet(b,j);return f.documentOverlayCache.saveOverlays(S,N.batchId,I)}))})).then((()=>({batchId:E.batchId,changes:TI(b)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),(function(c,d,f){let p=c.Ba[c.currentUser.toKey()];p||(p=new vt(je)),p=p.insert(d,f),c.Ba[c.currentUser.toKey()]=p})(r,a.batchId,t),await ts(r,a.changes),await nc(r.remoteStore)}catch(a){const o=ic(a,"Failed to persist write");t.reject(o)}}async function kA(n,e){const t=_e(n);try{const r=await qP(t.localStore,e);e.targetChanges.forEach(((a,o)=>{const c=t.Na.get(o);c&&(Te(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?c.va=!0:a.modifiedDocuments.size>0?Te(c.va):a.removedDocuments.size>0&&(Te(c.va),c.va=!1))})),await ts(t,r,e)}catch(r){await ga(r)}}function LE(n,e,t){const r=_e(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const a=[];r.Fa.forEach(((o,c)=>{const d=c.view.Z_(e);d.snapshot&&a.push(d.snapshot)})),(function(c,d){const f=_e(c);f.onlineState=d;let p=!1;f.queries.forEach(((v,b)=>{for(const E of b.j_)E.Z_(d)&&(p=!0)})),p&&F0(f)})(r.eventManager,e),a.length&&r.Ca.d_(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function IV(n,e,t){const r=_e(n);r.sharedClientState.updateQueryState(e,"rejected",t);const a=r.Na.get(e),o=a&&a.key;if(o){let c=new vt(be.comparator);c=c.insert(o,Et.newNoDocument(o,Ae.min()));const d=Le().add(o),f=new dd(Ae.min(),new Map,new vt(je),c,d);await kA(r,f),r.Oa=r.Oa.remove(o),r.Na.delete(e),H0(r)}else await zl(r.localStore,e,!1).then((()=>ql(r,e,t))).catch(ga)}async function AV(n,e){const t=_e(n),r=e.batch.batchId;try{const a=await BP(t.localStore,e);$0(t,r,null),G0(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await ts(t,a)}catch(a){await ga(a)}}async function NV(n,e,t){const r=_e(n);try{const a=await(function(c,d){const f=_e(c);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let v;return f.mutationQueue.lookupMutationBatch(p,d).next((b=>(Te(b!==null),v=b.keys(),f.mutationQueue.removeMutationBatch(p,b)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,v,d))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,v))).next((()=>f.localDocuments.getDocuments(p,v)))}))})(r.localStore,e);$0(r,e,t),G0(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await ts(r,a)}catch(a){await ga(a)}}async function CV(n,e){const t=_e(n);va(t.remoteStore)||fe("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await(function(c){const d=_e(c);return d.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(f=>d.mutationQueue.getHighestUnacknowledgedBatchId(f)))})(t.localStore);if(r===-1)return void e.resolve();const a=t.ka.get(r)||[];a.push(e),t.ka.set(r,a)}catch(r){const a=ic(r,"Initialization of waitForPendingWrites() operation failed");e.reject(a)}}function G0(n,e){(n.ka.get(e)||[]).forEach((t=>{t.resolve()})),n.ka.delete(e)}function $0(n,e,t){const r=_e(n);let a=r.Ba[r.currentUser.toKey()];if(a){const o=a.get(e);o&&(t?o.reject(t):o.resolve(),a=a.remove(e)),r.Ba[r.currentUser.toKey()]=a}}function ql(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach((r=>{n.La.containsKey(r)||DA(n,r)}))}function DA(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(Fl(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),H0(n))}function Uy(n,e,t){for(const r of t)r instanceof AA?(n.La.addReference(r.key,e),RV(n,r)):r instanceof NA?(fe("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||DA(n,r.key)):we()}function RV(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(fe("SyncEngine","New document in limbo: "+t),n.xa.add(r),H0(n))}function H0(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new be(Ye.fromString(e)),r=n.qa.next();n.Na.set(r,new _V(t)),n.Oa=n.Oa.insert(t,r),pm(n.remoteStore,new zi(kn(Jl(t.path)),r,"TargetPurposeLimboResolution",Hn.oe))}}async function ts(n,e,t){const r=_e(n),a=[],o=[],c=[];r.Fa.isEmpty()||(r.Fa.forEach(((d,f)=>{c.push(r.Ka(f,e,t).then((p=>{var v;if((p||t)&&r.isPrimaryClient){const b=p?!p.fromCache:(v=t?.targetChanges.get(f.targetId))===null||v===void 0?void 0:v.current;r.sharedClientState.updateQueryState(f.targetId,b?"current":"not-current")}if(p){a.push(p);const b=D0.Wi(f.targetId,p);o.push(b)}})))})),await Promise.all(c),r.Ca.d_(a),await(async function(f,p){const v=_e(f);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",(b=>K.forEach(p,(E=>K.forEach(E.$i,(S=>v.persistence.referenceDelegate.addReference(b,E.targetId,S))).next((()=>K.forEach(E.Ui,(S=>v.persistence.referenceDelegate.removeReference(b,E.targetId,S)))))))))}catch(b){if(!pa(b))throw b;fe("LocalStore","Failed to update sequence numbers: "+b)}for(const b of p){const E=b.targetId;if(!b.fromCache){const S=v.os.get(E),R=S.snapshotVersion,j=S.withLastLimboFreeSnapshotVersion(R);v.os=v.os.insert(E,j)}}})(r.localStore,o))}async function kV(n,e){const t=_e(n);if(!t.currentUser.isEqual(e)){fe("SyncEngine","User change. New user:",e.toKey());const r=await hA(t.localStore,e);t.currentUser=e,(function(o,c){o.ka.forEach((d=>{d.forEach((f=>{f.reject(new he(ne.CANCELLED,c))}))})),o.ka.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ts(t,r.hs)}}function DV(n,e){const t=_e(n),r=t.Na.get(e);if(r&&r.va)return Le().add(r.key);{let a=Le();const o=t.Ma.get(e);if(!o)return a;for(const c of o){const d=t.Fa.get(c);a=a.unionWith(d.view.Va)}return a}}async function jV(n,e){const t=_e(n),r=await Bf(t.localStore,e.query,!0),a=e.view.ba(r);return t.isPrimaryClient&&Uy(t,e.targetId,a.wa),a}async function OV(n,e){const t=_e(n);return pA(t.localStore,e).then((r=>ts(t,r)))}async function PV(n,e,t,r){const a=_e(n),o=await(function(d,f){const p=_e(d),v=_e(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",(b=>v.Mn(b,f).next((E=>E?p.localDocuments.getDocuments(b,E):K.resolve(null)))))})(a.localStore,e);o!==null?(t==="pending"?await nc(a.remoteStore):t==="acknowledged"||t==="rejected"?($0(a,e,r||null),G0(a,e),(function(d,f){_e(_e(d).mutationQueue).On(f)})(a.localStore,e)):we(),await ts(a,o)):fe("SyncEngine","Cannot apply mutation batch with id: "+e)}async function VV(n,e){const t=_e(n);if(ym(t),K0(t),e===!0&&t.Qa!==!0){const r=t.sharedClientState.getAllActiveQueryTargets(),a=await UE(t,r.toArray());t.Qa=!0,await My(t.remoteStore,!0);for(const o of a)pm(t.remoteStore,o)}else if(e===!1&&t.Qa!==!1){const r=[];let a=Promise.resolve();t.Ma.forEach(((o,c)=>{t.sharedClientState.isLocalQueryTarget(c)?r.push(c):a=a.then((()=>(ql(t,c),zl(t.localStore,c,!0)))),Fl(t.remoteStore,c)})),await a,await UE(t,r),(function(c){const d=_e(c);d.Na.forEach(((f,p)=>{Fl(d.remoteStore,p)})),d.La.pr(),d.Na=new Map,d.Oa=new vt(be.comparator)})(t),t.Qa=!1,await My(t.remoteStore,!1)}}async function UE(n,e,t){const r=_e(n),a=[],o=[];for(const c of e){let d;const f=r.Ma.get(c);if(f&&f.length!==0){d=await Ul(r.localStore,kn(f[0]));for(const p of f){const v=r.Fa.get(p),b=await jV(r,v);b.snapshot&&o.push(b.snapshot)}}else{const p=await gA(r.localStore,c);d=await Ul(r.localStore,p),await q0(r,jA(p),c,!1,d.resumeToken)}a.push(d)}return r.Ca.d_(o),a}function jA(n){return yI(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function MV(n){return(function(t){return _e(_e(t).persistence).Qi()})(_e(n).localStore)}async function LV(n,e,t,r){const a=_e(n);if(a.Qa)return void fe("SyncEngine","Ignoring unexpected query state notification.");const o=a.Ma.get(e);if(o&&o.length>0)switch(t){case"current":case"not-current":{const c=await pA(a.localStore,xI(o[0])),d=dd.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Dt.EMPTY_BYTE_STRING);await ts(a,c,d);break}case"rejected":await zl(a.localStore,e,!0),ql(a,e,r);break;default:we()}}async function UV(n,e,t){const r=ym(n);if(r.Qa){for(const a of e){if(r.Ma.has(a)&&r.sharedClientState.isActiveQueryTarget(a)){fe("SyncEngine","Adding an already active target "+a);continue}const o=await gA(r.localStore,a),c=await Ul(r.localStore,o);await q0(r,jA(o),c.targetId,!1,c.resumeToken),pm(r.remoteStore,c)}for(const a of t)r.Ma.has(a)&&await zl(r.localStore,a,!1).then((()=>{Fl(r.remoteStore,a),ql(r,a)})).catch(ga)}}function ym(n){const e=_e(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=kA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=DV.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=IV.bind(null,e),e.Ca.d_=mV.bind(null,e.eventManager),e.Ca.$a=gV.bind(null,e.eventManager),e}function K0(n){const e=_e(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=AV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=NV.bind(null,e),e}function zV(n,e,t){const r=_e(n);(async function(o,c,d){try{const f=await c.getMetadata();if(await(function(S,R){const j=_e(S),N=Ht(R.createTime);return j.persistence.runTransaction("hasNewerBundle","readonly",(I=>j.Gr.getBundleMetadata(I,R.id))).then((I=>!!I&&I.createTime.compareTo(N)>=0))})(o.localStore,f))return await c.close(),d._completeWith((function(S){return{taskState:"Success",documentsLoaded:S.totalDocuments,bytesLoaded:S.totalBytes,totalDocuments:S.totalDocuments,totalBytes:S.totalBytes}})(f)),Promise.resolve(new Set);d._updateProgress(IA(f));const p=new yV(f,o.localStore,c.serializer);let v=await c.Ua();for(;v;){const E=await p.la(v);E&&d._updateProgress(E),v=await c.Ua()}const b=await p.complete();return await ts(o,b.Ia,void 0),await(function(S,R){const j=_e(S);return j.persistence.runTransaction("Save bundle","readwrite",(N=>j.Gr.saveBundleMetadata(N,R)))})(o.localStore,f),d._completeWith(b.progress),Promise.resolve(b.Pa)}catch(f){return sr("SyncEngine",`Loading bundle failed with ${f}`),d._failWith(f),Promise.resolve(new Set)}})(r,e,t).then((a=>{r.sharedClientState.notifyBundleLoaded(a)}))}class ca{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=fd(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return dA(this.persistence,new uA,e.initialUser,this.serializer)}Ga(e){return new C0(gm.Zr,this.serializer)}Wa(e){return new vA}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ca.provider={build:()=>new ca};class FV extends ca{constructor(e){super(),this.cacheSizeBytes=e}ja(e,t){Te(this.persistence.referenceDelegate instanceof Ff);const r=this.persistence.referenceDelegate.garbageCollector;return new sA(r,e.asyncQueue,t)}Ga(e){const t=this.cacheSizeBytes!==void 0?Cn.withCacheSize(this.cacheSizeBytes):Cn.DEFAULT;return new C0((r=>Ff.Zr(r,t)),this.serializer)}}class Q0 extends ca{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await K0(this.Ja.syncEngine),await nc(this.Ja.remoteStore),await this.persistence.yi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}za(e){return dA(this.persistence,new uA,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new sA(r,e.asyncQueue,t)}Ha(e,t){const r=new lO(t,this.persistence);return new oO(e.asyncQueue,r)}Ga(e){const t=k0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Cn.withCacheSize(this.cacheSizeBytes):Cn.DEFAULT;return new R0(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,_A(),bf(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new vA}}class OA extends Q0{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof ey&&(this.sharedClientState.syncEngine={no:PV.bind(null,t),ro:LV.bind(null,t),io:UV.bind(null,t),Qi:MV.bind(null,t),eo:OV.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi((async r=>{await VV(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))}Wa(e){const t=_A();if(!ey.D(t))throw new he(ne.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=k0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ey(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class ua{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>LE(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=kV.bind(null,this.syncEngine),await My(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new fV})()}createDatastore(e){const t=fd(e.databaseInfo.databaseId),r=(function(o){return new WP(o)})(e.databaseInfo);return(function(o,c,d,f){return new ZP(o,c,d,f)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,a,o,c,d){return new tV(r,a,o,c,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>LE(this.syncEngine,t,0)),(function(){return DE.D()?new DE:new KP})())}createSyncEngine(e,t){return(function(a,o,c,d,f,p,v){const b=new bV(a,o,c,d,f,p);return v&&(b.Qa=!0),b})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(a){const o=_e(a);fe("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await tc(o),o.k_.shutdown(),o.q_.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}ua.provider={build:()=>new ua};function zE(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class vm{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):$t("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class BV{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new fn,this.buffer=new Uint8Array,this.eu=(function(){return new TextDecoder("utf-8")})(),this.tu().then((r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.aa)}`))}),(r=>this.metadata.reject(r)))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const t=this.eu.decode(e),r=Number(t);isNaN(r)&&this.ru(`length string (${t}) is not valid number`);const a=await this.iu(r);return new pV(JSON.parse(a),e.length+r)}su(){return this.buffer.findIndex((e=>e===123))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class qV{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new he(ne.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await(async function(a,o){const c=_e(a),d={documents:o.map((b=>Ku(c.serializer,b)))},f=await c.Lo("BatchGetDocuments",c.serializer.databaseId,Ye.emptyPath(),d,o.length),p=new Map;f.forEach((b=>{const E=aP(c.serializer,b);p.set(E.key.toString(),E)}));const v=[];return o.forEach((b=>{const E=p.get(b.toString());Te(!!E),v.push(E)})),v})(this.datastore,e);return t.forEach((r=>this.recordVersion(r))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ec(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((t,r)=>{const a=be.fromPath(r);this.mutations.push(new _0(a,this.precondition(a)))})),await(async function(r,a){const o=_e(r),c={writes:a.map((d=>Qu(o.serializer,d)))};await o.Mo("Commit",o.serializer.databaseId,Ye.emptyPath(),c)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw we();t=Ae.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new he(ne.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Ae.min())?At.exists(!1):At.updateTime(t):At.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Ae.min()))throw new he(ne.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return At.updateTime(t)}return At.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class GV{constructor(e,t,r,a,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=a,this.deferred=o,this._u=r.maxAttempts,this.t_=new O0(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go((async()=>{const e=new qV(this.datastore),t=this.cu(e);t&&t.then((r=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(r)})).catch((a=>{this.lu(a)}))))})).catch((r=>{this.lu(r)}))}))}cu(e){try{const t=this.updateFunction(e);return!ad(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget((()=>(this.uu(),Promise.resolve())))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!PI(t)}return!1}}class $V{constructor(e,t,r,a,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=a,this.user=hn.UNAUTHENTICATED,this.clientId=d0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,(async c=>{fe("FirestoreClient","Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(r,(c=>(fe("FirestoreClient","Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=ic(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function ny(n,e){n.asyncQueue.verifyOperationInProgress(),fe("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async a=>{r.isEqual(a)||(await hA(e.localStore,a),r=a)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function FE(n,e){n.asyncQueue.verifyOperationInProgress();const t=await Y0(n);fe("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>jE(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,a)=>jE(e.remoteStore,a))),n._onlineComponents=e}async function Y0(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){fe("FirestoreClient","Using user provided OfflineComponentProvider");try{await ny(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ne.FAILED_PRECONDITION||a.code===ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(t))throw t;sr("Error using user provided cache. Falling back to memory cache: "+t),await ny(n,new ca)}}else fe("FirestoreClient","Using default OfflineComponentProvider"),await ny(n,new ca);return n._offlineComponents}async function _m(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(fe("FirestoreClient","Using user provided OnlineComponentProvider"),await FE(n,n._uninitializedComponentsProvider._online)):(fe("FirestoreClient","Using default OnlineComponentProvider"),await FE(n,new ua))),n._onlineComponents}function PA(n){return Y0(n).then((e=>e.persistence))}function sc(n){return Y0(n).then((e=>e.localStore))}function VA(n){return _m(n).then((e=>e.remoteStore))}function W0(n){return _m(n).then((e=>e.syncEngine))}function MA(n){return _m(n).then((e=>e.datastore))}async function Gl(n){const e=await _m(n),t=e.eventManager;return t.onListen=xV.bind(null,e.syncEngine),t.onUnlisten=EV.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=wV.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=TV.bind(null,e.syncEngine),t}function HV(n){return n.asyncQueue.enqueue((async()=>{const e=await PA(n),t=await VA(n);return e.setNetworkEnabled(!0),(function(a){const o=_e(a);return o.L_.delete(0),md(o)})(t)}))}function KV(n){return n.asyncQueue.enqueue((async()=>{const e=await PA(n),t=await VA(n);return e.setNetworkEnabled(!1),(async function(a){const o=_e(a);o.L_.add(0),await tc(o),o.q_.set("Offline")})(t)}))}function QV(n,e){const t=new fn;return n.asyncQueue.enqueueAndForget((async()=>(async function(a,o,c){try{const d=await(function(p,v){const b=_e(p);return b.persistence.runTransaction("read document","readonly",(E=>b.localDocuments.getDocument(E,v)))})(a,o);d.isFoundDocument()?c.resolve(d):d.isNoDocument()?c.resolve(null):c.reject(new he(ne.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const f=ic(d,`Failed to get document '${o} from cache`);c.reject(f)}})(await sc(n),e,t))),t.promise}function LA(n,e,t={}){const r=new fn;return n.asyncQueue.enqueueAndForget((async()=>(function(o,c,d,f,p){const v=new vm({next:E=>{v.Za(),c.enqueueAndForget((()=>z0(o,b)));const S=E.docs.has(d);!S&&E.fromCache?p.reject(new he(ne.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&E.fromCache&&f&&f.source==="server"?p.reject(new he(ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(E)},error:E=>p.reject(E)}),b=new B0(Jl(d.path),v,{includeMetadataChanges:!0,_a:!0});return U0(o,b)})(await Gl(n),n.asyncQueue,e,t,r))),r.promise}function YV(n,e){const t=new fn;return n.asyncQueue.enqueueAndForget((async()=>(async function(a,o,c){try{const d=await Bf(a,o,!0),f=new CA(o,d.Ts),p=f.ma(d.documents),v=f.applyChanges(p,!1);c.resolve(v.snapshot)}catch(d){const f=ic(d,`Failed to execute query '${o} against cache`);c.reject(f)}})(await sc(n),e,t))),t.promise}function UA(n,e,t={}){const r=new fn;return n.asyncQueue.enqueueAndForget((async()=>(function(o,c,d,f,p){const v=new vm({next:E=>{v.Za(),c.enqueueAndForget((()=>z0(o,b))),E.fromCache&&f.source==="server"?p.reject(new he(ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(E)},error:E=>p.reject(E)}),b=new B0(d,v,{includeMetadataChanges:!0,_a:!0});return U0(o,b)})(await Gl(n),n.asyncQueue,e,t,r))),r.promise}function WV(n,e,t){const r=new fn;return n.asyncQueue.enqueueAndForget((async()=>{try{const a=await MA(n);r.resolve((async function(c,d,f){var p;const v=_e(c),{request:b,ut:E,parent:S}=KI(v.serializer,vI(d),f);v.connection.Fo||delete b.parent;const R=(await v.Lo("RunAggregationQuery",v.serializer.databaseId,S,b,1)).filter((N=>!!N.result));Te(R.length===1);const j=(p=R[0].result)===null||p===void 0?void 0:p.aggregateFields;return Object.keys(j).reduce(((N,I)=>(N[E[I]]=j[I],N)),{})})(a,e,t))}catch(a){r.reject(a)}})),r.promise}function XV(n,e){const t=new vm(e);return n.asyncQueue.enqueueAndForget((async()=>(function(a,o){_e(a).Y_.add(o),o.next()})(await Gl(n),t))),()=>{t.Za(),n.asyncQueue.enqueueAndForget((async()=>(function(a,o){_e(a).Y_.delete(o)})(await Gl(n),t)))}}function JV(n,e,t,r){const a=(function(c,d){let f;return f=typeof c=="string"?MI().encode(c):c,(function(v,b){return new BV(v,b)})((function(v,b){if(v instanceof Uint8Array)return zE(v,b);if(v instanceof ArrayBuffer)return zE(new Uint8Array(v),b);if(v instanceof ReadableStream)return v.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")})(f),d)})(t,fd(e));n.asyncQueue.enqueueAndForget((async()=>{zV(await W0(n),a,r)}))}function ZV(n,e){return n.asyncQueue.enqueue((async()=>(function(r,a){const o=_e(r);return o.persistence.runTransaction("Get named query","readonly",(c=>o.Gr.getNamedQuery(c,a)))})(await sc(n),e)))}function eM(n,e){return n.asyncQueue.enqueue((async()=>(async function(r,a){const o=_e(r),c=o.indexManager,d=[];return o.persistence.runTransaction("Configure indexes","readwrite",(f=>c.getFieldIndexes(f).next((p=>(function(b,E,S,R,j){b=[...b],E=[...E],b.sort(S),E.sort(S);const N=b.length,I=E.length;let te=0,X=0;for(;te<I&&X<N;){const de=S(b[X],E[te]);de<0?j(b[X++]):de>0?R(E[te++]):(te++,X++)}for(;te<I;)R(E[te++]);for(;X<N;)j(b[X++])})(p,a,rO,(v=>{d.push(c.addFieldIndex(f,v))}),(v=>{d.push(c.deleteFieldIndex(f,v))})))).next((()=>K.waitFor(d)))))})(await sc(n),e)))}function tM(n,e){return n.asyncQueue.enqueue((async()=>(function(r,a){_e(r).ss.zi=a})(await sc(n),e)))}function nM(n){return n.asyncQueue.enqueue((async()=>(function(t){const r=_e(t),a=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",(o=>a.deleteAllFieldIndexes(o)))})(await sc(n))))}function zA(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}const BE=new Map;function X0(n,e,t){if(!t)throw new he(ne.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function FA(n,e,t,r){if(e===!0&&r===!0)throw new he(ne.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function qE(n){if(!be.isDocumentKey(n))throw new he(ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function GE(n){if(be.isDocumentKey(n))throw new he(ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function bm(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":we()}function qe(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new he(ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=bm(n);throw new he(ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function BA(n,e){if(e<=0)throw new he(ne.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class $E{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new he(ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new he(ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}FA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zA((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new he(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new he(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new he(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,a){return r.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class gd{constructor(e,t,r,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new $E({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new he(ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new he(ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new $E(e),e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new $S;switch(r.type){case"firstParty":return new J4(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new he(ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=BE.get(t);r&&(fe("ComponentProvider","Removing Datastore"),BE.delete(t),r.terminate())})(this),Promise.resolve()}}function qA(n,e,t,r={}){var a;const o=(n=qe(n,gd))._getSettings(),c=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==c&&sr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:c,ssl:!1})),r.mockUserToken){let d,f;if(typeof r.mockUserToken=="string")d=r.mockUserToken,f=hn.MOCK_USER;else{d=xk(r.mockUserToken,(a=n._app)===null||a===void 0?void 0:a.options.projectId);const p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new he(ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new hn(p)}n._authCredentials=new Y4(new GS(d,f))}}class mn{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new mn(this.firestore,e,this._query)}}class Ut{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Pr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ut(this.firestore,e,this._key)}}class Pr extends mn{constructor(e,t,r){super(e,t,Jl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ut(this.firestore,null,new be(e))}withConverter(e){return new Pr(this.firestore,e,this._path)}}function yt(n,e,...t){if(n=it(n),X0("collection","path",e),n instanceof gd){const r=Ye.fromString(e,...t);return GE(r),new Pr(n,null,r)}{if(!(n instanceof Ut||n instanceof Pr))throw new he(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ye.fromString(e,...t));return GE(r),new Pr(n.firestore,null,r)}}function rM(n,e){if(n=qe(n,gd),X0("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new he(ne.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new mn(n,null,(function(r){return new Ji(Ye.emptyPath(),r)})(e))}function rt(n,e,...t){if(n=it(n),arguments.length===1&&(e=d0.newId()),X0("doc","path",e),n instanceof gd){const r=Ye.fromString(e,...t);return qE(r),new Ut(n,null,new be(r))}{if(!(n instanceof Ut||n instanceof Pr))throw new he(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ye.fromString(e,...t));return qE(r),new Ut(n.firestore,n instanceof Pr?n.converter:null,new be(r))}}function iM(n,e){return n=it(n),e=it(e),(n instanceof Ut||n instanceof Pr)&&(e instanceof Ut||e instanceof Pr)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function J0(n,e){return n=it(n),e=it(e),n instanceof mn&&e instanceof mn&&n.firestore===e.firestore&&ld(n._query,e._query)&&n.converter===e.converter}class HE{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new O0(this,"async_queue_retry"),this.Vu=()=>{const r=bf();r&&fe("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=bf();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=bf();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new fn;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!pa(e))throw e;fe("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((r=>{this.Eu=r,this.du=!1;const a=(function(c){let d=c.message||"";return c.stack&&(d=c.stack.includes(c.message)?c.stack:c.message+`
`+c.stack),d})(r);throw $t("INTERNAL UNHANDLED ERROR: ",a),r})).then((r=>(this.du=!1,r))))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const a=L0.createAndSchedule(this,e,t,r,(o=>this.yu(o)));return this.Tu.push(a),a}fu(){this.Eu&&we()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function zy(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const a=t;for(const o of r)if(o in a&&typeof a[o]=="function")return!0;return!1})(n,["next","error","complete"])}class GA{constructor(){this._progressObserver={},this._taskCompletionResolver=new fn,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}const sM=-1;class gt extends gd{constructor(e,t,r,a){super(e,t,r,a),this.type="firestore",this._queue=new HE,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new HE(e),this._firestoreClient=void 0,await e}}}function aM(n,e,t){t||(t="(default)");const r=Wi(n,"firestore");if(r.isInitialized(t)){const a=r.getImmediate({identifier:t}),o=r.getOptions(t);if(Gi(o,e))return a;throw new he(ne.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new he(ne.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new he(ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:t})}function $A(n,e){const t=typeof n=="object"?n:Zy(),r=typeof n=="string"?n:e||"(default)",a=Wi(t,"firestore").getImmediate({identifier:r});if(!a._initialized){const o=_k("firestore");o&&qA(a,...o)}return a}function Ct(n){if(n._terminated)throw new he(ne.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||HA(n),n._firestoreClient}function HA(n){var e,t,r;const a=n._freezeSettings(),o=(function(d,f,p,v){return new RO(d,f,p,v.host,v.ssl,v.experimentalForceLongPolling,v.experimentalAutoDetectLongPolling,zA(v.experimentalLongPollingOptions),v.useFetchStreams)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,a);n._componentsProvider||!((t=a.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=a.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),n._firestoreClient=new $V(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&(function(d){const f=d?._online.build();return{_offline:d?._offline.build(f),_online:f}})(n._componentsProvider))}function oM(n,e){sr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return KA(n,ua.provider,{build:r=>new Q0(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}async function lM(n){sr("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();KA(n,ua.provider,{build:t=>new OA(t,e.cacheSizeBytes)})}function KA(n,e,t){if((n=qe(n,gt))._firestoreClient||n._terminated)throw new he(ne.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new he(ne.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},HA(n)}function cM(n){if(n._initialized&&!n._terminated)throw new he(ne.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new fn;return n._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await(async function(r){if(!ni.D())return Promise.resolve();const a=r+"main";await ni.delete(a)})(k0(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}})),e.promise}function uM(n){return(function(t){const r=new fn;return t.asyncQueue.enqueueAndForget((async()=>CV(await W0(t),r))),r.promise})(Ct(n=qe(n,gt)))}function dM(n){return HV(Ct(n=qe(n,gt)))}function hM(n){return KV(Ct(n=qe(n,gt)))}function fM(n){return OD(n.app,"firestore",n._databaseId.database),n._delete()}function mM(n,e){const t=Ct(n=qe(n,gt)),r=new GA;return JV(t,n._databaseId,e,r),r}function gM(n,e){return ZV(Ct(n=qe(n,gt)),e).then((t=>t?new mn(n,null,t.query):null))}class $l{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class QA{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}class da{constructor(e){this._byteString=e}static fromBase64String(e){try{return new da(Dt.fromBase64String(e))}catch(t){throw new he(ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new da(Dt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class _a{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new he(ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Tt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function pM(){return new _a("__name__")}class ba{constructor(e){this._methodName=e}}class xm{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new he(ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new he(ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return je(this._lat,e._lat)||je(this._long,e._long)}}class pd{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,a){if(r.length!==a.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==a[o])return!1;return!0})(this._values,e._values)}}const yM=/^__.*__$/;class vM{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new es(e,this.data,this.fieldMask,t,this.fieldTransforms):new Zl(e,this.data,t,this.fieldTransforms)}}class YA{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new es(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function WA(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw we()}}class wm{constructor(e,t,r,a,o,c){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=a,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new wm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Fu({path:r,xu:!1});return a.Ou(e),a}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),a=this.Fu({path:r,xu:!1});return a.vu(),a}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Hf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(WA(this.Cu)&&yM.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class _M{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||fd(e)}Qu(e,t,r,a=!1){return new wm({Cu:e,methodName:t,qu:r,path:Tt.emptyPath(),xu:!1,ku:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Eo(n){const e=n._freezeSettings(),t=fd(n._databaseId);return new _M(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Em(n,e,t,r,a,o={}){const c=n.Qu(o.merge||o.mergeFields?2:0,e,t,a);sv("Data must be an object, but it was:",c,r);const d=ZA(r,c);let f,p;if(o.merge)f=new Kn(c.fieldMask),p=c.fieldTransforms;else if(o.mergeFields){const v=[];for(const b of o.mergeFields){const E=Yu(e,b,t);if(!c.contains(E))throw new he(ne.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);tN(v,E)||v.push(E)}f=new Kn(v),p=c.fieldTransforms.filter((b=>f.covers(b.field)))}else f=null,p=c.fieldTransforms;return new vM(new En(d),f,p)}class yd extends ba{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof yd}}function XA(n,e,t){return new wm({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Z0 extends ba{_toFieldTransform(e){return new ud(e.path,new Vl)}isEqual(e){return e instanceof Z0}}class ev extends ba{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=XA(this,e,!0),r=this.Ku.map((o=>To(o,t))),a=new ho(r);return new ud(e.path,a)}isEqual(e){return e instanceof ev&&Gi(this.Ku,e.Ku)}}class tv extends ba{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=XA(this,e,!0),r=this.Ku.map((o=>To(o,t))),a=new fo(r);return new ud(e.path,a)}isEqual(e){return e instanceof tv&&Gi(this.Ku,e.Ku)}}class nv extends ba{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Ml(e.serializer,AI(e.serializer,this.$u));return new ud(e.path,t)}isEqual(e){return e instanceof nv&&this.$u===e.$u}}function rv(n,e,t,r){const a=n.Qu(1,e,t);sv("Data must be an object, but it was:",a,r);const o=[],c=En.empty();ya(r,((f,p)=>{const v=Tm(e,f,t);p=it(p);const b=a.Nu(v);if(p instanceof yd)o.push(v);else{const E=To(p,b);E!=null&&(o.push(v),c.set(v,E))}}));const d=new Kn(o);return new YA(c,d,a.fieldTransforms)}function iv(n,e,t,r,a,o){const c=n.Qu(1,e,t),d=[Yu(e,r,t)],f=[a];if(o.length%2!=0)throw new he(ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<o.length;E+=2)d.push(Yu(e,o[E])),f.push(o[E+1]);const p=[],v=En.empty();for(let E=d.length-1;E>=0;--E)if(!tN(p,d[E])){const S=d[E];let R=f[E];R=it(R);const j=c.Nu(S);if(R instanceof yd)p.push(S);else{const N=To(R,j);N!=null&&(p.push(S),v.set(S,N))}}const b=new Kn(p);return new YA(v,b,c.fieldTransforms)}function JA(n,e,t,r=!1){return To(t,n.Qu(r?4:3,e))}function To(n,e){if(eN(n=it(n)))return sv("Unsupported field value:",e,n),ZA(n,e);if(n instanceof ba)return(function(r,a){if(!WA(a.Cu))throw a.Bu(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Bu(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(a);o&&a.fieldTransforms.push(o)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return(function(r,a){const o=[];let c=0;for(const d of r){let f=To(d,a.Lu(c));f==null&&(f={nullValue:"NULL_VALUE"}),o.push(f),c++}return{arrayValue:{values:o}}})(n,e)}return(function(r,a){if((r=it(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return AI(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=Be.fromDate(r);return{timestampValue:Ll(a.serializer,o)}}if(r instanceof Be){const o=new Be(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ll(a.serializer,o)}}if(r instanceof xm)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof da)return{bytesValue:zI(a.serializer,r._byteString)};if(r instanceof Ut){const o=a.databaseId,c=r.firestore._databaseId;if(!c.isEqual(o))throw a.Bu(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:T0(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof pd)return(function(c,d){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:c.toArray().map((f=>{if(typeof f!="number")throw d.Bu("VectorValues must only contain numeric values.");return v0(d.serializer,f)}))}}}}}})(r,a);throw a.Bu(`Unsupported field value: ${bm(r)}`)})(n,e)}function ZA(n,e){const t={};return sI(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ya(n,((r,a)=>{const o=To(a,e.Mu(r));o!=null&&(t[r]=o)})),{mapValue:{fields:t}}}function eN(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Be||n instanceof xm||n instanceof da||n instanceof Ut||n instanceof ba||n instanceof pd)}function sv(n,e,t){if(!eN(t)||!(function(a){return typeof a=="object"&&a!==null&&(Object.getPrototypeOf(a)===Object.prototype||Object.getPrototypeOf(a)===null)})(t)){const r=bm(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Yu(n,e,t){if((e=it(e))instanceof _a)return e._internalPath;if(typeof e=="string")return Tm(n,e);throw Hf("Field path arguments must be of type string or ",n,!1,void 0,t)}const bM=new RegExp("[~\\*/\\[\\]]");function Tm(n,e,t){if(e.search(bM)>=0)throw Hf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new _a(...e.split("."))._internalPath}catch{throw Hf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Hf(n,e,t,r,a){const o=r&&!r.isEmpty(),c=a!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(o||c)&&(f+=" (found",o&&(f+=` in field ${r}`),c&&(f+=` in document ${a}`),f+=")"),new he(ne.INVALID_ARGUMENT,d+n+f)}function tN(n,e){return n.some((t=>t.isEqual(e)))}class Wu{constructor(e,t,r,a,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=a,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ut(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new xM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Sm("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class xM extends Wu{data(){return super.data()}}function Sm(n,e){return typeof e=="string"?Tm(n,e):e instanceof _a?e._internalPath:e._delegate._internalPath}function nN(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new he(ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class av{}class ac extends av{}function Gt(n,e,...t){let r=[];e instanceof av&&r.push(e),r=r.concat(t),(function(o){const c=o.filter((f=>f instanceof So)).length,d=o.filter((f=>f instanceof oc)).length;if(c>1||c>0&&d>0)throw new he(ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const a of r)n=a._apply(n);return n}class oc extends ac{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new oc(e,t,r)}_apply(e){const t=this._parse(e);return iN(e._query,t),new mn(e.firestore,e.converter,Ny(e._query,t))}_parse(e){const t=Eo(e.firestore);return(function(o,c,d,f,p,v,b){let E;if(p.isKeyField()){if(v==="array-contains"||v==="array-contains-any")throw new he(ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if(v==="in"||v==="not-in"){QE(b,v);const S=[];for(const R of b)S.push(KE(f,o,R));E={arrayValue:{values:S}}}else E=KE(f,o,b)}else v!=="in"&&v!=="not-in"&&v!=="array-contains-any"||QE(b,v),E=JA(d,c,b,v==="in"||v==="not-in");return We.create(p,v,E)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function nn(n,e,t){const r=e,a=Sm("where",n);return oc._create(a,r,t)}class So extends av{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new So(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:ut.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(a,o){let c=a;const d=o.getFlattenedFilters();for(const f of d)iN(c,f),c=Ny(c,f)})(e._query,t),new mn(e.firestore,e.converter,Ny(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function wM(...n){return n.forEach((e=>sN("or",e))),So._create("or",n)}function EM(...n){return n.forEach((e=>sN("and",e))),So._create("and",n)}class Im extends ac{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Im(e,t)}_apply(e){const t=(function(a,o,c){if(a.startAt!==null)throw new he(ne.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new he(ne.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Hu(o,c)})(e._query,this._field,this._direction);return new mn(e.firestore,e.converter,(function(a,o){const c=a.explicitOrderBy.concat([o]);return new Ji(a.path,a.collectionGroup,c,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)})(e._query,t))}}function xf(n,e="asc"){const t=e,r=Sm("orderBy",n);return Im._create(r,t)}class vd extends ac{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new vd(e,t,r)}_apply(e){return new mn(e.firestore,e.converter,Vf(e._query,this._limit,this._limitType))}}function wf(n){return BA("limit",n),vd._create("limit",n,"F")}function TM(n){return BA("limitToLast",n),vd._create("limitToLast",n,"L")}class _d extends ac{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new _d(e,t,r)}_apply(e){const t=rN(e,this.type,this._docOrFields,this._inclusive);return new mn(e.firestore,e.converter,(function(a,o){return new Ji(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,o,a.endAt)})(e._query,t))}}function SM(...n){return _d._create("startAt",n,!0)}function IM(...n){return _d._create("startAfter",n,!1)}class bd extends ac{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new bd(e,t,r)}_apply(e){const t=rN(e,this.type,this._docOrFields,this._inclusive);return new mn(e.firestore,e.converter,(function(a,o){return new Ji(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,a.startAt,o)})(e._query,t))}}function AM(...n){return bd._create("endBefore",n,!1)}function NM(...n){return bd._create("endAt",n,!0)}function rN(n,e,t,r){if(t[0]=it(t[0]),t[0]instanceof Wu)return(function(o,c,d,f,p){if(!f)throw new he(ne.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${d}().`);const v=[];for(const b of Il(o))if(b.field.isKeyField())v.push(co(c,f.key));else{const E=f.data.field(b.field);if(om(E))throw new he(ne.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+b.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(E===null){const S=b.field.canonicalString();throw new he(ne.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${S}' (used as the orderBy) does not exist.`)}v.push(E)}return new oa(v,p)})(n._query,n.firestore._databaseId,e,t[0]._document,r);{const a=Eo(n.firestore);return(function(c,d,f,p,v,b){const E=c.explicitOrderBy;if(v.length>E.length)throw new he(ne.INVALID_ARGUMENT,`Too many arguments provided to ${p}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const S=[];for(let R=0;R<v.length;R++){const j=v[R];if(E[R].field.isKeyField()){if(typeof j!="string")throw new he(ne.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${p}(), but got a ${typeof j}`);if(!p0(c)&&j.indexOf("/")!==-1)throw new he(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${p}() must be a plain document ID, but '${j}' contains a slash.`);const N=c.path.child(Ye.fromString(j));if(!be.isDocumentKey(N))throw new he(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${p}() must result in a valid document path, but '${N}' is not because it contains an odd number of segments.`);const I=new be(N);S.push(co(d,I))}else{const N=JA(f,p,j);S.push(N)}}return new oa(S,b)})(n._query,n.firestore._databaseId,a,e,t,r)}}function KE(n,e,t){if(typeof(t=it(t))=="string"){if(t==="")throw new he(ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!p0(e)&&t.indexOf("/")!==-1)throw new he(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Ye.fromString(t));if(!be.isDocumentKey(r))throw new he(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return co(n,new be(r))}if(t instanceof Ut)return co(n,t._key);throw new he(ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bm(t)}.`)}function QE(n,e){if(!Array.isArray(n)||n.length===0)throw new he(ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function iN(n,e){const t=(function(a,o){for(const c of a)for(const d of c.getFlattenedFilters())if(o.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new he(ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new he(ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function sN(n,e){if(!(e instanceof oc||e instanceof So))throw new he(ne.INVALID_ARGUMENT,`Function ${n}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class ov{convertValue(e,t="none"){switch(sa(e)){case 0:return null;case 1:return e.booleanValue;case 2:return It(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Qi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw we()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ya(e,((a,o)=>{r[a]=this.convertValue(o,t)})),r}convertVectorValue(e){var t,r,a;const o=(a=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||a===void 0?void 0:a.map((c=>It(c.doubleValue)));return new pd(o)}convertGeoPoint(e){return new xm(It(e.latitude),It(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=lm(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(qu(e));default:return null}}convertTimestamp(e){const t=Ki(e);return new Be(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ye.fromString(e);Te(XI(r));const a=new ia(r.get(1),r.get(3)),o=new be(r.popFirst(5));return a.isEqual(t)||$t(`Document ${o} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}function Am(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class CM extends ov{constructor(e){super(),this.firestore=e}convertBytes(e){return new da(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ut(this.firestore,null,t)}}function RM(n){return new $l("sum",Yu("sum",n))}function kM(n){return new $l("avg",Yu("average",n))}function aN(){return new $l("count")}function DM(n,e){var t,r;return n instanceof $l&&e instanceof $l&&n.aggregateType===e.aggregateType&&((t=n._internalFieldPath)===null||t===void 0?void 0:t.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function jM(n,e){return J0(n.query,e.query)&&Gi(n.data(),e.data())}class Js{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class yo extends Wu{constructor(e,t,r,a,o,c){super(e,t,r,a,c),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Pu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Sm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Pu extends yo{data(e={}){return super.data(e)}}class vo{constructor(e,t,r,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Js(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Pu(this._firestore,this._userDataWriter,r.key,r,new Js(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new he(ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(a,o){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map((d=>{const f=new Pu(a._firestore,a._userDataWriter,d.doc.key,d.doc,new Js(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);return d.doc,{type:"added",doc:f,oldIndex:-1,newIndex:c++}}))}{let c=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((d=>o||d.type!==3)).map((d=>{const f=new Pu(a._firestore,a._userDataWriter,d.doc.key,d.doc,new Js(a._snapshot.mutatedKeys.has(d.doc.key),a._snapshot.fromCache),a.query.converter);let p=-1,v=-1;return d.type!==0&&(p=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),v=c.indexOf(d.doc.key)),{type:OM(d.type),doc:f,oldIndex:p,newIndex:v}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function OM(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return we()}}function PM(n,e){return n instanceof yo&&e instanceof yo?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof vo&&e instanceof vo&&n._firestore===e._firestore&&J0(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function wr(n){n=qe(n,Ut);const e=qe(n.firestore,gt);return LA(Ct(e),n._key).then((t=>cv(e,n,t)))}class xa extends ov{constructor(e){super(),this.firestore=e}convertBytes(e){return new da(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ut(this.firestore,null,t)}}function VM(n){n=qe(n,Ut);const e=qe(n.firestore,gt),t=Ct(e),r=new xa(e);return QV(t,n._key).then((a=>new yo(e,r,n._key,a,new Js(a!==null&&a.hasLocalMutations,!0),n.converter)))}function MM(n){n=qe(n,Ut);const e=qe(n.firestore,gt);return LA(Ct(e),n._key,{source:"server"}).then((t=>cv(e,n,t)))}function Zt(n){n=qe(n,mn);const e=qe(n.firestore,gt),t=Ct(e),r=new xa(e);return nN(n._query),UA(t,n._query).then((a=>new vo(e,r,n,a)))}function LM(n){n=qe(n,mn);const e=qe(n.firestore,gt),t=Ct(e),r=new xa(e);return YV(t,n._query).then((a=>new vo(e,r,n,a)))}function UM(n){n=qe(n,mn);const e=qe(n.firestore,gt),t=Ct(e),r=new xa(e);return UA(t,n._query,{source:"server"}).then((a=>new vo(e,r,n,a)))}function lv(n,e,t){n=qe(n,Ut);const r=qe(n.firestore,gt),a=Am(n.converter,e,t);return lc(r,[Em(Eo(r),"setDoc",n._key,a,n.converter!==null,t).toMutation(n._key,At.none())])}function wt(n,e,t,...r){n=qe(n,Ut);const a=qe(n.firestore,gt),o=Eo(a);let c;return c=typeof(e=it(e))=="string"||e instanceof _a?iv(o,"updateDoc",n._key,e,t,r):rv(o,"updateDoc",n._key,e),lc(a,[c.toMutation(n._key,At.exists(!0))])}function Xu(n){return lc(qe(n.firestore,gt),[new ec(n._key,At.none())])}function Vu(n,e){const t=qe(n.firestore,gt),r=rt(n),a=Am(n.converter,e);return lc(t,[Em(Eo(n.firestore),"addDoc",r._key,a,n.converter!==null,{}).toMutation(r._key,At.exists(!1))]).then((()=>r))}function oN(n,...e){var t,r,a;n=it(n);let o={includeMetadataChanges:!1,source:"default"},c=0;typeof e[c]!="object"||zy(e[c])||(o=e[c],c++);const d={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(zy(e[c])){const b=e[c];e[c]=(t=b.next)===null||t===void 0?void 0:t.bind(b),e[c+1]=(r=b.error)===null||r===void 0?void 0:r.bind(b),e[c+2]=(a=b.complete)===null||a===void 0?void 0:a.bind(b)}let f,p,v;if(n instanceof Ut)p=qe(n.firestore,gt),v=Jl(n._key.path),f={next:b=>{e[c]&&e[c](cv(p,n,b))},error:e[c+1],complete:e[c+2]};else{const b=qe(n,mn);p=qe(b.firestore,gt),v=b._query;const E=new xa(p);f={next:S=>{e[c]&&e[c](new vo(p,E,b,S))},error:e[c+1],complete:e[c+2]},nN(n._query)}return(function(E,S,R,j){const N=new vm(j),I=new B0(S,N,R);return E.asyncQueue.enqueueAndForget((async()=>U0(await Gl(E),I))),()=>{N.Za(),E.asyncQueue.enqueueAndForget((async()=>z0(await Gl(E),I)))}})(Ct(p),v,d,f)}function zM(n,e){return XV(Ct(n=qe(n,gt)),zy(e)?e:{next:e})}function lc(n,e){return(function(r,a){const o=new fn;return r.asyncQueue.enqueueAndForget((async()=>SV(await W0(r),a,o))),o.promise})(Ct(n),e)}function cv(n,e,t){const r=t.docs.get(e._key),a=new xa(n);return new yo(n,a,e._key,r,new Js(t.hasPendingWrites,t.fromCache),e.converter)}function FM(n){return lN(n,{count:aN()})}function lN(n,e){const t=qe(n.firestore,gt),r=Ct(t),a=iI(e,((o,c)=>new OI(c,o.aggregateType,o._internalFieldPath)));return WV(r,n._query,a).then((o=>(function(d,f,p){const v=new xa(d);return new QA(f,v,p)})(t,n,o)))}class BM{constructor(e){this.kind="memory",this._onlineComponentProvider=ua.provider,e?.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=ca.provider}toJSON(){return{kind:this.kind}}}class qM{constructor(e){let t;this.kind="persistent",e?.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=cN(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class GM{constructor(){this.kind="memoryEager",this._offlineComponentProvider=ca.provider}toJSON(){return{kind:this.kind}}}class $M{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new FV(e)}}toJSON(){return{kind:this.kind}}}function HM(){return new GM}function KM(n){return new $M(n?.cacheSizeBytes)}function QM(n){return new BM(n)}function YM(n){return new qM(n)}class WM{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ua.provider,this._offlineComponentProvider={build:t=>new Q0(t,e?.cacheSizeBytes,this.forceOwnership)}}}class XM{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ua.provider,this._offlineComponentProvider={build:t=>new OA(t,e?.cacheSizeBytes)}}}function cN(n){return new WM(n?.forceOwnership)}function JM(){return new XM}const ZM={maxAttempts:5};class uN{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Eo(e)}set(e,t,r){this._verifyNotCommitted();const a=Ws(e,this._firestore),o=Am(a.converter,t,r),c=Em(this._dataReader,"WriteBatch.set",a._key,o,a.converter!==null,r);return this._mutations.push(c.toMutation(a._key,At.none())),this}update(e,t,r,...a){this._verifyNotCommitted();const o=Ws(e,this._firestore);let c;return c=typeof(t=it(t))=="string"||t instanceof _a?iv(this._dataReader,"WriteBatch.update",o._key,t,r,a):rv(this._dataReader,"WriteBatch.update",o._key,t),this._mutations.push(c.toMutation(o._key,At.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Ws(e,this._firestore);return this._mutations=this._mutations.concat(new ec(t._key,At.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new he(ne.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Ws(n,e){if((n=it(n)).firestore!==e)throw new he(ne.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class dN extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Eo(t)}get(t){const r=Ws(t,this._firestore),a=new CM(this._firestore);return this._transaction.lookup([r._key]).then((o=>{if(!o||o.length!==1)return we();const c=o[0];if(c.isFoundDocument())return new Wu(this._firestore,a,c.key,c,r.converter);if(c.isNoDocument())return new Wu(this._firestore,a,r._key,null,r.converter);throw we()}))}set(t,r,a){const o=Ws(t,this._firestore),c=Am(o.converter,r,a),d=Em(this._dataReader,"Transaction.set",o._key,c,o.converter!==null,a);return this._transaction.set(o._key,d),this}update(t,r,a,...o){const c=Ws(t,this._firestore);let d;return d=typeof(r=it(r))=="string"||r instanceof _a?iv(this._dataReader,"Transaction.update",c._key,r,a,o):rv(this._dataReader,"Transaction.update",c._key,r),this._transaction.update(c._key,d),this}delete(t){const r=Ws(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Ws(e,this._firestore),r=new xa(this._firestore);return super.get(e).then((a=>new yo(this._firestore,r,t._key,a._document,new Js(!1,!1),t.converter)))}}function e5(n,e,t){n=qe(n,gt);const r=Object.assign(Object.assign({},ZM),t);return(function(o){if(o.maxAttempts<1)throw new he(ne.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r),(function(o,c,d){const f=new fn;return o.asyncQueue.enqueueAndForget((async()=>{const p=await MA(o);new GV(o.asyncQueue,p,d,c,f).au()})),f.promise})(Ct(n),(a=>e(new dN(n,a))),r)}function t5(){return new yd("deleteField")}function Au(){return new Z0("serverTimestamp")}function uv(...n){return new ev("arrayUnion",n)}function dv(...n){return new tv("arrayRemove",n)}function n5(n){return new nv("increment",n)}function r5(n){return new pd(n)}function Nu(n){return Ct(n=qe(n,gt)),new uN(n,(e=>lc(n,e)))}function i5(n,e){const t=Ct(n=qe(n,gt));if(!t._uninitializedComponentsProvider||t._uninitializedComponentsProvider._offline.kind==="memory")return sr("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=(function(o){const c=typeof o=="string"?(function(p){try{return JSON.parse(p)}catch(v){throw new he(ne.INVALID_ARGUMENT,"Failed to parse JSON: "+v?.message)}})(o):o,d=[];if(Array.isArray(c.indexes))for(const f of c.indexes){const p=YE(f,"collectionGroup"),v=[];if(Array.isArray(f.fields))for(const b of f.fields){const E=Tm("setIndexConfiguration",YE(b,"fieldPath"));b.arrayConfig==="CONTAINS"?v.push(new oo(E,2)):b.order==="ASCENDING"?v.push(new oo(E,0)):b.order==="DESCENDING"&&v.push(new oo(E,1))}d.push(new Dl(Dl.UNKNOWN_ID,p,v,jl.empty()))}return d})(e);return eM(t,r)}function YE(n,e){if(typeof n[e]!="string")throw new he(ne.INVALID_ARGUMENT,"Missing string value for: "+e);return n[e]}class hN{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function s5(n){var e;n=qe(n,gt);const t=WE.get(n);if(t)return t;if(((e=Ct(n)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const r=new hN(n);return WE.set(n,r),r}function a5(n){fN(n,!0)}function o5(n){fN(n,!1)}function l5(n){nM(Ct(n._firestore)).then((e=>fe("deleting all persistent cache indexes succeeded"))).catch((e=>sr("deleting all persistent cache indexes failed",e)))}function fN(n,e){tM(Ct(n._firestore),e).then((t=>fe(`setting persistent cache index auto creation isEnabled=${e} succeeded`))).catch((t=>sr(`setting persistent cache index auto creation isEnabled=${e} failed`,t)))}const WE=new WeakMap;function c5(n){var e;const t=(e=Ct(qe(n.firestore,gt))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return t===void 0?null:hm(t,kn(n._query))._t}function u5(n,e){var t;const r=iI(e,((o,c)=>new OI(c,o.aggregateType,o._internalFieldPath))),a=(t=Ct(qe(n.firestore,gt))._onlineComponents)===null||t===void 0?void 0:t.datastore.serializer;return a===void 0?null:KI(a,vI(n._query),r,!0).request}class d5{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return hv.instance.onExistenceFilterMismatch(e)}}class hv{constructor(){this.Uu=new Map}static get instance(){return sf||(sf=new hv,(function(t){if(Mf)throw new Error("a TestingHooksSpi instance is already set");Mf=t})(sf)),sf}et(e){this.Uu.forEach((t=>t(e)))}onExistenceFilterMismatch(e){const t=Symbol(),r=this.Uu;return r.set(t,e),()=>r.delete(t)}}let sf=null;(function(e,t=!0){(function(a){Xl=a})(Wl),ii(new Vr("firestore",((r,{instanceIdentifier:a,options:o})=>{const c=r.getProvider("app").getImmediate(),d=new gt(new W4(r.getProvider("auth-internal")),new Z4(r.getProvider("app-check-internal")),(function(p,v){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new he(ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ia(p.options.projectId,v)})(c,a),c);return o=Object.assign({useFetchStreams:t},o),d._setSettings(o),d}),"PUBLIC").setMultipleInstances(!0)),Er(Uw,"4.7.3",e),Er(Uw,"4.7.3","esm2017")})();const h5=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:ov,AggregateField:$l,AggregateQuerySnapshot:QA,Bytes:da,CACHE_SIZE_UNLIMITED:sM,CollectionReference:Pr,DocumentReference:Ut,DocumentSnapshot:yo,FieldPath:_a,FieldValue:ba,Firestore:gt,FirestoreError:he,GeoPoint:xm,LoadBundleTask:GA,PersistentCacheIndexManager:hN,Query:mn,QueryCompositeFilterConstraint:So,QueryConstraint:ac,QueryDocumentSnapshot:Pu,QueryEndAtConstraint:bd,QueryFieldFilterConstraint:oc,QueryLimitConstraint:vd,QueryOrderByConstraint:Im,QuerySnapshot:vo,QueryStartAtConstraint:_d,SnapshotMetadata:Js,Timestamp:Be,Transaction:dN,VectorValue:pd,WriteBatch:uN,_AutoId:d0,_ByteString:Dt,_DatabaseId:ia,_DocumentKey:be,_EmptyAppCheckTokenProvider:eO,_EmptyAuthCredentialsProvider:$S,_FieldPath:Tt,_TestingHooks:d5,_cast:qe,_debugAssert:Q4,_internalAggregationQueryToProtoRunAggregationQueryRequest:u5,_internalQueryToProtoQueryTarget:c5,_isBase64Available:NO,_logWarn:sr,_validateIsNotUsedTogether:FA,addDoc:Vu,aggregateFieldEqual:DM,aggregateQuerySnapshotEqual:jM,and:EM,arrayRemove:dv,arrayUnion:uv,average:kM,clearIndexedDbPersistence:cM,collection:yt,collectionGroup:rM,connectFirestoreEmulator:qA,count:aN,deleteAllPersistentCacheIndexes:l5,deleteDoc:Xu,deleteField:t5,disableNetwork:hM,disablePersistentCacheIndexAutoCreation:o5,doc:rt,documentId:pM,enableIndexedDbPersistence:oM,enableMultiTabIndexedDbPersistence:lM,enableNetwork:dM,enablePersistentCacheIndexAutoCreation:a5,endAt:NM,endBefore:AM,ensureFirestoreConfigured:Ct,executeWrite:lc,getAggregateFromServer:lN,getCountFromServer:FM,getDoc:wr,getDocFromCache:VM,getDocFromServer:MM,getDocs:Zt,getDocsFromCache:LM,getDocsFromServer:UM,getFirestore:$A,getPersistentCacheIndexManager:s5,increment:n5,initializeFirestore:aM,limit:wf,limitToLast:TM,loadBundle:mM,memoryEagerGarbageCollector:HM,memoryLocalCache:QM,memoryLruGarbageCollector:KM,namedQuery:gM,onSnapshot:oN,onSnapshotsInSync:zM,or:wM,orderBy:xf,persistentLocalCache:YM,persistentMultipleTabManager:JM,persistentSingleTabManager:cN,query:Gt,queryEqual:J0,refEqual:iM,runTransaction:e5,serverTimestamp:Au,setDoc:lv,setIndexConfiguration:i5,setLogLevel:K4,snapshotEqual:PM,startAfter:IM,startAt:SM,sum:RM,terminate:fM,updateDoc:wt,vector:r5,waitForPendingWrites:uM,where:nn,writeBatch:Nu},Symbol.toStringTag,{value:"Module"})),mN="@firebase/installations",fv="0.6.9";const gN=1e4,pN=`w:${fv}`,yN="FIS_v2",f5="https://firebaseinstallations.googleapis.com/v1",m5=3600*1e3,g5="installations",p5="Installations";const y5={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},_o=new xo(g5,p5,y5);function vN(n){return n instanceof Ur&&n.code.includes("request-failed")}function _N({projectId:n}){return`${f5}/projects/${n}/installations`}function bN(n){return{token:n.token,requestStatus:2,expiresIn:_5(n.expiresIn),creationTime:Date.now()}}async function xN(n,e){const r=(await e.json()).error;return _o.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function wN({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function v5(n,{refreshToken:e}){const t=wN(n);return t.append("Authorization",b5(e)),t}async function EN(n){const e=await n();return e.status>=500&&e.status<600?n():e}function _5(n){return Number(n.replace("s","000"))}function b5(n){return`${yN} ${n}`}async function x5({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=_N(n),a=wN(n),o=e.getImmediate({optional:!0});if(o){const p=await o.getHeartbeatsHeader();p&&a.append("x-firebase-client",p)}const c={fid:t,authVersion:yN,appId:n.appId,sdkVersion:pN},d={method:"POST",headers:a,body:JSON.stringify(c)},f=await EN(()=>fetch(r,d));if(f.ok){const p=await f.json();return{fid:p.fid||t,registrationStatus:2,refreshToken:p.refreshToken,authToken:bN(p.authToken)}}else throw await xN("Create Installation",f)}function TN(n){return new Promise(e=>{setTimeout(e,n)})}function w5(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}const E5=/^[cdef][\w-]{21}$/,Fy="";function T5(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=S5(n);return E5.test(t)?t:Fy}catch{return Fy}}function S5(n){return w5(n).substr(0,22)}function Nm(n){return`${n.appName}!${n.appId}`}const SN=new Map;function IN(n,e){const t=Nm(n);AN(t,e),I5(t,e)}function AN(n,e){const t=SN.get(n);if(t)for(const r of t)r(e)}function I5(n,e){const t=A5();t&&t.postMessage({key:n,fid:e}),N5()}let so=null;function A5(){return!so&&"BroadcastChannel"in self&&(so=new BroadcastChannel("[Firebase] FID Change"),so.onmessage=n=>{AN(n.data.key,n.data.fid)}),so}function N5(){SN.size===0&&so&&(so.close(),so=null)}const C5="firebase-installations-database",R5=1,bo="firebase-installations-store";let ry=null;function mv(){return ry||(ry=UT(C5,R5,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(bo)}}})),ry}async function Kf(n,e){const t=Nm(n),a=(await mv()).transaction(bo,"readwrite"),o=a.objectStore(bo),c=await o.get(t);return await o.put(e,t),await a.done,(!c||c.fid!==e.fid)&&IN(n,e.fid),e}async function NN(n){const e=Nm(n),r=(await mv()).transaction(bo,"readwrite");await r.objectStore(bo).delete(e),await r.done}async function Cm(n,e){const t=Nm(n),a=(await mv()).transaction(bo,"readwrite"),o=a.objectStore(bo),c=await o.get(t),d=e(c);return d===void 0?await o.delete(t):await o.put(d,t),await a.done,d&&(!c||c.fid!==d.fid)&&IN(n,d.fid),d}async function gv(n){let e;const t=await Cm(n.appConfig,r=>{const a=k5(r),o=D5(n,a);return e=o.registrationPromise,o.installationEntry});return t.fid===Fy?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function k5(n){const e=n||{fid:T5(),registrationStatus:0};return CN(e)}function D5(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const a=Promise.reject(_o.create("app-offline"));return{installationEntry:e,registrationPromise:a}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=j5(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:O5(n)}:{installationEntry:e}}async function j5(n,e){try{const t=await x5(n,e);return Kf(n.appConfig,t)}catch(t){throw vN(t)&&t.customData.serverCode===409?await NN(n.appConfig):await Kf(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function O5(n){let e=await XE(n.appConfig);for(;e.registrationStatus===1;)await TN(100),e=await XE(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await gv(n);return r||t}return e}function XE(n){return Cm(n,e=>{if(!e)throw _o.create("installation-not-found");return CN(e)})}function CN(n){return P5(n)?{fid:n.fid,registrationStatus:0}:n}function P5(n){return n.registrationStatus===1&&n.registrationTime+gN<Date.now()}async function V5({appConfig:n,heartbeatServiceProvider:e},t){const r=M5(n,t),a=v5(n,t),o=e.getImmediate({optional:!0});if(o){const p=await o.getHeartbeatsHeader();p&&a.append("x-firebase-client",p)}const c={installation:{sdkVersion:pN,appId:n.appId}},d={method:"POST",headers:a,body:JSON.stringify(c)},f=await EN(()=>fetch(r,d));if(f.ok){const p=await f.json();return bN(p)}else throw await xN("Generate Auth Token",f)}function M5(n,{fid:e}){return`${_N(n)}/${e}/authTokens:generate`}async function pv(n,e=!1){let t;const r=await Cm(n.appConfig,o=>{if(!RN(o))throw _o.create("not-registered");const c=o.authToken;if(!e&&z5(c))return o;if(c.requestStatus===1)return t=L5(n,e),o;{if(!navigator.onLine)throw _o.create("app-offline");const d=B5(o);return t=U5(n,d),d}});return t?await t:r.authToken}async function L5(n,e){let t=await JE(n.appConfig);for(;t.authToken.requestStatus===1;)await TN(100),t=await JE(n.appConfig);const r=t.authToken;return r.requestStatus===0?pv(n,e):r}function JE(n){return Cm(n,e=>{if(!RN(e))throw _o.create("not-registered");const t=e.authToken;return q5(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function U5(n,e){try{const t=await V5(n,e),r=Object.assign(Object.assign({},e),{authToken:t});return await Kf(n.appConfig,r),t}catch(t){if(vN(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await NN(n.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Kf(n.appConfig,r)}throw t}}function RN(n){return n!==void 0&&n.registrationStatus===2}function z5(n){return n.requestStatus===2&&!F5(n)}function F5(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+m5}function B5(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function q5(n){return n.requestStatus===1&&n.requestTime+gN<Date.now()}async function G5(n){const e=n,{installationEntry:t,registrationPromise:r}=await gv(e);return r?r.catch(console.error):pv(e).catch(console.error),t.fid}async function $5(n,e=!1){const t=n;return await H5(t),(await pv(t,e)).token}async function H5(n){const{registrationPromise:e}=await gv(n);e&&await e}function K5(n){if(!n||!n.options)throw iy("App Configuration");if(!n.name)throw iy("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw iy(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function iy(n){return _o.create("missing-app-config-values",{valueName:n})}const kN="installations",Q5="installations-internal",Y5=n=>{const e=n.getProvider("app").getImmediate(),t=K5(e),r=Wi(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},W5=n=>{const e=n.getProvider("app").getImmediate(),t=Wi(e,kN).getImmediate();return{getId:()=>G5(t),getToken:a=>$5(t,a)}};function X5(){ii(new Vr(kN,Y5,"PUBLIC")),ii(new Vr(Q5,W5,"PRIVATE"))}X5();Er(mN,fv);Er(mN,fv,"esm2017");const Qf="analytics",J5="firebase_id",Z5="origin",eL=60*1e3,tL="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",yv="https://www.googletagmanager.com/gtag/js";const Ln=new em("@firebase/analytics");const nL={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},ir=new xo("analytics","Analytics",nL);function rL(n){if(!n.startsWith(yv)){const e=ir.create("invalid-gtag-resource",{gtagURL:n});return Ln.warn(e.message),""}return n}function DN(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function iL(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function sL(n,e){const t=iL("firebase-js-sdk-policy",{createScriptURL:rL}),r=document.createElement("script"),a=`${yv}?l=${n}&id=${e}`;r.src=t?t?.createScriptURL(a):a,r.async=!0,document.head.appendChild(r)}function aL(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function oL(n,e,t,r,a,o){const c=r[a];try{if(c)await e[c];else{const f=(await DN(t)).find(p=>p.measurementId===a);f&&await e[f.appId]}}catch(d){Ln.error(d)}n("config",a,o)}async function lL(n,e,t,r,a){try{let o=[];if(a&&a.send_to){let c=a.send_to;Array.isArray(c)||(c=[c]);const d=await DN(t);for(const f of c){const p=d.find(b=>b.measurementId===f),v=p&&e[p.appId];if(v)o.push(v);else{o=[];break}}}o.length===0&&(o=Object.values(e)),await Promise.all(o),n("event",r,a||{})}catch(o){Ln.error(o)}}function cL(n,e,t,r){async function a(o,...c){try{if(o==="event"){const[d,f]=c;await lL(n,e,t,d,f)}else if(o==="config"){const[d,f]=c;await oL(n,e,t,r,d,f)}else if(o==="consent"){const[d,f]=c;n("consent",d,f)}else if(o==="get"){const[d,f,p]=c;n("get",d,f,p)}else if(o==="set"){const[d]=c;n("set",d)}else n(o,...c)}catch(d){Ln.error(d)}}return a}function uL(n,e,t,r,a){let o=function(...c){window[r].push(arguments)};return window[a]&&typeof window[a]=="function"&&(o=window[a]),window[a]=cL(o,n,e,t),{gtagCore:o,wrappedGtag:window[a]}}function dL(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(yv)&&t.src.includes(n))return t;return null}const hL=30,fL=1e3;class mL{constructor(e={},t=fL){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const jN=new mL;function gL(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function pL(n){var e;const{appId:t,apiKey:r}=n,a={method:"GET",headers:gL(r)},o=tL.replace("{app-id}",t),c=await fetch(o,a);if(c.status!==200&&c.status!==304){let d="";try{const f=await c.json();!((e=f.error)===null||e===void 0)&&e.message&&(d=f.error.message)}catch{}throw ir.create("config-fetch-failed",{httpStatus:c.status,responseMessage:d})}return c.json()}async function yL(n,e=jN,t){const{appId:r,apiKey:a,measurementId:o}=n.options;if(!r)throw ir.create("no-app-id");if(!a){if(o)return{measurementId:o,appId:r};throw ir.create("no-api-key")}const c=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},d=new bL;return setTimeout(async()=>{d.abort()},eL),ON({appId:r,apiKey:a,measurementId:o},c,d,e)}async function ON(n,{throttleEndTimeMillis:e,backoffCount:t},r,a=jN){var o;const{appId:c,measurementId:d}=n;try{await vL(r,e)}catch(f){if(d)return Ln.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${f?.message}]`),{appId:c,measurementId:d};throw f}try{const f=await pL(n);return a.deleteThrottleMetadata(c),f}catch(f){const p=f;if(!_L(p)){if(a.deleteThrottleMetadata(c),d)return Ln.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${p?.message}]`),{appId:c,measurementId:d};throw f}const v=Number((o=p?.customData)===null||o===void 0?void 0:o.httpStatus)===503?dw(t,a.intervalMillis,hL):dw(t,a.intervalMillis),b={throttleEndTimeMillis:Date.now()+v,backoffCount:t+1};return a.setThrottleMetadata(c,b),Ln.debug(`Calling attemptFetch again in ${v} millis`),ON(n,b,r,a)}}function vL(n,e){return new Promise((t,r)=>{const a=Math.max(e-Date.now(),0),o=setTimeout(t,a);n.addEventListener(()=>{clearTimeout(o),r(ir.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function _L(n){if(!(n instanceof Ur)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class bL{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function xL(n,e,t,r,a){if(a&&a.global){n("event",t,r);return}else{const o=await e,c=Object.assign(Object.assign({},r),{send_to:o});n("event",t,c)}}async function wL(n,e,t,r){{const a=await e;n("config",a,{update:!0,user_properties:t})}}async function EL(){if(Xy())try{await VT()}catch(n){return Ln.warn(ir.create("indexeddb-unavailable",{errorInfo:n?.toString()}).message),!1}else return Ln.warn(ir.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function TL(n,e,t,r,a,o,c){var d;const f=yL(n);f.then(S=>{t[S.measurementId]=S.appId,n.options.measurementId&&S.measurementId!==n.options.measurementId&&Ln.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${S.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(S=>Ln.error(S)),e.push(f);const p=EL().then(S=>{if(S)return r.getId()}),[v,b]=await Promise.all([f,p]);dL(o)||sL(o,v.measurementId),a("js",new Date);const E=(d=c?.config)!==null&&d!==void 0?d:{};return E[Z5]="firebase",E.update=!0,b!=null&&(E[J5]=b),a("config",v.measurementId,E),v.measurementId}class SL{constructor(e){this.app=e}_delete(){return delete Nl[this.app.options.appId],Promise.resolve()}}let Nl={},ZE=[];const eT={};let sy="dataLayer",IL="gtag",tT,vv,nT=!1;function AL(){const n=[];if(OT()&&n.push("This is a browser extension environment."),Ak()||n.push("Cookies are not available."),n.length>0){const e=n.map((r,a)=>`(${a+1}) ${r}`).join(" "),t=ir.create("invalid-analytics-context",{errorInfo:e});Ln.warn(t.message)}}function NL(n,e,t){AL();const r=n.options.appId;if(!r)throw ir.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)Ln.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ir.create("no-api-key");if(Nl[r]!=null)throw ir.create("already-exists",{id:r});if(!nT){aL(sy);const{wrappedGtag:o,gtagCore:c}=uL(Nl,ZE,eT,sy,IL);vv=o,tT=c,nT=!0}return Nl[r]=TL(n,ZE,eT,e,tT,sy,t),new SL(n)}function CL(n=Zy()){n=it(n);const e=Wi(n,Qf);return e.isInitialized()?e.getImmediate():RL(n)}function RL(n,e={}){const t=Wi(n,Qf);if(t.isInitialized()){const a=t.getImmediate();if(Gi(e,t.getOptions()))return a;throw ir.create("already-initialized")}return t.initialize({options:e})}function kL(n,e,t){n=it(n),wL(vv,Nl[n.app.options.appId],e).catch(r=>Ln.error(r))}function PN(n,e,t,r){n=it(n),xL(vv,Nl[n.app.options.appId],e,t,r).catch(a=>Ln.error(a))}const rT="@firebase/analytics",iT="0.10.8";function DL(){ii(new Vr(Qf,(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("installations-internal").getImmediate();return NL(r,a,t)},"PUBLIC")),ii(new Vr("analytics-internal",n,"PRIVATE")),Er(rT,iT),Er(rT,iT,"esm2017");function n(e){try{const t=e.getProvider(Qf).getImmediate();return{logEvent:(r,a,o)=>PN(t,r,a,o)}}catch(t){throw ir.create("interop-component-reg-failed",{reason:t})}}}DL();const jL={BASE_URL:"/",DEV:!1,MODE:"web",PROD:!0,SSR:!1,VITE_EXTENSION_KEY:"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2P3QDxUdksASJSgFQDK4JUlgPaS5fkRAOdrtpHYUGu75/v0JeKj9YTFGl9ipKOjvmwIDAQAB",VITE_FIREBASE_API_KEY:"AIzaSyAn2WmzmM49urbEsDL-CMtfM6REgPHId6k",VITE_FIREBASE_APP_ID:"1:762786438321:web:42ff64441bc56494cf9690",VITE_FIREBASE_AUTH_DOMAIN:"mobile-quicknote.firebaseapp.com",VITE_FIREBASE_MEASUREMENT_ID:"G-FHTHKF1QVZ",VITE_FIREBASE_MESSAGING_SENDER_ID:"762786438321",VITE_FIREBASE_PROJECT_ID:"mobile-quicknote",VITE_FIREBASE_STORAGE_BUCKET:"mobile-quicknote.firebasestorage.app",VITE_GOOGLE_CLIENT_ID:"762786438321-ultoc1c90q6qojshdf4201manseir4m2.apps.googleusercontent.com",VITE_WEB_APP_URL:"https://livenote-ruddy.vercel.app"},OL={firebase:{apiKey:"AIzaSyAn2WmzmM49urbEsDL-CMtfM6REgPHId6k",authDomain:"mobile-quicknote.firebaseapp.com",projectId:"mobile-quicknote",storageBucket:"mobile-quicknote.firebasestorage.app",messagingSenderId:"762786438321",appId:"1:762786438321:web:42ff64441bc56494cf9690",measurementId:"G-FHTHKF1QVZ"}},PL=["VITE_FIREBASE_API_KEY","VITE_FIREBASE_AUTH_DOMAIN","VITE_FIREBASE_PROJECT_ID","VITE_FIREBASE_STORAGE_BUCKET","VITE_FIREBASE_MESSAGING_SENDER_ID","VITE_FIREBASE_APP_ID","VITE_FIREBASE_MEASUREMENT_ID","VITE_GOOGLE_CLIENT_ID","VITE_EXTENSION_KEY"],sT=PL.filter(n=>!jL[n]);sT.length>0&&(console.error("Missing required environment variables:",sT),console.error("Please check your .env file and ensure all variables are set."));const By=OL.firebase,_v=zT(By),Ks=MS(_v);if(typeof chrome<"u"&&chrome.runtime){console.log(" Configuring Firebase Auth for Chrome Extension environment"),console.log(" Auth Domain:",By.authDomain),console.log(" Project ID:",By.projectId);try{console.log(" Firebase Auth configured for Chrome Extension")}catch(n){console.error(" Error configuring Firebase Auth for extension:",n)}}const Rm=new Jr;Rm.addScope("email");Rm.addScope("profile");Rm.setCustomParameters({hd:"*"});const xe=$A(_v);let Ju=null;if(typeof window<"u"&&typeof chrome>"u")try{Ju=CL(_v),console.log("Firebase Analytics initialized")}catch(n){console.warn("Analytics not available in this environment:",n)}else console.log("Analytics disabled in Chrome extension environment");const Yf=typeof chrome<"u"&&chrome.runtime,ji=(n,e)=>{if(!Ju){Yf&&console.log(`[Analytics] ${n}${e?` - ${JSON.stringify(e)}`:""}`);return}try{PN(Ju,n,e)}catch(t){console.warn(`Analytics ${n} tracking failed:`,t),Yf&&console.log(`[Analytics Fallback] ${n}${e?` - ${JSON.stringify(e)}`:""}`)}},_u={trackLogin:(n="google")=>{ji("login",{method:n})},trackSignUp:(n="email")=>{ji("sign_up",{method:n})},trackNoteCreated:()=>{ji("note_created")},trackNoteUpdated:()=>{ji("note_updated")},trackNoteDeleted:()=>{ji("note_deleted")},trackSearch:n=>{ji("search",{search_term:n.length>0?"has_query":"empty_query"})},trackColorChange:n=>{ji("note_color_changed",{color:n})},trackNotePinned:n=>{ji("note_pinned",{action:n?"pinned":"unpinned"})},setUserProperties:n=>{if(!Ju){Yf&&console.log(`[Analytics] User properties set: ${JSON.stringify(n)}`);return}try{kL(Ju,n)}catch(e){console.warn("Analytics user properties failed:",e),Yf&&console.log(`[Analytics Fallback] User properties set: ${JSON.stringify(n)}`)}},trackCustomEvent:(n,e)=>{ji(n,e)}},VN=V.createContext(void 0),lr=()=>{const n=V.useContext(VN);if(n===void 0)throw new Error("useAuth must be used within an AuthProvider");return n},VL=({children:n})=>{const[e,t]=V.useState(null),[r,a]=V.useState(!0);V.useEffect(()=>{console.log(" Setting up Firebase auth listener");const S=wS(Ks,R=>{if(R){console.log(" Firebase user authenticated:",R.email);const j={id:R.uid,email:R.email||"",displayName:R.displayName||"Anonymous User",photoURL:R.photoURL||void 0,isGuest:!1};t(j)}else{console.log(" No Firebase user found, checking for guest user");const j=o();t(j||null)}a(!1)});return()=>S()},[]);const o=()=>{try{const S=localStorage.getItem("guestUser");if(S)return JSON.parse(S)}catch(S){console.error("Error getting guest user:",S)}return null},c=()=>{const R={id:`guest_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,email:"guest@local.com",displayName:"Guest User",isGuest:!0};return localStorage.setItem("guestUser",JSON.stringify(R)),R},E={user:e,signInWithGoogle:async()=>{try{a(!0),typeof chrome<"u"&&chrome.identity&&!window.location.protocol.startsWith("http")?(console.log("Using Chrome Identity API for authentication"),await new Promise((S,R)=>{chrome.identity.getAuthToken({interactive:!0},async j=>{if(chrome.runtime.lastError||!j){console.error("Chrome Identity API error:",chrome.runtime.lastError),R(new Error(chrome.runtime.lastError?.message||"Authentication failed"));return}try{console.log("Got auth token, signing in with Firebase...");const{GoogleAuthProvider:N,signInWithCredential:I}=await kt(async()=>{const{GoogleAuthProvider:X,signInWithCredential:de}=await Promise.resolve().then(()=>G4);return{GoogleAuthProvider:X,signInWithCredential:de}},[]),te=N.credential(null,j);await I(Ks,te),console.log("Firebase authentication successful"),_u.trackLogin("google_chrome_identity"),S()}catch(N){console.error("Firebase authentication error:",N),R(N)}})})):(console.log("Falling back to Firebase popup authentication"),await OS(Ks,Rm),_u.trackLogin("google_popup"))}catch(S){throw console.error("Error signing in with Google:",S),S}finally{a(!1)}},signInWithEmail:async(S,R)=>{try{a(!0),console.log(" Signing in with email in Chrome Extension:",S),typeof chrome<"u"&&chrome.runtime&&(console.log(" Chrome Extension environment detected"),await vy(Ks,Df),console.log(" Auth persistence set to LOCAL"));const j=await vS(Ks,S,R);console.log(" Email authentication successful:",j.user.email),_u.trackLogin("email")}catch(j){throw console.error(" Error signing in with email:",j),j}finally{a(!1)}},signUpWithEmail:async(S,R,j)=>{try{a(!0),console.log(" Creating account with email in Chrome Extension:",S),typeof chrome<"u"&&chrome.runtime&&(console.log(" Chrome Extension environment detected for signup"),await vy(Ks,Df),console.log(" Auth persistence set to LOCAL for signup"));const N=await yS(Ks,S,R);console.log(" User account created successfully:",N.user.email),await _S(N.user,{displayName:j}),console.log(" Profile updated with display name:",j),_u.trackSignUp("email")}catch(N){throw console.error(" Error creating account:",N),N}finally{a(!1)}},signInAsGuest:async()=>{try{a(!0),console.log(" Creating guest user session");const S=c();t(S),console.log(" Guest user created:",S.displayName),_u.trackSignUp("guest")}catch(S){throw console.error(" Error creating guest session:",S),S}finally{a(!1)}},signOut:async()=>{try{a(!0),localStorage.removeItem("guestUser"),await ES(Ks),t(null),console.log(" Successfully signed out")}catch(S){console.warn("Sign out cleanup error:",S),t(null)}finally{a(!1)}},isLoading:r};return m.jsx(VN.Provider,{value:E,children:n})},MN=V.createContext(void 0),bv=()=>{const n=V.useContext(MN);if(n===void 0)throw new Error("useTheme must be used within a ThemeProvider");return n},ML=({children:n})=>{const[e,t]=V.useState(!1);V.useEffect(()=>{typeof chrome<"u"&&chrome.storage&&chrome.storage.local.get(["isDarkMode"],c=>{if(c.isDarkMode!==void 0)t(c.isDarkMode),r(c.isDarkMode);else{const d=window.matchMedia("(prefers-color-scheme: dark)").matches;t(d),r(d)}})},[]);const r=c=>{c?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},o={isDarkMode:e,toggleTheme:()=>{const c=!e;t(c),r(c),typeof chrome<"u"&&chrome.storage&&chrome.storage.local.set({isDarkMode:c}),typeof chrome<"u"&&chrome.runtime&&chrome.runtime.sendMessage({type:"THEME_CHANGE",payload:{isDarkMode:c}})}};return m.jsx(MN.Provider,{value:o,children:n})},bu="notes",LL=()=>Date.now().toString(36)+Math.random().toString(36).substr(2),xr={async migrateGuestNotes(n,e){console.log(" Starting guest notes migration:",{fromGuestId:n,toUserId:e});try{const t=this.getLocalNotes(n);if(console.log(` Found ${t.length} guest notes to migrate`),t.length===0){console.log(" No guest notes to migrate");return}for(const r of t)try{const a={title:r.title,description:r.description,color:r.color,isPinned:r.isPinned,userId:e};console.log(" Migrating note:",r.title),await this.createNote(a)}catch(a){console.error(" Failed to migrate note:",r.title,a)}localStorage.removeItem(`notes_${n}`),console.log(" Guest notes migration completed and cleared")}catch(t){throw console.error(" Error during guest notes migration:",t),t}},async getAllNotes(n){try{if(xe){const e=Gt(yt(xe,bu),nn("userId","==",n)),t=await Zt(e);return(await Promise.all(t.docs.map(async a=>{const o=a.data(),c={id:a.id,...o,createdAt:o.createdAt?.toDate()||new Date,updatedAt:o.updatedAt?.toDate()||new Date,groupId:o.groupId||void 0};if(c.isCommunity&&c.shareId)try{const f=await(await kt(async()=>{const{default:p}=await Promise.resolve().then(()=>Dr);return{default:p}},void 0)).default.getCommunityNote(c.shareId);f&&(c.communityMembers=f.members,c.memberCount=f.memberCount)}catch(d){console.error("Error loading community data for note:",c.id,d)}return c}))).sort((a,o)=>{const c=a.updatedAt.getTime();return o.updatedAt.getTime()-c})}return this.getLocalNotes(n)}catch(e){return console.error("Error getting notes from Firebase, falling back to local storage:",e),this.getLocalNotes(n)}},async createNote(n){const e=new Date,t={...n,isPinned:n.isPinned||!1,createdAt:e,updatedAt:e,groupId:n.groupId};try{if(xe){const r={...t,createdAt:Be.fromDate(e),updatedAt:Be.fromDate(e)};return n.groupId&&(r.groupId=n.groupId),{id:(await Vu(yt(xe,bu),r)).id,...t}}return this.createLocalNote(t)}catch(r){return console.error("Error creating note in Firebase, falling back to local storage:",r),this.createLocalNote(t)}},async updateNote(n,e){try{if(xe){const t=rt(xe,bu,n);await wt(t,{...e,updatedAt:Be.fromDate(new Date)});let r=this.getLocalNote(n);if(!r)try{const a=await kt(()=>Promise.resolve().then(()=>h5),void 0).then(o=>o.getDoc(t));if(a.exists()){const o=a.data();r={id:a.id,...o,createdAt:o.createdAt?.toDate()||new Date,updatedAt:o.updatedAt?.toDate()||new Date}}}catch(a){console.warn("Could not fetch updated note from Firebase:",a)}if(r){const a={...r,...e,updatedAt:new Date};try{this.updateLocalNote(n,e)}catch(o){console.warn("Could not update local storage:",o)}return a}else throw new Error("Could not retrieve updated note data")}return this.updateLocalNote(n,e)}catch(t){return console.error("Error updating note in Firebase, falling back to local storage:",t),this.updateLocalNote(n,e)}},async getNoteById(n){try{if(xe){const e=rt(xe,bu,n),t=await wr(e);if(!t.exists())return null;const r=t.data();return{id:t.id,...r,createdAt:r.createdAt?.toDate()||new Date,updatedAt:r.updatedAt?.toDate()||new Date,groupId:r.groupId||void 0}}return this.getLocalNote(n)}catch(e){return console.error("Error getting note by ID:",e),null}},async deleteNote(n){try{xe&&await Xu(rt(xe,bu,n)),this.deleteLocalNote(n)}catch(e){console.error("Error deleting note from Firebase, falling back to local storage:",e),this.deleteLocalNote(n)}},getLocalNotes(n){try{const e=localStorage.getItem(`notes_${n}`);return e?JSON.parse(e).map(t=>({...t,createdAt:new Date(t.createdAt),updatedAt:new Date(t.updatedAt)})):[]}catch{return[]}},createLocalNote(n){const t={id:LL(),...n},r=this.getLocalNotes(n.userId),a=[t,...r];return localStorage.setItem(`notes_${n.userId}`,JSON.stringify(a)),t},updateLocalNote(n,e){console.log(" Updating local note:",{id:n,updates:e});const t=this.getLocalNote(n);if(!t)throw console.error(" Note not found in local storage:",n),new Error(`Note with id ${n} not found in local storage`);const r={...t,...e,updatedAt:new Date};console.log(" Updated note data:",r);const o=this.getLocalNotes(t.userId).map(c=>c.id===n?r:c);return localStorage.setItem(`notes_${t.userId}`,JSON.stringify(o)),r},deleteLocalNote(n){const e=this.getLocalNote(n);if(!e)return;const r=this.getLocalNotes(e.userId).filter(a=>a.id!==n);localStorage.setItem(`notes_${e.userId}`,JSON.stringify(r))},getLocalNote(n){try{const e=Object.keys(localStorage).filter(t=>t.startsWith("notes_"));for(const t of e){const a=JSON.parse(localStorage.getItem(t)||"[]").find(o=>o.id===n);if(a)return{...a,createdAt:new Date(a.createdAt),updatedAt:new Date(a.updatedAt)}}return null}catch{return null}}},aT=Object.freeze(Object.defineProperty({__proto__:null,notesService:xr},Symbol.toStringTag,{value:"Module"})),UL="groups",zL="sharedGroups";class ct{static COLLECTION=UL;static SHARED_COLLECTION=zL;static async createGroup(e,t,r,a){if(!xe)throw new Error("Firebase not initialized");const o=new Date,c={name:e.name,description:e.description||"",ownerId:t,ownerEmail:r,ownerName:a,createdAt:Be.fromDate(o),updatedAt:Be.fromDate(o),noteIds:[],noteCount:0,isPinned:!1,isShared:!1,allowEditing:!1};return{id:(await Vu(yt(xe,this.COLLECTION),c)).id,...c,createdAt:o,updatedAt:o}}static async getUserGroups(e){if(!xe)return[];try{const t=Gt(yt(xe,this.COLLECTION),nn("ownerId","==",e)),r=await Zt(t),a=[];for(const o of r.docs){const c=o.data(),d=c.noteIds||[],f=d.length;if(c.noteCount!==f)try{await wt(o.ref,{noteCount:f}),console.log(` Fixed noteCount for group "${c.name||o.id}": ${c.noteCount} -> ${f} (noteIds: ${d.length})`)}catch(v){console.error("Error updating noteCount:",v)}const p={id:o.id,...c,noteIds:d,noteCount:f,createdAt:c.createdAt?.toDate()||new Date,updatedAt:c.updatedAt?.toDate()||new Date};if(p.isShared&&p.shareId)try{const v=Gt(yt(xe,this.SHARED_COLLECTION),nn("shareId","==",p.shareId)),b=await Zt(v);if(!b.empty){const E=b.docs[0].data();p.collaborators=E.collaborators||[],p.allowEditing=E.allowEditing}}catch(v){console.warn(" Failed to load group collaborators:",v)}a.push(p)}return a}catch(t){return console.error("Error fetching groups:",t),[]}}static async getGroupById(e){if(!xe)return null;try{const t=rt(xe,this.COLLECTION,e),r=await wr(t);if(!r.exists())return null;const a=r.data(),o=a.noteIds||[],c=o.length;if(a.noteCount!==c)try{await wt(t,{noteCount:c}),console.log(` Fixed noteCount for group ${e}: ${a.noteCount} -> ${c}`)}catch(f){console.error("Error updating noteCount:",f)}const d={id:r.id,...a,noteIds:o,noteCount:c,createdAt:a.createdAt?.toDate()||new Date,updatedAt:a.updatedAt?.toDate()||new Date};if(d.isShared&&d.shareId)try{const f=Gt(yt(xe,this.SHARED_COLLECTION),nn("shareId","==",d.shareId)),p=await Zt(f);if(!p.empty){const v=p.docs[0].data();d.collaborators=v.collaborators||[],d.allowEditing=v.allowEditing}}catch(f){console.warn(" Failed to load group collaborators:",f)}return d}catch(t){return console.error("Error fetching group:",t),null}}static async updateGroup(e,t){if(!xe)throw new Error("Firebase not initialized");const r=rt(xe,this.COLLECTION,e);await wt(r,{...t,updatedAt:Be.fromDate(new Date)})}static async deleteGroup(e){if(!xe)throw new Error("Firebase not initialized");const t=await this.getGroupById(e);if(!t)throw new Error("Group not found");if(t.noteIds&&t.noteIds.length>0){const a=Nu(xe),o=yt(xe,"notes");for(const c of t.noteIds){const d=rt(o,c);a.update(d,{groupId:null})}await a.commit()}const r=rt(xe,this.COLLECTION,e);if(await Xu(r),t.shareId)try{const a=Gt(yt(xe,this.SHARED_COLLECTION),nn("shareId","==",t.shareId));(await Zt(a)).docs.forEach(async c=>{await Xu(c.ref)})}catch(a){console.error("Error deleting shared group:",a)}}static async addNoteToGroup(e,t){if(!xe)throw new Error("Firebase not initialized");const r=Nu(xe),a=rt(xe,this.COLLECTION,e),o=await this.getGroupById(e);if(!o)throw new Error("Group not found");if(o.noteIds.includes(t))console.log(` Note ${t} already in group ${e}`);else{const f=[...o.noteIds,t].length;r.update(a,{noteIds:uv(t),noteCount:f,updatedAt:Be.fromDate(new Date)}),console.log(` Adding note ${t} to group ${e}. New count: ${f}`)}const c=rt(xe,"notes",t);r.update(c,{groupId:e}),await r.commit()}static async removeNoteFromGroup(e,t){if(!xe)throw new Error("Firebase not initialized");const r=Nu(xe),a=rt(xe,this.COLLECTION,e),o=await this.getGroupById(e);if(!o)throw new Error("Group not found");if(o.noteIds.includes(t)){const f=o.noteIds.filter(p=>p!==t).length;r.update(a,{noteIds:dv(t),noteCount:f,updatedAt:Be.fromDate(new Date)}),console.log(` Removing note ${t} from group ${e}. New count: ${f}`)}else console.log(` Note ${t} not in group ${e}`);const c=rt(xe,"notes",t);r.update(c,{groupId:null}),await r.commit()}static async getGroupNotes(e){return(await this.getGroupById(e))?.noteIds||[]}static async shareGroup(e,t,r){if(!xe)throw new Error("Firebase not initialized");const a=await this.getGroupById(e);if(!a)throw new Error("Group not found");let o=a.shareId||this.generateShareId();if(a.shareId){const d=Gt(yt(xe,this.SHARED_COLLECTION),nn("shareId","==",a.shareId)),f=await Zt(d);if(f.empty){o=this.generateShareId();const p={groupId:e,shareId:o,shareType:t,ownerId:a.ownerId,ownerEmail:a.ownerEmail,ownerName:a.ownerName,name:a.name,description:a.description||"",createdAt:Be.fromDate(new Date),collaborators:t==="private"?[]:void 0,allowEditing:t==="private"};await Vu(yt(xe,this.SHARED_COLLECTION),p)}else{const p=f.docs[0].ref,v=f.docs[0].data();await wt(p,{shareType:t,allowEditing:t==="private",collaborators:t==="private"&&v.collaborators?v.collaborators:t==="private"?[]:void 0})}}else{o=this.generateShareId();const d={groupId:e,shareId:o,shareType:t,ownerId:a.ownerId,ownerEmail:a.ownerEmail,ownerName:a.ownerName,name:a.name,description:a.description||"",createdAt:Be.fromDate(new Date),collaborators:t==="private"?[]:void 0,allowEditing:t==="private"};await Vu(yt(xe,this.SHARED_COLLECTION),d)}const c=rt(xe,this.COLLECTION,e);return await wt(c,{isShared:!0,shareId:o,shareType:t,updatedAt:Be.fromDate(new Date)}),{shareId:o,shareType:t}}static async getSharedGroup(e){if(!xe)return null;try{const t=Gt(yt(xe,this.SHARED_COLLECTION),nn("shareId","==",e)),r=await Zt(t);if(r.empty)return null;const a=r.docs[0],o=a.data();return{id:a.id,...o,createdAt:o.createdAt?.toDate()||new Date}}catch(t){return console.error("Error fetching shared group:",t),null}}static async getGroupsSharedWithUser(e){if(!xe)return[];try{const t=e.trim().toLowerCase();console.log(" Searching for groups shared with:",t);const r=Gt(yt(xe,this.SHARED_COLLECTION),nn("shareType","==","private")),a=await Zt(r);console.log(" Found",a.docs.length,"private shared groups to check");const o=[];return a.docs.forEach(c=>{const d=c.data(),f=d.collaborators||[];console.log(" Checking group:",d.name,"collaborators:",f.map(v=>v.email)),f.some(v=>{const b=(v.email||"").trim().toLowerCase(),E=b===t;return console.log("  Comparing:",b,"===",t,"?",E),E})&&(console.log(" User is a collaborator of group:",d.name),o.push({id:c.id,...d,createdAt:d.createdAt?.toDate()||new Date}))}),console.log(" Returning",o.length,"shared groups"),o}catch(t){return console.error("Error fetching shared groups:",t),[]}}static async addGroupCollaborator(e,t,r="edit"){if(!xe)throw new Error("Firebase not initialized");const a=Gt(yt(xe,this.SHARED_COLLECTION),nn("shareId","==",e)),o=await Zt(a);if(o.empty)throw new Error("Shared group not found");const c=o.docs[0].ref,f=o.docs[0].data().collaborators||[],p=t.trim().toLowerCase(),v=f.findIndex(b=>(b.email||"").trim().toLowerCase()===p);if(v>=0)f[v].permission=r,console.log(" Updated existing collaborator:",t);else{const b=t.trim();f.push({id:p,email:b,displayName:b.split("@")[0],permission:r,joinedAt:Be.fromDate(new Date),allowEditing:!0}),console.log(" Added new collaborator:",b)}await wt(c,{collaborators:f,allowEditing:!0})}static async removeGroupCollaborator(e,t){if(!xe)throw new Error("Firebase not initialized");const r=Gt(yt(xe,this.SHARED_COLLECTION),nn("shareId","==",e)),a=await Zt(r);if(a.empty)throw new Error("Shared group not found");const o=a.docs[0].ref,d=(a.docs[0].data().collaborators||[]).filter(f=>f.email?.toLowerCase()!==t.toLowerCase());await wt(o,{collaborators:d})}static async updateGroupCollaboratorPermission(e,t,r){if(!xe)throw new Error("Firebase not initialized");const a=Gt(yt(xe,this.SHARED_COLLECTION),nn("shareId","==",e)),o=await Zt(a);if(o.empty)throw new Error("Shared group not found");const c=o.docs[0].ref,f=o.docs[0].data().collaborators||[],p=t.toLowerCase(),v=f.findIndex(b=>b.email?.toLowerCase()===p);if(v>=0)f[v].permission=r,await wt(c,{collaborators:f});else throw new Error("Collaborator not found")}static async canEditGroupNotes(e,t,r){if(!xe)throw new Error("Firebase not initialized");if(!t&&!r)return!1;try{const a=await this.getGroupById(e);if(!a)return!1;if(a.ownerId===t)return!0;if(!a.isShared||!a.shareId)return!1;const o=Gt(yt(xe,this.SHARED_COLLECTION),nn("shareId","==",a.shareId)),c=await Zt(o);if(c.empty)return!1;const f=c.docs[0].data().collaborators||[];if(r){const p=r.toLowerCase().trim(),v=f.find(b=>b.email?.toLowerCase().trim()===p);if(v)return v.permission==="edit"||v.permission==="admin"}return!1}catch(a){return console.error("Error checking group edit permission:",a),!1}}static async unshareGroup(e){if(!xe)throw new Error("Firebase not initialized");const t=await this.getGroupById(e);if(!t||!t.shareId)return;const r=Gt(yt(xe,this.SHARED_COLLECTION),nn("shareId","==",t.shareId)),a=await Zt(r),o=Nu(xe);a.docs.forEach(d=>{o.delete(d.ref)}),await o.commit();const c=rt(xe,this.COLLECTION,e);await wt(c,{isShared:!1,shareId:null,shareType:null,updatedAt:Be.fromDate(new Date)})}static generateShareId(){const e="abcdefghijklmnopqrstuvwxyz0123456789";return Array.from({length:20},()=>e[Math.floor(Math.random()*e.length)]).join("")}static generateShareUrl(e){return`${window.location.origin}/share-group/${e}`}}const xv=Object.freeze(Object.defineProperty({__proto__:null,GroupsService:ct,default:ct},Symbol.toStringTag,{value:"Module"})),LN=V.createContext(void 0),cc=()=>{const n=V.useContext(LN);if(n===void 0)throw new Error("useNotes must be used within a NotesProvider");return n},FL=({children:n})=>{const[e,t]=V.useState([]),[r,a]=V.useState([]),[o,c]=V.useState(""),[d,f]=V.useState("all"),[p,v]=V.useState(!1),[b,E]=V.useState(null),[S,R]=V.useState([]),[j,N]=V.useState(null),{user:I}=lr();V.useEffect(()=>{I?(te(I),X()):(t([]),R([]))},[I]);const te=async F=>{if(F){if(!F.isGuest&&F.id!==I?.id){const L=localStorage.getItem("guestUser");if(L)try{const Q=JSON.parse(L);console.log(" Detected user login, checking for guest notes to migrate"),await xr.migrateGuestNotes(Q.id,F.id),localStorage.removeItem("guestUser"),console.log(" Guest notes migrated and guest session cleared")}catch(Q){console.error(" Failed to migrate guest notes:",Q)}}await de()}},X=async()=>{if(!(!I||I.isGuest))try{const F=await ct.getUserGroups(I.id);let L=[];if(I.email)try{L=await ct.getGroupsSharedWithUser(I.email),console.log(" Found shared groups:",L.length)}catch($){console.error("Error loading shared groups:",$)}const Q=[];for(const $ of L)try{const W=await ct.getGroupById($.groupId||$.id);if(W){const me=(W.noteIds||[]).length;Q.push({...W,noteCount:me,isShared:!0,shareId:$.shareId,shareType:$.shareType,collaborators:$.collaborators,allowEditing:$.allowEditing}),console.log(` Loaded shared group "${W.name}": ${me} notes`)}else Q.push({id:$.groupId||$.id,name:$.name,description:$.description,ownerId:$.ownerId,ownerEmail:$.ownerEmail,ownerName:$.ownerName,createdAt:$.createdAt,updatedAt:$.createdAt,noteIds:[],noteCount:0,isShared:!0,shareId:$.shareId,shareType:$.shareType,collaborators:$.collaborators,allowEditing:$.allowEditing})}catch(W){console.error("Error loading shared group details:",W)}const oe=[...F];Q.forEach($=>{const W=oe.findIndex(me=>me.id===$.id);if(W>=0){const me=oe[W],Se=(me.noteIds||[]).length;oe[W]={...me,noteCount:Se,isShared:!0,shareId:$.shareId,shareType:$.shareType,collaborators:$.collaborators||me.collaborators||[],allowEditing:$.allowEditing}}else oe.push($)});const se=oe.map($=>{const W=($.noteIds||[]).length;return $.noteCount!==W?(console.log(` Correcting count for "${$.name}": ${$.noteCount} -> ${W}`),{...$,noteCount:W}):$});console.log(" Groups loaded:",se.map($=>({name:$.name,count:$.noteCount,noteIdsLength:$.noteIds?.length||0,noteIds:$.noteIds}))),R(se)}catch(F){console.error("Error loading groups:",F)}},de=async()=>{if(I)try{v(!0),E(null);const F=await xr.getAllNotes(I.id);let L=[];try{const se=await ct.getUserGroups(I.id);console.log(" Found owned groups:",se.length);for(const $ of se)if($.noteIds&&$.noteIds.length>0){const{notesService:W}=await kt(async()=>{const{notesService:Fe}=await Promise.resolve().then(()=>aT);return{notesService:Fe}},void 0),Se=(await Promise.all($.noteIds.map(async Fe=>{try{const jt=await W.getNoteById(Fe);return jt&&jt.groupId===$.id?jt:null}catch(jt){return console.error("Error loading note from owned group:",Fe,jt),null}}))).filter(Fe=>Fe!==null);L=[...L,...Se],console.log(` Loaded ${Se.length} notes from owned group: ${$.name}`)}}catch(se){console.error("Error loading notes from owned groups:",se)}let Q=[];if(!I.isGuest&&I.email)try{const se=await ct.getGroupsSharedWithUser(I.email);console.log(" Found shared groups:",se.length);for(const $ of se)try{const W=$.groupId||$.id,me=await ct.getGroupById(W);if(me&&me.noteIds&&me.noteIds.length>0){const{notesService:Se}=await kt(async()=>{const{notesService:zt}=await Promise.resolve().then(()=>aT);return{notesService:zt}},void 0),jt=(await Promise.all(me.noteIds.map(async zt=>{try{const Rt=await Se.getNoteById(zt);return Rt&&Rt.groupId===W?Rt:null}catch(Rt){return console.error("Error loading note from group:",zt,Rt),null}}))).filter(zt=>zt!==null);Q=[...Q,...jt],console.log(` Loaded ${jt.length} notes from shared group: ${me.name}`)}else console.log(` Shared group ${me?.name||W} has no notes yet`)}catch(W){console.error("Error loading notes from shared group:",W)}}catch(se){console.error("Error loading shared group notes:",se)}const oe=[...F];if(L.forEach(se=>{oe.find($=>$.id===se.id)||oe.push(se)}),Q.forEach(se=>{oe.find($=>$.id===se.id)||oe.push(se)}),t(oe),!I.isGuest&&I.email)try{console.log(" Loading shared notes for user:",I.email);const{default:se}=await kt(async()=>{const{default:W}=await Promise.resolve().then(()=>Dr);return{default:W}},void 0),$=await se.getNotesSharedWithUser(I.email);console.log(" Found shared notes:",$.length,$),a($)}catch(se){console.error(" Error loading shared notes:",se),a([])}else a([])}catch(F){E("Failed to load notes"),console.error("Error loading notes:",F)}finally{v(!1)}},ve=async()=>{if(!(!I||I.isGuest||!I.email))try{const{default:F}=await kt(async()=>{const{default:Q}=await Promise.resolve().then(()=>Dr);return{default:Q}},void 0),L=await F.getNotesSharedWithUser(I.email);console.log(" Refreshed shared notes:",L.length),a(L)}catch(F){console.error("Error refreshing shared notes:",F)}},ge=async()=>{if(I)try{const F=[];await Promise.all(e.map(async L=>{if(L.isCommunity&&L.shareId)try{const{default:Q}=await kt(async()=>{const{default:se}=await Promise.resolve().then(()=>Dr);return{default:se}},void 0),oe=await Q.getCommunityNote(L.shareId);if(oe)if(oe.members.some($=>$.email===I.email))F.push({...L,communityMembers:oe.members,memberCount:oe.memberCount});else{console.log(" User no longer a member of community, removing note:",L.title);try{await xr.deleteNote(L.id)}catch($){console.warn(" Failed to delete note after leaving community:",$)}}else{console.log(" Community note no longer exists, removing:",L.title);try{await xr.deleteNote(L.id)}catch(se){console.warn(" Failed to delete note after community deletion:",se)}}}catch(Q){console.error("Error refreshing community data for note:",L.id,Q),F.push(L)}else F.push(L)})),t(L=>L.filter(Q=>!Q.isCommunity||F.some(oe=>oe.id===Q.id))),console.log(" Community member data refreshed and cleaned up")}catch(F){console.error("Error refreshing community data:",F)}},D=async F=>{if(!I)throw new Error("User not authenticated");try{E(null);const L=await xr.createNote({...F,userId:I.id});let Q={...L};if(F.groupId&&(Q.groupId=F.groupId),F.groupId)try{await ct.addNoteToGroup(F.groupId,L.id),console.log(" Added note to group:",F.groupId);try{const oe=await ct.getGroupById(F.groupId);if(oe&&oe.isShared&&oe.shareId){const se=I.email||"",$=oe.ownerEmail||"",W=I.displayName||I.email||"Someone";if(se&&$&&se.toLowerCase()!==$.toLowerCase()){const{default:me}=await kt(async()=>{const{default:Se}=await Promise.resolve().then(()=>Lu);return{default:Se}},void 0);await me.createNotification({type:"note_added",communityId:oe.shareId,communityTitle:oe.name||"Group",message:`${W} created a new note in "${oe.name||"the group"}"`,actionBy:{name:W,email:se}}),console.log(" Created notification for group note creation")}}}catch(oe){console.warn(" Failed to create group note creation notification:",oe)}R(oe=>oe.map(se=>{if(se.id===F.groupId){const $=[...se.noteIds||[],L.id],W=$.length;return console.log(` Optimistically updating group "${se.name}" count: ${se.noteCount} -> ${W}`),{...se,noteIds:$,noteCount:W}}return se})),await X(),console.log(" Groups refreshed after adding note")}catch(oe){console.error(" Failed to add note to group:",oe);try{await X()}catch(se){console.error(" Failed to refresh groups:",se)}}if(F.visibility==="public"||F.visibility==="community")try{const{default:oe}=await kt(async()=>{const{default:W}=await Promise.resolve().then(()=>Dr);return{default:W}},void 0),se=F.visibility==="public"?"public":"private",$=await oe.shareNote(Q,{type:se},I.displayName||I.email||"Anonymous",I.email||"");Q={...Q,isShared:!0,shareId:$,shareType:se,sharedAt:new Date,isCommunity:F.visibility==="community"},await xr.updateNote(L.id,{isShared:!0,shareId:$,shareType:se,sharedAt:new Date,isCommunity:F.visibility==="community"}),t(W=>[Q,...W]),console.log(` Note created and shared as ${F.visibility}:`,$)}catch(oe){console.warn(" Failed to automatically share note:",oe),t(se=>[Q,...se])}else t(oe=>[Q,...oe])}catch(L){throw E("Failed to create note"),console.error("Error creating note:",L),L}},C=async(F,L)=>{if(!I)throw new Error("User not authenticated");try{E(null);const Q=e.find(me=>me.id===F);if(!Q)throw new Error("Note not found in current notes list");if(Q.groupId&&!await ct.canEditGroupNotes(Q.groupId,I.id,I.email||void 0)){const Se='You do not have permission to edit notes in this group. Your permission is set to "view only".';throw E(Se),new Error(Se)}let oe={};if(L.visibility&&L.visibility!==Q.visibility){if(L.visibility==="public"||L.visibility==="community")try{const{default:me}=await kt(async()=>{const{default:Se}=await Promise.resolve().then(()=>Dr);return{default:Se}},void 0);if(Q.isShared){if(Q.shareId){const Se=L.visibility==="public"?"public":"private";await me.updateShareType(Q.shareId,Se),oe={shareType:Se,isCommunity:L.visibility==="community"},console.log(` Share type updated to ${Se}`)}}else{const Se=L.visibility==="public"?"public":"private",Fe=await me.shareNote(Q,{type:Se},I.displayName||I.email||"Anonymous",I.email||"");oe={isShared:!0,shareId:Fe,shareType:Se,sharedAt:new Date,isCommunity:L.visibility==="community"},console.log(` Note shared as ${L.visibility}:`,Fe)}}catch(me){console.warn(" Failed to update sharing:",me)}else if(L.visibility==="private"&&Q.isShared)try{if(Q.shareId){const{default:me}=await kt(async()=>{const{default:Se}=await Promise.resolve().then(()=>Dr);return{default:Se}},void 0);await me.unshareNote(Q.shareId),oe={isShared:!1,shareId:void 0,shareType:void 0,sharedAt:void 0,isCommunity:!1},console.log(" Note unshared")}}catch(me){console.warn(" Failed to unshare note:",me)}}const se={...L,...oe},$={...Q,...se,updatedAt:new Date};t(me=>me.map(Se=>Se.id===F?$:Se));const W=await xr.updateNote(F,se);if(Q.isShared&&Q.shareId)try{const{default:me}=await kt(async()=>{const{default:Fe}=await Promise.resolve().then(()=>Dr);return{default:Fe}},void 0),{default:Se}=await kt(async()=>{const{default:Fe}=await Promise.resolve().then(()=>Lu);return{default:Fe}},void 0);await me.syncNoteToShared(F,{title:W.title,description:W.description,color:W.color});try{const Fe=await me.getSharedNote(Q.shareId);if(Fe){const jt=Fe.ownerEmail||"",zt=I.email||"",Rt=I.displayName||I.email||"Someone";zt&&jt&&zt.toLowerCase()!==jt.toLowerCase()&&(await Se.createNotification({type:"note_edited",communityId:Q.shareId,communityTitle:Fe.title||"Shared Note",message:`${Rt} edited "${Fe.title||"the note"}"`,actionBy:{name:Rt,email:zt}}),console.log(" Created notification for note edit"))}}catch(Fe){console.warn(" Failed to create edit notification:",Fe)}console.log(" Synced note updates to shared notes")}catch(me){console.warn(" Failed to sync note to shared notes:",me)}if(Q.groupId)try{const{default:me}=await kt(async()=>{const{default:Fe}=await Promise.resolve().then(()=>xv);return{default:Fe}},void 0),Se=await me.getGroupById(Q.groupId);if(Se&&Se.isShared&&Se.shareId){const{default:Fe}=await kt(async()=>{const{default:ai}=await Promise.resolve().then(()=>Lu);return{default:ai}},void 0),jt=I.displayName||I.email||"Someone",zt=I.email||"",Rt=Se.ownerEmail||"";zt&&Rt&&zt.toLowerCase()!==Rt.toLowerCase()&&(await Fe.createNotification({type:"note_edited",communityId:Se.shareId,communityTitle:Se.name||"Group",message:`${jt} edited a note in "${Se.name||"the group"}"`,actionBy:{name:jt,email:zt}}),console.log(" Created notification for group note edit"))}}catch(me){console.warn(" Failed to create group edit notification:",me)}t(me=>me.map(Se=>Se.id===F?W:Se))}catch(Q){throw E("Failed to update note"),console.error("Error updating note:",Q),I&&await de(),Q}},O=async F=>{if(!I)throw new Error("User not authenticated");try{E(null);const L=e.find(se=>se.id===F);if(L?.groupId)try{await ct.removeNoteFromGroup(L.groupId,F),console.log(" Removed note from group:",L.groupId),R(se=>se.map($=>{if($.id===L.groupId){const W=($.noteIds||[]).filter(Se=>Se!==F),me=W.length;return console.log(` Optimistically updating group "${$.name}" count: ${$.noteCount} -> ${me}`),{...$,noteIds:W,noteCount:me}}return $})),await X()}catch(se){console.error("Error removing note from group:",se);try{await X()}catch($){console.error(" Failed to refresh groups:",$)}}let Q,oe=null;if(L?.shareId){Q=L.shareId;try{oe=(await kt(()=>Promise.resolve().then(()=>Dr),void 0)).default}catch(se){console.warn(" Failed to load sharing service, continuing with note deletion:",se)}}if(L?.isCommunity&&Q&&oe&&I.email)try{console.log(" Leaving community before deleting note:",L.title),await oe.leaveCommunity(Q,I.email),console.log(" Successfully left community")}catch(se){console.warn(" Failed to leave community, but continuing with note deletion:",se)}if(L?.isShared&&oe)try{console.log(" Deleting all shared notes for note:",L.title),await oe.deleteAllSharedNotesForNote(F),a(se=>se.filter($=>$.noteId!==F)),console.log(" All shared notes deleted - removed from all users")}catch(se){console.warn(" Failed to delete shared notes, continuing with note deletion:",se)}await xr.deleteNote(F),t(se=>se.filter($=>$.id!==F)),console.log(" Note deleted successfully")}catch(L){throw E("Failed to delete note"),console.error("Error deleting note:",L),L}},z=async(F,L)=>{if(!I)throw new Error("User not authenticated");try{E(null);const{default:Q}=await kt(async()=>{const{default:oe}=await Promise.resolve().then(()=>Dr);return{default:oe}},void 0);if(console.log(" Leaving community:",F),await Q.leaveCommunity(F,I.email),L)console.log(" Removing community note from personal notes:",L),await xr.deleteNote(L),t(oe=>oe.filter(se=>se.id!==L));else{const oe=e.find(se=>se.shareId===F);oe&&(console.log(" Removing community note from personal notes by shareId:",oe.id),await xr.deleteNote(oe.id),t(se=>se.filter($=>$.id!==oe.id)))}console.log(" Successfully left community and removed note")}catch(Q){throw E("Failed to leave community"),console.error("Error leaving community:",Q),Q}};V.useEffect(()=>{if(!I)return;const F=e.some(se=>se.isCommunity),L=r.length>0;if(!F&&!L)return;const Q=setInterval(()=>{F&&ge(),(L||!I.isGuest)&&ve()},3e4),oe=()=>{document.visibilityState==="visible"&&(F&&ge(),(L||!I.isGuest)&&ve())};return document.addEventListener("visibilitychange",oe),()=>{clearInterval(Q),document.removeEventListener("visibilitychange",oe)}},[I,e.length]);const q={notes:e,sharedWithMeNotes:r,createNote:D,updateNote:C,deleteNote:O,leaveCommunity:z,updateSharingSettings:async(F,L)=>{if(!I)throw new Error("User not authenticated");try{E(null);const Q=e.find(W=>W.id===F);if(!Q)throw new Error("Note not found");const{default:oe}=await kt(async()=>{const{default:W}=await Promise.resolve().then(()=>Dr);return{default:W}},void 0);let se={};if(Q.isShared)Q.shareId&&(await oe.updateShareType(Q.shareId,L),se={shareType:L,visibility:L},console.log(` Share type updated to ${L}`));else{const W=await oe.shareNote(Q,{type:L},I.displayName||I.email||"Anonymous",I.email||"");se={isShared:!0,shareId:W,shareType:L,sharedAt:new Date,visibility:L},console.log(` Note shared as ${L}:`,W)}const $={...se};return t(W=>W.map(me=>me.id===F?{...me,...$,updatedAt:new Date}:me)),await xr.updateNote(F,$),{shareId:Q.shareId||se.shareId,shareType:L}}catch(Q){throw E("Failed to update sharing settings"),console.error("Error updating sharing settings:",Q),Q}},refreshSharedNotes:ve,searchQuery:o,setSearchQuery:c,filterColor:d,setFilterColor:f,isLoading:p,error:b,refreshCommunityData:ge,groups:S,selectedGroupId:j,setSelectedGroupId:N,createGroup:async F=>{if(!I||I.isGuest)throw new Error("User not authenticated");try{E(null),console.log(" Creating group with user:",{id:I.id,email:I.email,name:I.displayName});const L=await ct.createGroup(F,I.id,I.email||"",I.displayName||"Anonymous");console.log(" Group created:",{id:L.id,name:L.name,ownerId:L.ownerId,ownerEmail:L.ownerEmail}),R(Q=>[...Q,L]),await X()}catch(L){throw E("Failed to create group"),console.error(" Error creating group:",L),L}},updateGroup:async(F,L)=>{if(!I)throw new Error("User not authenticated");try{E(null);const Q=S.find(se=>se.id===F);if(!Q)throw new Error("Group not found");if(!(Q.ownerId&&I.id&&String(Q.ownerId)===String(I.id)||Q.ownerEmail&&I.email&&Q.ownerEmail.toLowerCase().trim()===I.email.toLowerCase().trim()))throw new Error("You do not have permission to update this group");await ct.updateGroup(F,L),await X()}catch(Q){throw E(Q instanceof Error?Q.message:"Failed to update group"),Q}},deleteGroup:async F=>{if(!I)throw new Error("User not authenticated");try{E(null);const L=S.find(oe=>oe.id===F);if(!L)throw new Error("Group not found");if(!(L.ownerId&&I.id&&String(L.ownerId)===String(I.id)||L.ownerEmail&&I.email&&L.ownerEmail.toLowerCase().trim()===I.email.toLowerCase().trim()))throw new Error("You do not have permission to delete this group");await ct.deleteGroup(F),R(oe=>oe.filter(se=>se.id!==F)),j===F&&N(null)}catch(L){throw E(L instanceof Error?L.message:"Failed to delete group"),L}},addNoteToGroup:async(F,L)=>{try{await ct.addNoteToGroup(F,L),await X(),await de()}catch(Q){throw E("Failed to add note to group"),Q}},removeNoteFromGroup:async(F,L)=>{try{await ct.removeNoteFromGroup(F,L),await X(),await de()}catch(Q){throw E("Failed to remove note from group"),Q}},shareGroup:async(F,L)=>{if(!I||I.isGuest)throw new Error("User not authenticated");try{E(null);const Q=await ct.shareGroup(F,L,I.email||"");return await X(),Q}catch(Q){throw E("Failed to share group"),Q}},refreshGroups:async()=>{await X(),await de()},toggleGroupPin:async F=>{if(!I)throw new Error("User not authenticated");try{E(null);const L=S.find($=>$.id===F);if(!L)throw new Error("Group not found");if(!(L.ownerId&&I.id&&String(L.ownerId)===String(I.id)||L.ownerEmail&&I.email&&L.ownerEmail.toLowerCase().trim()===I.email.toLowerCase().trim()||L.isShared&&L.collaborators?.some($=>$.email?.toLowerCase().trim()===I.email?.toLowerCase().trim())))throw new Error("You do not have permission to pin this group");const se=!L.isPinned;await ct.updateGroup(F,{isPinned:se}),R($=>$.map(W=>W.id===F?{...W,isPinned:se}:W)),await X()}catch(L){throw E(L instanceof Error?L.message:"Failed to toggle group pin"),L}},leaveGroup:async F=>{if(!I||!I.email)throw new Error("User not authenticated");try{E(null);const L=S.find(Q=>Q.id===F);if(!L||!L.shareId)throw new Error("Group not found or not shared");await ct.removeGroupCollaborator(L.shareId,I.email),R(Q=>Q.filter(oe=>oe.id!==F)),j===F&&N(null),await X(),await de(),console.log(" Successfully left group")}catch(L){throw E("Failed to leave group"),console.error("Error leaving group:",L),L}}};return m.jsx(LN.Provider,{value:q,children:n})};const BL=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qL=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),oT=n=>{const e=qL(n);return e.charAt(0).toUpperCase()+e.slice(1)},UN=(...n)=>n.filter((e,t,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===t).join(" ").trim(),GL=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};var $L={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const HL=V.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:a="",children:o,iconNode:c,...d},f)=>V.createElement("svg",{ref:f,...$L,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:UN("lucide",a),...!o&&!GL(d)&&{"aria-hidden":"true"},...d},[...c.map(([p,v])=>V.createElement(p,v)),...Array.isArray(o)?o:[o]]));const Oe=(n,e)=>{const t=V.forwardRef(({className:r,...a},o)=>V.createElement(HL,{ref:o,iconNode:e,className:UN(`lucide-${BL(oT(n))}`,`lucide-${n}`,r),...a}));return t.displayName=oT(n),t};const KL=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],QL=Oe("arrow-left",KL);const YL=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Ef=Oe("bell",YL);const WL=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],XL=Oe("calendar",WL);const JL=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],wv=Oe("check",JL);const ZL=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],e3=Oe("chevron-down",ZL);const t3=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],n3=Oe("clock",t3);const r3=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],zN=Oe("copy",r3);const i3=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],s3=Oe("crown",i3);const a3=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],FN=Oe("download",a3);const o3=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],BN=Oe("ellipsis-vertical",o3);const l3=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],xd=Oe("external-link",l3);const c3=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],u3=Oe("eye-off",c3);const d3=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ev=Oe("eye",d3);const h3=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],lT=Oe("file-text",h3);const f3=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],m3=Oe("folder-open",f3);const g3=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],qN=Oe("folder-plus",g3);const p3=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],ay=Oe("folder",p3);const y3=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],GN=Oe("github",y3);const v3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],km=Oe("globe",v3);const _3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],Tv=Oe("info",_3);const b3=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],ta=Oe("lock",b3);const x3=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Dm=Oe("log-out",x3);const w3=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],cT=Oe("mail",w3);const E3=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],$N=Oe("moon",E3);const T3=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],HN=Oe("palette",T3);const S3=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],KN=Oe("pen-line",S3);const I3=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],A3=Oe("pen",I3);const N3=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],C3=Oe("phone",N3);const R3=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M15 9.34V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H7.89",key:"znwnzq"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M9 9v1.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h11",key:"c9qhm2"}]],k3=Oe("pin-off",R3);const D3=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],Hl=Oe("pin",D3);const j3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Sv=Oe("plus",j3);const O3=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],P3=Oe("refresh-cw",O3);const V3=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Iv=Oe("save",V3);const M3=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],QN=Oe("search",M3);const L3=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Wf=Oe("settings",L3);const U3=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Yi=Oe("share-2",U3);const z3=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],F3=Oe("shield",z3);const B3=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],YN=Oe("smartphone",B3);const q3=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],G3=Oe("square-pen",q3);const $3=[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]],H3=Oe("sticky-note",$3);const K3=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],WN=Oe("sun",K3);const Q3=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],XN=Oe("trash-2",Q3);const Y3=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],JN=Oe("user-minus",Y3);const W3=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],ZN=Oe("user-plus",W3);const X3=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Tn=Oe("users",X3);const J3=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],or=Oe("x",J3);const Z3=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],e6=Oe("zap",Z3),oy=n=>{if(!n?.code)return n?.message||"An unexpected error occurred";switch(n.code){case"auth/user-not-found":return"No account found with this email address";case"auth/wrong-password":return"Incorrect password. Please try again";case"auth/invalid-email":return"Please enter a valid email address";case"auth/user-disabled":return"This account has been disabled";case"auth/too-many-requests":return"Too many failed attempts. Please try again later";case"auth/email-already-in-use":return"An account with this email already exists";case"auth/weak-password":return"Password is too weak. Please use at least 6 characters";case"auth/operation-not-allowed":return"Email/password accounts are not enabled";case"auth/network-request-failed":return"Network error. Please check your connection";case"auth/invalid-credential":return"Invalid email or password";case"auth/credential-already-in-use":return"This credential is already associated with another account";case"auth/popup-closed-by-user":return"Sign in was cancelled";case"auth/popup-blocked":return"Pop-up was blocked. Please allow pop-ups and try again";case"auth/cancelled-popup-request":return"Sign in was cancelled";case"auth/unauthorized-domain":return"Authentication not configured for this domain";default:return console.warn("Unhandled Firebase error code:",n.code),n.message||"Authentication failed. Please try again"}},t6=()=>{const{signInWithGoogle:n,signInWithEmail:e,signUpWithEmail:t,signInAsGuest:r,isLoading:a}=lr(),[o,c]=V.useState(""),[d,f]=V.useState({}),[p,v]=V.useState("signin"),[b,E]=V.useState(!1),[S,R]=V.useState(!1),[j,N]=V.useState(!1),[I,te]=V.useState({email:"",password:"",displayName:""});V.useEffect(()=>{const P=window.location.protocol==="chrome-extension:";R(P)},[]),V.useEffect(()=>{try{const P=localStorage.getItem("rememberedEmail"),k=localStorage.getItem("rememberedLoginMethod");P&&(te(Ne=>({...Ne,email:P})),N(!0),k==="google"&&console.log(" Last login was with Google"))}catch(P){console.error("Error loading remembered login:",P)}},[]);const X=P=>P.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(P)?null:"Please enter a valid email address":"Email is required",de=P=>P?P.length<6?"Password must be at least 6 characters":null:"Password is required",ve=P=>P.trim()?P.trim().length<2?"Name must be at least 2 characters":null:"Name is required",ge=()=>{const P={},k=X(I.email),Ne=de(I.password);return k&&(P.email=k),Ne&&(P.password=Ne),console.log(" Validation errors found:",P),f(P),Object.keys(P).length===0},D=()=>{const P={},k=X(I.email),Ne=de(I.password),Ze=ve(I.displayName);return k&&(P.email=k),Ne&&(P.password=Ne),Ze&&(P.displayName=Ze),console.log(" SignUp validation errors found:",P),f(P),Object.keys(P).length===0},C=async()=>{if(c(""),console.log(" Starting email sign-in process..."),!ge()){console.log(" Validation failed: Form has errors");return}f({});try{console.log(" Signing in with email:",I.email),await e(I.email,I.password),console.log(" Email authentication successful"),j?(localStorage.setItem("rememberedEmail",I.email),localStorage.setItem("rememberedLoginMethod","email"),console.log(" Saved email for next login")):(localStorage.removeItem("rememberedEmail"),localStorage.removeItem("rememberedLoginMethod"))}catch(k){console.error(" Email login failed:",k),console.log(" Error details:",{code:k?.code,message:k?.message});const Ne=oy(k);console.log(" Error message shown to user:",Ne),k?.code==="auth/user-not-found"||k?.code==="auth/wrong-password"||k?.code==="auth/invalid-credential"||Ne.includes("No account found")||Ne.includes("Incorrect password")||Ne.includes("Invalid email or password")?c(" Login data is incorrect. Please check your email and password."):k?.code==="auth/invalid-email"?c(" Please enter a valid email address."):k?.code==="auth/too-many-requests"?c(" Too many failed attempts. Please try again later."):k?.code==="auth/network-request-failed"?c(" Network error. Please check your internet connection."):c(` ${Ne}`)}},O=async()=>{if(c(""),console.log(" Starting email sign-up process..."),!D()){console.log(" Validation failed: Form has errors");return}f({});try{console.log(" Creating account for:",I.email),await t(I.email,I.password,I.displayName),console.log(" Email signup successful")}catch(k){console.error(" Email signup failed:",k),console.log(" Signup error details:",{code:k?.code,message:k?.message});const Ne=oy(k);console.log(" Error message shown to user:",Ne),k?.code==="auth/email-already-in-use"?c(" An account with this email already exists. Please sign in instead."):k?.code==="auth/weak-password"?c(" Password is too weak. Please use at least 6 characters with numbers and letters."):k?.code==="auth/invalid-email"?c(" Please enter a valid email address."):k?.code==="auth/operation-not-allowed"?c(" Email signup is not enabled. Please contact support."):k?.code==="auth/network-request-failed"?c(" Network error. Please check your internet connection."):c(` ${Ne}`)}},z=(P,k)=>{te(Ne=>({...Ne,[P]:k})),c(""),f(Ne=>({...Ne,[P]:void 0}))},M=P=>{v(P),c(""),f({}),te({email:"",password:"",displayName:""})};return m.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center p-4",children:m.jsxs("div",{className:"w-full max-w-md bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:[m.jsxs("div",{className:"bg-blue-600 dark:bg-blue-700 p-6 text-center rounded-t-lg",children:[m.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-white/20 rounded-lg mb-3",children:m.jsx(H3,{className:"w-6 h-6 text-white"})}),m.jsx("h1",{className:"text-xl font-bold text-white mb-1",children:"Google Notes"}),m.jsx("p",{className:"text-blue-100 text-sm",children:"Your thoughts, organized beautifully"})]}),m.jsxs("div",{className:"p-6 space-y-6",children:[m.jsx("button",{onClick:async()=>{try{c(""),f({}),await n(),j?(localStorage.setItem("rememberedLoginMethod","google"),console.log(" Saved Google login method")):localStorage.removeItem("rememberedLoginMethod")}catch(P){console.error(" Google login failed:",P);const k=oy(P);P?.code==="auth/popup-closed-by-user"?c(" Sign-in was cancelled. Please try again."):P?.code==="auth/popup-blocked"?c(" Popup blocked. Please allow popups and try again."):P?.code==="auth/network-request-failed"?c(" Network error. Please check your internet connection."):c(` Google sign-in failed: ${k}`)}},disabled:a,className:"w-full flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a?m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-900 dark:border-white mr-2"}),"Signing in..."]}):m.jsxs(m.Fragment,{children:[m.jsxs("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",children:[m.jsx("path",{fill:"#4285f4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),m.jsx("path",{fill:"#34a853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),m.jsx("path",{fill:"#fbbc05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),m.jsx("path",{fill:"#ea4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Continue with Google"]})}),m.jsxs("div",{className:"relative",children:[m.jsx("div",{className:"absolute inset-0 flex items-center",children:m.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})}),m.jsx("div",{className:"relative flex justify-center text-sm",children:m.jsx("span",{className:"px-2 bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400",children:"or continue with email"})})]}),m.jsx("div",{className:"border-b border-gray-200 dark:border-gray-600",children:m.jsxs("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:[m.jsx("button",{type:"button",onClick:()=>M("signin"),className:`py-2 px-1 border-b-2 font-medium text-sm ${p==="signin"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}`,children:"Sign In"}),m.jsx("button",{type:"button",onClick:()=>M("signup"),className:`py-2 px-1 border-b-2 font-medium text-sm ${p==="signup"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}`,children:"Sign Up"})]})}),m.jsxs("form",{onSubmit:P=>{P.preventDefault(),p==="signin"?C():O()},className:"mt-6 space-y-4",children:[p==="signup"&&m.jsxs("div",{children:[m.jsx("label",{htmlFor:"displayName",className:"block text-left text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Full Name"}),m.jsx("input",{type:"text",id:"displayName",value:I.displayName,onChange:P=>z("displayName",P.target.value),className:`w-full px-3 py-2 border rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:border-transparent ${d.displayName?"border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:ring-blue-500"}`,placeholder:"Enter your full name",disabled:a}),d.displayName&&m.jsx("p",{className:"text-red-600 dark:text-red-400 text-xs mt-1",children:d.displayName})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"email",className:"block text-left text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Email"}),m.jsx("input",{type:"email",id:"email",value:I.email,onChange:P=>z("email",P.target.value),className:`w-full px-3 py-2 border rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:border-transparent ${d.email?"border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:ring-blue-500"}`,placeholder:"Enter your email address",disabled:a}),d.email&&m.jsx("p",{className:"text-red-600 dark:text-red-400 text-xs mt-1 font-medium",children:d.email})]}),m.jsxs("div",{children:[m.jsx("label",{htmlFor:"password",className:"block text-left text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Password"}),m.jsxs("div",{className:"relative",children:[m.jsx("input",{type:b?"text":"password",id:"password",value:I.password,onChange:P=>z("password",P.target.value),className:`w-full pl-3 pr-10 py-2 border rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:border-transparent ${d.password?"border-red-500 focus:ring-red-500":"border-gray-300 dark:border-gray-600 focus:ring-blue-500"}`,placeholder:p==="signup"?"Create a password (6+ characters)":"Enter your password",disabled:a}),m.jsx("button",{type:"button",onClick:()=>E(!b),className:"absolute inset-y-0 right-0 pr-3 flex items-center",disabled:a,children:b?m.jsx(u3,{className:"h-4 w-4 text-gray-400"}):m.jsx(Ev,{className:"h-4 w-4 text-gray-400"})})]}),d.password&&m.jsx("p",{className:"text-red-600 dark:text-red-400 text-xs mt-1 font-medium",children:d.password})]}),p==="signin"&&m.jsxs("div",{className:"flex items-center",children:[m.jsx("input",{type:"checkbox",id:"rememberMe",checked:j,onChange:P=>{const k=P.target.checked;N(k),k||(localStorage.removeItem("rememberedEmail"),localStorage.removeItem("rememberedLoginMethod"),console.log(" Cleared remembered login data"))},className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",disabled:a}),m.jsx("label",{htmlFor:"rememberMe",className:"ml-2 block text-sm text-gray-700 dark:text-gray-300 text-left",children:"Remember me"})]}),m.jsx("button",{type:"submit",disabled:a,className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 dark:bg-blue-700 hover:bg-blue-700 dark:hover:bg-blue-800 text-white rounded-md text-sm font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:a?m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),p==="signin"?"Signing in...":"Creating account..."]}):p==="signin"?"Sign in":"Create Account"})]}),o&&m.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3 mt-4",children:m.jsx("p",{className:"text-red-800 dark:text-red-200 text-sm text-center",children:o})}),m.jsxs("div",{className:"mt-6 text-center",children:[m.jsxs("div",{className:"relative mb-4",children:[m.jsx("div",{className:"absolute inset-0 flex items-center",children:m.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})}),m.jsx("div",{className:"relative flex justify-center text-sm",children:m.jsx("span",{className:"px-2 bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400",children:"or try without signing up"})})]}),m.jsx("button",{onClick:async()=>{try{c(""),await r()}catch(P){console.error(" Guest login failed:",P),c(" Failed to start guest session. Please try again.")}},disabled:a,className:"w-full flex items-center justify-center px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-md text-sm font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors border border-gray-300 dark:border-gray-600",children:a?m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600 mr-2"}),"Starting guest session..."]}):m.jsxs(m.Fragment,{children:[m.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:m.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z",clipRule:"evenodd"})}),"Continue as Guest"]})}),m.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs mt-2",children:"Notes will be saved locally. Sign in later to sync to cloud."})]}),S&&m.jsxs("div",{className:"mt-6 text-center",children:[m.jsx("button",{onClick:()=>window.open("https://livenote-ruddy.vercel.app","_blank"),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm font-medium underline hover:no-underline transition-colors",children:" Access Web Version"}),m.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs mt-1",children:"Use Google Notes in your browser"})]}),m.jsx("div",{className:"mt-6 text-center",children:m.jsx("a",{href:"https://livenotes-privacy-policy.vercel.app",target:"_blank",rel:"noopener noreferrer",className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 text-xs font-medium underline hover:no-underline transition-colors",children:"Privacy Policy"})})]})]})})},wl=n=>n?n.includes("googleusercontent.com")?n.replace(/=s\d+/,"=s200"):n:null,Mu=n=>{if(!n)return"U";const e=n.trim().split(" ");return e.length===1?e[0].charAt(0).toUpperCase():(e[0].charAt(0)+e[e.length-1].charAt(0)).toUpperCase()};class ro{static NOTIFICATIONS_COLLECTION="notifications";static async createNotification(e){try{const t=rt(yt(xe,this.NOTIFICATIONS_COLLECTION)),r={...e,id:t.id,timestamp:Be.now(),read:!1};await lv(t,r),console.log(" Notification created:",t.id)}catch(t){throw console.error("Error creating notification:",t),new Error("Failed to create notification")}}static async getNotifications(e,t=50){try{const r=Gt(yt(xe,this.NOTIFICATIONS_COLLECTION),xf("timestamp","desc"),wf(t*2)),a=await Zt(r),o=[];return a.forEach(c=>{const d=c.data();d.actionBy?.email?.toLowerCase()!==e.toLowerCase()&&o.push({id:c.id,type:d.type,communityId:d.communityId,communityTitle:d.communityTitle,message:d.message,timestamp:d.timestamp?.toDate()||new Date,read:d.read||!1,actionBy:d.actionBy})}),o.slice(0,t)}catch(r){return console.error("Error getting notifications:",r),[]}}static async getNotificationsForShare(e,t=50){try{const r=Gt(yt(xe,this.NOTIFICATIONS_COLLECTION),nn("communityId","==",e),xf("timestamp","desc"),wf(t)),a=await Zt(r),o=[];return a.forEach(c=>{const d=c.data();o.push({id:c.id,type:d.type,communityId:d.communityId,communityTitle:d.communityTitle,message:d.message,timestamp:d.timestamp?.toDate()||new Date,read:d.read||!1,actionBy:d.actionBy})}),o}catch(r){return console.error("Error getting notifications for share:",r),[]}}static subscribeToNotifications(e,t){try{const r=Gt(yt(xe,this.NOTIFICATIONS_COLLECTION),xf("timestamp","desc"),wf(50));return oN(r,o=>{const c=[];o.forEach(d=>{const f=d.data();f.actionBy?.email!==e&&c.push({id:d.id,type:f.type,communityId:f.communityId,communityTitle:f.communityTitle,message:f.message,timestamp:f.timestamp?.toDate()||new Date,read:f.read||!1,actionBy:f.actionBy})}),t(c)},o=>{console.error("Error in notification subscription:",o),t([])})}catch(r){return console.error("Error subscribing to notifications:",r),()=>{}}}static async markAsRead(e){try{const t=rt(xe,this.NOTIFICATIONS_COLLECTION,e);await wt(t,{read:!0})}catch(t){throw console.error("Error marking notification as read:",t),new Error("Failed to mark notification as read")}}static async markAllAsRead(e){try{const t=Gt(yt(xe,this.NOTIFICATIONS_COLLECTION),nn("read","==",!1)),a=(await Zt(t)).docs.filter(o=>o.data().actionBy?.email!==e).map(o=>wt(o.ref,{read:!0}));await Promise.all(a)}catch(t){throw console.error("Error marking all notifications as read:",t),new Error("Failed to mark all notifications as read")}}static async deleteNotification(e){try{const t=rt(xe,this.NOTIFICATIONS_COLLECTION,e);await wt(t,{deleted:!0})}catch(t){throw console.error("Error deleting notification:",t),new Error("Failed to delete notification")}}}const Lu=Object.freeze(Object.defineProperty({__proto__:null,NotificationService:ro,default:ro},Symbol.toStringTag,{value:"Module"})),n6=({className:n=""})=>{const{user:e}=lr(),[t,r]=V.useState([]),[a,o]=V.useState(!1),c=V.useRef(null),d=typeof chrome<"u"&&chrome.runtime&&!window.location.protocol.startsWith("http");V.useEffect(()=>{if(!e||!e.email)return;const R=ro.subscribeToNotifications(e.email,j=>{r(j)});return ro.getNotifications(e.email).then(j=>{r(j)}).catch(j=>{console.error("Error loading notifications:",j)}),()=>{R&&R()}},[e]),V.useEffect(()=>{const R=j=>{a&&c.current&&!c.current.contains(j.target)&&(j.target.closest('button[title="Community Notifications"]')||o(!1))};if(a){const j=setTimeout(()=>{document.addEventListener("mousedown",R)},100);return()=>{clearTimeout(j),document.removeEventListener("mousedown",R)}}},[a]);const f=async R=>{try{await ro.markAsRead(R),r(j=>j.map(N=>N.id===R?{...N,read:!0}:N))}catch(j){console.error("Error marking notification as read:",j)}},p=async()=>{if(e?.email)try{await ro.markAllAsRead(e.email),r(R=>R.map(j=>({...j,read:!0})))}catch(R){console.error("Error marking all notifications as read:",R)}},v=async R=>{try{await ro.deleteNotification(R),r(j=>j.filter(N=>N.id!==R))}catch(j){console.error("Error removing notification:",j)}},b=R=>{const j=d?"h-3.5 w-3.5":"h-4 w-4";switch(R){case"note_added":return m.jsx(Sv,{className:`${j} text-green-500`});case"note_edited":return m.jsx(KN,{className:`${j} text-blue-500`});case"member_joined":return m.jsx(Tn,{className:`${j} text-purple-500`});case"member_left":return m.jsx(Tn,{className:`${j} text-red-500`});default:return m.jsx(Ef,{className:`${j} text-gray-500`})}},E=R=>{const N=new Date().getTime()-R.getTime(),I=Math.floor(N/(1e3*60)),te=Math.floor(N/(1e3*60*60)),X=Math.floor(N/(1e3*60*60*24));return X>0?`${X}d ago`:te>0?`${te}h ago`:I>0?`${I}m ago`:"Just now"},S=t.filter(R=>!R.read).length;return e?m.jsxs("div",{className:`relative ${n} z-50`,children:[m.jsxs("button",{onClick:()=>o(!a),className:`relative ${d?"p-1.5":"p-2"} text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors`,title:"Community Notifications",children:[m.jsx(Ef,{className:d?"h-4 w-4":"h-5 w-5"}),S>0&&m.jsx("span",{className:`absolute -top-1 -right-1 bg-red-500 text-white ${d?"text-[10px] h-4 w-4":"text-xs h-5 w-5"} font-bold rounded-full flex items-center justify-center`,children:S>9?"9+":S})]}),a&&m.jsxs("div",{ref:c,className:`
            ${d?"fixed":"absolute"} 
            ${d?"right-2":"right-0"} 
            top-12 
            bg-white dark:bg-dark-card 
            border border-gray-200 dark:border-gray-600 
            rounded-lg shadow-xl 
            z-[100] 
            ${d?"w-80 max-h-64":"w-96 max-h-96"} 
            overflow-hidden
            ${d?"mt-1":""}
          `,style:d?{maxWidth:"calc(100vw - 1rem)",maxHeight:"calc(100vh - 4rem)"}:{},children:[m.jsxs("div",{className:`flex items-center justify-between ${d?"p-2":"p-4"} border-b border-gray-200 dark:border-gray-600`,children:[m.jsx("h3",{className:`${d?"text-xs":"text-sm"} font-semibold text-gray-900 dark:text-white text-left`,children:"Community Activity"}),m.jsxs("div",{className:`flex items-center ${d?"space-x-1":"space-x-2"}`,children:[S>0&&m.jsx("button",{onClick:p,className:`${d?"text-[10px] px-1.5 py-0.5":"text-xs px-2 py-1"} bg-blue-100 hover:bg-blue-200 text-blue-700 rounded transition-colors`,children:"Mark all read"}),m.jsx("button",{onClick:()=>o(!1),className:`${d?"p-0.5":"p-1"} hover:bg-gray-100 dark:hover:bg-gray-700 rounded`,children:m.jsx(or,{className:`${d?"h-3.5 w-3.5":"h-4 w-4"} text-gray-600 dark:text-gray-400`})})]})]}),m.jsx("div",{className:d?"max-h-48 overflow-y-auto":"max-h-80 overflow-y-auto",children:t.length===0?m.jsxs("div",{className:`${d?"p-4":"p-6"} text-center text-gray-500 dark:text-gray-400`,children:[m.jsx(Ef,{className:`${d?"h-6 w-6":"h-8 w-8"} mx-auto mb-2 opacity-50`}),m.jsx("p",{className:d?"text-xs":"text-sm",children:"No notifications yet"}),m.jsx("p",{className:d?"text-[10px]":"text-xs",children:"Community activity will appear here"})]}):m.jsx("div",{className:"divide-y divide-gray-200 dark:divide-gray-600",children:t.map(R=>m.jsx("div",{className:`${d?"p-2":"p-4"} hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${R.read?"":"bg-blue-50 dark:bg-blue-900/10"}`,children:m.jsxs("div",{className:`flex items-start ${d?"space-x-2":"space-x-3"}`,children:[m.jsx("div",{className:"flex-shrink-0 mt-0.5",children:b(R.type)}),m.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("p",{className:`${d?"text-xs":"text-sm"} font-medium text-gray-900 dark:text-white truncate text-left`,children:R.communityTitle}),m.jsxs("div",{className:`flex items-center ${d?"space-x-0.5":"space-x-1"}`,children:[m.jsx("span",{className:`${d?"text-[10px]":"text-xs"} text-gray-500 dark:text-gray-400`,children:E(R.timestamp)}),!R.read&&m.jsx("div",{className:`${d?"w-1.5 h-1.5":"w-2 h-2"} bg-blue-500 rounded-full`})]})]}),m.jsx("p",{className:`${d?"text-xs":"text-sm"} text-gray-600 dark:text-gray-300 ${d?"mt-0.5":"mt-1"} text-left`,children:R.message}),m.jsxs("p",{className:`${d?"text-[10px]":"text-xs"} text-gray-500 dark:text-gray-400 ${d?"mt-0.5":"mt-1"} text-left`,children:["by ",R.actionBy.name]})]}),m.jsxs("div",{className:`flex-shrink-0 flex items-center ${d?"space-x-0.5":"space-x-1"}`,children:[!R.read&&m.jsx("button",{onClick:()=>f(R.id),className:`${d?"p-0.5":"p-1"} hover:bg-gray-200 dark:hover:bg-gray-600 rounded`,title:"Mark as read",children:m.jsx(Ev,{className:`${d?"h-2.5 w-2.5":"h-3 w-3"} text-gray-500`})}),m.jsx("button",{onClick:()=>v(R.id),className:`${d?"p-0.5":"p-1"} hover:bg-gray-200 dark:hover:bg-gray-600 rounded`,title:"Remove notification",children:m.jsx(or,{className:`${d?"h-2.5 w-2.5":"h-3 w-3"} text-gray-500`})})]})]})},R.id))})}),t.length>0&&m.jsx("div",{className:`${d?"p-2":"p-3"} border-t border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-800`,children:m.jsx("button",{onClick:()=>{console.log(" View all notifications")},className:`w-full text-center ${d?"text-xs":"text-sm"} text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 transition-colors`,children:"View all notifications"})})]})]}):null},r6=({onSettings:n})=>{const{user:e,signOut:t}=lr(),{isDarkMode:r,toggleTheme:a}=bv(),[o,c]=V.useState(!1),d=V.useRef(null);V.useEffect(()=>{const v=b=>{d.current&&!d.current.contains(b.target)&&c(!1)};return document.addEventListener("mousedown",v),()=>{document.removeEventListener("mousedown",v)}},[]);const f=async()=>{try{await t(),c(!1)}catch(v){console.error("Error signing out:",v)}},p=typeof chrome<"u"&&chrome.runtime&&!window.location.protocol.startsWith("http");return m.jsxs("header",{className:`flex items-center justify-between ${p?"px-2.5 py-1.5":"px-4 sm:px-6 py-3 sm:py-4"} border-b border-gray-200 dark:border-dark-border bg-white dark:bg-dark-card shrink-0 relative z-40`,children:[m.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[m.jsx("div",{className:`${p?"w-7 h-7":"w-8 h-8"} bg-blue-500 rounded-lg flex items-center justify-center ${p?"mr-2":"mr-3"} shrink-0`,children:m.jsx("span",{className:`text-white font-bold ${p?"text-xs":"text-sm"}`,children:"N"})}),m.jsxs("div",{className:"min-w-0 flex-1",children:[m.jsx("h1",{className:`${p?"text-base":"text-lg"} font-bold text-gray-800 dark:text-white truncate`,children:"Google Notes"}),m.jsxs("p",{className:`${p?"text-[10px]":"text-xs"} text-gray-500 dark:text-gray-400 truncate`,children:[e?.displayName||"User",e?.isGuest&&m.jsx("span",{className:"ml-1 px-1 py-0.5 bg-orange-100 dark:bg-orange-900/20 text-orange-700 dark:text-orange-300 rounded text-[10px] font-medium",children:"Guest"})]})]})]}),m.jsxs("div",{className:`flex items-center ${p?"space-x-1.5":"space-x-2"} shrink-0`,children:[m.jsx(n6,{}),m.jsxs("div",{className:"relative",ref:d,children:[m.jsxs("button",{onClick:()=>c(!o),className:`flex items-center ${p?"space-x-1 p-0.5":"space-x-2 p-1"} hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors`,title:"User Menu",children:[m.jsx("div",{className:`${p?"w-7 h-7":"w-8 h-8"} bg-blue-500 rounded-full flex items-center justify-center overflow-hidden shrink-0`,children:wl(e?.photoURL)?m.jsx("img",{src:wl(e?.photoURL),alt:"Profile",className:`${p?"w-7 h-7":"w-8 h-8"} rounded-full object-cover`,onError:v=>{v.currentTarget.style.display="none",v.currentTarget.parentElement.innerHTML=`<span class="text-white ${p?"text-[10px]":"text-xs"} font-medium">${Mu(e?.displayName)}</span>`}}):m.jsx("span",{className:`text-white ${p?"text-[10px]":"text-xs"} font-medium`,children:Mu(e?.displayName)})}),!p&&m.jsx(e3,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})]}),o&&m.jsxs("div",{className:"absolute right-0 mt-2 w-56 bg-white dark:bg-dark-card rounded-lg shadow-lg border border-gray-200 dark:border-gray-600 z-50",children:[m.jsx("div",{className:"px-4 py-3 border-b border-gray-200 dark:border-gray-600",children:m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center overflow-hidden",children:wl(e?.photoURL)?m.jsx("img",{src:wl(e?.photoURL),alt:"Profile",className:"w-10 h-10 rounded-full object-cover"}):m.jsx("span",{className:"text-white text-sm font-medium",children:Mu(e?.displayName)})}),m.jsxs("div",{className:"flex-1",children:[m.jsx("div",{className:"font-medium text-gray-800 dark:text-white truncate",children:e?.displayName||"User"}),m.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 truncate",children:[e?.email,e?.isGuest&&m.jsx("span",{className:"ml-1 px-1 py-0.5 bg-orange-100 dark:bg-orange-900/20 text-orange-700 dark:text-orange-300 rounded text-xs",children:"Guest"})]})]})]})}),m.jsxs("div",{className:"py-1",children:[m.jsxs("button",{onClick:()=>{a(),c(!1)},className:"w-full flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[r?m.jsx(WN,{className:"h-4 w-4 mr-3 text-gray-500"}):m.jsx($N,{className:"h-4 w-4 mr-3 text-gray-500"}),r?"Light Mode":"Dark Mode"]}),m.jsxs("button",{onClick:()=>{n(),c(!1)},className:"w-full flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[m.jsx(Tv,{className:"h-4 w-4 mr-3 text-gray-500"}),"About & Settings"]}),typeof chrome<"u"&&chrome.runtime&&!window.location.protocol.startsWith("http")&&m.jsxs("button",{onClick:()=>{window.open("https://livenote-ruddy.vercel.app","_blank"),c(!1)},className:"w-full flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[m.jsx(xd,{className:"h-4 w-4 mr-3 text-gray-500"}),"Open Web Version"]}),m.jsxs("a",{href:"https://github.com",target:"_blank",rel:"noopener noreferrer",onClick:()=>c(!1),className:"w-full flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[m.jsx(GN,{className:"h-4 w-4 mr-3 text-gray-500"}),"GitHub Repository"]}),m.jsx("div",{className:"border-t border-gray-200 dark:border-gray-600 my-1"}),m.jsxs("button",{onClick:f,className:"w-full flex items-center px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",children:[m.jsx(Dm,{className:"h-4 w-4 mr-3"}),"Sign Out"]})]})]})]})]})]})},e1=({members:n,maxVisible:e=3})=>{const[t,r]=V.useState(!1);if(!n||n.length===0)return null;const a=[...n].sort((p,v)=>new Date(v.joinedAt).getTime()-new Date(p.joinedAt).getTime()),o=a.slice(0,e),c=Math.max(0,a.length-e),d=p=>p.split(" ").map(v=>v.charAt(0).toUpperCase()).join("").slice(0,2),f=p=>{const v=["bg-red-500","bg-blue-500","bg-green-500","bg-yellow-500","bg-purple-500","bg-pink-500","bg-indigo-500","bg-orange-500"],b=p.length%v.length;return v[b]};return m.jsxs("div",{className:"relative",children:[m.jsxs("div",{className:"flex items-center -space-x-2",children:[o.map((p,v)=>m.jsx("div",{className:`
              w-8 h-8 rounded-full border-2 border-white dark:border-gray-800 
              flex items-center justify-center text-white text-xs font-medium
              ${f(p.displayName)}
              shadow-sm hover:scale-110 transition-transform cursor-pointer
            `,title:`${p.displayName} (${p.role})`,style:{zIndex:e-v},children:p.photoURL?m.jsx("img",{src:p.photoURL,alt:p.displayName,className:"w-full h-full rounded-full object-cover"}):d(p.displayName)},p.id)),c>0&&m.jsxs("button",{onClick:()=>r(!0),className:`
              w-8 h-8 rounded-full border-2 border-white dark:border-gray-800
              bg-gray-500 hover:bg-gray-600 text-white text-xs font-medium
              flex items-center justify-center shadow-sm
              hover:scale-110 transition-all cursor-pointer
            `,title:`${c} more member${c!==1?"s":""}`,children:["+",c]})]}),t&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>r(!1)}),m.jsxs("div",{className:"absolute bottom-10 right-0 bg-white dark:bg-dark-card border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg z-50 p-4 min-w-[280px]",children:[m.jsxs("div",{className:"flex items-center justify-between mb-3",children:[m.jsxs("h3",{className:"font-medium text-gray-900 dark:text-white flex items-center space-x-2",children:[m.jsx(Tn,{className:"h-4 w-4"}),m.jsxs("span",{children:["Community Members (",n.length,")"]})]}),m.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:""})]}),m.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:a.map(p=>m.jsxs("div",{className:"flex items-center space-x-3 p-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[m.jsx("div",{className:`
                      w-10 h-10 rounded-full flex items-center justify-center
                      text-white text-sm font-medium ${f(p.displayName)}
                    `,children:p.photoURL?m.jsx("img",{src:p.photoURL,alt:p.displayName,className:"w-full h-full rounded-full object-cover"}):d(p.displayName)}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:p.displayName}),p.role==="owner"&&m.jsx("span",{className:"px-2 py-0.5 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-xs rounded-full",children:"Owner"})]}),m.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Joined ",new Date(p.joinedAt).toLocaleDateString()]})]})]},p.id))})]})]})]})};class Lt{static SHARED_NOTES_COLLECTION="sharedNotes";static generateShareId(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}static async shareNote(e,t,r,a){try{const o=this.generateShareId(),c={noteId:e.id,shareId:o,shareType:t.type,ownerId:e.userId,createdAt:new Date,expiresAt:t.expiresAt,title:e.title,description:e.description,color:e.color,ownerName:r,ownerEmail:a,allowEditing:t.type==="private"},d=rt(xe,this.SHARED_NOTES_COLLECTION,o);return await lv(d,{...c,createdAt:Au(),expiresAt:t.expiresAt?new Date(t.expiresAt):null}),o}catch(o){throw console.error("Error sharing note:",o),o instanceof Error?(console.error("Error name:",o.name),console.error("Error message:",o.message),console.error("Error stack:",o.stack),o):new Error("Failed to share note: Unknown error")}}static async getSharedNote(e){try{const t=rt(xe,this.SHARED_NOTES_COLLECTION,e),r=await wr(t);if(!r.exists())return null;const a=r.data();return a.expiresAt&&new Date(a.expiresAt.toDate())<new Date?(await this.unshareNote(e),null):{id:r.id,...a,ownerId:a.ownerId||a.ownerEmail||"",allowEditing:a.allowEditing??a.shareType==="private",createdAt:a.createdAt.toDate(),expiresAt:a.expiresAt?a.expiresAt.toDate():void 0}}catch(t){throw console.error("Error getting shared note:",t),new Error("Failed to get shared note")}}static async unshareNote(e){try{const t=rt(xe,this.SHARED_NOTES_COLLECTION,e);await Xu(t)}catch(t){throw console.error("Error unsharing note:",t),new Error("Failed to unshare note")}}static async getUserSharedNotes(e){try{const t=Gt(yt(xe,this.SHARED_NOTES_COLLECTION),nn("ownerEmail","==",e)),r=await Zt(t),a=[];return r.forEach(o=>{const c=o.data();if(c.expiresAt&&new Date(c.expiresAt.toDate())<new Date){this.unshareNote(o.id);return}a.push({id:o.id,...c,ownerId:c.ownerId||c.ownerEmail||"",allowEditing:c.allowEditing??c.shareType==="private",createdAt:c.createdAt.toDate(),expiresAt:c.expiresAt?c.expiresAt.toDate():void 0})}),a}catch(t){throw console.error("Error getting user shared notes:",t),new Error("Failed to get shared notes")}}static async getNotesSharedWithUser(e){try{console.log(" Searching for notes shared with:",e);const t=Gt(yt(xe,this.SHARED_NOTES_COLLECTION),nn("shareType","==","private")),r=await Zt(t);console.log(" Found",r.docs.length,"private shared notes to check");const a=[];return r.forEach(o=>{const c=o.data();if(console.log(" Checking note:",o.id,"owned by:",c.ownerEmail,"collaborators:",c.collaborators),c.expiresAt&&new Date(c.expiresAt.toDate())<new Date){console.log(" Skipping expired note:",o.id),this.unshareNote(o.id);return}if(c.ownerEmail===e||c.ownerId===e){console.log(" Skipping own note:",o.id);return}const d=c.collaborators||[],f=d.some(p=>p.email===e||p.email?.toLowerCase()===e.toLowerCase());console.log(" Is",e,"a collaborator?",f),f&&(console.log(" Adding shared note for collaborator:",o.id),a.push({id:o.id,...c,ownerId:c.ownerId||c.ownerEmail||"",allowEditing:c.allowEditing??c.shareType==="private",collaborators:d,createdAt:c.createdAt.toDate(),expiresAt:c.expiresAt?c.expiresAt.toDate():void 0}))}),console.log(" Returning",a.length,"shared notes for",e),a}catch(t){throw console.error("Error getting notes shared with user:",t),new Error("Failed to get shared notes")}}static generateShareUrl(e){return`https://livenote-ruddy.vercel.app/share/${e}`}static async updateShareType(e,t){try{const r=rt(xe,this.SHARED_NOTES_COLLECTION,e);await wt(r,{shareType:t,allowEditing:t==="private"})}catch(r){throw console.error("Error updating share type:",r),new Error("Failed to update share type")}}static async updateEditPermission(e,t){try{const r=rt(xe,this.SHARED_NOTES_COLLECTION,e);await wt(r,{allowEditing:t}),console.log(` Edit permission updated to ${t?"allowed":"disabled"}`)}catch(r){throw console.error("Error updating edit permission:",r),new Error("Failed to update edit permission")}}static async joinCommunity(e,t){try{if(!e||!t||!t.email)throw new Error("Invalid share ID or user data");console.log(" Joining community:",{shareId:e,userEmail:t.email,role:t.role});const r=rt(xe,this.SHARED_NOTES_COLLECTION,e),a=await wr(r);if(!a.exists())throw new Error("Shared note not found");const o=a.data(),c=o.members||[];if(c.some(p=>p.email===t.email))return;const f={id:t.id,email:t.email,displayName:t.displayName,photoURL:t.photoURL||null,joinedAt:t.joinedAt||new Date,role:t.role};try{await wt(r,{members:uv(f),memberCount:(o.memberCount||0)+1,isCommunity:!0}),console.log(" Successfully joined community using arrayUnion")}catch(p){console.warn(" arrayUnion failed, trying manual array update:",p);const v=[...c,f];await wt(r,{members:v,memberCount:v.length,isCommunity:!0}),console.log(" Successfully joined community using manual array update")}}catch(r){throw console.error("Error joining community:",r),r instanceof Error?(console.error("Community join error details:",{name:r.name,message:r.message,shareId:e,userEmail:t.email}),r.message.includes("permission")?new Error("Permission denied: Cannot join community note"):r.message.includes("not-found")?new Error("Community note not found"):new Error(`Failed to join community: ${r.message}`)):new Error("Failed to join community note: Unknown error")}}static async leaveCommunity(e,t){try{const r=rt(xe,this.SHARED_NOTES_COLLECTION,e),a=await wr(r);if(!a.exists())throw new Error("Shared note not found");const o=a.data(),d=(o.members||[]).find(f=>f.email===t);d&&await wt(r,{members:dv(d),memberCount:Math.max(0,(o.memberCount||1)-1)})}catch(r){throw console.error("Error leaving community:",r),r instanceof Error?(console.error("Leave community error details:",{name:r.name,message:r.message,shareId:e,userEmail:t}),r.message.includes("permission")?new Error("Permission denied: Cannot leave community note"):r.message.includes("not-found")?new Error("Community note not found"):new Error(`Failed to leave community: ${r.message}`)):new Error("Failed to leave community note: Unknown error")}}static async getCommunityNote(e){try{const t=await this.getSharedNote(e);if(!t)return null;const r=rt(xe,this.SHARED_NOTES_COLLECTION,e),o=(await wr(r)).data();return{...t,isCommunity:o?.isCommunity||!1,members:o?.members||[],memberCount:o?.memberCount||0}}catch(t){throw console.error("Error getting community note:",t),new Error("Failed to get community note")}}static canAccessPrivateNote(e,t){return e.shareType==="public"?!0:!!t}static async addCollaborator(e,t,r="edit"){try{const a=t.trim().toLowerCase(),o=rt(xe,this.SHARED_NOTES_COLLECTION,e),c=await wr(o);if(!c.exists())throw new Error("Shared note not found");const d=c.data(),f=d.collaborators||[],p=f.findIndex(v=>v.email?.toLowerCase()===a);if(p>=0?(f[p].permission=r,console.log(" Updated existing collaborator permission:",a)):(f.push({id:a,email:t.trim(),displayName:t.split("@")[0],permission:r,joinedAt:new Date}),console.log(" Added new collaborator:",a)),await wt(o,{collaborators:f,allowEditing:!0}),p<0)try{const{default:v}=await kt(async()=>{const{default:E}=await Promise.resolve().then(()=>Lu);return{default:E}},void 0),b=t.split("@")[0];await v.createNotification({type:"member_joined",communityId:e,communityTitle:d.title||"Shared Note",message:`${b} joined the community`,actionBy:{name:b,email:t.trim()}})}catch(v){console.warn("Failed to create notification:",v)}console.log(' Collaborator added/updated successfully - note will appear in their "Shared with Me"')}catch(a){throw console.error("Error adding collaborator:",a),new Error("Failed to add collaborator")}}static async removeCollaborator(e,t){try{const r=t.toLowerCase(),a=rt(xe,this.SHARED_NOTES_COLLECTION,e),o=await wr(a);if(!o.exists())throw new Error("Shared note not found");const f=(o.data().collaborators||[]).filter(p=>p.email?.toLowerCase()!==r);await wt(a,{collaborators:f}),console.log(" Collaborator removed successfully")}catch(r){throw console.error("Error removing collaborator:",r),new Error("Failed to remove collaborator")}}static async leaveSharedNote(e,t){try{console.log(" User leaving shared note:",{shareId:e,userEmail:t}),await this.removeCollaborator(e,t),console.log(" Successfully left shared note")}catch(r){throw console.error("Error leaving shared note:",r),new Error("Failed to leave shared note")}}static async updateCollaboratorPermission(e,t,r){try{const a=rt(xe,this.SHARED_NOTES_COLLECTION,e),o=await wr(a);if(!o.exists())throw new Error("Shared note not found");const d=o.data().collaborators||[],f=d.findIndex(p=>p.email===t);if(f>=0)d[f].permission=r,await wt(a,{collaborators:d}),console.log(" Collaborator permission updated successfully");else throw new Error("Collaborator not found")}catch(a){throw console.error("Error updating collaborator permission:",a),new Error("Failed to update collaborator permission")}}static canEditSharedNote(e,t,r){if(!t&&!r)return!1;if(t&&(e.ownerEmail===t||e.ownerEmail?.toLowerCase()===t.toLowerCase())||r&&e.ownerId===r)return!0;if(e.shareType==="private"){if(e.allowEditing!==!0)return!1;if(t&&e.collaborators&&e.collaborators.length>0){const a=e.collaborators.find(o=>o.email===t||o.email?.toLowerCase()===t.toLowerCase());return a?a.permission==="edit"||a.permission==="admin":!1}return!0}return!1}static async getShareIdsForNote(e){try{const t=Gt(yt(xe,this.SHARED_NOTES_COLLECTION),nn("noteId","==",e));return(await Zt(t)).docs.map(a=>a.id)}catch(t){return console.error("Error getting shareIds for note:",t),[]}}static async syncNoteToShared(e,t){try{const r=await this.getShareIdsForNote(e);if(r.length===0)return;await Promise.all(r.map(async a=>{const o=rt(xe,this.SHARED_NOTES_COLLECTION,a);await wt(o,{title:t.title,description:t.description,color:t.color,lastEditedAt:Au()})})),console.log(` Synced note content to ${r.length} shared note(s)`)}catch(r){throw console.error("Error syncing note to shared:",r),new Error("Failed to sync note to shared notes")}}static async deleteAllSharedNotesForNote(e){try{const t=await this.getShareIdsForNote(e);if(t.length===0)return;await Promise.all(t.map(async r=>{await this.unshareNote(r)})),console.log(` Deleted ${t.length} shared note(s) for note ${e}`)}catch(t){throw console.error("Error deleting shared notes for note:",t),new Error("Failed to delete shared notes")}}static async updateSharedNoteContent(e,t){try{const r=rt(xe,this.SHARED_NOTES_COLLECTION,e),a=await wr(r);if(!a.exists())throw new Error("Shared note not found");const o=a.data(),c=o.noteId;await wt(r,{...t,lastEditedAt:Au()});const d=t.lastEditedByEmail||"",f=o.ownerEmail||"";if(t.lastEditedBy&&f&&d&&d.toLowerCase()!==f.toLowerCase()&&t.lastEditedBy!==o.ownerName)try{const{default:p}=await kt(async()=>{const{default:v}=await Promise.resolve().then(()=>Lu);return{default:v}},void 0);await p.createNotification({type:"note_edited",communityId:e,communityTitle:o.title||"Shared Note",message:`${t.lastEditedBy} edited "${o.title||"the note"}"`,actionBy:{name:t.lastEditedBy,email:d}})}catch(p){console.warn("Failed to create edit notification:",p)}if(console.log(" Shared note content updated successfully"),c)try{const p=rt(xe,"notes",c);if((await wr(p)).exists()){const b={};t.title!==void 0&&(b.title=t.title),t.description!==void 0&&(b.description=t.description),b.updatedAt=Au(),await wt(p,b),console.log(" Original note synced with shared note updates")}else console.warn(" Original note not found for sync:",c)}catch(p){console.error(" Failed to sync to original note (shared note still updated):",p)}}catch(r){throw console.error("Error updating shared note content:",r),new Error("Failed to update shared note content")}}}const Dr=Object.freeze(Object.defineProperty({__proto__:null,SharingService:Lt,default:Lt},Symbol.toStringTag,{value:"Module"})),i6=({note:n,isOpen:e,onClose:t})=>{const{user:r}=lr(),{updateSharingSettings:a}=cc(),[o,c]=V.useState("public"),[d,f]=V.useState(""),[p,v]=V.useState(!1),[b,E]=V.useState(!1),[S,R]=V.useState(""),[j,N]=V.useState(""),[I,te]=V.useState(!1),[X,de]=V.useState(!0),[ve,ge]=V.useState(!1);if(V.useEffect(()=>{if(e&&n.isShared&&n.shareId){c(n.shareType||"public");const M=Lt.generateShareUrl(n.shareId);f(M),Lt.getSharedNote(n.shareId).then(P=>{P&&de(P.allowEditing??P.shareType==="private")}).catch(P=>{console.warn("Failed to load shared note details:",P)})}else e&&(c("public"),f(""),E(!1),R(""),de(!0))},[e,n]),!e)return null;const D=async()=>{if(r)try{v(!0),R("");const M=await a(n.id,o),P=Lt.generateShareUrl(M.shareId);f(P),console.log(` Note sharing updated to ${o}:`,M.shareId)}catch(M){console.error("Error updating sharing settings:",M),M instanceof Error?M.message.includes("permission")?R("Permission denied. Please check your Firebase configuration."):M.message.includes("network")?R("Network error. Please check your internet connection."):M.message.includes("auth")?R("Authentication error. Please try logging in again."):R(`Error: ${M.message}`):R("Failed to update sharing settings. Please try again.")}finally{v(!1)}},C=async()=>{try{await navigator.clipboard.writeText(d),E(!0),setTimeout(()=>E(!1),2e3)}catch(M){console.error("Failed to copy:",M)}},O=async()=>{if(!(!j.trim()||!r||!n.shareId))try{te(!0),R(""),await Lt.addCollaborator(n.shareId,j.trim(),"edit"),N(""),console.log(" Collaborator added successfully");const M=S;R(" Collaborator added successfully!"),setTimeout(()=>R(M),3e3)}catch(M){console.error("Error adding collaborator:",M),M instanceof Error?R(M.message):R("Failed to add collaborator. Please try again.")}finally{te(!1)}},z=async()=>{if(!n.shareId||!r||r.id!==n.userId)return;const M=!X;try{ge(!0),R(""),await Lt.updateEditPermission(n.shareId,M),de(M),console.log(` Edit permission ${M?"enabled":"disabled"}`)}catch(P){console.error("Error updating edit permission:",P),P instanceof Error?R(P.message):R("Failed to update edit permission. Please try again.")}finally{ge(!1)}};return m.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:t,children:m.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-lg shadow-xl w-full max-w-md",onClick:M=>M.stopPropagation(),children:[m.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-600",children:[m.jsxs("h2",{className:"text-base font-medium text-gray-900 dark:text-white",children:['Share "',n.title||"Untitled",'"']}),m.jsx("button",{onClick:t,className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",children:m.jsx(or,{className:"h-4 w-4 text-gray-500"})})]}),m.jsxs("div",{className:"p-4 space-y-4",children:[m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Share with others"}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx("button",{onClick:async()=>{if(c("public"),d)try{v(!0),await a(n.id,"public"),console.log(" Updated existing link to public")}catch(M){console.error("Error updating to public:",M),R("Failed to update sharing mode")}finally{v(!1)}},disabled:p,className:`px-3 py-1 text-xs rounded-full transition-colors ${o==="public"?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"} ${p?"opacity-50 cursor-not-allowed":""}`,children:" Public"}),m.jsx("button",{onClick:async()=>{if(c("private"),d)try{v(!0),await a(n.id,"private"),console.log(" Updated existing link to private")}catch(M){console.error("Error updating to private:",M),R("Failed to update sharing mode")}finally{v(!1)}},disabled:p,className:`px-3 py-1 text-xs rounded-full transition-colors ${o==="private"?"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"} ${p?"opacity-50 cursor-not-allowed":""}`,children:" Private"})]})]}),m.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:p&&d?"Updating link permissions...":o==="public"?"Anyone with the link can view":o==="private"&&d?X?"Signed-in users can view and edit":"Signed-in users can view only":"Signed-in users can view and edit"})]}),o==="private"&&d&&m.jsxs("div",{className:"space-y-3 border-t pt-3 border-gray-200 dark:border-gray-600",children:[r?.id===n.userId&&m.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[m.jsxs("div",{className:"flex-1",children:[m.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:"Allow Editing"}),m.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Control whether others can edit this private note"})]}),m.jsx("button",{onClick:z,disabled:ve,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${X?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"} ${ve?"opacity-50 cursor-not-allowed":""}`,children:m.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${X?"translate-x-6":"translate-x-1"}`})})]}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Manage Access"}),m.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:r?.id===n.userId?"You are the owner":"Shared with you"})]}),m.jsxs("div",{className:"flex items-center space-x-3 p-2 bg-gray-50 dark:bg-gray-800 rounded",children:[m.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:r?.displayName?.charAt(0)||r?.email?.charAt(0)||"?"}),m.jsxs("div",{className:"flex-1",children:[m.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:r?.displayName||r?.email}),m.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:r?.id===n.userId?"Owner":"Can edit"})]}),r?.id===n.userId&&m.jsx("button",{className:"text-xs text-blue-600 hover:text-blue-700 dark:text-blue-400",children:"Manage"})]}),r?.id===n.userId&&m.jsxs("div",{className:"space-y-2",children:[m.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[" Tip: Your current email is ",m.jsx("span",{className:"font-mono bg-gray-100 dark:bg-gray-800 px-1 rounded",children:r?.email})]}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx("input",{type:"email",placeholder:"Add people by email...",value:j,onChange:M=>N(M.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-200 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500",onKeyDown:M=>{M.key==="Enter"&&O()}}),m.jsx("button",{onClick:O,disabled:!j.trim()||I,className:"px-3 py-2 text-sm bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white rounded transition-colors",children:I?"...":"Add"})]})]})]}),S&&m.jsx("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:m.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:S})}),d?m.jsxs("div",{className:"flex items-center space-x-2 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded p-3",children:[m.jsx("input",{type:"text",value:d,readOnly:!0,className:"flex-1 bg-transparent text-sm text-gray-700 dark:text-gray-300 outline-none"}),m.jsx("button",{onClick:C,className:"p-1 text-green-600 hover:bg-green-100 dark:hover:bg-green-900/30 rounded transition-colors",title:b?"Copied!":"Copy link",children:b?m.jsx(wv,{className:"h-4 w-4"}):m.jsx(zN,{className:"h-4 w-4"})})]}):m.jsxs("button",{onClick:D,disabled:p,className:"w-full px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white rounded-lg transition-colors flex items-center justify-center space-x-2",children:[m.jsx(Yi,{className:"h-4 w-4"}),m.jsx("span",{children:p?"Creating Link...":d?"Update Link":"Get Link"})]})]})]})})},s6={yellow:"bg-note-yellow border-yellow-300",blue:"bg-note-blue border-blue-300",green:"bg-note-green border-green-300",pink:"bg-note-pink border-pink-300",purple:"bg-note-purple border-purple-300",orange:"bg-note-orange border-orange-300"},a6=({note:n,onEdit:e,animationDelay:t=0})=>{const{updateNote:r,deleteNote:a,refreshCommunityData:o,leaveCommunity:c,refreshSharedNotes:d}=cc(),{user:f}=lr(),p=()=>f&&n.userId===f.id,[v,b]=V.useState(!1),[E,S]=V.useState(!1),[R,j]=V.useState(!1),[N,I]=V.useState(!1),[te,X]=V.useState(!1),[de,ve]=V.useState(!1),[ge,D]=V.useState(null),[C,O]=V.useState(!1),[z,M]=V.useState(""),[P,k]=V.useState(!1),Ne=V.useRef(null),Ze=V.useRef(null);V.useEffect(()=>{const W=me=>{v&&Ne.current&&!Ne.current.contains(me.target)&&(me.target.closest('button[title="More options"]')||b(!1))};if(v){const me=setTimeout(()=>{document.addEventListener("mousedown",W)},100);return()=>{clearTimeout(me),document.removeEventListener("mousedown",W)}}},[v]),V.useEffect(()=>{const W=me=>{de&&Ze.current&&!Ze.current.contains(me.target)&&ve(!1)};return de&&document.addEventListener("mousedown",W),()=>{document.removeEventListener("mousedown",W)}},[de]);const B=async()=>{try{await r(n.id,{isPinned:!n.isPinned})}catch(W){console.error("Error pinning note:",W)}},ue=async()=>{if(confirm("Are you sure you want to delete this note?"))try{S(!0),await a(n.id)}catch(W){console.error("Error deleting note:",W),S(!1)}},pe=async()=>{if(n.groupId&&f)try{const{default:W}=await kt(async()=>{const{default:Se}=await Promise.resolve().then(()=>xv);return{default:Se}},void 0);if(!await W.canEditGroupNotes(n.groupId,f.id,f.email||void 0)){alert('You do not have permission to edit notes in this group. Your permission is set to "view only".'),b(!1);return}}catch(W){console.error("Error checking edit permission:",W)}e(n),b(!1)},Re=async()=>{if(n.isCommunity)try{j(!0),await o(),console.log(" Community members refreshed for note:",n.title)}catch(W){console.error("Error refreshing community members:",W)}finally{j(!1),b(!1)}},Pe=async()=>{if(!(!n.isCommunity||!n.shareId)&&confirm(`Are you sure you want to leave the community and remove "${n.title}" from your notes?`))try{I(!0),await c(n.shareId,n.id),console.log(" Left community for note:",n.title)}catch(W){console.error("Error leaving community:",W),alert("Failed to leave community. Please try again.")}finally{I(!1),b(!1)}},q=(W,me=100)=>W.length<=me?W:W.slice(0,me)+"...";V.useEffect(()=>{n.isShared&&n.shareId&&f&&F()},[n.isShared,n.shareId,f]);const F=async()=>{if(n.shareId)try{O(!0);const W=await Lt.getSharedNote(n.shareId);W&&D(W)}catch(W){console.error("Error loading shared note data:",W)}finally{O(!1)}},L=()=>!f||!ge?!1:f.email&&(ge.ownerEmail===f.email||ge.ownerEmail?.toLowerCase()===f.email.toLowerCase())||f.id&&ge.ownerId===f.id,Q=async()=>{if(!(!z.trim()||!n.shareId||!L()))try{k(!0),await Lt.addCollaborator(n.shareId,z.trim(),"edit"),M(""),await F(),await d(),console.log(" Collaborator added successfully")}catch(W){console.error("Error adding collaborator:",W),alert(W instanceof Error?W.message:"Failed to add collaborator")}finally{k(!1)}},oe=async W=>{if(!(!n.shareId||!L())&&confirm(`Remove ${W} from this note?`))try{await Lt.removeCollaborator(n.shareId,W),await F(),await d(),console.log(" Collaborator removed successfully")}catch(me){console.error("Error removing collaborator:",me),alert("Failed to remove collaborator")}},se=async(W,me)=>{if(!(!n.shareId||!L()))try{await Lt.updateCollaboratorPermission(n.shareId,W,me),await F(),console.log(" Permission updated successfully")}catch(Se){console.error("Error updating permission:",Se),alert("Failed to update permission")}},$=typeof chrome<"u"&&chrome.runtime&&!window.location.protocol.startsWith("http");return m.jsxs("div",{className:`
        relative ${$?"p-2.5":"p-4"} rounded-lg border-2 transition-all duration-200 hover:shadow-md
        ${s6[n.color]}
        ${E?"opacity-50 pointer-events-none":""}
        animate-fade-in
      `,style:{animationDelay:`${t}s`},children:[m.jsxs("div",{className:`absolute ${$?"top-1.5 right-1.5":"top-2 right-2"} flex items-center ${$?"space-x-0.5":"space-x-1"}`,children:[m.jsx("button",{onClick:B,className:`${$?"p-1":"p-1.5"} hover:bg-white/50 dark:hover:bg-black/20 rounded-full transition-colors ${n.isPinned?"bg-white/30 dark:bg-black/10":""}`,title:n.isPinned?"Unpin note":"Pin note",children:m.jsx(Hl,{className:`${$?"h-3.5 w-3.5":"h-4 w-4"} text-gray-600 ${n.isPinned?"fill-current":""}`})}),m.jsx("button",{onClick:()=>b(!v),className:`${$?"p-1":"p-1.5"} hover:bg-white/50 dark:hover:bg-black/20 rounded-full transition-colors`,title:"More options",children:m.jsx(BN,{className:`${$?"h-3.5 w-3.5":"h-4 w-4"} text-gray-600`})}),v&&m.jsxs("div",{ref:Ne,className:`absolute right-0 ${$?"top-7":"top-8"} bg-white dark:bg-dark-card border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg z-10 ${$?"py-1.5":"py-2"} ${$?"min-w-[180px]":"min-w-[220px]"}`,children:[m.jsx("div",{className:`${$?"px-2 py-1.5":"px-3 py-2"} border-b border-gray-200 dark:border-gray-600`,children:m.jsxs("div",{className:`flex items-center ${$?"space-x-1.5":"space-x-2"} text-gray-700 dark:text-gray-300 text-left`,children:[m.jsx(Tv,{className:`${$?"h-3.5 w-3.5":"h-4 w-4"}`}),m.jsx("span",{className:`font-medium ${$?"text-xs":"text-sm"} text-left`,children:"Note Details"})]})}),m.jsxs("div",{className:`${$?"px-2 py-1.5":"px-3 py-2"}`,children:[m.jsxs("div",{className:`flex items-center ${$?"space-x-1.5":"space-x-2"} ${$?"mb-0.5":"mb-1"} text-gray-600 dark:text-gray-400 text-left`,children:[m.jsx(XL,{className:`${$?"h-3.5 w-3.5":"h-4 w-4"}`}),m.jsx("span",{className:`font-medium ${$?"text-xs":"text-sm"} text-left`,children:"Created:"})]}),m.jsxs("div",{className:`${$?"ml-5 text-xs":"ml-6 text-sm"} text-left text-gray-700 dark:text-gray-300`,children:[new Date(n.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"2-digit"}).replace(",","-")," ",new Date(n.createdAt).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}).toLowerCase()]})]}),m.jsxs("div",{className:`${$?"px-2 py-1.5":"px-3 py-2"}`,children:[m.jsxs("div",{className:`flex items-center ${$?"space-x-1.5":"space-x-2"} ${$?"mb-0.5":"mb-1"} text-gray-600 dark:text-gray-400 text-left`,children:[m.jsx(n3,{className:`${$?"h-3.5 w-3.5":"h-4 w-4"}`}),m.jsx("span",{className:`font-medium ${$?"text-xs":"text-sm"} text-left`,children:"Updated:"})]}),m.jsxs("div",{className:`${$?"ml-5 text-xs":"ml-6 text-sm"} text-left text-gray-700 dark:text-gray-300`,children:[new Date(n.updatedAt).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"2-digit"}).replace(",","-")," ",new Date(n.updatedAt).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}).toLowerCase()]})]}),m.jsx("div",{className:`${$?"px-2 py-1.5":"px-3 py-2"} border-b border-gray-200 dark:border-gray-600`,children:m.jsxs("div",{className:`flex items-center justify-between ${$?"text-xs":"text-sm"} text-gray-600 dark:text-gray-400`,children:[m.jsxs("span",{children:["Characters: ",(n.title+(n.description||"")).length]}),m.jsxs("span",{children:["Words: ",(n.title+" "+(n.description||"")).trim().split(/\s+/).length]})]})}),n.isCommunity&&m.jsxs("div",{className:`${$?"px-2 py-1.5":"px-3 py-2"} border-b border-gray-200 dark:border-gray-600`,children:[m.jsxs("div",{className:`flex items-center justify-between ${$?"mb-1.5":"mb-2"}`,children:[m.jsxs("div",{className:`flex items-center ${$?"space-x-1.5":"space-x-2"} text-gray-600 dark:text-gray-400`,children:[m.jsx(Tn,{className:`${$?"h-3.5 w-3.5":"h-4 w-4"}`}),m.jsx("span",{className:`font-medium ${$?"text-xs":"text-sm"}`,children:"Community Note"})]}),m.jsxs("button",{onClick:Re,disabled:R,className:`${$?"px-1.5 py-0.5 text-[10px]":"px-2 py-1 text-xs"} bg-blue-100 hover:bg-blue-200 dark:bg-blue-900/30 dark:hover:bg-blue-800/40 text-blue-700 dark:text-blue-300 rounded transition-colors disabled:opacity-50 flex items-center ${$?"space-x-0.5":"space-x-1"}`,title:"Refresh community members",children:[m.jsx(P3,{className:`${$?"h-2.5 w-2.5":"h-3 w-3"} ${R?"animate-spin":""}`}),m.jsx("span",{children:"Refresh"})]})]}),m.jsxs("div",{className:`${$?"ml-5 text-xs":"ml-6 text-sm"} text-gray-700 dark:text-gray-300`,children:[n.memberCount||0," member",(n.memberCount||0)!==1?"s":"",n.communityMembers&&n.communityMembers.length>0&&m.jsxs("div",{className:`${$?"mt-0.5 text-[10px]":"mt-1 text-xs"} text-gray-500 dark:text-gray-400`,children:["Latest: ",n.communityMembers.slice(0,3).map(W=>W.displayName.split(" ")[0]).join(", ")]})]}),m.jsx("div",{className:`${$?"mt-2 pt-2":"mt-3 pt-3"} border-t border-gray-200 dark:border-gray-600`,children:m.jsxs("button",{onClick:Pe,disabled:N,className:`w-full ${$?"px-2 py-1.5":"px-3 py-2"} text-left hover:bg-orange-50 dark:hover:bg-orange-900/20 flex items-center text-orange-600 dark:text-orange-400 transition-colors disabled:opacity-50 rounded`,children:[m.jsx(JN,{className:`${$?"h-3.5 w-3.5 mr-2":"h-4 w-4 mr-3"}`}),m.jsx("span",{className:`${$?"text-xs":"text-sm"} font-medium`,children:N?"Leaving...":"Leave Community"})]})})]}),p()&&m.jsxs("button",{onClick:ue,className:`w-full ${$?"px-2 py-2":"px-3 py-3"} text-left hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center text-red-600 transition-colors`,children:[m.jsx(XN,{className:`${$?"h-3.5 w-3.5 mr-2":"h-4 w-4 mr-3"}`}),m.jsx("span",{className:`${$?"text-xs":"text-sm"} font-medium`,children:"Delete Note"})]})]})]}),m.jsxs("div",{className:`${$?"pr-16":"pr-20"} cursor-pointer text-left`,onClick:pe,children:[m.jsx("h3",{className:`${$?"text-sm":"text-base"} font-semibold text-gray-800 dark:text-gray-900 ${$?"mb-1":"mb-2"} leading-tight text-left`,children:n.title||"Untitled"}),n.description&&m.jsx("p",{className:`text-gray-700 dark:text-gray-800 ${$?"text-xs mb-2":"text-sm mb-3"} leading-relaxed text-left`,children:q(n.description,$?80:100)}),m.jsxs("div",{className:`flex items-center justify-between ${$?"gap-1 text-[10px]":"gap-2 text-xs"} text-gray-600 dark:text-gray-700`,children:[m.jsx("span",{className:"text-left",children:new Date(n.updatedAt).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"})}),m.jsxs("div",{className:`flex items-center flex-wrap ${$?"gap-1":"gap-2"} justify-end`,children:[n.isCommunity&&n.memberCount&&m.jsxs("div",{className:"flex items-center space-x-1 bg-blue-100 dark:bg-blue-900/20 px-2 py-1 rounded-full",children:[m.jsx(Tn,{className:"h-3 w-3 text-blue-600"}),m.jsx("span",{className:"font-medium text-blue-600 text-left",children:n.memberCount})]}),n.isCommunity&&n.communityMembers&&n.communityMembers.length>0&&m.jsx(e1,{members:n.communityMembers}),n.visibility&&n.visibility!=="private"&&m.jsx("div",{className:`flex items-center space-x-1 px-2 py-1 rounded-full text-xs text-left ${n.visibility==="public"?"bg-green-100 dark:bg-green-900/20 text-green-700 dark:text-green-400":n.visibility==="community"?"bg-purple-100 dark:bg-purple-900/20 text-purple-700 dark:text-purple-400":""}`,children:n.visibility==="public"?m.jsxs(m.Fragment,{children:[m.jsx(km,{className:"h-3 w-3"}),m.jsx("span",{className:"text-left",children:"Public"})]}):n.visibility==="community"?m.jsxs(m.Fragment,{children:[m.jsx(Tn,{className:"h-3 w-3"}),m.jsx("span",{className:"text-left",children:"Community"})]}):null}),(n.isShared||n.isCommunity)&&m.jsxs("div",{className:"flex items-center space-x-1 bg-blue-100 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400 px-2 py-1 rounded-full text-xs",children:[m.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full animate-pulse mr-1"}),m.jsx(Yi,{className:"h-3 w-3"}),m.jsx("span",{className:"text-left",children:n.isCommunity?"Community":"Shared"})]}),n.isShared&&(n.shareType==="private"||ge?.shareType==="private")&&ge&&m.jsx(m.Fragment,{children:ge.collaborators&&ge.collaborators.length>0&&m.jsxs("button",{onClick:W=>{W.stopPropagation(),ve(!0)},className:"flex items-center space-x-1 bg-purple-100 dark:bg-purple-900/20 text-purple-700 dark:text-purple-400 px-2 py-1 rounded-full text-xs hover:bg-purple-200 dark:hover:bg-purple-800/30 transition-colors text-left",title:"Manage collaborators",children:[m.jsx(Tn,{className:"h-3 w-3"}),m.jsxs("span",{className:"text-left",children:["Collaborators(",ge.collaborators.length,")"]}),L()&&m.jsx(Wf,{className:"h-3 w-3 ml-1"})]})}),n.isPinned&&m.jsxs("div",{className:"flex items-center space-x-1 bg-yellow-100 dark:bg-yellow-900/20 text-yellow-700 dark:text-yellow-400 px-2 py-1 rounded-full text-xs",children:[m.jsx(Hl,{className:"h-3 w-3"}),m.jsx("span",{className:"text-left",children:"Pinned"})]})]})]})]}),de&&m.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:()=>ve(!1),children:m.jsxs("div",{ref:Ze,className:"bg-white dark:bg-dark-card rounded-lg shadow-xl w-full max-w-md max-h-[80vh] overflow-hidden flex flex-col",onClick:W=>W.stopPropagation(),children:[m.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-600",children:[m.jsxs("div",{className:"flex items-center space-x-2 text-left",children:[m.jsx(Tn,{className:"h-5 w-5 text-purple-600 dark:text-purple-400"}),m.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white text-left",children:"Manage Collaborators"}),ge?.collaborators&&m.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 text-left",children:["(",ge.collaborators.length,")"]})]}),m.jsx("button",{onClick:()=>ve(!1),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",children:m.jsx(or,{className:"h-5 w-5 text-gray-500"})})]}),m.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:C?m.jsx("div",{className:"text-left py-8 text-sm text-gray-500 dark:text-gray-400",children:"Loading collaborators..."}):m.jsxs(m.Fragment,{children:[ge&&m.jsx("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:ge.ownerName?.charAt(0)||ge.ownerEmail?.charAt(0)||"O"}),m.jsxs("div",{className:"text-left",children:[m.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white text-left",children:ge.ownerName||ge.ownerEmail}),m.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-left",children:"Owner"})]})]})}),ge?.collaborators&&ge.collaborators.length>0?ge.collaborators.map((W,me)=>m.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800/50 rounded-lg",children:[m.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[m.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:W.displayName?.charAt(0)||W.email?.charAt(0)||"C"}),m.jsxs("div",{className:"flex-1 text-left",children:[m.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white text-left",children:W.displayName||W.email}),m.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-left",children:W.email})]})]}),L()&&m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsxs("select",{value:W.permission||"edit",onChange:Se=>se(W.email,Se.target.value),className:"text-xs px-2 py-1.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 text-left",children:[m.jsx("option",{value:"view",children:"View"}),m.jsx("option",{value:"edit",children:"Edit"})]}),m.jsx("button",{onClick:()=>oe(W.email),className:"p-1.5 hover:bg-red-100 dark:hover:bg-red-900/20 rounded transition-colors",title:"Remove collaborator",children:m.jsx(or,{className:"h-4 w-4 text-red-600 dark:text-red-400"})})]})]},W.email||me)):m.jsx("div",{className:"text-left py-8 text-sm text-gray-500 dark:text-gray-400",children:"No collaborators yet"}),L()&&m.jsx("div",{className:"pt-3 border-t border-gray-200 dark:border-gray-700",children:m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx("input",{type:"email",placeholder:"Add collaborator by email...",value:z,onChange:W=>M(W.target.value),onKeyDown:W=>{W.key==="Enter"&&Q()},className:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 text-left"}),m.jsxs("button",{onClick:Q,disabled:!z.trim()||P,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white rounded-lg transition-colors flex items-center space-x-2",children:[m.jsx(ZN,{className:"h-4 w-4"}),m.jsx("span",{children:P?"...":"Add"})]})]})})]})})]})}),te&&m.jsx(i6,{note:n,isOpen:te,onClose:()=>X(!1)})]})},o6=({notes:n,onEditNote:e})=>m.jsx("div",{className:"grid grid-cols-1 gap-3",children:n.map((t,r)=>m.jsx(a6,{note:t,onEdit:e,animationDelay:r*.05},t.id))}),l6={yellow:"bg-note-yellow border-yellow-300",blue:"bg-note-blue border-blue-300",green:"bg-note-green border-green-300",pink:"bg-note-pink border-pink-300",purple:"bg-note-purple border-purple-300",orange:"bg-note-orange border-orange-300"},c6=({sharedNote:n,animationDelay:e=0})=>{const t=(a,o=100)=>a.length<=o?a:a.slice(0,o)+"...",r=()=>{const a=`${window.location.origin}/share/${n.shareId}`;window.location.href=a};return m.jsxs("div",{className:`
        relative p-4 rounded-lg border-2 transition-all duration-200 hover:shadow-md cursor-pointer
        ${l6[n.color]}
        animate-fade-in
      `,style:{animationDelay:`${e}s`},onClick:r,children:[m.jsxs("div",{className:"flex items-start justify-between mb-3",children:[m.jsx("div",{className:"flex-1",children:m.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[n.shareType==="public"?m.jsx(Ev,{className:"h-4 w-4 text-green-600"}):m.jsx(ta,{className:"h-4 w-4 text-blue-600"}),m.jsxs("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:[n.shareType==="public"?"Public":"Private","  by ",n.ownerName]})]})}),m.jsx("button",{onClick:a=>{a.stopPropagation(),r()},className:"p-1.5 hover:bg-white/50 dark:hover:bg-black/20 rounded-full transition-colors",title:"Open shared note",children:m.jsx(xd,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-800 leading-tight",children:n.title||"Untitled"}),n.description&&m.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-700 leading-relaxed",children:t(n.description)})]}),m.jsx("div",{className:"mt-3 pt-3 border-t border-gray-300 dark:border-gray-600",children:m.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600 dark:text-gray-500",children:[m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsxs("span",{children:["Shared ",new Date(n.createdAt).toLocaleDateString()]}),n.collaborators&&n.collaborators.length>0&&m.jsxs("div",{className:"flex items-center space-x-1",children:[m.jsx(Tn,{className:"h-3 w-3"}),m.jsxs("span",{children:[n.collaborators.length+1," collaborators"]})]})]}),m.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-blue-50 dark:bg-blue-900/20 rounded-full",children:[m.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full animate-pulse"}),m.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:"Live"})]})]})})]})},u6=[{value:"yellow",label:"Yellow",bg:"bg-note-yellow"},{value:"blue",label:"Blue",bg:"bg-note-blue"},{value:"green",label:"Green",bg:"bg-note-green"},{value:"pink",label:"Pink",bg:"bg-note-pink"},{value:"purple",label:"Purple",bg:"bg-note-purple"},{value:"orange",label:"Orange",bg:"bg-note-orange"}],d6=({note:n,onClose:e})=>{const{createNote:t,updateNote:r,selectedGroupId:a}=cc(),{user:o}=lr(),[c,d]=V.useState(""),[f,p]=V.useState(""),[v,b]=V.useState("yellow"),[E,S]=V.useState(!1),[R,j]=V.useState(!1),[N,I]=V.useState(!1),[te,X]=V.useState(null),de=!!n;V.useEffect(()=>{n?(d(n.title),p(n.description),b(n.color),S(n.isPinned),X(n.groupId||null)):(d(""),p(""),b("yellow"),S(!1),X(a))},[n,a]);const ve=async()=>{if(!c.trim()&&!f.trim()){e();return}try{if(j(!0),de&&n){if(n.groupId&&o)try{const{default:C}=await kt(async()=>{const{default:z}=await Promise.resolve().then(()=>xv);return{default:z}},void 0);if(!await C.canEditGroupNotes(n.groupId,o.id,o.email||void 0)){alert('You do not have permission to edit notes in this group. Your permission is set to "view only".'),j(!1);return}}catch(C){console.error("Error checking edit permission:",C)}console.log(" Updating note:",{noteId:n.id,updates:{title:c.trim(),description:f.trim(),color:v,isPinned:E}});const D={title:c.trim(),description:f.trim(),color:v,isPinned:E};await r(n.id,D),console.log(" Note updated successfully")}else{console.log(" Creating new note:",{title:c.trim(),description:f.trim(),color:v,isPinned:E,groupId:te});const D={title:c.trim(),description:f.trim(),color:v,isPinned:E,groupId:te||void 0};await t(D),console.log(" Note created successfully")}e()}catch(D){console.error(" Error saving note:",D),alert(`Failed to ${de?"update":"create"} note. Please try again.`)}finally{j(!1)}},ge=D=>{D.key==="Escape"?e():D.key==="Enter"&&(D.metaKey||D.ctrlKey)&&ve()};return m.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e,children:m.jsxs("div",{className:"w-full max-w-md bg-white dark:bg-dark-card rounded-lg shadow-xl animate-scale-in",onKeyDown:ge,onClick:D=>D.stopPropagation(),children:[m.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-600",children:[m.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white text-left",children:de?"Edit Note":"New Note"}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx("button",{onClick:()=>S(!E),className:`p-2 rounded-lg transition-colors ${E?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}`,title:E?"Unpin note":"Pin note",children:m.jsx(Hl,{className:"h-4 w-4"})}),m.jsxs("div",{className:"relative",children:[m.jsx("button",{onClick:()=>I(!N),className:"p-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",title:"Change color",children:m.jsx(HN,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})}),N&&m.jsx("div",{className:"absolute right-0 top-12 bg-white dark:bg-dark-card border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg p-2 z-10",children:m.jsx("div",{className:"grid grid-cols-3 gap-2",children:u6.map(D=>m.jsx("button",{onClick:()=>{b(D.value),I(!1)},className:`w-8 h-8 rounded-lg border-2 transition-transform hover:scale-110 ${D.bg} ${v===D.value?"border-gray-800 dark:border-white":"border-gray-300 dark:border-gray-600"}`,title:D.label},D.value))})})]}),m.jsx("button",{onClick:e,className:"p-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:m.jsx(or,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})})]})]}),m.jsxs("div",{className:"p-4 space-y-4",children:[m.jsx("input",{type:"text",placeholder:"Note title...",value:c,onChange:D=>d(D.target.value),className:"w-full text-lg font-semibold bg-transparent text-gray-800 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 border-none outline-none resize-none text-left",autoFocus:!0}),m.jsx("textarea",{placeholder:"Write your note here...",value:f,onChange:D=>p(D.target.value),rows:4,className:"w-full bg-transparent text-gray-700 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400 border-none outline-none resize-none text-left"}),de&&n&&(n.isShared||n.isCommunity)&&m.jsxs("div",{className:"flex items-center justify-between text-sm p-2",children:[m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),m.jsx("span",{className:"text-gray-600 dark:text-gray-300 text-left",children:n.isCommunity?`Community (${n.memberCount||0} members)`:"Shared"})]}),n.isShared&&m.jsx("button",{onClick:()=>{const D=`${window.location.origin}/share/${n.shareId}`;navigator.clipboard.writeText(D),alert("Link copied!")},className:"px-2 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded text-xs transition-colors",children:"Copy"})]})]}),m.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-800/50 rounded-b-lg",children:[m.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-left",children:de?"Press Cmd+Enter to save":"Press Cmd+Enter to create"}),m.jsxs("button",{onClick:ve,disabled:R,className:"flex items-center px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white rounded-lg font-medium transition-colors",children:[R?m.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):m.jsx(Iv,{className:"h-4 w-4 mr-2"}),de?"Save":"Create"]})]})]})})},h6=({onMenuClick:n,showMenuButton:e=!1})=>{const{searchQuery:t,setSearchQuery:r}=cc(),a=typeof chrome<"u"&&chrome.runtime&&!window.location.protocol.startsWith("http"),o=()=>{r("")};return m.jsx("div",{className:"relative",children:m.jsxs("div",{className:"relative flex items-center",children:[a&&e&&n&&m.jsx("button",{onClick:n,className:`${a?"mr-1.5 p-1":"mr-2 p-1.5"} flex-shrink-0 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors`,title:"Toggle groups",children:m.jsx("svg",{className:`${a?"h-3.5 w-3.5":"h-4 w-4"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),m.jsxs("div",{className:"relative flex-1",children:[m.jsx(QN,{className:`absolute ${a?"left-1.5 top-1/2 h-3 w-3":"left-3 top-1/2 h-4 w-4"} transform -translate-y-1/2 text-gray-400`}),m.jsx("input",{type:"text",placeholder:"Search notes...",value:t,onChange:c=>r(c.target.value),className:`w-full ${a?"pl-7 pr-7 py-1 text-xs":"pl-10 pr-10 py-2 text-sm"} border border-gray-200 dark:border-gray-600 rounded-lg bg-white dark:bg-dark-card text-gray-800 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent`}),t&&m.jsx("button",{onClick:o,className:`absolute ${a?"right-1.5 top-1/2":"right-3 top-1/2"} transform -translate-y-1/2 p-0.5 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-full transition-colors`,children:m.jsx(or,{className:`${a?"h-2.5 w-2.5":"h-3.5 w-3.5"} text-gray-400`})})]})]})})},uT={all:{bg:"bg-gray-100 dark:bg-gray-700",border:"border-gray-300 dark:border-gray-600",label:"All"},yellow:{bg:"bg-note-yellow",border:"border-yellow-300",label:"Yellow"},blue:{bg:"bg-note-blue",border:"border-blue-300",label:"Blue"},green:{bg:"bg-note-green",border:"border-green-300",label:"Green"},pink:{bg:"bg-note-pink",border:"border-pink-300",label:"Pink"},purple:{bg:"bg-note-purple",border:"border-purple-300",label:"Purple"},orange:{bg:"bg-note-orange",border:"border-orange-300",label:"Orange"}},f6=()=>{const{filterColor:n,setFilterColor:e}=cc(),t=typeof chrome<"u"&&chrome.runtime&&!window.location.protocol.startsWith("http");return m.jsxs("div",{className:"flex items-center space-x-1.5 overflow-x-auto pb-1",children:[m.jsx("span",{className:`${t?"text-[10px]":"text-xs"} text-gray-500 dark:text-gray-400 whitespace-nowrap mr-1`,children:"Filter:"}),Object.keys(uT).map(r=>{const a=uT[r],o=n===r;return m.jsx("button",{onClick:()=>e(r),className:`
              ${t?"px-2 py-0.5 text-[10px]":"px-3 py-1 text-xs"} rounded-full font-semibold whitespace-nowrap transition-all
              ${o?`${a.bg} ${a.border} border-2 text-gray-800 dark:text-gray-200`:"bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700"}
            `,children:a.label},r)})]})},m6=({onClose:n})=>{const{user:e,signOut:t}=lr(),{isDarkMode:r,toggleTheme:a}=bv(),o=async()=>{try{await t(),n()}catch(c){console.error("Error signing out:",c)}};return m.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:m.jsxs("div",{className:"w-full max-w-md bg-white dark:bg-dark-card rounded-lg shadow-xl animate-scale-in",children:[m.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-600",children:[m.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:"Settings"}),m.jsx("button",{onClick:n,className:"p-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:m.jsx(or,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})})]}),m.jsxs("div",{className:"p-4 space-y-4",children:[m.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[m.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center overflow-hidden",children:wl(e?.photoURL)?m.jsx("img",{src:wl(e?.photoURL),alt:"Profile",className:"w-12 h-12 rounded-full object-cover",onError:c=>{c.currentTarget.style.display="none",c.currentTarget.parentElement.innerHTML=`<span class="text-white text-sm font-medium">${Mu(e?.displayName)}</span>`}}):m.jsx("span",{className:"text-white text-sm font-medium",children:Mu(e?.displayName)})}),m.jsxs("div",{className:"flex-1",children:[m.jsx("h3",{className:"font-medium text-gray-800 dark:text-white",children:e?.displayName||"Anonymous User"}),m.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e?.email})]})]}),m.jsxs("div",{className:"flex items-center justify-between p-3 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg transition-colors",children:[m.jsxs("div",{className:"flex items-center space-x-3",children:[r?m.jsx($N,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"}):m.jsx(WN,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"}),m.jsx("span",{className:"text-gray-800 dark:text-white",children:r?"Dark Mode":"Light Mode"})]}),m.jsx("button",{onClick:a,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${r?"bg-blue-500":"bg-gray-300"}`,children:m.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${r?"translate-x-6":"translate-x-1"}`})})]}),!window.location.protocol.startsWith("http")&&m.jsxs("button",{onClick:()=>window.open("https://livenote-ruddy.vercel.app","_blank"),className:"w-full flex items-center space-x-3 p-3 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg transition-colors text-left",children:[m.jsx(xd,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"}),m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-800 dark:text-white",children:"Web Version"}),m.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Open Google Notes in browser"})]})]}),m.jsxs("button",{className:"w-full flex items-center space-x-3 p-3 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg transition-colors text-left",children:[m.jsx(Tv,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"}),m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-800 dark:text-white",children:"About"}),m.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Google Notes Extension v1.0.0"})]})]}),m.jsxs("button",{className:"w-full flex items-center space-x-3 p-3 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-lg transition-colors text-left",children:[m.jsx(GN,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"}),m.jsxs("div",{children:[m.jsx("span",{className:"text-gray-800 dark:text-white",children:"Source Code"}),m.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"View on GitHub"})]})]})]}),m.jsxs("div",{className:"p-4 border-t border-gray-200 dark:border-gray-600 space-y-3",children:[e?.isGuest&&m.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsx("p",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:"Sign in to sync your notes"}),m.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-300 mt-1",children:"Your notes are currently saved locally only"})]}),m.jsx("button",{onClick:()=>{o()},className:"px-3 py-1.5 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-md font-medium transition-colors",children:"Sign In"})]})}),m.jsxs("button",{onClick:o,className:"w-full flex items-center justify-center space-x-2 px-4 py-3 bg-red-500 hover:bg-red-600 text-white rounded-lg font-medium transition-colors",children:[m.jsx(Dm,{className:"h-4 w-4"}),m.jsx("span",{children:e?.isGuest?"Exit Guest Mode":"Sign Out"})]})]})]})})},g6=({groups:n,selectedGroupId:e,onSelectGroup:t,onEditGroup:r,onDeleteGroup:a,onShareGroup:o,onTogglePin:c,onLeaveGroup:d})=>{const{user:f}=lr(),p=N=>{if(!f)return!1;if(N.ownerId&&f.id&&String(N.ownerId)===String(f.id))return!0;if(N.ownerEmail&&f.email){const I=N.ownerEmail.toLowerCase().trim(),te=f.email.toLowerCase().trim();if(I===te)return!0}return!1},v=N=>!f||!f.email||p(N)?!1:N.collaborators&&N.collaborators.length>0?N.collaborators.some(I=>I.email?.toLowerCase()===f.email?.toLowerCase()):N.isShared&&!p(N),b=[...n].sort((N,I)=>N.isPinned&&!I.isPinned?-1:!N.isPinned&&I.isPinned?1:N.name.localeCompare(I.name)),[E,S]=V.useState(null),R=Yx.useRef(null);Yx.useEffect(()=>{const N=I=>{E&&R.current&&!R.current.contains(I.target)&&S(null)};if(E)return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[E]);const j=typeof chrome<"u"&&chrome.runtime&&!window.location.protocol.startsWith("http");return m.jsxs("div",{className:"space-y-1.5",children:[m.jsx("button",{onClick:()=>t(null),className:`w-full flex items-center justify-between ${j?"p-2":"p-3"} rounded-lg transition-colors text-left ${e===null?"bg-blue-100 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400":"bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:m.jsxs("div",{className:"flex items-center space-x-2 min-w-0",children:[m.jsx(ay,{className:`${j?"h-3.5 w-3.5":"h-4 w-4"} shrink-0`}),m.jsx("span",{className:`${j?"text-xs":"text-sm"} font-semibold truncate`,children:"All Notes"})]})}),b.map(N=>m.jsxs("div",{className:`relative flex items-center gap-1.5 ${j?"p-2":"p-3"} rounded-lg transition-colors ${e===N.id?"bg-blue-100 dark:bg-blue-900/20 text-blue-700 dark:text-blue-400":"bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300"}`,children:[m.jsxs("button",{onClick:()=>t(N.id),className:"flex-1 flex items-start space-x-1.5 text-left min-w-0",children:[e===N.id?m.jsx(m3,{className:`${j?"h-3.5 w-3.5":"h-4 w-4"} shrink-0`}):m.jsx(ay,{className:`${j?"h-3.5 w-3.5":"h-4 w-4"} shrink-0`}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsxs("div",{className:`${j?"text-xs":"text-sm"} font-semibold truncate flex items-center space-x-1`,children:[N.isPinned&&m.jsx(Hl,{className:`${j?"h-2.5 w-2.5":"h-3 w-3"} text-blue-500 flex-shrink-0`}),m.jsx("span",{className:"truncate",children:N.name})]}),m.jsxs("div",{className:`${j?"text-[10px]":"text-xs"} opacity-75 flex items-center space-x-1.5 mt-0.5 flex-wrap`,children:[m.jsxs("span",{className:"flex items-center space-x-0.5",children:[m.jsx(ay,{className:`${j?"h-2.5 w-2.5":"h-3 w-3"}`}),m.jsx("span",{children:N.noteCount||0})]}),N.isShared&&N.collaborators&&N.collaborators.length>0&&m.jsxs("span",{className:"flex items-center space-x-0.5",children:[m.jsx(Tn,{className:`${j?"h-2.5 w-2.5":"h-3 w-3"}`}),m.jsx("span",{children:N.collaborators.length})]}),N.isShared&&(!N.collaborators||N.collaborators.length===0)&&!p(N)&&m.jsxs("span",{className:"flex items-center space-x-0.5",children:[m.jsx(Yi,{className:`${j?"h-2.5 w-2.5":"h-3 w-3"}`}),m.jsx("span",{className:"truncate",children:"Shared"})]})]})]})]}),p(N)&&m.jsx("button",{onClick:I=>{I.stopPropagation(),o(N)},className:`${j?"p-1":"p-1.5"} hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded transition-colors text-blue-600 dark:text-blue-400 shrink-0`,title:"Share group",children:m.jsx(Yi,{className:`${j?"h-3.5 w-3.5":"h-4 w-4"}`})}),m.jsxs("div",{className:"relative shrink-0",ref:R,children:[m.jsx("button",{onClick:I=>{I.stopPropagation(),S(E===N.id?null:N.id)},className:`${j?"p-0.5":"p-1"} hover:bg-gray-300 dark:hover:bg-gray-600 rounded transition-colors`,children:m.jsx(BN,{className:`${j?"h-3.5 w-3.5":"h-4 w-4"}`})}),E===N.id&&m.jsxs("div",{className:"absolute right-0 top-8 bg-white dark:bg-dark-card border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg z-10 min-w-[160px]",children:[m.jsx("button",{onClick:I=>{I.stopPropagation(),c(N.id),S(null)},className:"w-full flex items-center space-x-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-left text-sm",children:N.isPinned?m.jsxs(m.Fragment,{children:[m.jsx(k3,{className:"h-4 w-4"}),m.jsx("span",{children:"Unpin"})]}):m.jsxs(m.Fragment,{children:[m.jsx(Hl,{className:"h-4 w-4"}),m.jsx("span",{children:"Pin"})]})}),p(N)&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"border-t border-gray-200 dark:border-gray-600"}),m.jsxs("button",{onClick:I=>{I.stopPropagation(),r(N),S(null)},className:"w-full flex items-center space-x-2 px-3 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 text-left text-sm",children:[m.jsx(A3,{className:"h-4 w-4"}),m.jsx("span",{children:"Edit"})]}),m.jsx("div",{className:"border-t border-gray-200 dark:border-gray-600"}),m.jsxs("button",{onClick:I=>{I.stopPropagation(),confirm(`Are you sure you want to delete "${N.name}"? This will remove all notes from the group but won't delete the notes themselves.`)&&a(N.id),S(null)},className:"w-full flex items-center space-x-2 px-3 py-2 hover:bg-red-100 dark:hover:bg-red-900/20 text-red-600 dark:text-red-400 text-left text-sm",children:[m.jsx(XN,{className:"h-4 w-4"}),m.jsx("span",{children:"Delete"})]})]}),v(N)&&m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"border-t border-gray-200 dark:border-gray-600"}),m.jsxs("button",{onClick:I=>{I.stopPropagation(),confirm(`Are you sure you want to leave "${N.name}"? You will no longer have access to this group.`)&&d(N.id),S(null)},className:"w-full flex items-center space-x-2 px-3 py-2 hover:bg-orange-100 dark:hover:bg-orange-900/20 text-orange-600 dark:text-orange-400 text-left text-sm",children:[m.jsx(Dm,{className:"h-4 w-4"}),m.jsx("span",{children:"Leave"})]})]})]})]})]},N.id))]})},p6=({group:n,onClose:e,onCreateGroup:t,onUpdateGroup:r})=>{const[a,o]=V.useState(""),[c,d]=V.useState(""),[f,p]=V.useState(!1),v=!!n;V.useEffect(()=>{n?(o(n.name),d(n.description||"")):(o(""),d(""))},[n]);const b=async()=>{if(!a.trim()){alert("Please enter a group name");return}try{p(!0),v&&n&&r?await r(n.id,{name:a.trim(),description:c.trim()}):await t({name:a.trim(),description:c.trim()}),e()}catch(S){console.error("Error saving group:",S),alert(`Failed to ${v?"update":"create"} group. Please try again.`)}finally{p(!1)}},E=S=>{S.key==="Escape"?e():S.key==="Enter"&&(S.metaKey||S.ctrlKey)&&b()};return m.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e,children:m.jsxs("div",{className:"w-full max-w-md bg-white dark:bg-dark-card rounded-lg shadow-xl animate-scale-in",onKeyDown:E,onClick:S=>S.stopPropagation(),children:[m.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-600",children:[m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(qN,{className:"h-5 w-5 text-blue-500"}),m.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white text-left",children:v?"Edit Group":"New Group"})]}),m.jsx("button",{onClick:e,className:"p-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:m.jsx(or,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})})]}),m.jsxs("div",{className:"p-4 space-y-4",children:[m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 text-left",children:"Group Name *"}),m.jsx("input",{type:"text",placeholder:"Enter group name...",value:a,onChange:S=>o(S.target.value),className:"w-full px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-800 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 text-left",autoFocus:!0})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 text-left",children:"Description (Optional)"}),m.jsx("textarea",{placeholder:"Enter group description...",value:c,onChange:S=>d(S.target.value),rows:3,className:"w-full px-3 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-800 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none text-left"})]})]}),m.jsxs("div",{className:"flex items-center justify-between p-4 border-t border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-800/50 rounded-b-lg",children:[m.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-left",children:v?"Press Cmd+Enter to save":"Press Cmd+Enter to create"}),m.jsxs("button",{onClick:b,disabled:f||!a.trim(),className:"flex items-center px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white rounded-lg font-medium transition-colors",children:[f?m.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):m.jsx(Iv,{className:"h-4 w-4 mr-2"}),v?"Save":"Create"]})]})]})})},y6=({group:n,isOpen:e,onClose:t,onShareUpdate:r})=>{const[a,o]=V.useState(n.shareType||"public"),[c,d]=V.useState(""),[f,p]=V.useState(!1),[v,b]=V.useState(!1),[E,S]=V.useState(""),[R,j]=V.useState(""),[N,I]=V.useState(!1),[te,X]=V.useState(n.allowEditing??!0),[de,ve]=V.useState([]),[ge,D]=V.useState(!1),[C,O]=V.useState(n.shareId||null);V.useEffect(()=>{if(e)if(n.shareId){o(n.shareType||"public"),O(n.shareId);const B=ct.generateShareUrl(n.shareId);d(B),z(n.shareId)}else o("public"),O(null),d(""),b(!1),S(""),X(!0),ve([])},[e,n.shareId,n.shareType]);const z=async B=>{const ue=B||n.shareId;if(ue){D(!0);try{const pe=await ct.getSharedGroup(ue);pe&&(X(pe.allowEditing??pe.shareType==="private"),ve(pe.collaborators||[]))}catch(pe){console.error("Error loading shared group data:",pe)}finally{D(!1)}}};if(!e)return null;const M=async()=>{try{p(!0),S("");let B;n.shareId?B=await ct.shareGroup(n.id,a,n.ownerEmail):B=await ct.shareGroup(n.id,a,n.ownerEmail);const ue=B.shareId;O(ue),d(ct.generateShareUrl(ue)),await z(ue),r()}catch(B){console.error("Error sharing group:",B),S(B.message||"Failed to share group")}finally{p(!1)}},P=async()=>{c&&(await navigator.clipboard.writeText(c),b(!0),setTimeout(()=>b(!1),2e3))},k=async()=>{if(!(!R.trim()||!C))try{I(!0),S(""),await ct.addGroupCollaborator(C,R.trim(),"edit"),j(""),await z(C)}catch(B){S(B.message||"Failed to add collaborator")}finally{I(!1)}},Ne=async B=>{if(C)try{await ct.removeGroupCollaborator(C,B),await z(C)}catch(ue){S(ue.message||"Failed to remove collaborator")}},Ze=async(B,ue)=>{if(!C)return;const pe=ue==="edit"?"view":"edit";try{await ct.updateGroupCollaboratorPermission(C,B,pe),await z(C)}catch(Re){S(Re.message||"Failed to update permission")}};return m.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:t,children:m.jsxs("div",{className:"w-full max-w-md bg-white dark:bg-dark-card rounded-lg shadow-xl animate-scale-in max-h-[90vh] overflow-hidden flex flex-col",onClick:B=>B.stopPropagation(),children:[m.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-600",children:[m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Yi,{className:"h-5 w-5 text-blue-500"}),m.jsx("h2",{className:"text-lg font-semibold text-gray-800 dark:text-white text-left",children:"Share Group"})]}),m.jsx("button",{onClick:t,className:"p-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",children:m.jsx(or,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})})]}),m.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[m.jsxs("div",{children:[m.jsxs("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 text-left",children:["Group: ",n.name]}),m.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-left",children:[n.noteCount||0," notes in this group"]})]}),m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 text-left",children:"Share Type"}),m.jsxs("div",{className:"space-y-2",children:[m.jsxs("label",{className:"flex items-start space-x-3 p-3 border border-gray-200 dark:border-gray-600 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800",children:[m.jsx("input",{type:"radio",name:"shareType",value:"public",checked:a==="public",onChange:B=>o(B.target.value),className:"mt-1"}),m.jsxs("div",{className:"flex-1 text-left",children:[m.jsx("div",{className:"font-medium text-gray-800 dark:text-white",children:"Public"}),m.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Anyone with the link can view"})]})]}),m.jsxs("label",{className:"flex items-start space-x-3 p-3 border border-gray-200 dark:border-gray-600 rounded-lg cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-800",children:[m.jsx("input",{type:"radio",name:"shareType",value:"private",checked:a==="private",onChange:B=>o(B.target.value),className:"mt-1"}),m.jsxs("div",{className:"flex-1 text-left",children:[m.jsx("div",{className:"font-medium text-gray-800 dark:text-white",children:"Private"}),m.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Only people you invite can view"})]})]})]})]}),a==="private"&&m.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[m.jsxs("div",{className:"text-left",children:[m.jsx("div",{className:"font-medium text-gray-800 dark:text-white",children:"Allow Editing"}),m.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Let collaborators edit notes in this group"})]}),m.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[m.jsx("input",{type:"checkbox",checked:te,onChange:B=>X(B.target.checked),className:"sr-only peer"}),m.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),a==="private"&&m.jsxs("div",{children:[m.jsx("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 text-left",children:"Collaborators"}),C?ge?m.jsx("div",{className:"text-center py-4",children:m.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500 mx-auto"})}):de.length===0?m.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"No collaborators yet"}):m.jsx("div",{className:"space-y-2",children:de.map((B,ue)=>m.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[m.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[m.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white text-sm font-medium",children:B.displayName?.charAt(0)||B.email?.charAt(0)||"C"}),m.jsxs("div",{className:"flex-1 text-left",children:[m.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white text-left",children:B.displayName||B.email}),m.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 text-left",children:B.email})]})]}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsxs("select",{value:B.permission||"edit",onChange:pe=>Ze(B.email,B.permission),className:"text-xs px-2 py-1.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded text-gray-700 dark:text-gray-300 text-left",children:[m.jsx("option",{value:"view",children:"View"}),m.jsx("option",{value:"edit",children:"Edit"})]}),m.jsx("button",{onClick:()=>Ne(B.email),className:"p-1.5 hover:bg-red-100 dark:hover:bg-red-900/20 rounded transition-colors",title:"Remove collaborator",children:m.jsx(or,{className:"h-4 w-4 text-red-600 dark:text-red-400"})})]})]},B.email||ue))}):m.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"Share the group first to add collaborators"}),C&&m.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx("input",{type:"email",placeholder:"Add collaborator by email...",value:R,onChange:B=>j(B.target.value),onKeyDown:B=>{B.key==="Enter"&&k()},className:"flex-1 px-3 py-2 text-sm border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 text-left"}),m.jsxs("button",{onClick:k,disabled:!R.trim()||N,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white rounded-lg transition-colors flex items-center space-x-2",children:[m.jsx(Tn,{className:"h-4 w-4"}),m.jsx("span",{children:N?"...":"Add"})]})]})})]}),c&&m.jsxs("div",{children:[m.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 text-left",children:"Share Link"}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx("input",{type:"text",value:c,readOnly:!0,className:"flex-1 px-3 py-2 text-sm bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 text-left"}),m.jsx("button",{onClick:P,className:"p-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors",title:"Copy link",children:v?m.jsx(wv,{className:"h-4 w-4"}):m.jsx(zN,{className:"h-4 w-4"})})]})]}),E&&m.jsx("div",{className:"p-3 bg-red-100 dark:bg-red-900/50 border border-red-200 dark:border-red-800 rounded-lg",children:m.jsx("p",{className:"text-red-700 dark:text-red-300 text-sm text-left",children:E})})]}),m.jsx("div",{className:"p-4 border-t border-gray-200 dark:border-gray-600 bg-gray-50 dark:bg-gray-800/50",children:m.jsx("button",{onClick:M,disabled:f,className:"w-full flex items-center justify-center px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white rounded-lg font-medium transition-colors",children:f?m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),m.jsx("span",{children:"Sharing..."})]}):m.jsxs(m.Fragment,{children:[m.jsx(Yi,{className:"h-4 w-4 mr-2"}),m.jsx("span",{children:c?"Update Share Settings":"Generate Share Link"})]})})})]})})},v6=()=>{const{user:n}=lr(),{notes:e,sharedWithMeNotes:t,searchQuery:r,filterColor:a,isLoading:o,error:c,groups:d,selectedGroupId:f,setSelectedGroupId:p,createGroup:v,updateGroup:b,deleteGroup:E,refreshGroups:S,toggleGroupPin:R,leaveGroup:j}=cc(),{isDarkMode:N}=bv(),I=typeof chrome<"u"&&chrome.runtime&&!window.location.protocol.startsWith("http"),[te,X]=V.useState(!I),[de,ve]=V.useState(!1),[ge,D]=V.useState(null),[C,O]=V.useState(!1),[z,M]=V.useState(!1),[P,k]=V.useState(null),[Ne,Ze]=V.useState(!1),[B,ue]=V.useState(null),Re=e.filter(W=>{const me=r===""||W.title.toLowerCase().includes(r.toLowerCase())||W.description.toLowerCase().includes(r.toLowerCase()),Se=a==="all"||W.color===a,Fe=f===null||W.groupId===f;return me&&Se&&Fe}).sort((W,me)=>W.isPinned&&!me.isPinned?-1:!W.isPinned&&me.isPinned?1:new Date(me.updatedAt).getTime()-new Date(W.updatedAt).getTime()),Pe=()=>{D(null),ve(!0)},q=W=>{D(W),ve(!0)},F=()=>{ve(!1),D(null)},L=()=>{k(null),M(!0)},Q=W=>{k(W),M(!0)},oe=()=>{M(!1),k(null)},se=W=>{ue(W),Ze(!0)},$=()=>{Ze(!1),ue(null)};return m.jsxs("div",{className:`h-full flex flex-col bg-white dark:bg-dark-bg transition-colors ${N?"dark":""}`,children:[m.jsx(r6,{onSettings:()=>O(!0)}),m.jsxs("div",{className:"flex-1 flex overflow-hidden relative",children:[I&&te&&m.jsx("div",{className:"fixed inset-0 bg-black/20 z-40",onClick:()=>X(!1)}),!n?.isGuest&&m.jsx(m.Fragment,{children:m.jsxs("div",{className:`
                ${I?"absolute":"relative"} 
                ${I?"left-0 top-0 bottom-0 z-50":""}
                ${I?te?"w-56":"w-0":te?"w-64":"w-0"}
                border-r border-gray-200 dark:border-dark-border 
                bg-white dark:bg-dark-card 
                flex flex-col shrink-0
                transition-all duration-300 ease-in-out
                ${I?"shadow-lg":""}
                overflow-hidden
              `,children:[m.jsx("div",{className:`${I?"p-2":"p-4"} border-b border-gray-200 dark:border-dark-border flex-shrink-0`,children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("h3",{className:`${I?"text-xs":"text-sm"} font-bold text-gray-800 dark:text-gray-200 uppercase tracking-wide`,children:"Groups"}),m.jsx("button",{onClick:L,className:`${I?"p-1.5":"p-2"} bg-blue-500 hover:bg-blue-600 text-white rounded transition-colors`,title:"Create new group",children:m.jsx(qN,{className:`${I?"h-3.5 w-3.5":"h-4 w-4"}`})})]})}),m.jsx("div",{className:`flex-1 overflow-y-auto ${I?"p-1.5":"p-3"}`,children:m.jsx(g6,{groups:d,selectedGroupId:f,onSelectGroup:W=>{p(W),I&&X(!1)},onEditGroup:Q,onDeleteGroup:E,onShareGroup:se,onTogglePin:R,onLeaveGroup:j})})]})}),m.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-w-0",children:[m.jsxs("div",{className:`${I?"px-2.5 py-1.5":"px-4 sm:px-6 py-4 sm:py-5"} border-b border-gray-200 dark:border-dark-border bg-white dark:bg-dark-card`,children:[m.jsx("div",{className:I?"mb-1.5":"mb-4",children:m.jsx(h6,{onMenuClick:()=>X(!te),showMenuButton:I&&!n?.isGuest})}),m.jsx(f6,{})]}),m.jsxs("div",{className:`flex-1 overflow-auto ${I?"p-2":"p-5"}`,children:[n?.isGuest&&m.jsx("div",{className:`mb-2 ${I?"p-2":"p-4"} bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg`,children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex-1",children:[m.jsx("p",{className:`text-orange-800 dark:text-orange-200 ${I?"text-xs":"text-sm"} font-medium`,children:" Guest Mode"}),m.jsx("p",{className:`text-orange-600 dark:text-orange-300 ${I?"text-[10px]":"text-xs"} mt-1`,children:"Notes are saved locally. Sign in to sync across devices."})]}),m.jsx("button",{onClick:()=>O(!0),className:`${I?"px-2 py-1 text-[10px]":"px-3 py-1.5 text-xs"} bg-orange-500 hover:bg-orange-600 text-white rounded-md font-medium transition-colors`,children:"Sign In"})]})}),c&&m.jsx("div",{className:`mb-2 ${I?"p-2":"p-3.5"} bg-red-100 dark:bg-red-900/50 border border-red-200 dark:border-red-800 rounded-lg`,children:m.jsx("p",{className:`text-red-700 dark:text-red-300 ${I?"text-xs":"text-sm"}`,children:c})}),o?m.jsxs("div",{className:"flex items-center justify-center py-12",children:[m.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-500"}),m.jsx("span",{className:"ml-2 text-xs text-gray-600 dark:text-gray-400",children:"Loading..."})]}):Re.length===0&&t.length===0?m.jsx("div",{className:"text-center py-12",children:m.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-xs",children:r||a!=="all"?"No notes match your filter":"No notes yet. Create your first note!"})}):m.jsxs("div",{className:`${I?"space-y-1.5":"space-y-4"}`,children:[f&&(()=>{const W=d.find(me=>me.id===f);return W?m.jsx("div",{className:`mb-1.5 ${I?"p-1.5":"p-2.5"} bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded text-left`,children:m.jsxs("div",{className:"flex items-start justify-between gap-2",children:[m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("div",{className:"flex items-center gap-1.5 mb-0.5",children:m.jsxs("span",{className:`text-blue-800 dark:text-blue-200 ${I?"text-[10px]":"text-xs"} font-semibold truncate`,children:[" ",W.name]})}),W.description&&m.jsx("p",{className:`text-blue-700 dark:text-blue-300 ${I?"text-[9px]":"text-[10px]"} truncate`,children:W.description}),m.jsxs("div",{className:`flex items-center gap-2 mt-1 ${I?"text-[9px]":"text-[10px]"} text-blue-600 dark:text-blue-400`,children:[m.jsxs("span",{children:[W.noteCount||0," notes"]}),W.isShared&&W.collaborators&&W.collaborators.length>0&&m.jsxs("span",{children:[" ",W.collaborators.length," collaborator",W.collaborators.length!==1?"s":""]})]})]}),m.jsx("button",{onClick:()=>p(null),className:`${I?"px-1.5 py-0.5 text-[10px]":"px-2 py-1 text-xs"} bg-blue-500 hover:bg-blue-600 text-white rounded font-medium transition-colors flex-shrink-0`,children:"Show All"})]})}):null})(),Re.length>0&&m.jsxs("div",{children:[m.jsxs("h2",{className:`${I?"text-xs":"text-sm"} font-bold text-gray-800 dark:text-white ${I?"mb-1.5":"mb-2"} flex items-center text-left`,children:[m.jsx("span",{className:I?"mr-1":"mr-1.5",children:""}),f?"Group Notes":"My Notes",m.jsxs("span",{className:`ml-2 ${I?"text-[10px]":"text-xs"} text-gray-500 dark:text-gray-400 font-normal`,children:["(",Re.length,")"]})]}),m.jsx(o6,{notes:Re,onEditNote:q})]}),t.length>0&&m.jsxs("div",{className:I?"mt-3":"mt-4",children:[m.jsxs("h2",{className:`${I?"text-xs":"text-sm"} font-bold text-gray-800 dark:text-white ${I?"mb-1.5":"mb-2"} flex items-center text-left`,children:[m.jsx("span",{className:I?"mr-1":"mr-1.5",children:""}),"Shared with Me",m.jsxs("span",{className:`ml-2 ${I?"text-[10px]":"text-xs"} text-gray-500 dark:text-gray-400 font-normal`,children:["(",t.length,")"]})]}),m.jsx("div",{className:`grid grid-cols-1 ${I?"gap-1.5":"gap-2"}`,children:t.map((W,me)=>m.jsx(c6,{sharedNote:W,animationDelay:me*.05},W.id))})]})]})]}),m.jsx("div",{className:`${I?"p-2 pt-1.5":"p-5 pt-4"} border-t border-gray-200 dark:border-dark-border bg-white dark:bg-dark-card`,children:m.jsxs("button",{onClick:Pe,className:`w-full flex items-center justify-center ${I?"px-3 py-2":"px-4 py-3"} bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-semibold ${I?"text-xs":"text-sm"} transition-colors shadow-sm`,children:[m.jsx(Sv,{className:`${I?"h-3.5 w-3.5 mr-1.5":"h-4 w-4 mr-2"}`}),"Add New Note"]})}),I&&m.jsx("div",{className:`${I?"pt-1.5 pb-1.5 px-2":"pt-4 pb-3 px-3"} border-t border-gray-200 dark:border-dark-border`,children:m.jsxs("button",{onClick:()=>{window.open("https://livenote-ruddy.vercel.app","_blank")},className:"flex items-center gap-1.5 text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300 transition-colors cursor-pointer",children:[m.jsx(xd,{className:`${I?"h-3 w-3":"h-3.5 w-3.5"}`}),m.jsx("span",{className:`${I?"text-xs":"text-sm"} underline`,children:"Use this in web view"})]})})]})]}),de&&m.jsx(d6,{note:ge,onClose:F}),C&&m.jsx(m6,{onClose:()=>O(!1)}),z&&m.jsx(p6,{group:P,onClose:oe,onCreateGroup:v,onUpdateGroup:b}),Ne&&B&&m.jsx(y6,{group:B,isOpen:Ne,onClose:$,onShareUpdate:async()=>{await S();const me=(await ct.getUserGroups(n?.id||"")).find(Se=>Se.id===B.id);me&&ue(me)}})]})},_6=()=>m.jsx("div",{className:"flex items-center justify-center h-full bg-white dark:bg-dark-bg",children:m.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}),dT=()=>{const[n,e]=V.useState(!1),[t,r]=V.useState(null),[a,o]=V.useState(!1),[c,d]=V.useState(!1),f=typeof chrome<"u"&&chrome.runtime&&!window.location.protocol.startsWith("http");V.useEffect(()=>{if(f)return;if(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0){d(!0);return}if(localStorage.getItem("installPromptDismissed")==="true")return;const E=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;o(E);const S=j=>{j.preventDefault(),r(j)};window.addEventListener("beforeinstallprompt",S);const R=setTimeout(()=>{e(!0)},15e3);return()=>{clearTimeout(R),window.removeEventListener("beforeinstallprompt",S)}},[f]);const p=async()=>{if(t){await t.prompt();const{outcome:b}=await t.userChoice;b==="accepted"&&console.log("User accepted the install prompt"),r(null),e(!1)}},v=()=>{e(!1),localStorage.setItem("installPromptDismissed","true")};return f||c||!n?null:m.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 p-4 sm:p-6 animate-slide-up",children:m.jsxs("div",{className:"max-w-md mx-auto bg-white dark:bg-dark-card border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg p-4 flex items-center gap-3 sm:gap-4",children:[m.jsx("div",{className:"flex-shrink-0",children:a?m.jsx(YN,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-500"}):m.jsx(FN,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-500"})}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsx("h3",{className:"text-sm sm:text-base font-semibold text-gray-800 dark:text-white mb-1",children:"Install LiveNotes"}),m.jsx("p",{className:"text-xs sm:text-sm text-gray-600 dark:text-gray-300",children:a?"Add to Home Screen for quick access":"Install our app for a better experience"})]}),m.jsxs("div",{className:"flex items-center gap-2",children:[!a&&t&&m.jsx("button",{onClick:p,className:"px-3 py-1.5 sm:px-4 sm:py-2 bg-blue-500 hover:bg-blue-600 text-white text-xs sm:text-sm font-medium rounded-lg transition-colors whitespace-nowrap",children:"Install"}),m.jsx("button",{onClick:v,className:"p-1.5 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors","aria-label":"Close",children:m.jsx(or,{className:"h-4 w-4 sm:h-5 sm:w-5 text-gray-500 dark:text-gray-400"})})]})]})})},b6=()=>{const{user:n,isLoading:e}=lr();return e?m.jsx(_6,{}):n?m.jsxs(m.Fragment,{children:[m.jsx(v6,{}),m.jsx(dT,{})]}):m.jsxs(m.Fragment,{children:[m.jsx(t6,{}),m.jsx(dT,{})]})},x6=({sharedNote:n,onUpdate:e,isOwner:t})=>{const[r,a]=V.useState(!1),[o,c]=V.useState(n.shareType),[d,f]=V.useState(!1);if(!t)return null;const p=async()=>{try{f(!0),await Lt.updateShareType(n.shareId,o);const v={...n,shareType:o};e(v),a(!1)}catch(v){console.error("Error updating share type:",v),alert("Failed to update share settings")}finally{f(!1)}};return m.jsxs("div",{className:"relative",children:[m.jsx("button",{onClick:()=>a(!r),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Share Settings",children:m.jsx(Wf,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})}),r&&m.jsxs("div",{className:"absolute right-0 top-10 bg-white dark:bg-dark-card border border-gray-200 dark:border-gray-600 rounded-lg shadow-lg z-10 p-4 min-w-[250px]",children:[m.jsx("h3",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Share Settings"}),m.jsxs("div",{className:"space-y-3",children:[m.jsx("button",{onClick:()=>c("public"),className:`w-full p-3 rounded-lg border-2 transition-colors text-left ${o==="public"?"border-green-500 bg-green-50 dark:bg-green-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300"}`,children:m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx(km,{className:"h-5 w-5 text-green-500"}),m.jsxs("div",{children:[m.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"Public"}),m.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Anyone with the link can view"})]})]})}),m.jsx("button",{onClick:()=>c("private"),className:`w-full p-3 rounded-lg border-2 transition-colors text-left ${o==="private"?"border-orange-500 bg-orange-50 dark:bg-orange-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300"}`,children:m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx(ta,{className:"h-5 w-5 text-orange-500"}),m.jsxs("div",{children:[m.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:"Private"}),m.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Login required to view"})]})]})})]}),m.jsxs("div",{className:"flex justify-between items-center mt-4 pt-3 border-t border-gray-200 dark:border-gray-600",children:[m.jsx("button",{onClick:()=>{c(n.shareType),a(!1)},className:"px-3 py-1 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200",children:"Cancel"}),m.jsxs("button",{onClick:p,disabled:d||o===n.shareType,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-blue-300 text-white rounded-lg transition-colors flex items-center space-x-2 text-sm",children:[m.jsx(Iv,{className:"h-3 w-3"}),m.jsx("span",{children:d?"Saving...":"Save"})]})]})]}),r&&m.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>a(!1)})]})},w6=({sharedNote:n,isCommunity:e=!1})=>{const r=e?{icon:Tn,color:"text-purple-500",bgColor:"bg-purple-100 dark:bg-purple-900/20",borderColor:"border-purple-200 dark:border-purple-800",text:"Community",description:"Community members can view and contribute"}:n.shareType==="public"?{icon:km,color:"text-green-500",bgColor:"bg-green-100 dark:bg-green-900/20",borderColor:"border-green-200 dark:border-green-800",text:"Public",description:"Anyone with the link can view"}:{icon:ta,color:"text-orange-500",bgColor:"bg-orange-100 dark:bg-orange-900/20",borderColor:"border-orange-200 dark:border-orange-800",text:"Private",description:"Login required to view"},a=r.icon;return m.jsxs("div",{className:`inline-flex items-center space-x-2 px-3 py-1.5 rounded-full border ${r.bgColor} ${r.borderColor}`,children:[m.jsx(a,{className:`h-4 w-4 ${r.color}`}),m.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:r.text})]})},E6=({members:n,shareId:e,onPermissionUpdate:t,className:r=""})=>{const[a,o]=V.useState({allowMembersToEdit:!0,allowMembersToAddNotes:!0,allowMembersToInvite:!1,requireApprovalToJoin:!1}),[c,d]=V.useState(!1),[f,p]=V.useState(!1),v=async(S,R)=>{try{p(!0);const j={...a,[S]:R};o(j),t(e),console.log(" Community permissions updated:",j)}catch(j){console.error("Error updating permissions:",j)}finally{p(!1)}},b=n.filter(S=>S.role==="owner").length,E=n.filter(S=>S.role==="member").length;return m.jsxs("div",{className:`bg-white dark:bg-dark-card rounded-lg border border-gray-200 dark:border-gray-600 p-4 ${r}`,children:[m.jsxs("div",{className:"flex items-center justify-between mb-4",children:[m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Wf,{className:"h-5 w-5 text-gray-500"}),m.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:"Community Settings"})]}),m.jsx("button",{onClick:()=>d(!c),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:m.jsx(Wf,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[m.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg",children:[m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Tn,{className:"h-4 w-4 text-blue-600"}),m.jsx("span",{className:"text-sm font-medium text-blue-600",children:"Members"})]}),m.jsx("p",{className:"text-lg font-bold text-blue-700 dark:text-blue-400",children:E+b})]}),m.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-3 rounded-lg",children:[m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(ta,{className:"h-4 w-4 text-green-600"}),m.jsx("span",{className:"text-sm font-medium text-green-600",children:"Security"})]}),m.jsx("p",{className:"text-lg font-bold text-green-700 dark:text-green-400",children:a.requireApprovalToJoin?"Private":"Open"})]})]}),c&&m.jsxs("div",{className:"space-y-3 border-t border-gray-200 dark:border-gray-600 pt-4",children:[m.jsx("h4",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Community Permissions"}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx(KN,{className:"h-4 w-4 text-gray-500"}),m.jsxs("div",{children:[m.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Allow members to edit notes"}),m.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Members can modify existing community notes"})]})]}),m.jsx("button",{onClick:()=>v("allowMembersToEdit",!a.allowMembersToEdit),disabled:f,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${a.allowMembersToEdit?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`,children:m.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${a.allowMembersToEdit?"translate-x-6":"translate-x-1"}`})})]}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx(Sv,{className:"h-4 w-4 text-gray-500"}),m.jsxs("div",{children:[m.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Allow members to add notes"}),m.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Members can create new notes in this community"})]})]}),m.jsx("button",{onClick:()=>v("allowMembersToAddNotes",!a.allowMembersToAddNotes),disabled:f,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${a.allowMembersToAddNotes?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`,children:m.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${a.allowMembersToAddNotes?"translate-x-6":"translate-x-1"}`})})]}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx(Tn,{className:"h-4 w-4 text-gray-500"}),m.jsxs("div",{children:[m.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Allow members to invite others"}),m.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Members can share community links with others"})]})]}),m.jsx("button",{onClick:()=>v("allowMembersToInvite",!a.allowMembersToInvite),disabled:f,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${a.allowMembersToInvite?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`,children:m.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${a.allowMembersToInvite?"translate-x-6":"translate-x-1"}`})})]}),m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx(ta,{className:"h-4 w-4 text-gray-500"}),m.jsxs("div",{children:[m.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Require approval to join"}),m.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"New members need owner approval before joining"})]})]}),m.jsx("button",{onClick:()=>v("requireApprovalToJoin",!a.requireApprovalToJoin),disabled:f,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${a.requireApprovalToJoin?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"}`,children:m.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${a.requireApprovalToJoin?"translate-x-6":"translate-x-1"}`})})]}),f&&m.jsxs("div",{className:"flex items-center justify-center py-2",children:[m.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500 mr-2"}),m.jsx("span",{className:"text-sm text-gray-500",children:"Saving permissions..."})]})]})]})},T6=({shareId:n,className:e=""})=>{const{user:t}=lr(),[r,a]=V.useState(null),[o,c]=V.useState(!0),[d,f]=V.useState(!1),[p,v]=V.useState("");V.useEffect(()=>{b()},[n]);const b=async()=>{try{c(!0);const N=await Lt.getCommunityNote(n);a(N)}catch(N){console.error("Error loading community data:",N),v("Failed to load community data")}finally{c(!1)}},E=async()=>{if(!(!t||!r))try{f(!0),v("");const N={id:t.id||t.email,email:t.email,displayName:t.displayName||t.email,photoURL:t.photoURL,joinedAt:new Date,role:"member"};await Lt.joinCommunity(n,N),await b()}catch(N){console.error("Error joining community:",N),v("Failed to join community")}finally{f(!1)}},S=async()=>{if(!(!t||!r))try{f(!0),v(""),await Lt.leaveCommunity(n,t.email),await b()}catch(N){console.error("Error leaving community:",N),v("Failed to leave community")}finally{f(!1)}};if(o)return m.jsxs("div",{className:`flex items-center space-x-2 ${e}`,children:[m.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"}),m.jsx("span",{className:"text-sm text-gray-500",children:"Loading community..."})]});if(!r||!r.isCommunity)return null;const R=t&&r.members.some(N=>N.email===t.email),j=r.members.find(N=>N.email===t?.email);return m.jsxs("div",{className:`bg-white dark:bg-dark-card rounded-lg border border-gray-200 dark:border-gray-600 p-4 ${e}`,children:[m.jsxs("div",{className:"flex items-center justify-between mb-4",children:[m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Tn,{className:"h-5 w-5 text-blue-500"}),m.jsxs("h3",{className:"font-semibold text-gray-900 dark:text-white",children:["Community (",r.memberCount,")"]})]}),t&&m.jsx("div",{children:R?m.jsxs("button",{onClick:S,disabled:d||j?.role==="owner",className:"flex items-center space-x-1 px-3 py-1 text-sm bg-red-100 hover:bg-red-200 text-red-700 rounded-lg transition-colors disabled:opacity-50",children:[m.jsx(JN,{className:"h-3 w-3"}),m.jsx("span",{children:j?.role==="owner"?"Owner":"Leave"})]}):m.jsxs("button",{onClick:E,disabled:d,className:"flex items-center space-x-1 px-3 py-1 text-sm bg-blue-100 hover:bg-blue-200 text-blue-700 rounded-lg transition-colors disabled:opacity-50",children:[m.jsx(ZN,{className:"h-3 w-3"}),m.jsx("span",{children:d?"Joining...":"Join"})]})})]}),p&&m.jsx("div",{className:"mb-4 p-2 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded text-sm text-red-600 dark:text-red-400",children:p}),m.jsx("div",{className:"space-y-2",children:r.members.length===0?m.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 italic",children:"No members yet. Be the first to join!"}):r.members.map(N=>m.jsxs("div",{className:"flex items-center space-x-3 p-2 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[m.jsx("div",{className:"flex-shrink-0",children:N.photoURL?m.jsx("img",{src:N.photoURL,alt:N.displayName,className:"h-8 w-8 rounded-full"}):m.jsx("div",{className:"h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center text-white text-sm font-medium",children:N.displayName.charAt(0).toUpperCase()})}),m.jsxs("div",{className:"flex-1 min-w-0",children:[m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:N.displayName}),N.role==="owner"&&m.jsx("div",{title:"Owner",children:m.jsx(s3,{className:"h-3 w-3 text-yellow-500"})})]}),m.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Joined ",new Date(N.joinedAt).toLocaleDateString()]})]})]},N.id))}),R&&j?.role==="owner"&&m.jsx(E6,{members:r.members,shareId:n,onPermissionUpdate:b,className:"mt-4"}),!t&&m.jsxs("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg text-center",children:[m.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300 mb-2",children:"Join this community to collaborate on this note!"}),m.jsx("button",{onClick:()=>{const N="https://livenote-ruddy.vercel.app";window.location.href=N},className:"text-sm px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded transition-colors",children:"Sign In to Join"})]})]})},S6={yellow:"bg-note-yellow border-yellow-300",blue:"bg-note-blue border-blue-300",green:"bg-note-green border-green-300",pink:"bg-note-pink border-pink-300",purple:"bg-note-purple border-purple-300",orange:"bg-note-orange border-orange-300"},I6=()=>{const{shareId:n}=gR(),{user:e,isLoading:t}=lr(),[r,a]=V.useState(null),[o,c]=V.useState(!0),[d,f]=V.useState(""),[p,v]=V.useState(!1),[b,E]=V.useState(!1),[S,R]=V.useState({name:"",canInstall:!1,isExtensionInstalled:!1,isWeb:!1}),[j,N]=V.useState(!1),[I,te]=V.useState(""),[X,de]=V.useState(""),[ve,ge]=V.useState(!1);V.useEffect(()=>{if(!n){f("Invalid share link"),c(!1);return}const B=window.location.protocol==="chrome-extension:",ue=!B&&(window.location.protocol==="http:"||window.location.protocol==="https:");let pe=!1;B?pe=!0:ue&&typeof chrome<"u"&&chrome.runtime&&(pe=!1);const Re=navigator.userAgent;let Pe="Browser",q=!1;Re.includes("Chrome")&&!Re.includes("Edg")?(Pe="Chrome",q=!0):Re.includes("Firefox")?(Pe="Firefox",q=!0):Re.includes("Safari")&&!Re.includes("Chrome")?(Pe="Safari",q=!0):Re.includes("Edg")&&(Pe="Edge",q=!0),R({name:Pe,canInstall:q&&ue&&!pe,isExtensionInstalled:pe,isWeb:ue}),t||D()},[n,e,t]),V.useEffect(()=>{if(!n||j||o||!r)return;const ue=setInterval(async()=>{try{let pe=await Lt.getSharedNote(n),Re=!1;if(!pe){const Pe=await Lt.getCommunityNote(n);pe=Pe,Re=Pe?.isCommunity||!1}pe&&!j&&(pe.title!==r.title||pe.description!==r.description||pe.lastEditedAt?.getTime()!==r.lastEditedAt?.getTime())&&(a(pe),E(Re),j||(te(pe.title),de(pe.description)),console.log(" Shared note refreshed with latest updates"))}catch(pe){console.warn("Error refreshing shared note:",pe)}},5e3);return()=>clearInterval(ue)},[n,j,o,r]);const D=async()=>{try{c(!0),f("");let B=await Lt.getSharedNote(n),ue=!1;if(!B){const pe=await Lt.getCommunityNote(n);B=pe,ue=pe?.isCommunity||!1}if(!B){f("This note is no longer available or has expired.");return}if(B.shareType==="public"){a(B),E(ue),v(!1),te(B.title),de(B.description);return}if(t&&await new Promise(pe=>setTimeout(pe,500)),B.shareType==="private"&&!e){v(!0),f("This is a private note. Please log in to view it.");return}a(B),E(ue),v(!1),te(B.title),de(B.description)}catch(B){console.error("Error loading shared note:",B),f("Failed to load the shared note. Please try again.")}finally{c(!1)}},C=()=>!r||!e?!1:Lt.canEditSharedNote(r,e.email,e.id),O=()=>!r||!e||e.email&&(r.ownerEmail===e.email||r.ownerEmail?.toLowerCase()===e.email.toLowerCase())||e.id&&r.ownerId===e.id?!1:r.collaborators&&r.collaborators.length>0?r.collaborators.some(B=>B.email===e.email||B.email?.toLowerCase()===e.email?.toLowerCase()):!1,z=async()=>{if(!(!r||!e||!n)&&confirm("Are you sure you want to leave this shared note? You will no longer have access to it."))try{c(!0),f(""),await Lt.leaveSharedNote(n,e.email||""),console.log(" Successfully left shared note"),Ne()}catch(B){console.error("Error leaving shared note:",B),f("Failed to leave shared note. Please try again."),c(!1)}},M=()=>{if(r?.shareType==="private"&&!e){v(!0),f("Please log in to edit this private note.");return}N(!0),te(r?.title||""),de(r?.description||"")},P=()=>{N(!1),te(r?.title||""),de(r?.description||"")},k=async()=>{if(!r||!e){f("Please log in to save changes."),v(!0),N(!1);return}if(r.shareType==="private"&&!e){f("Please log in to edit this private note."),v(!0),N(!1);return}try{ge(!0),f(""),await Lt.updateSharedNoteContent(n,{title:I,description:X,lastEditedBy:e.displayName||e.email,lastEditedByEmail:e.email||"",lastEditedAt:new Date}),a(B=>B?{...B,title:I,description:X,lastEditedBy:e.displayName||e.email,lastEditedAt:new Date}:null),N(!1),console.log(" Changes saved successfully")}catch(B){console.error("Error saving changes:",B),f("Failed to save changes. Please try again.")}finally{ge(!1)}},Ne=()=>{const B="https://livenote-ruddy.vercel.app";window.location.href=B},Ze=()=>{let B="";switch(S.name){case"Chrome":B="https://chrome.google.com/webstore/category/extensions";break;case"Firefox":B="https://addons.mozilla.org/firefox/";break;case"Safari":B="https://apps.apple.com/us/story/id1377753262";break;case"Edge":B="https://microsoftedge.microsoft.com/addons/category/Edge-Extensions";break;default:B="https://chrome.google.com/webstore/category/extensions"}window.open(B,"_blank")};return o||t?m.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-dark-bg flex items-center justify-center",children:m.jsxs("div",{className:"text-center",children:[m.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),m.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t?"Checking authentication...":"Loading shared note..."})]})}):d?m.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-dark-bg flex items-center justify-center p-4",children:m.jsxs("div",{className:"max-w-md w-full bg-white dark:bg-dark-card rounded-lg shadow-lg p-6 text-center",children:[m.jsx("div",{className:"mb-4",children:p?m.jsx(ta,{className:"h-12 w-12 text-orange-500 mx-auto"}):m.jsx(Yi,{className:"h-12 w-12 text-gray-400 mx-auto"})}),m.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:p?"Login Required":"Note Not Found"}),m.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:d}),m.jsxs("button",{onClick:Ne,className:"w-full px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors flex items-center justify-center space-x-2",children:[m.jsx(xd,{className:"h-4 w-4"}),m.jsx("span",{children:p?"Go to App & Login":"Go to App"})]})]})}):r?m.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-dark-bg",children:[m.jsx("header",{className:"bg-white dark:bg-dark-card shadow-sm border-b border-gray-200 dark:border-gray-700",children:m.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-4 flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx("button",{onClick:Ne,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Go to Google Notes",children:m.jsx(QL,{className:"h-5 w-5 text-gray-600 dark:text-gray-400"})}),m.jsxs("div",{className:"flex items-center space-x-2",children:[m.jsx(Yi,{className:"h-6 w-6 text-blue-500"}),m.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Shared Note"})]})]}),m.jsxs("div",{className:"flex items-center space-x-3",children:[m.jsx(w6,{sharedNote:r,isCommunity:b}),e&&(r.ownerEmail===e.email||r.ownerId===e.id)&&m.jsx(x6,{sharedNote:r,onUpdate:B=>a(B),isOwner:!0}),e&&O()&&m.jsxs("button",{onClick:z,disabled:o,className:"px-4 py-2 bg-orange-500 hover:bg-orange-600 disabled:bg-orange-300 text-white rounded-lg transition-colors flex items-center space-x-2",title:"Leave this shared note",children:[m.jsx(Dm,{className:"h-4 w-4"}),m.jsx("span",{children:"Leave"})]}),S.canInstall&&m.jsxs("button",{onClick:Ze,className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors flex items-center space-x-2",children:[m.jsx(FN,{className:"h-4 w-4"}),m.jsxs("span",{children:["Get ",S.name," Extension"]})]})]})]})}),r.shareType==="private"&&m.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-b border-blue-200 dark:border-blue-800",children:m.jsx("div",{className:"max-w-4xl mx-auto px-4 py-3",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center space-x-2 text-blue-700 dark:text-blue-300",children:[m.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full animate-pulse"}),m.jsx("span",{className:"text-sm font-medium",children:" Collaborative Editing"}),m.jsx("span",{className:"text-xs opacity-75",children:e?r.allowEditing?" Anyone with access can edit this note":" View only - editing disabled by owner":" Login required to edit this note"})]}),m.jsx("div",{className:"flex items-center space-x-2",children:e?m.jsxs("div",{className:"flex items-center space-x-2 text-xs text-blue-600 dark:text-blue-400",children:[m.jsx(Tn,{className:"h-4 w-4"}),m.jsxs("span",{children:[r.collaborators?r.collaborators.length+1:1," collaborators"]})]}):m.jsxs("button",{onClick:Ne,className:"px-3 py-1 text-xs bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors flex items-center space-x-1",children:[m.jsx(ta,{className:"h-3 w-3"}),m.jsx("span",{children:"Login to Edit"})]})})]})})}),m.jsx("main",{className:"max-w-4xl mx-auto px-4 py-8",children:m.jsxs("div",{className:"space-y-6",children:[m.jsxs("div",{className:`
            p-6 rounded-lg border-2 shadow-sm relative
            ${S6[r.color]}
          `,children:[r.shareType==="private"&&!e?m.jsx("div",{className:"absolute top-4 right-4",children:m.jsxs("button",{onClick:Ne,className:"px-3 py-2 text-sm bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors flex items-center space-x-2",title:"Login required to edit",children:[m.jsx(ta,{className:"w-4 h-4"}),m.jsx("span",{children:"Login to Edit"})]})}):C()?m.jsx("div",{className:"absolute top-4 right-4",children:j?m.jsxs("div",{className:"flex space-x-2",children:[m.jsx("button",{onClick:k,disabled:ve,className:"p-2 text-green-600 hover:text-green-700 hover:bg-green-50 rounded-lg transition-colors disabled:opacity-50",title:"Save changes",children:ve?m.jsx("div",{className:"w-5 h-5 border-2 border-green-600 border-t-transparent rounded-full animate-spin"}):m.jsx(wv,{className:"w-5 h-5"})}),m.jsx("button",{onClick:P,disabled:ve,className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors disabled:opacity-50",title:"Cancel editing",children:m.jsx(or,{className:"w-5 h-5"})})]}):m.jsx("button",{onClick:M,className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit note",children:m.jsx(G3,{className:"w-5 h-5"})})}):null,j?m.jsx("input",{type:"text",value:I,onChange:B=>te(B.target.value),className:"w-full text-2xl font-bold text-gray-800 dark:text-gray-900 mb-4 bg-transparent border border-gray-300 dark:border-gray-600 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 text-left",placeholder:"Note title"}):m.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-gray-900 mb-4 pr-12 text-left",children:r.title||"Untitled"}),j?m.jsx("textarea",{value:X,onChange:B=>de(B.target.value),className:"w-full h-64 text-gray-700 dark:text-gray-800 bg-transparent border border-gray-300 dark:border-gray-600 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-vertical text-left",placeholder:"Note content"}):r.description&&m.jsx("div",{className:"prose prose-gray dark:prose-invert max-w-none text-left",children:m.jsx("pre",{className:"whitespace-pre-wrap font-sans text-gray-700 dark:text-gray-800 leading-relaxed text-left",children:r.description})}),m.jsx("div",{className:"mt-6 pt-4 border-t border-gray-300 dark:border-gray-600 text-sm text-gray-600 dark:text-gray-700",children:m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsxs("div",{className:"flex items-center space-x-4",children:[m.jsxs("span",{children:["Shared by ",m.jsx("strong",{children:r.ownerName})]}),m.jsx("span",{children:new Date(r.createdAt).toLocaleDateString()})]}),b&&"members"in r&&r.members&&m.jsx(e1,{members:r.members})]})})]}),b&&n&&m.jsx(T6,{shareId:n}),m.jsxs("div",{className:"bg-white dark:bg-dark-card rounded-lg border border-gray-200 dark:border-gray-700 p-6 text-center",children:[m.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Create Your Own Notes"}),m.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Start organizing your thoughts with Google Notes. Create, share, and collaborate on notes easily."}),m.jsx("button",{onClick:Ne,className:"px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors font-medium",children:"Get Started"})]})]})})]}):m.jsx(CR,{to:"/",replace:!0})},A6=()=>m.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:m.jsxs("div",{className:"container mx-auto px-4 py-12 max-w-4xl",children:[m.jsxs("div",{className:"text-center mb-12",children:[m.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-4",children:"LiveNotes"}),m.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300",children:"Your Privacy Matters to Us"}),m.jsxs("div",{className:"mt-4 text-sm text-gray-500 dark:text-gray-400",children:["Last Updated: ",new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]})]}),m.jsxs("section",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 mb-8",children:[m.jsxs("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[m.jsx(lT,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"}),"About LiveNotes"]}),m.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed mb-4 text-left",children:"LiveNotes is a powerful, modern note-taking application designed to help you capture, organize, and share your ideas seamlessly across all your devices. Whether you're using our Chrome Extension, Web App, or Mobile App, LiveNotes provides a unified experience that keeps your notes synchronized in real-time."}),m.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed text-left",children:"Our mission is to make note-taking simple, collaborative, and accessible. With LiveNotes, you can create beautiful notes, organize them efficiently, collaborate with others, and access your content anywhere, anytime."})]}),m.jsxs("section",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 mb-8",children:[m.jsxs("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[m.jsx(e6,{className:"w-8 h-8 text-purple-600 dark:text-purple-400"}),"Key Features"]}),m.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[m.jsxs("div",{className:"flex items-start gap-4",children:[m.jsx("div",{className:"bg-blue-100 dark:bg-blue-900 p-3 rounded-lg",children:m.jsx(lT,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),m.jsxs("div",{className:"text-left",children:[m.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Rich Note Creation"}),m.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Create beautiful notes with titles, descriptions, and color coding for better organization."})]})]}),m.jsxs("div",{className:"flex items-start gap-4",children:[m.jsx("div",{className:"bg-purple-100 dark:bg-purple-900 p-3 rounded-lg",children:m.jsx(Hl,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),m.jsxs("div",{className:"text-left",children:[m.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Pin Important Notes"}),m.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Pin your most important notes to the top for quick access."})]})]}),m.jsxs("div",{className:"flex items-start gap-4",children:[m.jsx("div",{className:"bg-green-100 dark:bg-green-900 p-3 rounded-lg",children:m.jsx(Yi,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),m.jsxs("div",{className:"text-left",children:[m.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Share & Collaborate"}),m.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Share notes publicly or privately with collaborators. Control edit permissions for each user."})]})]}),m.jsxs("div",{className:"flex items-start gap-4",children:[m.jsx("div",{className:"bg-orange-100 dark:bg-orange-900 p-3 rounded-lg",children:m.jsx(Tn,{className:"w-6 h-6 text-orange-600 dark:text-orange-400"})}),m.jsxs("div",{className:"text-left",children:[m.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Group Management"}),m.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Organize notes into groups and share entire groups with team members or collaborators."})]})]}),m.jsxs("div",{className:"flex items-start gap-4",children:[m.jsx("div",{className:"bg-red-100 dark:bg-red-900 p-3 rounded-lg",children:m.jsx(Ef,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),m.jsxs("div",{className:"text-left",children:[m.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Real-time Notifications"}),m.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Get instant notifications when collaborators make changes to shared notes or groups."})]})]}),m.jsxs("div",{className:"flex items-start gap-4",children:[m.jsx("div",{className:"bg-indigo-100 dark:bg-indigo-900 p-3 rounded-lg",children:m.jsx(QN,{className:"w-6 h-6 text-indigo-600 dark:text-indigo-400"})}),m.jsxs("div",{className:"text-left",children:[m.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Smart Search & Filter"}),m.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Quickly find notes using powerful search and filter by color, tags, or other criteria."})]})]}),m.jsxs("div",{className:"flex items-start gap-4",children:[m.jsx("div",{className:"bg-pink-100 dark:bg-pink-900 p-3 rounded-lg",children:m.jsx(HN,{className:"w-6 h-6 text-pink-600 dark:text-pink-400"})}),m.jsxs("div",{className:"text-left",children:[m.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Color Organization"}),m.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Organize notes with color coding and visual categorization."})]})]}),m.jsxs("div",{className:"flex items-start gap-4",children:[m.jsx("div",{className:"bg-teal-100 dark:bg-teal-900 p-3 rounded-lg",children:m.jsx(km,{className:"w-6 h-6 text-teal-600 dark:text-teal-400"})}),m.jsxs("div",{className:"text-left",children:[m.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Cross-Platform Sync"}),m.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Access your notes seamlessly across Chrome Extension, Web App, and Mobile Apps (iOS & Android)."})]})]}),m.jsxs("div",{className:"flex items-start gap-4",children:[m.jsx("div",{className:"bg-yellow-100 dark:bg-yellow-900 p-3 rounded-lg",children:m.jsx(YN,{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400"})}),m.jsxs("div",{className:"text-left",children:[m.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2",children:"Offline Support"}),m.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Work offline and sync automatically when you reconnect to the internet."})]})]})]})]}),m.jsxs("section",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8 mb-8",children:[m.jsxs("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:[m.jsx(F3,{className:"w-8 h-8 text-green-600 dark:text-green-400"}),"Privacy Policy"]}),m.jsxs("div",{className:"space-y-6 text-gray-700 dark:text-gray-300",children:[m.jsxs("div",{children:[m.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-3 text-left",children:"1. Information We Collect"}),m.jsx("p",{className:"leading-relaxed mb-4 text-left",children:"LiveNotes collects the following information to provide and improve our services:"}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[m.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-1 text-left",children:m.jsx("strong",{children:"Account Information:"})}),m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm text-left",children:"Email address, display name, and profile picture (when using Google Sign-In)"})]}),m.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[m.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-1 text-left",children:m.jsx("strong",{children:"Note Content:"})}),m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm text-left",children:"All notes, titles, descriptions, and metadata you create"})]}),m.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[m.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-1 text-left",children:m.jsx("strong",{children:"Usage Data:"})}),m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm text-left",children:"How you interact with the app, features used, and performance metrics"})]}),m.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[m.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-1 text-left",children:m.jsx("strong",{children:"Device Information:"})}),m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm text-left",children:"Device type, operating system, and app version for optimization"})]}),m.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[m.jsx("h4",{className:"font-semibold text-gray-900 dark:text-white mb-1 text-left",children:m.jsx("strong",{children:"Collaboration Data:"})}),m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm text-left",children:"Information about shared notes, collaborators, and group memberships"})]})]})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 text-left",children:"2. How We Use Your Information"}),m.jsxs("div",{className:"space-y-3",children:[m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"To provide, maintain, and improve our services"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"To enable real-time synchronization across your devices"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"To facilitate collaboration and sharing features"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"To send you notifications about important updates and collaboration activities"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"To analyze usage patterns and improve user experience"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"To ensure security and prevent fraud"})})]})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-3 text-left",children:"3. Data Security"}),m.jsx("p",{className:"leading-relaxed mb-4 text-left",children:"We take data security seriously and implement industry-standard security measures:"}),m.jsxs("div",{className:"space-y-3",children:[m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"All data is encrypted in transit using SSL/TLS"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"Firebase Authentication ensures secure user authentication"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"Firestore security rules protect your data from unauthorized access"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"Regular security audits and updates"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"Access controls and permission management for shared content"})})]})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-3 text-left",children:"4. Data Sharing"}),m.jsx("p",{className:"leading-relaxed mb-4 text-left",children:"We respect your privacy and do not sell your personal information. We only share data:"}),m.jsxs("div",{className:"space-y-3",children:[m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"When you explicitly choose to share notes or groups with others"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"With service providers (like Firebase) necessary to operate our services"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"When required by law or to protect our rights and safety"})})]})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-3 text-left",children:"5. Your Rights"}),m.jsx("p",{className:"leading-relaxed mb-4 text-left",children:"You have the right to:"}),m.jsxs("div",{className:"space-y-3",children:[m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"Access, update, or delete your personal information"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"Export your notes and data at any time"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"Control sharing permissions for your notes and groups"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"Opt-out of non-essential notifications"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"Delete your account and all associated data"})})]})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 text-left",children:"6. Cookies and Tracking"}),m.jsxs("div",{className:"space-y-3",children:[m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"We use essential cookies and local storage to maintain your session and preferences"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"We do not use third-party tracking cookies or advertising trackers"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"All data is stored securely and used solely to provide our services"})})]})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 text-left",children:"7. Children's Privacy"}),m.jsxs("div",{className:"space-y-3",children:[m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"LiveNotes is not intended for children under 13 years of age"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"We do not knowingly collect personal information from children"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"If you believe we have collected information from a child, please contact us immediately"})})]})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4 text-left",children:"8. Changes to This Policy"}),m.jsxs("div",{className:"space-y-3",children:[m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"We may update this Privacy Policy from time to time"})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:'We will notify you of any significant changes by posting the new policy on this page and updating the "Last Updated" date'})}),m.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:m.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-left",children:"Your continued use of LiveNotes after changes become effective constitutes acceptance of the updated policy"})})]})]})]})]}),m.jsxs("section",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg shadow-lg p-8 text-white",children:[m.jsxs("h2",{className:"text-3xl font-bold mb-6 flex items-center gap-3",children:[m.jsx(cT,{className:"w-8 h-8"}),"Contact Us"]}),m.jsx("p",{className:"text-blue-100 mb-6 leading-relaxed text-left",children:"Have questions about our Privacy Policy, need support, or want to report an issue? We're here to help! Reach out to us through any of the following channels:"}),m.jsxs("div",{className:"space-y-4 text-left",children:[m.jsxs("a",{href:"mailto:enterjpk@gmail.com",className:"flex  gap-4 p-4 bg-white/10 hover:bg-white/20 rounded-lg transition-colors backdrop-blur-sm",children:[m.jsx("div",{className:"bg-white/20 p-3 rounded-lg",children:m.jsx(cT,{className:"w-6 h-6"})}),m.jsxs("div",{children:[m.jsx("div",{className:"font-semibold text-lg",children:"Email"}),m.jsx("div",{className:"text-blue-100",children:"enterjpk@gmail.com"})]})]}),m.jsxs("a",{href:"tel:+919234861665",className:"flex gap-4 p-4 bg-white/10 hover:bg-white/20 rounded-lg transition-colors backdrop-blur-sm",children:[m.jsx("div",{className:"bg-white/20 p-3 rounded-lg",children:m.jsx(C3,{className:"w-6 h-6"})}),m.jsxs("div",{children:[m.jsx("div",{className:"font-semibold text-lg",children:"Phone"}),m.jsx("div",{className:"text-blue-100",children:"+91 92348 61665"})]})]})]}),m.jsx("div",{className:"mt-6 pt-6 border-t border-white/20",children:m.jsx("p",{className:"text-blue-100 text-sm",children:"We typically respond to inquiries within 24-48 hours during business days. For urgent matters, please call us directly."})})]}),m.jsxs("footer",{className:"text-center mt-8 text-gray-600 dark:text-gray-400",children:[m.jsxs("p",{className:"text-sm",children:[" ",new Date().getFullYear()," LiveNotes. All rights reserved."]}),m.jsx("p",{className:"text-xs mt-2",children:"Built with  for seamless note-taking and collaboration"})]})]})});function N6(){return m.jsx(ML,{children:m.jsx(VL,{children:m.jsx(ek,{children:m.jsxs(kR,{children:[m.jsx(af,{path:"/privacy-policy",element:m.jsx(A6,{})}),m.jsx(af,{path:"/share/:shareId",element:m.jsx(I6,{})}),m.jsx(af,{path:"/*",element:m.jsx(FL,{children:m.jsx(b6,{})})})]})})})})}LC.createRoot(document.getElementById("root")).render(m.jsx(V.StrictMode,{children:m.jsx(N6,{})}));
